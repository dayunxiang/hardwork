///<jscompress sourcefile="leaflet-src.js" />
/*
 Leaflet 1.0.3+ed36a04, a JS library for interactive maps. http://leafletjs.com
 (c) 2010-2016 Vladimir Agafonkin, (c) 2010-2011 CloudMade
*////<jscompress sourcefile="leaflet.draw-src.js" />
/*
 Leaflet.draw 0.4.9, a plugin that adds drawing and editing tools to Leaflet powered maps.
 (c) 2012-2017, Jacob Toye, Jon West, Smartrak, Leaflet

 https://github.com/Leaflet/Leaflet.draw
 http://leafletjs.com
 *////<jscompress sourcefile="esri-leaflet-debug.js" />
/* esri-leaflet - v2.0.8 - Tue Mar 21 2017 16:09:38 GMT-0700 (PDT)
 * Copyright (c) 2017 Environmental Systems Research Institute, Inc.
 * Apache-2.0 *////<jscompress sourcefile="leaflet.circle.topolygon-src.js" />
/**
 * @preserve Licensed under MIT License
 *////<jscompress sourcefile="leaflet.geometryutil.js" />
// Packaging/modules magic dance.
///<jscompress sourcefile="leaflet.markercluster.js" />
/*
 Leaflet.markercluster, Provides Beautiful Animated Marker Clustering functionality for Leaflet, a JS library for interactive maps.
 https://github.com/Leaflet/Leaflet.markercluster
 (c) 2012-2013, Dave Leaver, smartrak
*//*
 Licensed under MIT License
*/
(function(n,e,h){function b(){var a=n.L;c.noConflict=function(){n.L=a;return this};n.L=c}var c={version:"1.0.3+ed36a04"};"object"===typeof module&&"object"===typeof module.exports?module.exports=c:"function"===typeof define&&define.amd&&define(c);"undefined"!==typeof n&&b();c.Util={extend:function(a){var c,b,f,l;b=1;for(f=arguments.length;b<f;b++)for(c in l=arguments[b],l)a[c]=l[c];return a},create:Object.create||function(){function a(){}return function(c){a.prototype=c;return new a}}(),bind:function(a,c){var b=Array.prototype.slice;if(a.bind)return a.bind.apply(a,b.call(arguments,1));var f=b.call(arguments,2);return function(){return a.apply(c,f.length?f.concat(b.call(arguments)):arguments)}},stamp:function(a){a._leaflet_id=a._leaflet_id||++c.Util.lastId;return a._leaflet_id},lastId:0,throttle:function(a,c,b){var f,l,d,m;m=function(){f=!1;l&&(d.apply(b,l),l=!1)};return d=function(){f?l=arguments:(a.apply(b,arguments),setTimeout(m,c),f=!0)}},wrapNum:function(a,c,b){var f=c[1];c=c[0];var l=f-c;return a===f&&b?a:((a-c)%l+l)%l+c},falseFn:function(){return!1},formatNum:function(a,c){var b=Math.pow(10,c||5);return Math.round(a*b)/b},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return c.Util.trim(a).split(/\s+/)},setOptions:function(a,k){a.hasOwnProperty("options")||(a.options=a.options?c.Util.create(a.options):{});for(var b in k)a.options[b]=k[b];return a.options},getParamString:function(a,c,b){var f=[],l;for(l in a)f.push(encodeURIComponent(b?l.toUpperCase():l)+"\x3d"+encodeURIComponent(a[l]));return(c&&-1!==c.indexOf("?")?"\x26":"?")+f.join("\x26")},template:function(a,k){return a.replace(c.Util.templateRe,function(a,c){var b=k[c];if(b===h)throw Error("No value provided for variable "+a);"function"===typeof b&&(b=b(k));return b})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},indexOf:function(a,c){for(var b=0;b<a.length;b++)if(a[b]===c)return b;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d"};(function(){function a(a){return n["webkit"+a]||n["moz"+a]||n["ms"+a]}function k(a){var c=+new Date,k=Math.max(0,16-(c-b));b=c+k;return n.setTimeout(a,k)}var b=0,f=n.requestAnimationFrame||a("RequestAnimationFrame")||k,l=n.cancelAnimationFrame||a("CancelAnimationFrame")||a("CancelRequestAnimationFrame")||function(a){n.clearTimeout(a)};c.Util.requestAnimFrame=function(a,b,g){if(g&&f===k)a.call(b);else return f.call(n,c.bind(a,b))};c.Util.cancelAnimFrame=function(a){a&&l.call(n,a)}})();c.extend=c.Util.extend;c.bind=c.Util.bind;c.stamp=c.Util.stamp;c.setOptions=c.Util.setOptions;c.Class=function(){};c.Class.extend=function(a){var k=function(){this.initialize&&this.initialize.apply(this,arguments);this.callInitHooks()},b=k.__super__=this.prototype,f=c.Util.create(b);f.constructor=k;k.prototype=f;for(var l in this)this.hasOwnProperty(l)&&"prototype"!==l&&(k[l]=this[l]);a.statics&&(c.extend(k,a.statics),delete a.statics);a.includes&&(c.Util.extend.apply(null,[f].concat(a.includes)),delete a.includes);f.options&&(a.options=c.Util.extend(c.Util.create(f.options),a.options));c.extend(f,a);f._initHooks=[];f.callInitHooks=function(){if(!this._initHooksCalled){b.callInitHooks&&b.callInitHooks.call(this);this._initHooksCalled=!0;for(var a=0,c=f._initHooks.length;a<c;a++)f._initHooks[a].call(this)}};return k};c.Class.include=function(a){c.extend(this.prototype,a);return this};c.Class.mergeOptions=function(a){c.extend(this.prototype.options,a);return this};c.Class.addInitHook=function(a){var c=Array.prototype.slice.call(arguments,1);this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push("function"===typeof a?a:function(){this[a].apply(this,c)});return this};c.Evented=c.Class.extend({on:function(a,k,b){if("object"===typeof a)for(var f in a)this._on(f,a[f],k);else{a=c.Util.splitWords(a);f=0;for(var l=a.length;f<l;f++)this._on(a[f],k,b)}return this},off:function(a,k,b){if(a)if("object"===typeof a)for(var f in a)this._off(f,a[f],k);else{a=c.Util.splitWords(a);f=0;for(var l=a.length;f<l;f++)this._off(a[f],k,b)}else delete this._events;return this},_on:function(a,c,b){this._events=this._events||{};var f=this._events[a];f||(f=[],this._events[a]=f);b===this&&(b=h);a={fn:c,ctx:b};for(var l=0,d=f.length;l<d;l++)if(f[l].fn===c&&f[l].ctx===b)return;f.push(a)},_off:function(a,k,b){var f,l,d;if(this._events&&(f=this._events[a]))if(k){if(b===this&&(b=h),f)for(l=0,d=f.length;l<d;l++){var m=f[l];if(m.ctx===b&&m.fn===k){m.fn=c.Util.falseFn;this._firingCount&&(this._events[a]=f=f.slice());f.splice(l,1);break}}}else{l=0;for(d=f.length;l<d;l++)f[l].fn=c.Util.falseFn;delete this._events[a]}},fire:function(a,k,b){if(!this.listens(a,b))return this;k=c.Util.extend({},k,{type:a,target:this});if(this._events&&(a=this._events[a])){this._firingCount=this._firingCount+1||1;for(var f=0,l=a.length;f<l;f++){var d=a[f];d.fn.call(d.ctx||this,k)}this._firingCount--}b&&this._propagateEvent(k);return this},listens:function(a,c){var b=this._events&&this._events[a];if(b&&b.length)return!0;if(c)for(var f in this._eventParents)if(this._eventParents[f].listens(a,c))return!0;return!1},once:function(a,k,b){if("object"===typeof a){for(var f in a)this.once(f,a[f],k);return this}var l=c.bind(function(){this.off(a,k,b).off(a,l,b)},this);return this.on(a,k,b).on(a,l,b)},addEventParent:function(a){this._eventParents=this._eventParents||{};this._eventParents[c.stamp(a)]=a;return this},removeEventParent:function(a){this._eventParents&&delete this._eventParents[c.stamp(a)];return this},_propagateEvent:function(a){for(var k in this._eventParents)this._eventParents[k].fire(a.type,c.extend({layer:a.target},a),!0)}});var d=c.Evented.prototype;d.addEventListener=d.on;d.removeEventListener=d.clearAllEventListeners=d.off;d.addOneTimeEventListener=d.once;d.fireEvent=d.fire;d.hasEventListeners=d.listens;c.Mixin={Events:d};(function(){var a=navigator.userAgent.toLowerCase(),k=e.documentElement,b="ActiveXObject"in n,f=-1!==a.indexOf("webkit"),l=-1!==a.indexOf("phantom"),d=-1!==a.search("android [23]"),m=-1!==a.indexOf("chrome"),h=-1!==a.indexOf("gecko")&&!f&&!n.opera&&!b,p=0===navigator.platform.indexOf("Win"),r="undefined"!==typeof orientation||-1!==a.indexOf("mobile"),t=!n.PointerEvent&&n.MSPointerEvent,u=n.PointerEvent||t,v=b&&"transition"in k.style,x="WebKitCSSMatrix"in n&&"m11"in new n.WebKitCSSMatrix&&!d,y="MozPerspective"in k.style,k="OTransition"in k.style,z=!n.L_NO_TOUCH&&(u||"ontouchstart"in n||n.DocumentTouch&&e instanceof n.DocumentTouch);c.Browser={ie:b,ielt9:b&&!e.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in e),webkit:f,gecko:h,android:-1!==a.indexOf("android"),android23:d,chrome:m,safari:!m&&-1!==a.indexOf("safari"),win:p,ie3d:v,webkit3d:x,gecko3d:y,opera12:k,any3d:!n.L_DISABLE_3D&&(v||x||y)&&!k&&!l,mobile:r,mobileWebkit:r&&f,mobileWebkit3d:r&&x,mobileOpera:r&&n.opera,mobileGecko:r&&h,touch:!!z,msPointer:!!t,pointer:!!u,retina:1<(n.devicePixelRatio||n.screen.deviceXDPI/n.screen.logicalXDPI)}})();c.Point=function(a,c,b){this.x=b?Math.round(a):a;this.y=b?Math.round(c):c};c.Point.prototype={clone:function(){return new c.Point(this.x,this.y)},add:function(a){return this.clone()._add(c.point(a))},_add:function(a){this.x+=a.x;this.y+=a.y;return this},subtract:function(a){return this.clone()._subtract(c.point(a))},_subtract:function(a){this.x-=a.x;this.y-=a.y;return this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){this.x/=a;this.y/=a;return this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){this.x*=a;this.y*=a;return this},scaleBy:function(a){return new c.Point(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new c.Point(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},floor:function(){return this.clone()._floor()},_floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){return this.clone()._ceil()},_ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},distanceTo:function(a){a=c.point(a);var k=a.x-this.x;a=a.y-this.y;return Math.sqrt(k*k+a*a)},equals:function(a){a=c.point(a);return a.x===this.x&&a.y===this.y},contains:function(a){a=c.point(a);return Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+c.Util.formatNum(this.x)+", "+c.Util.formatNum(this.y)+")"}};c.point=function(a,k,b){return a instanceof c.Point?a:c.Util.isArray(a)?new c.Point(a[0],a[1]):a===h||null===a?a:"object"===typeof a&&"x"in a&&"y"in a?new c.Point(a.x,a.y):new c.Point(a,k,b)};c.Bounds=function(a,c){if(a)for(var b=c?[a,c]:a,f=0,l=b.length;f<l;f++)this.extend(b[f])};c.Bounds.prototype={extend:function(a){a=c.point(a);this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone());return this},getCenter:function(a){return new c.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new c.Point(this.min.x,this.max.y)},getTopRight:function(){return new c.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var k;a="number"===typeof a[0]||a instanceof c.Point?c.point(a):c.bounds(a);a instanceof c.Bounds?(k=a.min,a=a.max):k=a;return k.x>=this.min.x&&a.x<=this.max.x&&k.y>=this.min.y&&a.y<=this.max.y},intersects:function(a){a=c.bounds(a);var k=this.min,b=this.max,f=a.min;a=a.max;var l=a.y>=k.y&&f.y<=b.y;return a.x>=k.x&&f.x<=b.x&&l},overlaps:function(a){a=c.bounds(a);var k=this.min,b=this.max,f=a.min;a=a.max;var l=a.y>k.y&&f.y<b.y;return a.x>k.x&&f.x<b.x&&l},isValid:function(){return!(!this.min||!this.max)}};c.bounds=function(a,k){return!a||a instanceof c.Bounds?a:new c.Bounds(a,k)};c.Transformation=function(a,c,b,f){this._a=a;this._b=c;this._c=b;this._d=f};c.Transformation.prototype={transform:function(a,c){return this._transform(a.clone(),c)},_transform:function(a,c){c=c||1;a.x=c*(this._a*a.x+this._b);a.y=c*(this._c*a.y+this._d);return a},untransform:function(a,k){k=k||1;return new c.Point((a.x/k-this._b)/this._a,(a.y/k-this._d)/this._c)}};c.DomUtil={get:function(a){return"string"===typeof a?e.getElementById(a):a},getStyle:function(a,c){var b=a.style[c]||a.currentStyle&&a.currentStyle[c];b&&"auto"!==b||!e.defaultView||(b=(b=e.defaultView.getComputedStyle(a,null))?b[c]:null);return"auto"===b?null:b},create:function(a,c,b){a=e.createElement(a);a.className=c||"";b&&b.appendChild(a);return a},remove:function(a){var c=a.parentNode;c&&c.removeChild(a)},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},toFront:function(a){a.parentNode.appendChild(a)},toBack:function(a){var c=a.parentNode;c.insertBefore(a,c.firstChild)},hasClass:function(a,k){if(a.classList!==h)return a.classList.contains(k);var b=c.DomUtil.getClass(a);return 0<b.length&&(new RegExp("(^|\\s)"+k+"(\\s|$)")).test(b)},addClass:function(a,k){if(a.classList!==h)for(var b=c.Util.splitWords(k),f=0,l=b.length;f<l;f++)a.classList.add(b[f]);else c.DomUtil.hasClass(a,k)||(b=c.DomUtil.getClass(a),c.DomUtil.setClass(a,(b?b+" ":"")+k))},removeClass:function(a,k){a.classList!==h?a.classList.remove(k):c.DomUtil.setClass(a,c.Util.trim((" "+c.DomUtil.getClass(a)+" ").replace(" "+k+" "," ")))},setClass:function(a,c){a.className.baseVal===h?a.className=c:a.className.baseVal=c},getClass:function(a){return a.className.baseVal===h?a.className:a.className.baseVal},setOpacity:function(a,k){"opacity"in a.style?a.style.opacity=k:"filter"in a.style&&c.DomUtil._setOpacityIE(a,k)},_setOpacityIE:function(a,c){var b=!1;try{b=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(f){if(1===c)return}c=Math.round(100*c);b?(b.Enabled=100!==c,b.Opacity=c):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity\x3d"+c+")"},testProp:function(a){for(var c=e.documentElement.style,b=0;b<a.length;b++)if(a[b]in c)return a[b];return!1},setTransform:function(a,k,b){k=k||new c.Point(0,0);a.style[c.DomUtil.TRANSFORM]=(c.Browser.ie3d?"translate("+k.x+"px,"+k.y+"px)":"translate3d("+k.x+"px,"+k.y+"px,0)")+(b?" scale("+b+")":"")},setPosition:function(a,k){a._leaflet_pos=k;c.Browser.any3d?c.DomUtil.setTransform(a,k):(a.style.left=k.x+"px",a.style.top=k.y+"px")},getPosition:function(a){return a._leaflet_pos||new c.Point(0,0)}};(function(){c.DomUtil.TRANSFORM=c.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var a=c.DomUtil.TRANSITION=c.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);c.DomUtil.TRANSITION_END="webkitTransition"===a||"OTransition"===a?a+"End":"transitionend";if("onselectstart"in e)c.DomUtil.disableTextSelection=function(){c.DomEvent.on(n,"selectstart",c.DomEvent.preventDefault)},c.DomUtil.enableTextSelection=function(){c.DomEvent.off(n,"selectstart",c.DomEvent.preventDefault)};else{var k=c.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);c.DomUtil.disableTextSelection=function(){if(k){var a=e.documentElement.style;this._userSelect=a[k];a[k]="none"}};c.DomUtil.enableTextSelection=function(){k&&(e.documentElement.style[k]=this._userSelect,delete this._userSelect)}}c.DomUtil.disableImageDrag=function(){c.DomEvent.on(n,"dragstart",c.DomEvent.preventDefault)};c.DomUtil.enableImageDrag=function(){c.DomEvent.off(n,"dragstart",c.DomEvent.preventDefault)};c.DomUtil.preventOutline=function(a){for(;-1===a.tabIndex;)a=a.parentNode;a&&a.style&&(c.DomUtil.restoreOutline(),this._outlineElement=a,this._outlineStyle=a.style.outline,a.style.outline="none",c.DomEvent.on(n,"keydown",c.DomUtil.restoreOutline,this))};c.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,c.DomEvent.off(n,"keydown",c.DomUtil.restoreOutline,this))}})();c.LatLng=function(a,c,b){if(isNaN(a)||isNaN(c))throw Error("Invalid LatLng object: ("+a+", "+c+")");this.lat=+a;this.lng=+c;b!==h&&(this.alt=+b)};c.LatLng.prototype={equals:function(a,k){if(!a)return!1;a=c.latLng(a);return Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=(k===h?1E-9:k)},toString:function(a){return"LatLng("+c.Util.formatNum(this.lat,a)+", "+c.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){return c.CRS.Earth.distance(this,c.latLng(a))},wrap:function(){return c.CRS.Earth.wrapLatLng(this)},toBounds:function(a){a=180*a/40075017;var k=a/Math.cos(Math.PI/180*this.lat);return c.latLngBounds([this.lat-a,this.lng-k],[this.lat+a,this.lng+k])},clone:function(){return new c.LatLng(this.lat,this.lng,this.alt)}};c.latLng=function(a,k,b){return a instanceof c.LatLng?a:c.Util.isArray(a)&&"object"!==typeof a[0]?3===a.length?new c.LatLng(a[0],a[1],a[2]):2===a.length?new c.LatLng(a[0],a[1]):null:a===h||null===a?a:"object"===typeof a&&"lat"in a?new c.LatLng(a.lat,"lng"in a?a.lng:a.lon,a.alt):k===h?null:new c.LatLng(a,k,b)};c.LatLngBounds=function(a,c){if(a)for(var b=c?[a,c]:a,f=0,l=b.length;f<l;f++)this.extend(b[f])};c.LatLngBounds.prototype={extend:function(a){var k=this._southWest,b=this._northEast,f;if(a instanceof c.LatLng)f=a;else if(a instanceof c.LatLngBounds){if(f=a._southWest,a=a._northEast,!f||!a)return this}else return a?this.extend(c.latLng(a)||c.latLngBounds(a)):this;k||b?(k.lat=Math.min(f.lat,k.lat),k.lng=Math.min(f.lng,k.lng),b.lat=Math.max(a.lat,b.lat),b.lng=Math.max(a.lng,b.lng)):(this._southWest=new c.LatLng(f.lat,f.lng),this._northEast=new c.LatLng(a.lat,a.lng));return this},pad:function(a){var k=this._southWest,b=this._northEast,f=Math.abs(k.lat-b.lat)*a;a*=Math.abs(k.lng-b.lng);return new c.LatLngBounds(new c.LatLng(k.lat-f,k.lng-a),new c.LatLng(b.lat+f,b.lng+a))},getCenter:function(){return new c.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new c.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new c.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"===typeof a[0]||a instanceof c.LatLng||"lat"in a?c.latLng(a):c.latLngBounds(a);var k=this._southWest,b=this._northEast,f;a instanceof c.LatLngBounds?(f=a.getSouthWest(),a=a.getNorthEast()):f=a;return f.lat>=k.lat&&a.lat<=b.lat&&f.lng>=k.lng&&a.lng<=b.lng},intersects:function(a){a=c.latLngBounds(a);var k=this._southWest,b=this._northEast,f=a.getSouthWest();a=a.getNorthEast();var l=a.lng>=k.lng&&f.lng<=b.lng;return a.lat>=k.lat&&f.lat<=b.lat&&l},overlaps:function(a){a=c.latLngBounds(a);var k=this._southWest,b=this._northEast,f=a.getSouthWest();a=a.getNorthEast();var l=a.lng>k.lng&&f.lng<b.lng;return a.lat>k.lat&&f.lat<b.lat&&l},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(a){if(!a)return!1;a=c.latLngBounds(a);return this._southWest.equals(a.getSouthWest())&&this._northEast.equals(a.getNorthEast())},isValid:function(){return!(!this._southWest||!this._northEast)}};c.latLngBounds=function(a,k){return a instanceof c.LatLngBounds?a:new c.LatLngBounds(a,k)};c.Projection={};c.Projection.LonLat={project:function(a){return new c.Point(a.lng,a.lat)},unproject:function(a){return new c.LatLng(a.y,a.x)},bounds:c.bounds([-180,-90],[180,90])};c.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(a){var k=Math.PI/180,b=this.MAX_LATITUDE,b=Math.sin(Math.max(Math.min(b,a.lat),-b)*k);return new c.Point(this.R*a.lng*k,this.R*Math.log((1+b)/(1-b))/2)},unproject:function(a){var k=180/Math.PI;return new c.LatLng((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*k,a.x*k/this.R)},bounds:function(){var a=6378137*Math.PI;return c.bounds([-a,-a],[a,a])}()};c.CRS={latLngToPoint:function(a,c){var b=this.projection.project(a),f=this.scale(c);return this.transformation._transform(b,f)},pointToLatLng:function(a,c){var b=this.scale(c),b=this.transformation.untransform(a,b);return this.projection.unproject(b)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var k=this.projection.bounds,b=this.scale(a);a=this.transformation.transform(k.min,b);k=this.transformation.transform(k.max,b);return c.bounds(a,k)},infinite:!1,wrapLatLng:function(a){var k=this.wrapLng?c.Util.wrapNum(a.lng,this.wrapLng,!0):a.lng,b=this.wrapLat?c.Util.wrapNum(a.lat,this.wrapLat,!0):a.lat;return c.latLng(b,k,a.alt)},wrapLatLngBounds:function(a){var k=a.getCenter(),b=this.wrapLatLng(k),f=k.lat-b.lat,k=k.lng-b.lng;if(0===f&&0===k)return a;b=a.getSouthWest();a=a.getNorthEast();b=c.latLng({lat:b.lat-f,lng:b.lng-k});f=c.latLng({lat:a.lat-f,lng:a.lng-k});return new c.LatLngBounds(b,f)}};c.CRS.Simple=c.extend({},c.CRS,{projection:c.Projection.LonLat,transformation:new c.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,c){var b=c.lng-a.lng,f=c.lat-a.lat;return Math.sqrt(b*b+f*f)},infinite:!0});c.CRS.Earth=c.extend({},c.CRS,{wrapLng:[-180,180],R:6371E3,distance:function(a,c){var b=Math.PI/180,f=a.lat*b,l=c.lat*b;return this.R*Math.acos(Math.min(Math.sin(f)*Math.sin(l)+Math.cos(f)*Math.cos(l)*Math.cos((c.lng-a.lng)*b),1))}});c.CRS.EPSG3857=c.extend({},c.CRS.Earth,{code:"EPSG:3857",projection:c.Projection.SphericalMercator,transformation:function(){var a=.5/(Math.PI*c.Projection.SphericalMercator.R);return new c.Transformation(a,.5,-a,.5)}()});c.CRS.EPSG900913=c.extend({},c.CRS.EPSG3857,{code:"EPSG:900913"});c.CRS.EPSG4326=c.extend({},c.CRS.Earth,{code:"EPSG:4326",projection:c.Projection.LonLat,transformation:new c.Transformation(1/180,1,-1/180,.5)});c.Map=c.Evented.extend({options:{crs:c.CRS.EPSG3857,center:h,zoom:h,minZoom:h,maxZoom:h,layers:[],maxBounds:h,renderer:h,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,k){k=c.setOptions(this,k);this._initContainer(a);this._initLayout();this._onResize=c.bind(this._onResize,this);this._initEvents();k.maxBounds&&this.setMaxBounds(k.maxBounds);k.zoom!==h&&(this._zoom=this._limitZoom(k.zoom));k.center&&k.zoom!==h&&this.setView(c.latLng(k.center),k.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._sizeChanged=!0;this.callInitHooks();if(this._zoomAnimated=c.DomUtil.TRANSITION&&c.Browser.any3d&&!c.Browser.mobileOpera&&this.options.zoomAnimation)this._createAnimProxy(),c.DomEvent.on(this._proxy,c.DomUtil.TRANSITION_END,this._catchTransitionEnd,this);this._addLayers(this.options.layers)},setView:function(a,k,b){k=k===h?this._zoom:this._limitZoom(k);a=this._limitCenter(c.latLng(a),k,this.options.maxBounds);b=b||{};this._stop();if(this._loaded&&!b.reset&&!0!==b&&(b.animate!==h&&(b.zoom=c.extend({animate:b.animate},b.zoom),b.pan=c.extend({animate:b.animate,duration:b.duration},b.pan)),this._zoom!==k?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,k,b.zoom):this._tryAnimatedPan(a,b.pan)))return clearTimeout(this._sizeTimer),this;this._resetView(a,k);return this},setZoom:function(a,c){return this._loaded?this.setView(this.getCenter(),a,{zoom:c}):(this._zoom=a,this)},zoomIn:function(a,k){a=a||(c.Browser.any3d?this.options.zoomDelta:1);return this.setZoom(this._zoom+a,k)},zoomOut:function(a,k){a=a||(c.Browser.any3d?this.options.zoomDelta:1);return this.setZoom(this._zoom-a,k)},setZoomAround:function(a,k,b){var f=this.getZoomScale(k),l=this.getSize().divideBy(2);a=(a instanceof c.Point?a:this.latLngToContainerPoint(a)).subtract(l).multiplyBy(1-1/f);l=this.containerPointToLatLng(l.add(a));return this.setView(l,k,{zoom:b})},_getBoundsCenterZoom:function(a,k){k=k||{};a=a.getBounds?a.getBounds():c.latLngBounds(a);var b=c.point(k.paddingTopLeft||k.padding||[0,0]),f=c.point(k.paddingBottomRight||k.padding||[0,0]),l=this.getBoundsZoom(a,!1,b.add(f)),l="number"===typeof k.maxZoom?Math.min(k.maxZoom,l):l,b=f.subtract(b).divideBy(2),f=this.project(a.getSouthWest(),l),d=this.project(a.getNorthEast(),l);return{center:this.unproject(f.add(d).divideBy(2).add(b),l),zoom:l}},fitBounds:function(a,k){a=c.latLngBounds(a);if(!a.isValid())throw Error("Bounds are not valid.");var b=this._getBoundsCenterZoom(a,k);return this.setView(b.center,b.zoom,k)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,c){return this.setView(a,this._zoom,{pan:c})},panBy:function(a,k){a=c.point(a).round();k=k||{};if(!a.x&&!a.y)return this.fire("moveend");if(!0!==k.animate&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;this._panAnim||(this._panAnim=new c.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this));k.noMoveStart||this.fire("movestart");if(!1!==k.animate){c.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var b=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,b,k.duration||.25,k.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,k,b){function f(a){a=(x*x-v*v+2.0164*(a?-1:1)*2.0164*y*y)/(4.0328*(a?x:v)*y);a=Math.sqrt(a*a+1)-a;return 1E-9>a?-18:Math.log(a)}function l(a){return(Math.exp(a)+Math.exp(-a))/2}function d(a){return v*(l(z)/l(z+1.42*a))}function m(a){var c=l(z);a=z+1.42*a;a=(Math.exp(a)-Math.exp(-a))/2/l(a);return v*(c*a-(Math.exp(z)-Math.exp(-z))/2)/2.0164}function e(){var b=(Date.now()-B)/I,g=(1-Math.pow(1-b,1.5))*D;1>=b?(this._flyToFrame=c.Util.requestAnimFrame(e,this),this._move(this.unproject(p.add(n.subtract(p).multiplyBy(m(g)/y)),u),this.getScaleZoom(v/d(g),u),{flyTo:!0})):this._move(a,k)._moveEnd(!0)}b=b||{};if(!1===b.animate||!c.Browser.any3d)return this.setView(a,k,b);this._stop();var p=this.project(this.getCenter()),n=this.project(a),t=this.getSize(),u=this._zoom;a=c.latLng(a);k=k===h?u:k;var v=Math.max(t.x,t.y),x=v*this.getZoomScale(u,k),y=n.distanceTo(p)||1,z=f(0),B=Date.now(),D=(f(1)-z)/1.42,I=b.duration?1E3*b.duration:800*D;this._moveStart(!0);e.call(this);return this},flyToBounds:function(a,c){var b=this._getBoundsCenterZoom(a,c);return this.flyTo(b.center,b.zoom,c)},setMaxBounds:function(a){a=c.latLngBounds(a);if(a.isValid())this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds);else return this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds);this.options.maxBounds=a;this._loaded&&this._panInsideMaxBounds();return this.on("moveend",this._panInsideMaxBounds)},setMinZoom:function(a){this.options.minZoom=a;return this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(a):this},setMaxZoom:function(a){this.options.maxZoom=a;return this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(a):this},panInsideBounds:function(a,k){this._enforcingBounds=!0;var b=this.getCenter(),f=this._limitCenter(b,this._zoom,c.latLngBounds(a));b.equals(f)||this.panTo(f,k);this._enforcingBounds=!1;return this},invalidateSize:function(a){if(!this._loaded)return this;a=c.extend({animate:!1,pan:!0},!0===a?{animate:!0}:a);var b=this.getSize();this._sizeChanged=!0;this._lastCenter=null;var g=this.getSize(),f=b.divideBy(2).round(),l=g.divideBy(2).round(),f=f.subtract(l);if(!f.x&&!f.y)return this;a.animate&&a.pan?this.panBy(f):(a.pan&&this._rawPanBy(f),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c.bind(this.fire,this,"moveend"),200)):this.fire("moveend"));return this.fire("resize",{oldSize:b,newSize:g})},stop:function(){this.setZoom(this._limitZoom(this._zoom));this.options.zoomSnap||this.fire("viewreset");return this._stop()},locate:function(a){a=this._locateOptions=c.extend({timeout:1E4,watch:!1},a);if(!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=c.bind(this._handleGeolocationResponse,this),g=c.bind(this._handleGeolocationError,this);a.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,g,a):navigator.geolocation.getCurrentPosition(b,g,a);return this},stopLocate:function(){navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId);this._locateOptions&&(this._locateOptions.setView=!1);return this},_handleGeolocationError:function(a){var c=a.code;a=a.message||(1===c?"permission denied":2===c?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:c,message:"Geolocation error: "+a+"."})},_handleGeolocationResponse:function(a){var b=new c.LatLng(a.coords.latitude,a.coords.longitude),g=b.toBounds(a.coords.accuracy),f=this._locateOptions;if(f.setView){var l=this.getBoundsZoom(g);this.setView(b,f.maxZoom?Math.min(l,f.maxZoom):l)}var b={latlng:b,bounds:g,timestamp:a.timestamp},d;for(d in a.coords)"number"===typeof a.coords[d]&&(b[d]=a.coords[d]);this.fire("locationfound",b)},addHandler:function(a,c){if(!c)return this;var b=this[a]=new c(this);this._handlers.push(b);this.options[a]&&b.enable();return this},remove:function(){this._initEvents(!0);if(this._containerId!==this._container._leaflet_id)throw Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(b){this._containerId=this._container._leaflet_id=h}c.DomUtil.remove(this._mapPane);this._clearControlPos&&this._clearControlPos();this._clearHandlers();this._loaded&&this.fire("unload");for(var a in this._layers)this._layers[a].remove();return this},createPane:function(a,b){var g="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),g=c.DomUtil.create("div",g,b||this._mapPane);a&&(this._panes[a]=g);return g},getCenter:function(){this._checkIfLoaded();return this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),b=this.unproject(a.getBottomLeft()),a=this.unproject(a.getTopRight());return new c.LatLngBounds(b,a)},getMinZoom:function(){return this.options.minZoom===h?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===h?this._layersMaxZoom===h?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,b,g){a=c.latLngBounds(a);g=c.point(g||[0,0]);var f=this.getZoom()||0,l=this.getMinZoom(),d=this.getMaxZoom(),m=a.getNorthWest();a=a.getSouthEast();g=this.getSize().subtract(g);m=c.bounds(this.project(a,f),this.project(m,f)).getSize();a=c.Browser.any3d?this.options.zoomSnap:1;f=this.getScaleZoom(Math.min(g.x/m.x,g.y/m.y),f);a&&(f=a/100*Math.round(f/(a/100)),f=b?Math.ceil(f/a)*a:Math.floor(f/a)*a);return Math.max(l,Math.min(d,f))},getSize:function(){if(!this._size||this._sizeChanged)this._size=new c.Point(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1;return this._size.clone()},getPixelBounds:function(a,b){var g=this._getTopLeftPoint(a,b);return new c.Bounds(g,g.add(this.getSize()))},getPixelOrigin:function(){this._checkIfLoaded();return this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===h?this.getZoom():a)},getPane:function(a){return"string"===typeof a?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,c){var b=this.options.crs;c=c===h?this._zoom:c;return b.scale(a)/b.scale(c)},getScaleZoom:function(a,c){var b=this.options.crs;c=c===h?this._zoom:c;b=b.zoom(a*b.scale(c));return isNaN(b)?Infinity:b},project:function(a,b){b=b===h?this._zoom:b;return this.options.crs.latLngToPoint(c.latLng(a),b)},unproject:function(a,b){b=b===h?this._zoom:b;return this.options.crs.pointToLatLng(c.point(a),b)},layerPointToLatLng:function(a){a=c.point(a).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(a){return this.project(c.latLng(a))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(c.latLng(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(c.latLngBounds(a))},distance:function(a,b){return this.options.crs.distance(c.latLng(a),c.latLng(b))},containerPointToLayerPoint:function(a){return c.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return c.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){a=this.containerPointToLayerPoint(c.point(a));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(c.latLng(a)))},mouseEventToContainerPoint:function(a){return c.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){a=this._container=c.DomUtil.get(a);if(!a)throw Error("Map container not found.");if(a._leaflet_id)throw Error("Map container is already initialized.");c.DomEvent.addListener(a,"scroll",this._onScroll,this);this._containerId=c.Util.stamp(a)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&c.Browser.any3d;c.DomUtil.addClass(a,"leaflet-container"+(c.Browser.touch?" leaflet-touch":"")+(c.Browser.retina?" leaflet-retina":"")+(c.Browser.ielt9?" leaflet-oldie":"")+(c.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=c.DomUtil.getStyle(a,"position");"absolute"!==b&&"relative"!==b&&"fixed"!==b&&(a.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={};this._mapPane=this.createPane("mapPane",this._container);c.DomUtil.setPosition(this._mapPane,new c.Point(0,0));this.createPane("tilePane");this.createPane("shadowPane");this.createPane("overlayPane");this.createPane("markerPane");this.createPane("tooltipPane");this.createPane("popupPane");this.options.markerZoomAnimation||(c.DomUtil.addClass(a.markerPane,"leaflet-zoom-hide"),c.DomUtil.addClass(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,b){c.DomUtil.setPosition(this._mapPane,new c.Point(0,0));var g=!this._loaded;this._loaded=!0;b=this._limitZoom(b);this.fire("viewprereset");var f=this._zoom!==b;this._moveStart(f)._move(a,b)._moveEnd(f);this.fire("viewreset");g&&this.fire("load")},_moveStart:function(a){a&&this.fire("zoomstart");return this.fire("movestart")},_move:function(a,c,b){c===h&&(c=this._zoom);var f=this._zoom!==c;this._zoom=c;this._lastCenter=a;this._pixelOrigin=this._getNewPixelOrigin(a);(f||b&&b.pinch)&&this.fire("zoom",b);return this.fire("move",b)},_moveEnd:function(a){a&&this.fire("zoomend");return this.fire("moveend")},_stop:function(){c.Util.cancelAnimFrame(this._flyToFrame);this._panAnim&&this._panAnim.stop();return this},_rawPanBy:function(a){c.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");},_initEvents:function(a){if(c.DomEvent){this._targets={};this._targets[c.stamp(this._container)]=this;a=a?"off":"on";c.DomEvent[a](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this);if(this.options.trackResize)c.DomEvent[a](n,"resize",this._onResize,this);if(c.Browser.any3d&&this.options.transform3DLimit)this[a]("moveend",this._onMoveEnd)}},_onResize:function(){c.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=c.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0;this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,b){for(var g=[],f,l="mouseout"===b||"mouseover"===b,d=a.target||a.srcElement,m=!1;d;){if((f=this._targets[c.stamp(d)])&&("click"===b||"preclick"===b)&&!a._simulated&&this._draggableMoved(f)){m=!0;break}if(f&&f.listens(b,!0)){if(l&&!c.DomEvent._isExternalTarget(d,a))break;g.push(f);if(l)break}if(d===this._container)break;d=d.parentNode}g.length||m||l||!c.DomEvent._isExternalTarget(d,a)||(g=[this]);return g},_handleDOMEvent:function(a){if(this._loaded&&!c.DomEvent._skipped(a)){var b="keypress"===a.type&&13===a.keyCode?"click":a.type;"mousedown"===b&&c.DomUtil.preventOutline(a.target||a.srcElement);this._fireDOMEvent(a,b)}},_fireDOMEvent:function(a,b,g){if("click"===a.type){var f=c.Util.extend({},a);f.type="preclick";this._fireDOMEvent(f,f.type,g)}if(!a._stopped&&(g=(g||[]).concat(this._findEventTargets(a,b)),g.length)){var l=g[0];"contextmenu"===b&&l.listens(b,!0)&&c.DomEvent.preventDefault(a);f={originalEvent:a};if("keypress"!==a.type){var d=l instanceof c.Marker;f.containerPoint=d?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(a);f.layerPoint=this.containerPointToLayerPoint(f.containerPoint);f.latlng=d?l.getLatLng():this.layerPointToLatLng(f.layerPoint)}for(a=0;a<g.length&&!(g[a].fire(b,f,!0),f.originalEvent._stopped||g[a].options.nonBubblingEvents&&-1!==c.Util.indexOf(g[a].options.nonBubblingEvents,b));a++);}},_draggableMoved:function(a){a=a.dragging&&a.dragging.enabled()?a:this;return a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,c=this._handlers.length;a<c;a++)this._handlers[a].disable()},whenReady:function(a,c){if(this._loaded)a.call(c||this,{target:this});else this.on("load",a,c);return this},_getMapPanePos:function(){return c.DomUtil.getPosition(this._mapPane)||new c.Point(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,c){return(a&&c!==h?this._getNewPixelOrigin(a,c):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,c){var b=this.getSize()._divideBy(2);return this.project(a,c)._subtract(b)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,c,b){b=this._getNewPixelOrigin(b,c);return this.project(a,c)._subtract(b)},_latLngBoundsToNewLayerBounds:function(a,b,g){g=this._getNewPixelOrigin(g,b);return c.bounds([this.project(a.getSouthWest(),b)._subtract(g),this.project(a.getNorthWest(),b)._subtract(g),this.project(a.getSouthEast(),b)._subtract(g),this.project(a.getNorthEast(),b)._subtract(g)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,b,g){if(!g)return a;var f=this.project(a,b),l=this.getSize().divideBy(2),l=new c.Bounds(f.subtract(l),f.add(l));g=this._getBoundsOffset(l,g,b);return g.round().equals([0,0])?a:this.unproject(f.add(g),b)},_limitOffset:function(a,b){if(!b)return a;var g=this.getPixelBounds(),g=new c.Bounds(g.min.add(a),g.max.add(a));return a.add(this._getBoundsOffset(g,b))},_getBoundsOffset:function(a,b,g){g=c.bounds(this.project(b.getNorthEast(),g),this.project(b.getSouthWest(),g));b=g.min.subtract(a.min);g=g.max.subtract(a.max);a=this._rebound(b.x,-g.x);b=this._rebound(b.y,-g.y);return new c.Point(a,b)},_rebound:function(a,c){return 0<a+c?Math.round(a-c)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(c))},_limitZoom:function(a){var b=this.getMinZoom(),g=this.getMaxZoom(),f=c.Browser.any3d?this.options.zoomSnap:1;f&&(a=Math.round(a/f)*f);return Math.max(b,Math.min(g,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){c.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(a,c){var b=this._getCenterOffset(a)._floor();if(!0!==(c&&c.animate)&&!this.getSize().contains(b))return!1;this.panBy(b,c);return!0},_createAnimProxy:function(){var a=this._proxy=c.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a);this.on("zoomanim",function(b){var g=c.DomUtil.TRANSFORM,f=a.style[g];c.DomUtil.setTransform(a,this.project(b.center,b.zoom),this.getZoomScale(b.zoom,1));f===a.style[g]&&this._animatingZoom&&this._onZoomTransitionEnd()},this);this.on("load moveend",function(){var b=this.getCenter(),g=this.getZoom();c.DomUtil.setTransform(a,this.project(b,g),this.getZoomScale(g,1))},this)},_catchTransitionEnd:function(a){this._animatingZoom&&0<=a.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,b,g){if(this._animatingZoom)return!0;g=g||{};if(!this._zoomAnimated||!1===g.animate||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var f=this.getZoomScale(b),f=this._getCenterOffset(a)._divideBy(1-1/f);if(!0!==g.animate&&!this.getSize().contains(f))return!1;c.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(a,b,!0)},this);return!0},_animateZoom:function(a,b,g,f){g&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=b,c.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"));this.fire("zoomanim",{center:a,zoom:b,noUpdate:f});setTimeout(c.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(c.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),c.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}});c.map=function(a,b){return new c.Map(a,b)};c.Layer=c.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[],attribution:null},addTo:function(a){a.addLayer(this);return this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){a&&a.removeLayer(this);return this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){this._map._targets[c.stamp(a)]=this;return this},removeInteractiveTarget:function(a){delete this._map._targets[c.stamp(a)];return this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var c=a.target;if(c.hasLayer(this)){this._map=c;this._zoomAnimated=c._zoomAnimated;if(this.getEvents){var b=this.getEvents();c.on(b,this);this.once("remove",function(){c.off(b,this)},this)}this.onAdd(c);this.getAttribution&&c.attributionControl&&c.attributionControl.addAttribution(this.getAttribution());this.fire("add");c.fire("layeradd",{layer:this})}}});c.Map.include({addLayer:function(a){var b=c.stamp(a);if(this._layers[b])return this;this._layers[b]=a;a._mapToAdd=this;a.beforeAdd&&a.beforeAdd(this);this.whenReady(a._layerAdd,a);return this},removeLayer:function(a){var b=c.stamp(a);if(!this._layers[b])return this;if(this._loaded)a.onRemove(this);a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution());delete this._layers[b];this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove"));a._map=a._mapToAdd=null;return this},hasLayer:function(a){return!!a&&c.stamp(a)in this._layers},eachLayer:function(a,c){for(var b in this._layers)a.call(c,this._layers[b]);return this},_addLayers:function(a){a=a?c.Util.isArray(a)?a:[a]:[];for(var b=0,g=a.length;b<g;b++)this.addLayer(a[b])},_addZoomLimit:function(a){if(isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))this._zoomBoundLayers[c.stamp(a)]=a,this._updateZoomLevels()},_removeZoomLimit:function(a){a=c.stamp(a);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var a=Infinity,c=-Infinity,b=this._getZoomSpan(),f;for(f in this._zoomBoundLayers)var l=this._zoomBoundLayers[f].options,a=l.minZoom===h?a:Math.min(a,l.minZoom),c=l.maxZoom===h?c:Math.max(c,l.maxZoom);this._layersMaxZoom=-Infinity===c?h:c;this._layersMinZoom=Infinity===a?h:a;b!==this._getZoomSpan()&&this.fire("zoomlevelschange");this.options.maxZoom===h&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom);this.options.minZoom===h&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});c.DomEvent={on:function(a,b,g,f){if("object"===typeof b)for(var l in b)this._on(a,l,b[l],g);else{b=c.Util.splitWords(b);l=0;for(var d=b.length;l<d;l++)this._on(a,b[l],g,f)}return this},off:function(a,b,g,f){if("object"===typeof b)for(var l in b)this._off(a,l,b[l],g);else{b=c.Util.splitWords(b);l=0;for(var d=b.length;l<d;l++)this._off(a,b[l],g,f)}return this},_on:function(a,b,g,f){var l=b+c.stamp(g)+(f?"_"+c.stamp(f):"");if(a._leaflet_events&&a._leaflet_events[l])return this;var d=function(c){return g.call(f||a,c||n.event)},m=d;c.Browser.pointer&&0===b.indexOf("touch")?this.addPointerListener(a,b,d,l):!c.Browser.touch||"dblclick"!==b||!this.addDoubleTapListener||c.Browser.pointer&&c.Browser.chrome?"addEventListener"in a?"mousewheel"===b?a.addEventListener("onwheel"in a?"wheel":"mousewheel",d,!1):"mouseenter"===b||"mouseleave"===b?(d=function(b){b=b||n.event;c.DomEvent._isExternalTarget(a,b)&&m(b)},a.addEventListener("mouseenter"===b?"mouseover":"mouseout",d,!1)):("click"===b&&c.Browser.android&&(d=function(a){return c.DomEvent._filterClick(a,m)}),a.addEventListener(b,d,!1)):"attachEvent"in a&&a.attachEvent("on"+b,d):this.addDoubleTapListener(a,d,l);a._leaflet_events=a._leaflet_events||{};a._leaflet_events[l]=d;return this},_off:function(a,b,g,f){g=b+c.stamp(g)+(f?"_"+c.stamp(f):"");f=a._leaflet_events&&a._leaflet_events[g];if(!f)return this;c.Browser.pointer&&0===b.indexOf("touch")?this.removePointerListener(a,b,g):c.Browser.touch&&"dblclick"===b&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,g):"removeEventListener"in a?"mousewheel"===b?a.removeEventListener("onwheel"in a?"wheel":"mousewheel",f,!1):a.removeEventListener("mouseenter"===b?"mouseover":"mouseleave"===b?"mouseout":b,f,!1):"detachEvent"in a&&a.detachEvent("on"+b,f);a._leaflet_events[g]=null;return this},stopPropagation:function(a){a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0;c.DomEvent._skipped(a);return this},disableScrollPropagation:function(a){return c.DomEvent.on(a,"mousewheel",c.DomEvent.stopPropagation)},disableClickPropagation:function(a){var b=c.DomEvent.stopPropagation;c.DomEvent.on(a,c.Draggable.START.join(" "),b);return c.DomEvent.on(a,{click:c.DomEvent._fakeStop,dblclick:b})},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;return this},stop:function(a){return c.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,b){if(!b)return new c.Point(a.clientX,a.clientY);var g=b.getBoundingClientRect();return new c.Point(a.clientX-g.left-b.clientLeft,a.clientY-g.top-b.clientTop)},_wheelPxFactor:c.Browser.win&&c.Browser.chrome?2:c.Browser.gecko?n.devicePixelRatio:1,getWheelDelta:function(a){return c.Browser.edge?a.wheelDeltaY/2:a.deltaY&&0===a.deltaMode?-a.deltaY/c.DomEvent._wheelPxFactor:a.deltaY&&1===a.deltaMode?20*-a.deltaY:a.deltaY&&2===a.deltaMode?60*-a.deltaY:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&32765>Math.abs(a.detail)?20*-a.detail:a.detail?a.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(a){c.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var c=this._skipEvents[a.type];this._skipEvents[a.type]=!1;return c},_isExternalTarget:function(a,c){var b=c.relatedTarget;if(!b)return!0;try{for(;b&&b!==a;)b=b.parentNode}catch(f){return!1}return b!==a},_filterClick:function(a,b){var g=a.timeStamp||a.originalEvent&&a.originalEvent.timeStamp,f=c.DomEvent._lastClick&&g-c.DomEvent._lastClick;f&&100<f&&500>f||a.target._simulatedClick&&!a._simulated?c.DomEvent.stop(a):(c.DomEvent._lastClick=g,b(a))}};c.DomEvent.addListener=c.DomEvent.on;c.DomEvent.removeListener=c.DomEvent.off;c.PosAnimation=c.Evented.extend({run:function(a,b,g,f){this.stop();this._el=a;this._inProgress=!0;this._duration=g||.25;this._easeOutPower=1/Math.max(f||.5,.2);this._startPos=c.DomUtil.getPosition(a);this._offset=b.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=c.Util.requestAnimFrame(this._animate,this);this._step()},_step:function(a){var c=+new Date-this._startTime,b=1E3*this._duration;c<b?this._runFrame(this._easeOut(c/b),a):(this._runFrame(1),this._complete())},_runFrame:function(a,b){var g=this._startPos.add(this._offset.multiplyBy(a));b&&g._round();c.DomUtil.setPosition(this._el,g);this.fire("step")},_complete:function(){c.Util.cancelAnimFrame(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}});c.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:c.bounds([-2.003750834279E7,-1.549657073972E7],[2.003750834279E7,1.876465623138E7]),project:function(a){var b=Math.PI/180,g=this.R,f=a.lat*b,l=this.R_MINOR/g,l=Math.sqrt(1-l*l),d=l*Math.sin(f),f=-g*Math.log(Math.max(Math.tan(Math.PI/4-f/2)/Math.pow((1-d)/(1+d),l/2),1E-10));return new c.Point(a.lng*b*g,f)},unproject:function(a){for(var b=180/Math.PI,g=this.R,f=this.R_MINOR/g,f=Math.sqrt(1-f*f),l=Math.exp(-a.y/g),d=Math.PI/2-2*Math.atan(l),m=0,e=.1;15>m&&1E-7<Math.abs(e);m++)e=f*Math.sin(d),e=Math.pow((1-e)/(1+e),f/2),e=Math.PI/2-2*Math.atan(l*e)-d,d+=e;return new c.LatLng(d*b,a.x*b/g)}};c.CRS.EPSG3395=c.extend({},c.CRS.Earth,{code:"EPSG:3395",projection:c.Projection.Mercator,transformation:function(){var a=.5/(Math.PI*c.Projection.Mercator.R);return new c.Transformation(a,.5,-a,.5)}()});c.GridLayer=c.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:c.Browser.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:h,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){c.setOptions(this,a)},onAdd:function(){this._initContainer();this._levels={};this._tiles={};this._resetView();this._update()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles();c.DomUtil.remove(this._container);a._removeZoomLimit(this);this._tileZoom=this._container=null},bringToFront:function(){this._map&&(c.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max));return this},bringToBack:function(){this._map&&(c.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min));return this},getContainer:function(){return this._container},setOpacity:function(a){this.options.opacity=a;this._updateOpacity();return this},setZIndex:function(a){this.options.zIndex=a;this._updateZIndex();return this},isLoading:function(){return this._loading},redraw:function(){this._map&&(this._removeAllTiles(),this._update());return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};this.options.updateWhenIdle||(this._onMove||(this._onMove=c.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove);this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},createTile:function(){return e.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof c.Point?a:new c.Point(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==h&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var c=this.getPane().children,b=-a(-Infinity,Infinity),f=0,l=c.length,d;f<l;f++)d=c[f].style.zIndex,c[f]!==this._container&&d&&(b=a(b,+d));isFinite(b)&&(this.options.zIndex=b+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!c.Browser.ielt9){c.DomUtil.setOpacity(this._container,this.options.opacity);var a=+new Date,b=!1,g=!1,f;for(f in this._tiles){var l=this._tiles[f];if(l.current&&l.loaded){var d=Math.min(1,(a-l.loaded)/200);c.DomUtil.setOpacity(l.el,d);1>d?b=!0:(l.active&&(g=!0),l.active=!0)}}g&&!this._noPrune&&this._pruneTiles();b&&(c.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=c.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=c.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),1>this.options.opacity&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,b=this.options.maxZoom;if(a===h)return h;for(var g in this._levels)this._levels[g].el.children.length||g===a?this._levels[g].el.style.zIndex=b-Math.abs(a-g):(c.DomUtil.remove(this._levels[g].el),this._removeTilesAtZoom(g),delete this._levels[g]);g=this._levels[a];var f=this._map;g||(g=this._levels[a]={},g.el=c.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),g.el.style.zIndex=b,g.origin=f.project(f.unproject(f.getPixelOrigin()),a).round(),g.zoom=a,this._setZoomTransform(g,f.getCenter(),f.getZoom()),c.Util.falseFn(g.el.offsetWidth));return this._level=g},_pruneTiles:function(){if(this._map){var a,c;c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom)this._removeAllTiles();else{for(a in this._tiles)c=this._tiles[a],c.retain=c.current;for(a in this._tiles)c=this._tiles[a],c.current&&!c.active&&(c=c.coords,this._retainParent(c.x,c.y,c.z,c.z-5)||this._retainChildren(c.x,c.y,c.z,c.z+2));for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}}},_removeTilesAtZoom:function(a){for(var c in this._tiles)this._tiles[c].coords.z===a&&this._removeTile(c)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)c.DomUtil.remove(this._levels[a].el),delete this._levels[a];this._removeAllTiles();this._tileZoom=null},_retainParent:function(a,b,g,f){a=Math.floor(a/2);b=Math.floor(b/2);--g;var l=new c.Point(+a,+b);l.z=+g;l=this._tileCoordsToKey(l);if((l=this._tiles[l])&&l.active)return l.retain=!0;l&&l.loaded&&(l.retain=!0);return g>f?this._retainParent(a,b,g,f):!1},_retainChildren:function(a,b,g,f){for(var l=2*a;l<2*a+2;l++)for(var d=2*b;d<2*b+2;d++){var m=new c.Point(l,d);m.z=g+1;m=this._tileCoordsToKey(m);(m=this._tiles[m])&&m.active?m.retain=!0:(m&&m.loaded&&(m.retain=!0),g+1<f&&this._retainChildren(l,d,g+1,f))}},_resetView:function(a){a=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_setView:function(a,c,b,f){var l=Math.round(c);if(this.options.maxZoom!==h&&l>this.options.maxZoom||this.options.minZoom!==h&&l<this.options.minZoom)l=h;var d=this.options.updateWhenZooming&&l!==this._tileZoom;if(!f||d)this._tileZoom=l,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),l!==h&&this._update(a),b||this._pruneTiles(),this._noPrune=!!b;this._setZoomTransforms(a,c)},_setZoomTransforms:function(a,c){for(var b in this._levels)this._setZoomTransform(this._levels[b],a,c)},_setZoomTransform:function(a,b,g){var f=this._map.getZoomScale(g,a.zoom);b=a.origin.multiplyBy(f).subtract(this._map._getNewPixelOrigin(b,g)).round();c.Browser.any3d?c.DomUtil.setTransform(a.el,b,f):c.DomUtil.setPosition(a.el,b)},_resetGrid:function(){var a=this._map,c=a.options.crs,b=this._tileSize=this.getTileSize(),f=this._tileZoom,l=this._map.getPixelWorldBounds(this._tileZoom);l&&(this._globalTileRange=this._pxBoundsToTileRange(l));this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,c.wrapLng[0]],f).x/b.x),Math.ceil(a.project([0,c.wrapLng[1]],f).x/b.y)];this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([c.wrapLat[0],0],f).y/b.x),Math.ceil(a.project([c.wrapLat[1],0],f).y/b.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(a){var b=this._map,g=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),g=b.getZoomScale(g,this._tileZoom);a=b.project(a,this._tileZoom).floor();b=b.getSize().divideBy(2*g);return new c.Bounds(a.subtract(b),a.add(b))},_update:function(a){var b=this._map;if(b){var g=b.getZoom();a===h&&(a=b.getCenter());if(this._tileZoom!==h){var b=this._getTiledPixelBounds(a),f=this._pxBoundsToTileRange(b),l=f.getCenter(),b=[],d=this.options.keepBuffer,d=new c.Bounds(f.getBottomLeft().subtract([d,-d]),f.getTopRight().add([d,-d])),m;for(m in this._tiles){var q=this._tiles[m].coords;q.z===this._tileZoom&&d.contains(c.point(q.x,q.y))||(this._tiles[m].current=!1)}if(1<Math.abs(g-this._tileZoom))this._setView(a,g);else{for(g=f.min.y;g<=f.max.y;g++)for(a=f.min.x;a<=f.max.x;a++)m=new c.Point(a,g),m.z=this._tileZoom,this._isValidTile(m)&&((d=this._tiles[this._tileCoordsToKey(m)])?d.current=!0:b.push(m));b.sort(function(a,c){return a.distanceTo(l)-c.distanceTo(l)});if(0!==b.length){this._loading||(this._loading=!0,this.fire("loading"));f=e.createDocumentFragment();for(a=0;a<b.length;a++)this._addTile(b[a],f);this._level.el.appendChild(f)}}}}},_isValidTile:function(a){var b=this._map.options.crs;if(!b.infinite){var g=this._globalTileRange;if(!b.wrapLng&&(a.x<g.min.x||a.x>g.max.x)||!b.wrapLat&&(a.y<g.min.y||a.y>g.max.y))return!1}if(!this.options.bounds)return!0;a=this._tileCoordsToBounds(a);return c.latLngBounds(this.options.bounds).overlaps(a)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToBounds:function(a){var b=this._map,g=this.getTileSize(),f=a.scaleBy(g),g=f.add(g),f=b.unproject(f,a.z);a=b.unproject(g,a.z);a=new c.LatLngBounds(f,a);this.options.noWrap||b.wrapLatLngBounds(a);return a},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){a=a.split(":");var b=new c.Point(+a[0],+a[1]);b.z=+a[2];return b},_removeTile:function(a){var b=this._tiles[a];b&&(c.DomUtil.remove(b.el),delete this._tiles[a],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){c.DomUtil.addClass(a,"leaflet-tile");var b=this.getTileSize();a.style.width=b.x+"px";a.style.height=b.y+"px";a.onselectstart=c.Util.falseFn;a.onmousemove=c.Util.falseFn;c.Browser.ielt9&&1>this.options.opacity&&c.DomUtil.setOpacity(a,this.options.opacity);c.Browser.android&&!c.Browser.android23&&(a.style.WebkitBackfaceVisibility="hidden")},_addTile:function(a,b){var g=this._getTilePos(a),f=this._tileCoordsToKey(a),l=this.createTile(this._wrapCoords(a),c.bind(this._tileReady,this,a));this._initTile(l);2>this.createTile.length&&c.Util.requestAnimFrame(c.bind(this._tileReady,this,a,null,l));c.DomUtil.setPosition(l,g);this._tiles[f]={el:l,coords:a,current:!0};b.appendChild(l);this.fire("tileloadstart",{tile:l,coords:a})},_tileReady:function(a,b,g){this._map&&(b&&this.fire("tileerror",{error:b,tile:g,coords:a}),g=this._tileCoordsToKey(a),g=this._tiles[g])&&(g.loaded=+new Date,this._map._fadeAnimated?(c.DomUtil.setOpacity(g.el,0),c.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=c.Util.requestAnimFrame(this._updateOpacity,this)):(g.active=!0,this._pruneTiles()),b||(c.DomUtil.addClass(g.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:g.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),c.Browser.ielt9||!this._map._fadeAnimated?c.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(c.bind(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var b=new c.Point(this._wrapX?c.Util.wrapNum(a.x,this._wrapX):a.x,this._wrapY?c.Util.wrapNum(a.y,this._wrapY):a.y);b.z=a.z;return b},_pxBoundsToTileRange:function(a){var b=this.getTileSize();return new c.Bounds(a.min.unscaleBy(b).floor(),a.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});c.gridLayer=function(a){return new c.GridLayer(a)};c.TileLayer=c.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,minNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(a,b){this._url=a;b=c.setOptions(this,b);b.detectRetina&&c.Browser.retina&&0<b.maxZoom&&(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom++):(b.zoomOffset++,b.maxZoom--),b.minZoom=Math.max(0,b.minZoom));"string"===typeof b.subdomains&&(b.subdomains=b.subdomains.split(""));if(!c.Browser.android)this.on("tileunload",this._onTileRemove)},setUrl:function(a,c){this._url=a;c||this.redraw();return this},createTile:function(a,b){var g=e.createElement("img");c.DomEvent.on(g,"load",c.bind(this._tileOnLoad,this,b,g));c.DomEvent.on(g,"error",c.bind(this._tileOnError,this,b,g));this.options.crossOrigin&&(g.crossOrigin="");g.alt="";g.setAttribute("role","presentation");g.src=this.getTileUrl(a);return g},getTileUrl:function(a){var b={r:c.Browser.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};this._map&&!this._map.options.crs.infinite&&(a=this._globalTileRange.max.y-a.y,this.options.tms&&(b.y=a),b["-y"]=a);return c.Util.template(this._url,c.extend(b,this.options))},_tileOnLoad:function(a,b){c.Browser.ielt9?setTimeout(c.bind(a,this,null,b),0):a(null,b)},_tileOnError:function(a,c,b){var f=this.options.errorTileUrl;f&&c.src!==f&&(c.src=f);a(b,c)},getTileSize:function(){var a=this._map,b=c.GridLayer.prototype.getTileSize.call(this),g=this._tileZoom+this.options.zoomOffset,f=this.options.minNativeZoom,l=this.options.maxNativeZoom;return null!==f&&g<f?b.divideBy(a.getZoomScale(f,g)).round():null!==l&&g>l?b.divideBy(a.getZoomScale(l,g)).round():b},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,c=this.options.maxZoom,b=this.options.zoomOffset,f=this.options.minNativeZoom,l=this.options.maxNativeZoom;this.options.zoomReverse&&(a=c-a);a+=b;return null!==f&&a<f?f:null!==l&&a>l?l:a},_getSubdomain:function(a){return this.options.subdomains[Math.abs(a.x+a.y)%this.options.subdomains.length]},_abortLoading:function(){var a,b;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&(b=this._tiles[a].el,b.onload=c.Util.falseFn,b.onerror=c.Util.falseFn,b.complete||(b.src=c.Util.emptyImageUrl,c.DomUtil.remove(b)))}});c.tileLayer=function(a,b){return new c.TileLayer(a,b)};c.TileLayer.WMS=c.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,b){this._url=a;var g=c.extend({},this.defaultWmsParams),f;for(f in b)f in this.options||(g[f]=b[f]);b=c.setOptions(this,b);g.width=g.height=b.tileSize*(b.detectRetina&&c.Browser.retina?2:1);this.wmsParams=g},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;c.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var b=this._tileCoordsToBounds(a),g=this._crs.project(b.getNorthWest()),b=this._crs.project(b.getSouthEast()),g=(1.3<=this._wmsVersion&&this._crs===c.CRS.EPSG4326?[b.y,g.x,g.y,b.x]:[g.x,b.y,b.x,g.y]).join(",");a=c.TileLayer.prototype.getTileUrl.call(this,a);return a+c.Util.getParamString(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"\x26BBOX\x3d":"\x26bbox\x3d")+g},setParams:function(a,b){c.extend(this.wmsParams,a);b||this.redraw();return this}});c.tileLayer.wms=function(a,b){return new c.TileLayer.WMS(a,b)};c.ImageOverlay=c.Layer.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1},initialize:function(a,b,g){this._url=a;this._bounds=c.latLngBounds(b);c.setOptions(this,g)},onAdd:function(){this._image||(this._initImage(),1>this.options.opacity&&this._updateOpacity());this.options.interactive&&(c.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image));this.getPane().appendChild(this._image);this._reset()},onRemove:function(){c.DomUtil.remove(this._image);this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){this.options.opacity=a;this._image&&this._updateOpacity();return this},setStyle:function(a){a.opacity&&this.setOpacity(a.opacity);return this},bringToFront:function(){this._map&&c.DomUtil.toFront(this._image);return this},bringToBack:function(){this._map&&c.DomUtil.toBack(this._image);return this},setUrl:function(a){this._url=a;this._image&&(this._image.src=a);return this},setBounds:function(a){this._bounds=a;this._map&&this._reset();return this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._image=c.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));a.onselectstart=c.Util.falseFn;a.onmousemove=c.Util.falseFn;a.onload=c.bind(this.fire,this,"load");this.options.crossOrigin&&(a.crossOrigin="");a.src=this._url;a.alt=this.options.alt},_animateZoom:function(a){var b=this._map.getZoomScale(a.zoom);a=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;c.DomUtil.setTransform(this._image,a,b)},_reset:function(){var a=this._image,b=new c.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),g=b.getSize();c.DomUtil.setPosition(a,b.min);a.style.width=g.x+"px";a.style.height=g.y+"px"},_updateOpacity:function(){c.DomUtil.setOpacity(this._image,this.options.opacity)}});c.imageOverlay=function(a,b,g){return new c.ImageOverlay(a,b,g)};c.Icon=c.Class.extend({initialize:function(a){c.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,c){var b=this._getIconUrl(a);if(!b){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}b=this._createImg(b,c&&"IMG"===c.tagName?c:null);this._setIconStyles(b,a);return b},_setIconStyles:function(a,b){var g=this.options,f=g[b+"Size"];"number"===typeof f&&(f=[f,f]);var f=c.point(f),l=c.point("shadow"===b&&g.shadowAnchor||g.iconAnchor||f&&f.divideBy(2,!0));a.className="leaflet-marker-"+b+" "+(g.className||"");l&&(a.style.marginLeft=-l.x+"px",a.style.marginTop=-l.y+"px");f&&(a.style.width=f.x+"px",a.style.height=f.y+"px")},_createImg:function(a,c){c=c||e.createElement("img");c.src=a;return c},_getIconUrl:function(a){return c.Browser.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});c.icon=function(a){return new c.Icon(a)};c.Icon.Default=c.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){c.Icon.Default.imagePath||(c.Icon.Default.imagePath=this._detectIconPath());return(this.options.imagePath||c.Icon.Default.imagePath)+c.Icon.prototype._getIconUrl.call(this,a)},_detectIconPath:function(){var a=c.DomUtil.create("div","leaflet-default-icon-path",e.body),b=c.DomUtil.getStyle(a,"background-image")||c.DomUtil.getStyle(a,"backgroundImage");e.body.removeChild(a);return 0===b.indexOf("url")?b.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,""):""}});c.Marker=c.Layer.extend({options:{icon:new c.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(a,b){c.setOptions(this,b);this._latlng=c.latLng(a)},onAdd:function(a){if(this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation)a.on("zoomanim",this._animateZoom,this);this._initIcon();this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks());this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this);this._removeIcon();this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var b=this._latlng;this._latlng=c.latLng(a);this.update();return this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(a){this.options.zIndexOffset=a;return this.update()},setIcon:function(a){this.options.icon=a;this._map&&(this._initIcon(),this.update());this._popup&&this.bindPopup(this._popup,this._popup.options);return this},getElement:function(){return this._icon},update:function(){if(this._icon){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),g=a.icon.createIcon(this._icon),f=!1;g!==this._icon&&(this._icon&&this._removeIcon(),f=!0,a.title&&(g.title=a.title),a.alt&&(g.alt=a.alt));c.DomUtil.addClass(g,b);a.keyboard&&(g.tabIndex="0");this._icon=g;if(a.riseOnHover)this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var g=a.icon.createShadow(this._shadow),l=!1;g!==this._shadow&&(this._removeShadow(),l=!0);g&&(c.DomUtil.addClass(g,b),g.alt="");this._shadow=g;1>a.opacity&&this._updateOpacity();f&&this.getPane().appendChild(this._icon);this._initInteraction();g&&l&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex});c.DomUtil.remove(this._icon);this.removeInteractiveTarget(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&c.DomUtil.remove(this._shadow);this._shadow=null},_setPos:function(a){c.DomUtil.setPosition(this._icon,a);this._shadow&&c.DomUtil.setPosition(this._shadow,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(c.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),c.Handler.MarkerDrag)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable());this.dragging=new c.Handler.MarkerDrag(this);a&&this.dragging.enable()}},setOpacity:function(a){this.options.opacity=a;this._map&&this._updateOpacity();return this},_updateOpacity:function(){var a=this.options.opacity;c.DomUtil.setOpacity(this._icon,a);this._shadow&&c.DomUtil.setOpacity(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}});c.marker=function(a,b){return new c.Marker(a,b)};c.DivIcon=c.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){a=a&&"DIV"===a.tagName?a:e.createElement("div");var b=this.options;a.innerHTML=!1!==b.html?b.html:"";b.bgPos&&(b=c.point(b.bgPos),a.style.backgroundPosition=-b.x+"px "+-b.y+"px");this._setIconStyles(a,"icon");return a},createShadow:function(){return null}});c.divIcon=function(a){return new c.DivIcon(a)};c.DivOverlay=c.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(a,b){c.setOptions(this,a);this._source=b},onAdd:function(a){this._zoomAnimated=a._zoomAnimated;this._container||this._initLayout();a._fadeAnimated&&c.DomUtil.setOpacity(this._container,0);clearTimeout(this._removeTimeout);this.getPane().appendChild(this._container);this.update();a._fadeAnimated&&c.DomUtil.setOpacity(this._container,1);this.bringToFront()},onRemove:function(a){a._fadeAnimated?(c.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(c.bind(c.DomUtil.remove,c.DomUtil,this._container),200)):c.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(a){this._latlng=c.latLng(a);this._map&&(this._updatePosition(),this._adjustPan());return this},getContent:function(){return this._content},setContent:function(a){this._content=a;this.update();return this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){this._map&&c.DomUtil.toFront(this._container);return this},bringToBack:function(){this._map&&c.DomUtil.toBack(this._container);return this},_updateContent:function(){if(this._content){var a=this._contentNode,c="function"===typeof this._content?this._content(this._source||this):this._content;if("string"===typeof c)a.innerHTML=c;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),b=c.point(this.options.offset),g=this._getAnchor();this._zoomAnimated?c.DomUtil.setPosition(this._container,a.add(g)):b=b.add(a).add(g);a=this._containerBottom=-b.y;b=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=a+"px";this._container.style.left=b+"px"}},_getAnchor:function(){return[0,0]}});c.Popup=c.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(a){a.openPopup(this);return this},onAdd:function(a){c.DivOverlay.prototype.onAdd.call(this,a);a.fire("popupopen",{popup:this});if(this._source&&(this._source.fire("popupopen",{popup:this},!0),!(this._source instanceof c.Path)))this._source.on("preclick",c.DomEvent.stopPropagation)},onRemove:function(a){c.DivOverlay.prototype.onRemove.call(this,a);a.fire("popupclose",{popup:this});this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof c.Path||this._source.off("preclick",c.DomEvent.stopPropagation))},getEvents:function(){var a=c.DivOverlay.prototype.getEvents.call(this);if("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)a.preclick=this._close;this.options.keepInView&&(a.moveend=this._adjustPan);return a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a=this._container=c.DomUtil.create("div","leaflet-popup "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var b=this._closeButton=c.DomUtil.create("a","leaflet-popup-close-button",a);b.href="#close";b.innerHTML="\x26#215;";c.DomEvent.on(b,"click",this._onCloseButtonClick,this)}b=this._wrapper=c.DomUtil.create("div","leaflet-popup-content-wrapper",a);this._contentNode=c.DomUtil.create("div","leaflet-popup-content",b);c.DomEvent.disableClickPropagation(b).disableScrollPropagation(this._contentNode).on(b,"contextmenu",c.DomEvent.stopPropagation);this._tipContainer=c.DomUtil.create("div","leaflet-popup-tip-container",a);this._tip=c.DomUtil.create("div","leaflet-popup-tip",this._tipContainer)},_updateLayout:function(){var a=this._contentNode,b=a.style;b.width="";b.whiteSpace="nowrap";var g=a.offsetWidth,g=Math.min(g,this.options.maxWidth),g=Math.max(g,this.options.minWidth);b.width=g+1+"px";b.whiteSpace="";b.height="";var g=a.offsetHeight,f=this.options.maxHeight;f&&g>f?(b.height=f+"px",c.DomUtil.addClass(a,"leaflet-popup-scrolled")):c.DomUtil.removeClass(a,"leaflet-popup-scrolled");this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);var b=this._getAnchor();c.DomUtil.setPosition(this._container,a.add(b))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var a=this._map,b=parseInt(c.DomUtil.getStyle(this._container,"marginBottom"),10)||0,b=this._container.offsetHeight+b,g=this._containerWidth,f=new c.Point(this._containerLeft,-b-this._containerBottom);f._add(c.DomUtil.getPosition(this._container));var f=a.layerPointToContainerPoint(f),l=c.point(this.options.autoPanPadding),d=c.point(this.options.autoPanPaddingTopLeft||l),l=c.point(this.options.autoPanPaddingBottomRight||l),m=a.getSize(),e=0,h=0;f.x+g+l.x>m.x&&(e=f.x+g-m.x+l.x);0>f.x-e-d.x&&(e=f.x-d.x);f.y+b+l.y>m.y&&(h=f.y+b-m.y+l.y);0>f.y-h-d.y&&(h=f.y-d.y);(e||h)&&a.fire("autopanstart").panBy([e,h])}},_onCloseButtonClick:function(a){this._close();c.DomEvent.stop(a)},_getAnchor:function(){return c.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});c.popup=function(a,b){return new c.Popup(a,b)};c.Map.mergeOptions({closePopupOnClick:!0});c.Map.include({openPopup:function(a,b,g){a instanceof c.Popup||(a=(new c.Popup(g)).setContent(a));b&&a.setLatLng(b);if(this.hasLayer(a))return this;this._popup&&this._popup.options.autoClose&&this.closePopup();this._popup=a;return this.addLayer(a)},closePopup:function(a){a&&a!==this._popup||(a=this._popup,this._popup=null);a&&this.removeLayer(a);return this}});c.Layer.include({bindPopup:function(a,b){if(a instanceof c.Popup)c.setOptions(a,b),this._popup=a,a._source=this;else{if(!this._popup||b)this._popup=new c.Popup(b,this);this._popup.setContent(a)}this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0);return this},unbindPopup:function(){this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null);return this},openPopup:function(a,b){a instanceof c.Layer||(b=a,a=this);if(a instanceof c.FeatureGroup)for(var g in this._layers){a=this._layers[g];break}b||(b=a.getCenter?a.getCenter():a.getLatLng());this._popup&&this._map&&(this._popup._source=a,this._popup.update(),this._map.openPopup(this._popup,b));return this},closePopup:function(){this._popup&&this._popup._close();return this},togglePopup:function(a){this._popup&&(this._popup._map?this.closePopup():this.openPopup(a));return this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){this._popup&&this._popup.setContent(a);return this},getPopup:function(){return this._popup},_openPopup:function(a){var b=a.layer||a.target;this._popup&&this._map&&(c.DomEvent.stop(a),b instanceof c.Path?this.openPopup(a.layer||a.target,a.latlng):this._map.hasLayer(this._popup)&&this._popup._source===b?this.closePopup():this.openPopup(b,a.latlng))},_movePopup:function(a){this._popup.setLatLng(a.latlng)}});c.Tooltip=c.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(a){c.DivOverlay.prototype.onAdd.call(this,a);this.setOpacity(this.options.opacity);a.fire("tooltipopen",{tooltip:this});this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(a){c.DivOverlay.prototype.onRemove.call(this,a);a.fire("tooltipclose",{tooltip:this});this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var a=c.DivOverlay.prototype.getEvents.call(this);c.Browser.touch&&!this.options.permanent&&(a.preclick=this._close);return a},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=c.DomUtil.create("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var b=this._map,g=this._container,f=b.latLngToContainerPoint(b.getCenter()),b=b.layerPointToContainerPoint(a),l=this.options.direction,d=g.offsetWidth,m=g.offsetHeight,e=c.point(this.options.offset),h=this._getAnchor();"top"===l?a=a.add(c.point(-d/2+e.x,-m+e.y+h.y,!0)):"bottom"===l?a=a.subtract(c.point(d/2-e.x,-e.y,!0)):"center"===l?a=a.subtract(c.point(d/2+e.x,m/2-h.y+e.y,!0)):"right"===l||"auto"===l&&b.x<f.x?(l="right",a=a.add(c.point(e.x+h.x,h.y-m/2+e.y,!0))):(l="left",a=a.subtract(c.point(d+h.x-e.x,m/2-h.y-e.y,!0)));c.DomUtil.removeClass(g,"leaflet-tooltip-right");c.DomUtil.removeClass(g,"leaflet-tooltip-left");c.DomUtil.removeClass(g,"leaflet-tooltip-top");c.DomUtil.removeClass(g,"leaflet-tooltip-bottom");c.DomUtil.addClass(g,"leaflet-tooltip-"+l);c.DomUtil.setPosition(g,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a;this._container&&c.DomUtil.setOpacity(this._container,a)},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(a)},_getAnchor:function(){return c.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});c.tooltip=function(a,b){return new c.Tooltip(a,b)};c.Map.include({openTooltip:function(a,b,g){a instanceof c.Tooltip||(a=(new c.Tooltip(g)).setContent(a));b&&a.setLatLng(b);return this.hasLayer(a)?this:this.addLayer(a)},closeTooltip:function(a){a&&this.removeLayer(a);return this}});c.Layer.include({bindTooltip:function(a,b){if(a instanceof c.Tooltip)c.setOptions(a,b),this._tooltip=a,a._source=this;else{if(!this._tooltip||b)this._tooltip=c.tooltip(b,this);this._tooltip.setContent(a)}this._initTooltipInteractions();this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip();return this},unbindTooltip:function(){this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null);return this},_initTooltipInteractions:function(a){if(a||!this._tooltipHandlersAdded){var b={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?b.add=this._openTooltip:(b.mouseover=this._openTooltip,b.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(b.mousemove=this._moveTooltip),c.Browser.touch&&(b.click=this._openTooltip));this[a?"off":"on"](b);this._tooltipHandlersAdded=!a}},openTooltip:function(a,b){a instanceof c.Layer||(b=a,a=this);if(a instanceof c.FeatureGroup)for(var g in this._layers){a=this._layers[g];break}b||(b=a.getCenter?a.getCenter():a.getLatLng());this._tooltip&&this._map&&(this._tooltip._source=a,this._tooltip.update(),this._map.openTooltip(this._tooltip,b),this._tooltip.options.interactive&&this._tooltip._container&&(c.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container)));return this},closeTooltip:function(){this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(c.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container)));return this},toggleTooltip:function(a){this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(a));return this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){this._tooltip&&this._tooltip.setContent(a);return this},getTooltip:function(){return this._tooltip},_openTooltip:function(a){var c=a.layer||a.target;this._tooltip&&this._map&&this.openTooltip(c,this._tooltip.options.sticky?a.latlng:h)},_moveTooltip:function(a){var c=a.latlng;this._tooltip.options.sticky&&a.originalEvent&&(a=this._map.mouseEventToContainerPoint(a.originalEvent),a=this._map.containerPointToLayerPoint(a),c=this._map.layerPointToLatLng(a));this._tooltip.setLatLng(c)}});c.LayerGroup=c.Layer.extend({initialize:function(a){this._layers={};var c,b;if(a)for(c=0,b=a.length;c<b;c++)this.addLayer(a[c])},addLayer:function(a){var c=this.getLayerId(a);this._layers[c]=a;this._map&&this._map.addLayer(a);return this},removeLayer:function(a){a=a in this._layers?a:this.getLayerId(a);this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]);delete this._layers[a];return this},hasLayer:function(a){return!!a&&(a in this._layers||this.getLayerId(a)in this._layers)},clearLayers:function(){for(var a in this._layers)this.removeLayer(this._layers[a]);return this},invoke:function(a){var c=Array.prototype.slice.call(arguments,1),b,f;for(b in this._layers)f=this._layers[b],f[a]&&f[a].apply(f,c);return this},onAdd:function(a){for(var c in this._layers)a.addLayer(this._layers[c])},onRemove:function(a){for(var c in this._layers)a.removeLayer(this._layers[c])},eachLayer:function(a,c){for(var b in this._layers)a.call(c,this._layers[b]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[],c;for(c in this._layers)a.push(this._layers[c]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return c.stamp(a)}});c.layerGroup=function(a){return new c.LayerGroup(a)};c.FeatureGroup=c.LayerGroup.extend({addLayer:function(a){if(this.hasLayer(a))return this;a.addEventParent(this);c.LayerGroup.prototype.addLayer.call(this,a);return this.fire("layeradd",{layer:a})},removeLayer:function(a){if(!this.hasLayer(a))return this;a in this._layers&&(a=this._layers[a]);a.removeEventParent(this);c.LayerGroup.prototype.removeLayer.call(this,a);return this.fire("layerremove",{layer:a})},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new c.LatLngBounds,b;for(b in this._layers){var g=this._layers[b];a.extend(g.getBounds?g.getBounds():g.getLatLng())}return a}});c.featureGroup=function(a){return new c.FeatureGroup(a)};c.Renderer=c.Layer.extend({options:{padding:.1},initialize:function(a){c.setOptions(this,a);c.stamp(this);this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&c.DomUtil.addClass(this._container,"leaflet-zoom-animated"));this.getPane().appendChild(this._container);this._update();this.on("update",this._updatePaths,this)},onRemove:function(){c.DomUtil.remove(this._container);this.off("update",this._updatePaths,this)},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};this._zoomAnimated&&(a.zoomanim=this._onAnimZoom);return a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,b){var g=this._map.getZoomScale(b,this._zoom),f=c.DomUtil.getPosition(this._container),l=this._map.getSize().multiplyBy(.5+this.options.padding),d=this._map.project(this._center,b),d=this._map.project(a,b).subtract(d),f=l.multiplyBy(-g).add(f).add(l).subtract(d);c.Browser.any3d?c.DomUtil.setTransform(this._container,f,g):c.DomUtil.setPosition(this._container,f)},_reset:function(){this._update();this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,b=this._map.getSize(),g=this._map.containerPointToLayerPoint(b.multiplyBy(-a)).round();this._bounds=new c.Bounds(g,g.add(b.multiplyBy(1+2*a)).round());this._center=this._map.getCenter();this._zoom=this._map.getZoom()}});c.Map.include({getRenderer:function(a){a=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;a||(a=this._renderer=this.options.preferCanvas&&c.canvas()||c.svg());this.hasLayer(a)||this.addLayer(a);return a},_getPaneRenderer:function(a){if("overlayPane"===a||a===h)return!1;var b=this._paneRenderers[a];b===h&&(b=c.SVG&&c.svg({pane:a})||c.Canvas&&c.canvas({pane:a}),this._paneRenderers[a]=b);return b}});c.Path=c.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this);this._reset();this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){this._map&&this._renderer._updatePath(this);return this},setStyle:function(a){c.setOptions(this,a);this._renderer&&this._renderer._updateStyle(this);return this},bringToFront:function(){this._renderer&&this._renderer._bringToFront(this);return this},bringToBack:function(){this._renderer&&this._renderer._bringToBack(this);return this},getElement:function(){return this._path},_reset:function(){this._project();this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(c.Browser.touch?10:0)}});c.LineUtil={simplify:function(a,c){if(!c||!a.length)return a.slice();var b=c*c;a=this._reducePoints(a,b);return a=this._simplifyDP(a,b)},pointToSegmentDistance:function(a,c,b){return Math.sqrt(this._sqClosestPointOnSegment(a,c,b,!0))},closestPointOnSegment:function(a,c,b){return this._sqClosestPointOnSegment(a,c,b)},_simplifyDP:function(a,c){var b=a.length,f=new (typeof Uint8Array!==h+""?Uint8Array:Array)(b);f[0]=f[b-1]=1;this._simplifyDPStep(a,f,c,0,b-1);var l,d=[];for(l=0;l<b;l++)f[l]&&d.push(a[l]);return d},_simplifyDPStep:function(a,c,b,f,l){var d=0,m,e,h;for(e=f+1;e<=l-1;e++)h=this._sqClosestPointOnSegment(a[e],a[f],a[l],!0),h>d&&(m=e,d=h);d>b&&(c[m]=1,this._simplifyDPStep(a,c,b,f,m),this._simplifyDPStep(a,c,b,m,l))},_reducePoints:function(a,c){for(var b=[a[0]],f=1,l=0,d=a.length;f<d;f++)this._sqDist(a[f],a[l])>c&&(b.push(a[f]),l=f);l<d-1&&b.push(a[d-1]);return b},clipSegment:function(a,c,b,f,l){f=f?this._lastCode:this._getBitCode(a,b);var d=this._getBitCode(c,b),m,e,h;for(this._lastCode=d;;){if(!(f|d))return[a,c];if(f&d)return!1;m=f||d;e=this._getEdgeIntersection(a,c,m,b,l);h=this._getBitCode(e,b);m===f?(a=e,f=h):(c=e,d=h)}},_getEdgeIntersection:function(a,b,g,f,l){var d=b.x-a.x;b=b.y-a.y;var m=f.min;f=f.max;var e,h;g&8?(e=a.x+d*(f.y-a.y)/b,h=f.y):g&4?(e=a.x+d*(m.y-a.y)/b,h=m.y):g&2?(e=f.x,h=a.y+b*(f.x-a.x)/d):g&1&&(e=m.x,h=a.y+b*(m.x-a.x)/d);return new c.Point(e,h,l)},_getBitCode:function(a,c){var b=0;a.x<c.min.x?b|=1:a.x>c.max.x&&(b|=2);a.y<c.min.y?b|=4:a.y>c.max.y&&(b|=8);return b},_sqDist:function(a,c){var b=c.x-a.x,f=c.y-a.y;return b*b+f*f},_sqClosestPointOnSegment:function(a,b,g,f){var l=b.x;b=b.y;var d=g.x-l,m=g.y-b,e=d*d+m*m;0<e&&(e=((a.x-l)*d+(a.y-b)*m)/e,1<e?(l=g.x,b=g.y):0<e&&(l+=d*e,b+=m*e));d=a.x-l;m=a.y-b;return f?d*d+m*m:new c.Point(l,b)}};c.Polyline=c.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,b){c.setOptions(this,b);this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){this._setLatLngs(a);return this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var b=Infinity,g=null,f=c.LineUtil._sqClosestPointOnSegment,d,e,m=0,h=this._parts.length;m<h;m++)for(var p=this._parts[m],n=1,t=p.length;n<t;n++){d=p[n-1];e=p[n];var u=f(a,d,e,!0);u<b&&(b=u,g=f(a,d,e))}g&&(g.distance=Math.sqrt(b));return g},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,c,b,f,d,e,m=this._rings[0],h=m.length;if(!h)return null;for(c=a=0;a<h-1;a++)c+=m[a].distanceTo(m[a+1])/2;if(0===c)return this._map.layerPointToLatLng(m[0]);for(f=a=0;a<h-1;a++)if(d=m[a],e=m[a+1],b=d.distanceTo(e),f+=b,f>c)return a=(f-c)/b,this._map.layerPointToLatLng([e.x-a*(e.x-d.x),e.y-a*(e.y-d.y)])},getBounds:function(){return this._bounds},addLatLng:function(a,b){b=b||this._defaultShape();a=c.latLng(a);b.push(a);this._bounds.extend(a);return this.redraw()},_setLatLngs:function(a){this._bounds=new c.LatLngBounds;this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return c.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var b=[],g=c.Polyline._flat(a),f=0,d=a.length;f<d;f++)g?(b[f]=c.latLng(a[f]),this._bounds.extend(b[f])):b[f]=this._convertLatLngs(a[f]);return b},_project:function(){var a=new c.Bounds;this._rings=[];this._projectLatlngs(this._latlngs,this._rings,a);var b=this._clickTolerance(),b=new c.Point(b,b);this._bounds.isValid()&&a.isValid()&&(a.min._subtract(b),a.max._add(b),this._pxBounds=a)},_projectLatlngs:function(a,b,g){var f=a.length,d,e;if(a[0]instanceof c.LatLng){e=[];for(d=0;d<f;d++)e[d]=this._map.latLngToLayerPoint(a[d]),g.extend(e[d]);b.push(e)}else for(d=0;d<f;d++)this._projectLatlngs(a[d],b,g)},_clipPoints:function(){var a=this._renderer._bounds;this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else{var b=this._parts,g,f,d,e,m,h,p;d=g=0;for(e=this._rings.length;g<e;g++)for(p=this._rings[g],f=0,m=p.length;f<m-1;f++)if(h=c.LineUtil.clipSegment(p[f],p[f+1],a,f,!0))if(b[d]=b[d]||[],b[d].push(h[0]),h[1]!==p[f+1]||f===m-2)b[d].push(h[1]),d++}},_simplifyPoints:function(){for(var a=this._parts,b=this.options.smoothFactor,g=0,f=a.length;g<f;g++)a[g]=c.LineUtil.simplify(a[g],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}});c.polyline=function(a,b){return new c.Polyline(a,b)};c.Polyline._flat=function(a){return!c.Util.isArray(a[0])||"object"!==typeof a[0][0]&&"undefined"!==typeof a[0][0]};c.PolyUtil={};c.PolyUtil.clipPolygon=function(a,b,g){var f,d=[1,4,2,8],e,m,h,p,n,t,u=c.LineUtil;e=0;for(n=a.length;e<n;e++)a[e]._code=u._getBitCode(a[e],b);for(h=0;4>h;h++){t=d[h];f=[];e=0;n=a.length;for(m=n-1;e<n;m=e++)(p=a[e],m=a[m],p._code&t)?m._code&t||(m=u._getEdgeIntersection(m,p,t,b,g),m._code=u._getBitCode(m,b),f.push(m)):(m._code&t&&(m=u._getEdgeIntersection(m,p,t,b,g),m._code=u._getBitCode(m,b),f.push(m)),f.push(p));a=f}return a};c.Polygon=c.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,c,b,f,d,e,m,h=this._rings[0],p=h.length;if(!p)return null;a=d=e=m=0;for(c=p-1;a<p;c=a++)b=h[a],c=h[c],f=b.y*c.x-c.y*b.x,e+=(b.x+c.x)*f,m+=(b.y+c.y)*f,d+=3*f;return this._map.layerPointToLatLng(0===d?h[0]:[e/d,m/d])},_convertLatLngs:function(a){a=c.Polyline.prototype._convertLatLngs.call(this,a);var b=a.length;2<=b&&a[0]instanceof c.LatLng&&a[0].equals(a[b-1])&&a.pop();return a},_setLatLngs:function(a){c.Polyline.prototype._setLatLngs.call(this,a);c.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return c.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,b=this.options.weight,b=new c.Point(b,b),a=new c.Bounds(a.min.subtract(b),a.max.add(b));this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else for(var b=0,g=this._rings.length,f;b<g;b++)f=c.PolyUtil.clipPolygon(this._rings[b],a,!0),f.length&&this._parts.push(f)},_updatePath:function(){this._renderer._updatePoly(this,!0)}});c.polygon=function(a,b){return new c.Polygon(a,b)};c.Rectangle=c.Polygon.extend({initialize:function(a,b){c.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),b)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){a=c.latLngBounds(a);return[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});c.rectangle=function(a,b){return new c.Rectangle(a,b)};c.CircleMarker=c.Path.extend({options:{fill:!0,radius:10},initialize:function(a,b){c.setOptions(this,b);this._latlng=c.latLng(a);this._radius=this.options.radius},setLatLng:function(a){this._latlng=c.latLng(a);this.redraw();return this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){this.options.radius=this._radius=a;return this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var b=a&&a.radius||this._radius;c.Path.prototype.setStyle.call(this,a);this.setRadius(b);return this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var a=this._radius,b=this._radiusY||a,g=this._clickTolerance(),a=[a+g,b+g];this._pxBounds=new c.Bounds(this._point.subtract(a),this._point.add(a))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}});c.circleMarker=function(a,b){return new c.CircleMarker(a,b)};c.Circle=c.CircleMarker.extend({initialize:function(a,b,g){"number"===typeof b&&(b=c.extend({},g,{radius:b}));c.setOptions(this,b);this._latlng=c.latLng(a);if(isNaN(this.options.radius))throw Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){this._mRadius=a;return this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new c.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:c.Path.prototype.setStyle,_project:function(){var a=this._latlng.lng,b=this._latlng.lat,g=this._map,f=g.options.crs;if(f.distance===c.CRS.Earth.distance){var d=Math.PI/180,f=this._mRadius/c.CRS.Earth.R/d,e=g.project([b+f,a]),m=g.project([b-f,a]),m=e.add(m).divideBy(2),h=g.unproject(m).lat,d=Math.acos((Math.cos(f*d)-Math.sin(b*d)*Math.sin(h*d))/(Math.cos(b*d)*Math.cos(h*d)))/d;if(isNaN(d)||0===d)d=f/Math.cos(Math.PI/180*b);this._point=m.subtract(g.getPixelOrigin());this._radius=isNaN(d)?0:Math.max(Math.round(m.x-g.project([h,a-d]).x),1);this._radiusY=Math.max(Math.round(m.y-e.y),1)}else a=f.unproject(f.project(this._latlng).subtract([this._mRadius,0])),this._point=g.latLngToLayerPoint(this._latlng),this._radius=this._point.x-g.latLngToLayerPoint(a).x;this._updateBounds()}});c.circle=function(a,b,g){return new c.Circle(a,b,g)};c.SVG=c.Renderer.extend({getEvents:function(){var a=c.Renderer.prototype.getEvents.call(this);a.zoomstart=this._onZoomStart;return a},_initContainer:function(){this._container=c.SVG.create("svg");this._container.setAttribute("pointer-events","none");this._rootGroup=c.SVG.create("g");this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){c.Renderer.prototype._update.call(this);var a=this._bounds,b=a.getSize(),g=this._container;this._svgSize&&this._svgSize.equals(b)||(this._svgSize=b,g.setAttribute("width",b.x),g.setAttribute("height",b.y));c.DomUtil.setPosition(g,a.min);g.setAttribute("viewBox",[a.min.x,a.min.y,b.x,b.y].join(" "));this.fire("update")}},_initPath:function(a){var b=a._path=c.SVG.create("path");a.options.className&&c.DomUtil.addClass(b,a.options.className);a.options.interactive&&c.DomUtil.addClass(b,"leaflet-interactive");this._updateStyle(a);this._layers[c.stamp(a)]=a},_addPath:function(a){this._rootGroup.appendChild(a._path);a.addInteractiveTarget(a._path)},_removePath:function(a){c.DomUtil.remove(a._path);a.removeInteractiveTarget(a._path);delete this._layers[c.stamp(a)]},_updatePath:function(a){a._project();a._update()},_updateStyle:function(a){var b=a._path;a=a.options;b&&(a.stroke?(b.setAttribute("stroke",a.color),b.setAttribute("stroke-opacity",a.opacity),b.setAttribute("stroke-width",a.weight),b.setAttribute("stroke-linecap",a.lineCap),b.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?b.setAttribute("stroke-dasharray",a.dashArray):b.removeAttribute("stroke-dasharray"),a.dashOffset?b.setAttribute("stroke-dashoffset",a.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),a.fill?(b.setAttribute("fill",a.fillColor||a.color),b.setAttribute("fill-opacity",a.fillOpacity),b.setAttribute("fill-rule",a.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(a,b){this._setPath(a,c.SVG.pointsToPath(a._parts,b))},_updateCircle:function(a){var b=a._point,c=a._radius,f="a"+c+","+(a._radiusY||c)+" 0 1,0 ",b=a._empty()?"M0 0":"M"+(b.x-c)+","+b.y+f+2*c+",0 "+f+2*-c+",0 ";this._setPath(a,b)},_setPath:function(a,b){a._path.setAttribute("d",b)},_bringToFront:function(a){c.DomUtil.toFront(a._path)},_bringToBack:function(a){c.DomUtil.toBack(a._path)}});c.extend(c.SVG,{create:function(a){return e.createElementNS("http://www.w3.org/2000/svg",a)},pointsToPath:function(a,b){var g="",f,d,e,m,h,p;f=0;for(e=a.length;f<e;f++){h=a[f];d=0;for(m=h.length;d<m;d++)p=h[d],g+=(d?"L":"M")+p.x+" "+p.y;g+=b?c.Browser.svg?"z":"x":""}return g||"M0 0"}});c.Browser.svg=!(!e.createElementNS||!c.SVG.create("svg").createSVGRect);c.svg=function(a){return c.Browser.svg||c.Browser.vml?new c.SVG(a):null};c.Browser.vml=!c.Browser.svg&&function(){try{var a=e.createElement("div");a.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';var b=a.firstChild;b.style.behavior="url(#default#VML)";return b&&"object"===typeof b.adj}catch(c){return!1}}();c.SVG.include(c.Browser.vml?{_initContainer:function(){this._container=c.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(c.Renderer.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var b=a._container=c.SVG.create("shape");c.DomUtil.addClass(b,"leaflet-vml-shape "+(this.options.className||""));b.coordsize="1 1";a._path=c.SVG.create("path");b.appendChild(a._path);this._updateStyle(a);this._layers[c.stamp(a)]=a},_addPath:function(a){var b=a._container;this._container.appendChild(b);a.options.interactive&&a.addInteractiveTarget(b)},_removePath:function(a){var b=a._container;c.DomUtil.remove(b);a.removeInteractiveTarget(b);delete this._layers[c.stamp(a)]},_updateStyle:function(a){var b=a._stroke,g=a._fill,f=a.options,d=a._container;d.stroked=!!f.stroke;d.filled=!!f.fill;f.stroke?(b||(b=a._stroke=c.SVG.create("stroke")),d.appendChild(b),b.weight=f.weight+"px",b.color=f.color,b.opacity=f.opacity,b.dashStyle=f.dashArray?c.Util.isArray(f.dashArray)?f.dashArray.join(" "):f.dashArray.replace(/( *, *)/g," "):"",b.endcap=f.lineCap.replace("butt","flat"),b.joinstyle=f.lineJoin):b&&(d.removeChild(b),a._stroke=null);f.fill?(g||(g=a._fill=c.SVG.create("fill")),d.appendChild(g),g.color=f.fillColor||f.color,g.opacity=f.fillOpacity):g&&(d.removeChild(g),a._fill=null)},_updateCircle:function(a){var b=a._point.round(),c=Math.round(a._radius),f=Math.round(a._radiusY||c);this._setPath(a,a._empty()?"M0 0":"AL "+b.x+","+b.y+" "+c+","+f+" 0,23592600")},_setPath:function(a,b){a._path.v=b},_bringToFront:function(a){c.DomUtil.toFront(a._container)},_bringToBack:function(a){c.DomUtil.toBack(a._container)}}:{});c.Browser.vml&&(c.SVG.create=function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return e.createElement("\x3clvml:"+a+' class\x3d"lvml"\x3e')}}catch(a){return function(a){return e.createElement("\x3c"+a+' xmlns\x3d"urn:schemas-microsoft.com:vml" class\x3d"lvml"\x3e')}}}());c.Canvas=c.Renderer.extend({getEvents:function(){var a=c.Renderer.prototype.getEvents.call(this);a.viewprereset=this._onViewPreReset;return a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){c.Renderer.prototype.onAdd.call(this);this._draw()},_initContainer:function(){var a=this._container=e.createElement("canvas");c.DomEvent.on(a,"mousemove",c.Util.throttle(this._onMouseMove,32,this),this).on(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(a,"mouseout",this._handleMouseOut,this);this._ctx=a.getContext("2d")},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var b in this._layers)a=this._layers[b],a._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={};c.Renderer.prototype._update.call(this);var a=this._bounds,b=this._container,g=a.getSize(),f=c.Browser.retina?2:1;c.DomUtil.setPosition(b,a.min);b.width=f*g.x;b.height=f*g.y;b.style.width=g.x+"px";b.style.height=g.y+"px";c.Browser.retina&&this._ctx.scale(2,2);this._ctx.translate(-a.min.x,-a.min.y);this.fire("update")}},_reset:function(){c.Renderer.prototype._reset.call(this);this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a);this._layers[c.stamp(a)]=a;a=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a);this._drawLast=a;this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var b=a._order,g=b.next,b=b.prev;g?g.prev=b:this._drawLast=b;b?b.next=g:this._drawFirst=g;delete a._order;delete this._layers[c.stamp(a)];this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a);a._project();a._update();this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a);this._requestRedraw(a)},_updateDashArray:function(a){if(a.options.dashArray){var b=a.options.dashArray.split(","),c=[],f;for(f=0;f<b.length;f++)c.push(Number(b[f]));a.options._dashArray=c}},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||c.Util.requestAnimFrame(this._redraw,this))},_extendRedrawBounds:function(a){var b=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new c.Bounds;this._redrawBounds.extend(a._pxBounds.min.subtract([b,b]));this._redrawBounds.extend(a._pxBounds.max.add([b,b]))},_redraw:function(){this._redrawRequest=null;this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil());this._clear();this._draw();this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var b=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,b.x,b.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var a,b=this._redrawBounds;this._ctx.save();b&&(a=b.getSize(),this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,a.x,a.y),this._ctx.clip());this._drawing=!0;for(var c=this._drawFirst;c;c=c.next)a=c.layer,(!b||a._pxBounds&&a._pxBounds.intersects(b))&&a._updatePath();this._drawing=!1;this._ctx.restore()},_updatePoly:function(a,b){if(this._drawing){var c,f,d,e,m=a._parts,h=m.length,p=this._ctx;if(h){this._drawnLayers[a._leaflet_id]=a;p.beginPath();p.setLineDash&&p.setLineDash(a.options&&a.options._dashArray||[]);for(c=0;c<h;c++){f=0;for(d=m[c].length;f<d;f++)e=m[c][f],p[f?"lineTo":"moveTo"](e.x,e.y);b&&p.closePath()}this._fillStroke(p,a)}}},_updateCircle:function(a){if(this._drawing&&!a._empty()){var b=a._point,c=this._ctx,f=a._radius,d=(a._radiusY||f)/f;this._drawnLayers[a._leaflet_id]=a;1!==d&&(c.save(),c.scale(1,d));c.beginPath();c.arc(b.x,b.y/d,f,0,2*Math.PI,!1);1!==d&&c.restore();this._fillStroke(c,a)}},_fillStroke:function(a,b){var c=b.options;c.fill&&(a.globalAlpha=c.fillOpacity,a.fillStyle=c.fillColor||c.color,a.fill(c.fillRule||"evenodd"));c.stroke&&0!==c.weight&&(a.globalAlpha=c.opacity,a.lineWidth=c.weight,a.strokeStyle=c.color,a.lineCap=c.lineCap,a.lineJoin=c.lineJoin,a.stroke())},_onClick:function(a){for(var b=this._map.mouseEventToLayerPoint(a),g,f,d=this._drawFirst;d;d=d.next)g=d.layer,g.options.interactive&&g._containsPoint(b)&&!this._map._draggableMoved(g)&&(f=g);f&&(c.DomEvent._fakeStop(a),this._fireEvent([f],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,b)}},_handleMouseOut:function(a){var b=this._hoveredLayer;b&&(c.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([b],a,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(a,b){for(var g,f,d=this._drawFirst;d;d=d.next)g=d.layer,g.options.interactive&&g._containsPoint(b)&&(f=g);f!==this._hoveredLayer&&(this._handleMouseOut(a),f&&(c.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([f],a,"mouseover"),this._hoveredLayer=f));this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a)},_fireEvent:function(a,b,c){this._map._fireDOMEvent(b,c||b.type,a)},_bringToFront:function(a){var b=a._order,c=b.next,f=b.prev;c&&((c.prev=f)?f.next=c:c&&(this._drawFirst=c),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(a))},_bringToBack:function(a){var b=a._order,c=b.next,f=b.prev;f&&((f.next=c)?c.prev=f:f&&(this._drawLast=f),b.prev=null,b.next=this._drawFirst,this._drawFirst=this._drawFirst.prev=b,this._requestRedraw(a))}});c.Browser.canvas=!!e.createElement("canvas").getContext;c.canvas=function(a){return c.Browser.canvas?new c.Canvas(a):null};c.Polyline.prototype._containsPoint=function(a,b){var g,f,d,e,m,h,p=this._clickTolerance();if(!this._pxBounds.contains(a))return!1;g=0;for(e=this._parts.length;g<e;g++)for(h=this._parts[g],f=0,m=h.length,d=m-1;f<m;d=f++)if((b||0!==f)&&c.LineUtil.pointToSegmentDistance(a,h[d],h[f])<=p)return!0;return!1};c.Polygon.prototype._containsPoint=function(a){var b=!1,g,f,d,e,m,h,p;if(!this._pxBounds.contains(a))return!1;e=0;for(h=this._parts.length;e<h;e++)for(g=this._parts[e],m=0,p=g.length,d=p-1;m<p;d=m++)f=g[m],d=g[d],f.y>a.y!==d.y>a.y&&a.x<(d.x-f.x)*(a.y-f.y)/(d.y-f.y)+f.x&&(b=!b);return b||c.Polyline.prototype._containsPoint.call(this,a,!0)};c.CircleMarker.prototype._containsPoint=function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()};c.GeoJSON=c.FeatureGroup.extend({initialize:function(a,b){c.setOptions(this,b);this._layers={};a&&this.addData(a)},addData:function(a){var b=c.Util.isArray(a)?a:a.features,g,f;if(b){a=0;for(g=b.length;a<g;a++)f=b[a],(f.geometries||f.geometry||f.features||f.coordinates)&&this.addData(f);return this}b=this.options;if(b.filter&&!b.filter(a))return this;g=c.GeoJSON.geometryToLayer(a,b);if(!g)return this;g.feature=c.GeoJSON.asFeature(a);g.defaultOptions=g.options;this.resetStyle(g);if(b.onEachFeature)b.onEachFeature(a,g);return this.addLayer(g)},resetStyle:function(a){a.options=c.Util.extend({},a.defaultOptions);this._setLayerStyle(a,this.options.style);return this},setStyle:function(a){return this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){"function"===typeof b&&(b=b(a.feature));a.setStyle&&a.setStyle(b)}});c.extend(c.GeoJSON,{geometryToLayer:function(a,b){var g="Feature"===a.type?a.geometry:a,f=g?g.coordinates:null,d=[],e=b&&b.pointToLayer,m=b&&b.coordsToLatLng||this.coordsToLatLng,h,p;if(!f&&!g)return null;switch(g.type){case "Point":return g=m(f),e?e(a,g):new c.Marker(g);case "MultiPoint":h=0;for(p=f.length;h<p;h++)g=m(f[h]),d.push(e?e(a,g):new c.Marker(g));return new c.FeatureGroup(d);case "LineString":case "MultiLineString":return d=this.coordsToLatLngs(f,"LineString"===g.type?0:1,m),new c.Polyline(d,b);case "Polygon":case "MultiPolygon":return d=this.coordsToLatLngs(f,"Polygon"===g.type?1:2,m),new c.Polygon(d,b);case "GeometryCollection":h=0;for(p=g.geometries.length;h<p;h++)(f=this.geometryToLayer({geometry:g.geometries[h],type:"Feature",properties:a.properties},b))&&d.push(f);return new c.FeatureGroup(d);default:throw Error("Invalid GeoJSON object.");}},coordsToLatLng:function(a){return new c.LatLng(a[1],a[0],a[2])},coordsToLatLngs:function(a,b,c){for(var f=[],d=0,e=a.length,m;d<e;d++)m=b?this.coordsToLatLngs(a[d],b-1,c):(c||this.coordsToLatLng)(a[d]),f.push(m);return f},latLngToCoords:function(a){return a.alt!==h?[a.lng,a.lat,a.alt]:[a.lng,a.lat]},latLngsToCoords:function(a,b,g){for(var f=[],d=0,e=a.length;d<e;d++)f.push(b?c.GeoJSON.latLngsToCoords(a[d],b-1,g):c.GeoJSON.latLngToCoords(a[d]));!b&&g&&f.push(f[0]);return f},getFeature:function(a,b){return a.feature?c.extend({},a.feature,{geometry:b}):c.GeoJSON.asFeature(b)},asFeature:function(a){return"Feature"===a.type||"FeatureCollection"===a.type?a:{type:"Feature",properties:{},geometry:a}}});d={toGeoJSON:function(){return c.GeoJSON.getFeature(this,{type:"Point",coordinates:c.GeoJSON.latLngToCoords(this.getLatLng())})}};c.Marker.include(d);c.Circle.include(d);c.CircleMarker.include(d);c.Polyline.prototype.toGeoJSON=function(){var a=!c.Polyline._flat(this._latlngs),b=c.GeoJSON.latLngsToCoords(this._latlngs,a?1:0);return c.GeoJSON.getFeature(this,{type:(a?"Multi":"")+"LineString",coordinates:b})};c.Polygon.prototype.toGeoJSON=function(){var a=!c.Polyline._flat(this._latlngs),b=a&&!c.Polyline._flat(this._latlngs[0]),g=c.GeoJSON.latLngsToCoords(this._latlngs,b?2:a?1:0,!0);a||(g=[g]);return c.GeoJSON.getFeature(this,{type:(b?"Multi":"")+"Polygon",coordinates:g})};c.LayerGroup.include({toMultiPoint:function(){var a=[];this.eachLayer(function(b){a.push(b.toGeoJSON().geometry.coordinates)});return c.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===a)return this.toMultiPoint();var b="GeometryCollection"===a,g=[];this.eachLayer(function(a){a.toGeoJSON&&(a=a.toGeoJSON(),g.push(b?a.geometry:c.GeoJSON.asFeature(a)))});return b?c.GeoJSON.getFeature(this,{geometries:g,type:"GeometryCollection"}):{type:"FeatureCollection",features:g}}});c.geoJSON=function(a,b){return new c.GeoJSON(a,b)};c.geoJson=c.geoJSON;c.Draggable=c.Evented.extend({options:{clickTolerance:3},statics:{START:c.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,b,c){this._element=a;this._dragStartTarget=b||a;this._preventOutline=c},enable:function(){this._enabled||(c.DomEvent.on(this._dragStartTarget,c.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(c.Draggable._dragging===this&&this.finishDrag(),c.DomEvent.off(this._dragStartTarget,c.Draggable.START.join(" "),this._onDown,this),this._moved=this._enabled=!1)},_onDown:function(a){if(!a._simulated&&this._enabled&&(this._moved=!1,!(c.DomUtil.hasClass(this._element,"leaflet-zoom-anim")||c.Draggable._dragging||a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(c.Draggable._dragging=this,this._preventOutline&&c.DomUtil.preventOutline(this._element),c.DomUtil.disableImageDrag(),c.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var b=a.touches?a.touches[0]:a;this._startPoint=new c.Point(b.clientX,b.clientY);c.DomEvent.on(e,c.Draggable.MOVE[a.type],this._onMove,this).on(e,c.Draggable.END[a.type],this._onUp,this)}},_onMove:function(a){if(!a._simulated&&this._enabled)if(a.touches&&1<a.touches.length)this._moved=!0;else{var b=a.touches&&1===a.touches.length?a.touches[0]:a,b=(new c.Point(b.clientX,b.clientY)).subtract(this._startPoint);!b.x&&!b.y||Math.abs(b.x)+Math.abs(b.y)<this.options.clickTolerance||(c.DomEvent.preventDefault(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=c.DomUtil.getPosition(this._element).subtract(b),c.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,n.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),c.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(b),this._moving=!0,c.Util.cancelAnimFrame(this._animRequest),this._lastEvent=a,this._animRequest=c.Util.requestAnimFrame(this._updatePosition,this,!0))}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a);c.DomUtil.setPosition(this._element,this._newPos);this.fire("drag",a)},_onUp:function(a){!a._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){c.DomUtil.removeClass(e.body,"leaflet-dragging");this._lastTarget&&(c.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var a in c.Draggable.MOVE)c.DomEvent.off(e,c.Draggable.MOVE[a],this._onMove,this).off(e,c.Draggable.END[a],this._onUp,this);c.DomUtil.enableImageDrag();c.DomUtil.enableTextSelection();this._moved&&this._moving&&(c.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1;c.Draggable._dragging=!1}});c.Handler=c.Class.extend({initialize:function(a){this._map=a},enable:function(){if(this._enabled)return this;this._enabled=!0;this.addHooks();return this},disable:function(){if(!this._enabled)return this;this._enabled=!1;this.removeHooks();return this},enabled:function(){return!!this._enabled}});c.Map.mergeOptions({dragging:!0,inertia:!c.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});c.Map.Drag=c.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new c.Draggable(a._mapPane,a._container);this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);this._draggable.on("predrag",this._onPreDragLimit,this);a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}c.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag");this._draggable.enable();this._positions=[];this._times=[]},removeHooks:function(){c.DomUtil.removeClass(this._map._container,"leaflet-grab");c.DomUtil.removeClass(this._map._container,"leaflet-touch-drag");this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var a=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=c.latLngBounds(this._map.options.maxBounds);this._offsetLimit=c.bounds(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize()));this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart");a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var b=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c);this._times.push(b);50<b-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move",a).fire("drag",a)},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(a).x;this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,b){return a-(a-b)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var a=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;a.x<b.min.x&&(a.x=this._viscousLimit(a.x,b.min.x));a.y<b.min.y&&(a.y=this._viscousLimit(a.y,b.min.y));a.x>b.max.x&&(a.x=this._viscousLimit(a.x,b.max.x));a.y>b.max.y&&(a.y=this._viscousLimit(a.y,b.max.y));this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,f=this._draggable._newPos.x,d=(f-b+c)%a+b-c,a=(f+b+c)%a-b-c,c=Math.abs(d+c)<Math.abs(a+c)?d:a;this._draggable._absPos=this._draggable._newPos.clone();this._draggable._newPos.x=c},_onDragEnd:function(a){var b=this._map,g=b.options,f=!g.inertia||2>this._times.length;b.fire("dragend",a);if(f)b.fire("moveend");else{a=this._lastPos.subtract(this._positions[0]);var d=g.easeLinearity,f=a.multiplyBy(d/((this._lastTime-this._times[0])/1E3)),e=f.distanceTo([0,0]);a=Math.min(g.inertiaMaxSpeed,e);var f=f.multiplyBy(a/e),m=a/(g.inertiaDeceleration*d),h=f.multiplyBy(-m/2).round();h.x||h.y?(h=b._limitOffset(h,b.options.maxBounds),c.Util.requestAnimFrame(function(){b.panBy(h,{duration:m,easeLinearity:d,noMoveStart:!0,animate:!0})})):b.fire("moveend")}}});c.Map.addInitHook("addHandler","dragging",c.Map.Drag);c.Map.mergeOptions({doubleClickZoom:!0});c.Map.DoubleClickZoom=c.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom(),f=b.options.zoomDelta,c=a.originalEvent.shiftKey?c-f:c+f;"center"===b.options.doubleClickZoom?b.setZoom(c):b.setZoomAround(a.containerPoint,c)}});c.Map.addInitHook("addHandler","doubleClickZoom",c.Map.DoubleClickZoom);c.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});c.Map.ScrollWheelZoom=c.Handler.extend({addHooks:function(){c.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this);this._delta=0},removeHooks:function(){c.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var b=c.DomEvent.getWheelDelta(a),d=this._map.options.wheelDebounceTime;this._delta+=b;this._lastMousePos=this._map.mouseEventToContainerPoint(a);this._startTime||(this._startTime=+new Date);b=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(c.bind(this._performZoom,this),b);c.DomEvent.stop(a)},_performZoom:function(){var a=this._map,b=a.getZoom(),c=this._map.options.zoomSnap||0;a._stop();var f=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,c=c?Math.ceil(f/c)*c:f,c=a._limitZoom(b+(0<this._delta?c:-c))-b;this._delta=0;this._startTime=null;c&&("center"===a.options.scrollWheelZoom?a.setZoom(b+c):a.setZoomAround(this._lastMousePos,b+c))}});c.Map.addInitHook("addHandler","scrollWheelZoom",c.Map.ScrollWheelZoom);c.extend(c.DomEvent,{_touchstart:c.Browser.msPointer?"MSPointerDown":c.Browser.pointer?"pointerdown":"touchstart",_touchend:c.Browser.msPointer?"MSPointerUp":c.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(a,b,d){function f(a){var b;if(c.Browser.pointer){if(!c.Browser.edge||"mouse"===a.pointerType)return;b=c.DomEvent._pointersCount}else b=a.touches.length;if(!(1<b)){b=Date.now();var f=b-(e||b);m=a.touches?a.touches[0]:a;h=0<f&&250>=f;e=b}}function l(a){if(h&&!m.cancelBubble){if(c.Browser.pointer){if(!c.Browser.edge||"mouse"===a.pointerType)return;a={};var f,d;for(d in m)f=m[d],a[d]=f&&f.bind?f.bind(m):f;m=a}m.type="dblclick";b(m);e=null}}var e,m,h=!1,p=this._touchstart,n=this._touchend;a["_leaflet_"+p+d]=f;a["_leaflet_"+n+d]=l;a["_leaflet_dblclick"+d]=b;a.addEventListener(p,f,!1);a.addEventListener(n,l,!1);a.addEventListener("dblclick",b,!1);return this},removeDoubleTapListener:function(a,b){var d=a["_leaflet_"+this._touchend+b],f=a["_leaflet_dblclick"+b];a.removeEventListener(this._touchstart,a["_leaflet_"+this._touchstart+b],!1);a.removeEventListener(this._touchend,d,!1);c.Browser.edge||a.removeEventListener("dblclick",f,!1);return this}});c.extend(c.DomEvent,{POINTER_DOWN:c.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:c.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:c.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:c.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(a,b,c,f){"touchstart"===b?this._addPointerStart(a,c,f):"touchmove"===b?this._addPointerMove(a,c,f):"touchend"===b&&this._addPointerEnd(a,c,f);return this},removePointerListener:function(a,b,c){c=a["_leaflet_"+b+c];"touchstart"===b?a.removeEventListener(this.POINTER_DOWN,c,!1):"touchmove"===b?a.removeEventListener(this.POINTER_MOVE,c,!1):"touchend"===b&&(a.removeEventListener(this.POINTER_UP,c,!1),a.removeEventListener(this.POINTER_CANCEL,c,!1));return this},_addPointerStart:function(a,b,d){var f=c.bind(function(a){if("mouse"!==a.pointerType&&a.MSPOINTER_TYPE_MOUSE&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE)if(0>this.TAG_WHITE_LIST.indexOf(a.target.tagName))c.DomEvent.preventDefault(a);else return;this._handlePointer(a,b)},this);a["_leaflet_touchstart"+d]=f;a.addEventListener(this.POINTER_DOWN,f,!1);this._pointerDocListener||(a=c.bind(this._globalPointerUp,this),e.documentElement.addEventListener(this.POINTER_DOWN,c.bind(this._globalPointerDown,this),!0),e.documentElement.addEventListener(this.POINTER_MOVE,c.bind(this._globalPointerMove,this),!0),e.documentElement.addEventListener(this.POINTER_UP,a,!0),e.documentElement.addEventListener(this.POINTER_CANCEL,a,!0),this._pointerDocListener=!0)},_globalPointerDown:function(a){this._pointers[a.pointerId]=a;this._pointersCount++},_globalPointerMove:function(a){this._pointers[a.pointerId]&&(this._pointers[a.pointerId]=a)},_globalPointerUp:function(a){delete this._pointers[a.pointerId];this._pointersCount--},_handlePointer:function(a,b){a.touches=[];for(var c in this._pointers)a.touches.push(this._pointers[c]);a.changedTouches=[a];b(a)},_addPointerMove:function(a,b,d){var f=c.bind(function(a){(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons)&&this._handlePointer(a,b)},this);a["_leaflet_touchmove"+d]=f;a.addEventListener(this.POINTER_MOVE,f,!1)},_addPointerEnd:function(a,b,d){var f=c.bind(function(a){this._handlePointer(a,b)},this);a["_leaflet_touchend"+d]=f;a.addEventListener(this.POINTER_UP,f,!1);a.addEventListener(this.POINTER_CANCEL,f,!1)}});c.Map.mergeOptions({touchZoom:c.Browser.touch&&!c.Browser.android23,bounceAtZoomLimits:!0});c.Map.TouchZoom=c.Handler.extend({addHooks:function(){c.DomUtil.addClass(this._map._container,"leaflet-touch-zoom");c.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){c.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom");c.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var b=this._map;if(a.touches&&2===a.touches.length&&!b._animatingZoom&&!this._zooming){var d=b.mouseEventToContainerPoint(a.touches[0]),f=b.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=b.getSize()._divideBy(2);this._startLatLng=b.containerPointToLatLng(this._centerPoint);"center"!==b.options.touchZoom&&(this._pinchStartLatLng=b.containerPointToLatLng(d.add(f)._divideBy(2)));this._startDist=d.distanceTo(f);this._startZoom=b.getZoom();this._moved=!1;this._zooming=!0;b._stop();c.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this);c.DomEvent.preventDefault(a)}},_onTouchMove:function(a){if(a.touches&&2===a.touches.length&&this._zooming){var b=this._map,d=b.mouseEventToContainerPoint(a.touches[0]),f=b.mouseEventToContainerPoint(a.touches[1]),l=d.distanceTo(f)/this._startDist;this._zoom=b.getScaleZoom(l,this._startZoom);!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&1>l||this._zoom>b.getMaxZoom()&&1<l)&&(this._zoom=b._limitZoom(this._zoom));if("center"===b.options.touchZoom){if(this._center=this._startLatLng,1===l)return}else{d=d._add(f)._divideBy(2)._subtract(this._centerPoint);if(1===l&&0===d.x&&0===d.y)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(d),this._zoom)}this._moved||(b._moveStart(!0),this._moved=!0);c.Util.cancelAnimFrame(this._animRequest);b=c.bind(b._move,b,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=c.Util.requestAnimFrame(b,this,!0);c.DomEvent.preventDefault(a)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,c.Util.cancelAnimFrame(this._animRequest),c.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});c.Map.addInitHook("addHandler","touchZoom",c.Map.TouchZoom);c.Map.mergeOptions({tap:!0,tapTolerance:15});c.Map.Tap=c.Handler.extend({addHooks:function(){c.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){c.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches)if(c.DomEvent.preventDefault(a),this._fireClick=!0,1<a.touches.length)this._fireClick=!1,clearTimeout(this._holdTimeout);else{var b=a.touches[0];a=b.target;this._startPos=this._newPos=new c.Point(b.clientX,b.clientY);a.tagName&&"a"===a.tagName.toLowerCase()&&c.DomUtil.addClass(a,"leaflet-active");this._holdTimeout=setTimeout(c.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",b))},this),1E3);this._simulateEvent("mousedown",b);c.DomEvent.on(e,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(a){clearTimeout(this._holdTimeout);c.DomEvent.off(e,{touchmove:this._onMove,touchend:this._onUp},this);if(this._fireClick&&a&&a.changedTouches){a=a.changedTouches[0];var b=a.target;b&&b.tagName&&"a"===b.tagName.toLowerCase()&&c.DomUtil.removeClass(b,"leaflet-active");this._simulateEvent("mouseup",a);this._isTapValid()&&this._simulateEvent("click",a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){a=a.touches[0];this._newPos=new c.Point(a.clientX,a.clientY);this._simulateEvent("mousemove",a)},_simulateEvent:function(a,b){var c=e.createEvent("MouseEvents");c._simulated=!0;b.target._simulatedClick=!0;c.initMouseEvent(a,!0,!0,n,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);b.target.dispatchEvent(c)}});c.Browser.touch&&!c.Browser.pointer&&c.Map.addInitHook("addHandler","tap",c.Map.Tap);c.Map.mergeOptions({boxZoom:!0});c.Map.BoxZoom=c.Handler.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane},addHooks:function(){c.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){c.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(a){if(!a.shiftKey||1!==a.which&&1!==a.button)return!1;this._resetState();c.DomUtil.disableTextSelection();c.DomUtil.disableImageDrag();this._startPoint=this._map.mouseEventToContainerPoint(a);c.DomEvent.on(e,{contextmenu:c.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=c.DomUtil.create("div","leaflet-zoom-box",this._container),c.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart"));this._point=this._map.mouseEventToContainerPoint(a);a=new c.Bounds(this._point,this._startPoint);var b=a.getSize();c.DomUtil.setPosition(this._box,a.min);this._box.style.width=b.x+"px";this._box.style.height=b.y+"px"},_finish:function(){this._moved&&(c.DomUtil.remove(this._box),c.DomUtil.removeClass(this._container,"leaflet-crosshair"));c.DomUtil.enableTextSelection();c.DomUtil.enableImageDrag();c.DomEvent.off(e,{contextmenu:c.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(1===a.which||1===a.button)this._finish(),this._moved&&(setTimeout(c.bind(this._resetState,this),0),a=new c.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a}))},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});c.Map.addInitHook("addHandler","boxZoom",c.Map.BoxZoom);c.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80});c.Map.Keyboard=c.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a;this._setPanDelta(a.options.keyboardPanDelta);this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;0>=a.tabIndex&&(a.tabIndex="0");c.DomEvent.on(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks();c.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=e.body,b=e.documentElement,c=a.scrollTop||b.scrollTop,a=a.scrollLeft||b.scrollLeft;this._map._container.focus();n.scrollTo(a,c)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanDelta:function(a){var b=this._panKeys={},c=this.keyCodes,f,d;f=0;for(d=c.left.length;f<d;f++)b[c.left[f]]=[-1*a,0];f=0;for(d=c.right.length;f<d;f++)b[c.right[f]]=[a,0];f=0;for(d=c.down.length;f<d;f++)b[c.down[f]]=[0,a];f=0;for(d=c.up.length;f<d;f++)b[c.up[f]]=[0,-1*a]},_setZoomDelta:function(a){var b=this._zoomKeys={},c=this.keyCodes,f,d;f=0;for(d=c.zoomIn.length;f<d;f++)b[c.zoomIn[f]]=a;f=0;for(d=c.zoomOut.length;f<d;f++)b[c.zoomOut[f]]=-a},_addHooks:function(){c.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){c.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var b=a.keyCode,d=this._map;if(b in this._panKeys){if(d._panAnim&&d._panAnim._inProgress)return;b=this._panKeys[b];a.shiftKey&&(b=c.point(b).multiplyBy(3));d.panBy(b);d.options.maxBounds&&d.panInsideBounds(d.options.maxBounds)}else if(b in this._zoomKeys)d.setZoom(d.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[b]);else if(27===b)d.closePopup();else return;c.DomEvent.stop(a)}}});c.Map.addInitHook("addHandler","keyboard",c.Map.Keyboard);c.Handler.MarkerDrag=c.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new c.Draggable(a,a,!0));this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable();c.DomUtil.addClass(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable();this._marker._icon&&c.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng();this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(a){var b=this._marker,d=b._shadow,f=c.DomUtil.getPosition(b._icon),l=b._map.layerPointToLatLng(f);d&&c.DomUtil.setPosition(d,f);b._latlng=l;a.latlng=l;a.oldLatLng=this._oldLatLng;b.fire("move",a).fire("drag",a)},_onDragEnd:function(a){delete this._oldLatLng;this._marker.fire("moveend").fire("dragend",a)}});c.Control=c.Class.extend({options:{position:"topright"},initialize:function(a){c.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;b&&b.removeControl(this);this.options.position=a;b&&b.addControl(this);return this},getContainer:function(){return this._container},addTo:function(a){this.remove();this._map=a;var b=this._container=this.onAdd(a),d=this.getPosition();a=a._controlCorners[d];c.DomUtil.addClass(b,"leaflet-control");-1!==d.indexOf("bottom")?a.insertBefore(b,a.firstChild):a.appendChild(b);return this},remove:function(){if(!this._map)return this;c.DomUtil.remove(this._container);if(this.onRemove)this.onRemove(this._map);this._map=null;return this},_refocusOnMap:function(a){this._map&&a&&0<a.screenX&&0<a.screenY&&this._map.getContainer().focus()}});c.control=function(a){return new c.Control(a)};c.Map.include({addControl:function(a){a.addTo(this);return this},removeControl:function(a){a.remove();return this},_initControlPos:function(){function a(a,l){b[a+l]=c.DomUtil.create("div","leaflet-"+a+" leaflet-"+l,d)}var b=this._controlCorners={},d=this._controlContainer=c.DomUtil.create("div","leaflet-control-container",this._container);a("top","left");a("top","right");a("bottom","left");a("bottom","right")},_clearControlPos:function(){c.DomUtil.remove(this._controlContainer)}});c.Control.Zoom=c.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(a){var b=c.DomUtil.create("div","leaflet-control-zoom leaflet-bar"),d=this.options;this._zoomInButton=this._createButton(d.zoomInText,d.zoomInTitle,"leaflet-control-zoom-in",b,this._zoomIn);this._zoomOutButton=this._createButton(d.zoomOutText,d.zoomOutTitle,"leaflet-control-zoom-out",b,this._zoomOut);this._updateDisabled();a.on("zoomend zoomlevelschange",this._updateDisabled,this);return b},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){this._disabled=!0;this._updateDisabled();return this},enable:function(){this._disabled=!1;this._updateDisabled();return this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,b,d,f,l){d=c.DomUtil.create("a",d,f);d.innerHTML=a;d.href="#";d.title=b;d.setAttribute("role","button");d.setAttribute("aria-label",b);c.DomEvent.on(d,"mousedown dblclick",c.DomEvent.stopPropagation).on(d,"click",c.DomEvent.stop).on(d,"click",l,this).on(d,"click",this._refocusOnMap,this);return d},_updateDisabled:function(){var a=this._map;c.DomUtil.removeClass(this._zoomInButton,"leaflet-disabled");c.DomUtil.removeClass(this._zoomOutButton,"leaflet-disabled");(this._disabled||a._zoom===a.getMinZoom())&&c.DomUtil.addClass(this._zoomOutButton,"leaflet-disabled");(this._disabled||a._zoom===a.getMaxZoom())&&c.DomUtil.addClass(this._zoomInButton,"leaflet-disabled")}});c.Map.mergeOptions({zoomControl:!0});c.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new c.Control.Zoom,this.addControl(this.zoomControl))});c.control.zoom=function(a){return new c.Control.Zoom(a)};c.Control.Attribution=c.Control.extend({options:{position:"bottomright",prefix:'\x3ca href\x3d"http://leafletjs.com" title\x3d"A JS library for interactive maps"\x3eLeaflet\x3c/a\x3e'},initialize:function(a){c.setOptions(this,a);this._attributions={}},onAdd:function(a){a.attributionControl=this;this._container=c.DomUtil.create("div","leaflet-control-attribution");c.DomEvent&&c.DomEvent.disableClickPropagation(this._container);for(var b in a._layers)a._layers[b].getAttribution&&this.addAttribution(a._layers[b].getAttribution());this._update();return this._container},setPrefix:function(a){this.options.prefix=a;this._update();return this},addAttribution:function(a){if(!a)return this;this._attributions[a]||(this._attributions[a]=0);this._attributions[a]++;this._update();return this},removeAttribution:function(a){if(!a)return this;this._attributions[a]&&(this._attributions[a]--,this._update());return this},_update:function(){if(this._map){var a=[],b;for(b in this._attributions)this._attributions[b]&&a.push(b);b=[];this.options.prefix&&b.push(this.options.prefix);a.length&&b.push(a.join(", "));this._container.innerHTML=b.join(" | ")}}});c.Map.mergeOptions({attributionControl:!0});c.Map.addInitHook(function(){this.options.attributionControl&&(new c.Control.Attribution).addTo(this)});c.control.attribution=function(a){return new c.Control.Attribution(a)};c.Control.Scale=c.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var b=c.DomUtil.create("div","leaflet-control-scale"),d=this.options;this._addScales(d,"leaflet-control-scale-line",b);a.on(d.updateWhenIdle?"moveend":"move",this._update,this);a.whenReady(this._update,this);return b},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,b,d){a.metric&&(this._mScale=c.DomUtil.create("div",b,d));a.imperial&&(this._iScale=c.DomUtil.create("div",b,d))},_update:function(){var a=this._map,b=a.getSize().y/2,a=a.distance(a.containerPointToLatLng([0,b]),a.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(a)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a);this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var b=this._getRoundNum(a);this._updateScale(this._mScale,1E3>b?b+" m":b/1E3+" km",b/a)},_updateImperial:function(a){a*=3.2808399;var b;5280<a?(a/=5280,b=this._getRoundNum(a),this._updateScale(this._iScale,b+" mi",b/a)):(b=this._getRoundNum(a),this._updateScale(this._iScale,b+" ft",b/a))},_updateScale:function(a,b,c){a.style.width=Math.round(this.options.maxWidth*c)+"px";a.innerHTML=b},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1);a/=b;return b*(10<=a?10:5<=a?5:3<=a?3:2<=a?2:1)}});c.control.scale=function(a){return new c.Control.Scale(a)};c.Control.Layers=c.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,b,c,f){return c<f?-1:f<c?1:0}},initialize:function(a,b,d){c.setOptions(this,d);this._layers=[];this._lastZIndex=0;this._handlingClick=!1;for(var f in a)this._addLayer(a[f],f);for(f in b)this._addLayer(b[f],f,!0)},onAdd:function(a){this._initLayout();this._update();this._map=a;a.on("zoomend",this._checkDisabledLayers,this);return this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,b){this._addLayer(a,b);return this._map?this._update():this},addOverlay:function(a,b){this._addLayer(a,b,!0);return this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);(a=this._getLayer(c.stamp(a)))&&this._layers.splice(this._layers.indexOf(a),1);return this._map?this._update():this},expand:function(){c.DomUtil.addClass(this._container,"leaflet-control-layers-expanded");this._form.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);a<this._form.clientHeight?(c.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=a+"px"):c.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar");this._checkDisabledLayers();return this},collapse:function(){c.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded");return this},_initLayout:function(){var a=this._container=c.DomUtil.create("div","leaflet-control-layers"),b=this.options.collapsed;a.setAttribute("aria-haspopup",!0);c.DomEvent.disableClickPropagation(a);c.Browser.touch||c.DomEvent.disableScrollPropagation(a);var d=this._form=c.DomUtil.create("form","leaflet-control-layers-list");if(b&&(this._map.on("click",this.collapse,this),!c.Browser.android))c.DomEvent.on(a,{mouseenter:this.expand,mouseleave:this.collapse},this);var f=this._layersLink=c.DomUtil.create("a","leaflet-control-layers-toggle",a);f.href="#";f.title="Layers";if(c.Browser.touch)c.DomEvent.on(f,"click",c.DomEvent.stop).on(f,"click",this.expand,this);else c.DomEvent.on(f,"focus",this.expand,this);c.DomEvent.on(d,"click",function(){setTimeout(c.bind(this._onInputClick,this),0)},this);b||this.expand();this._baseLayersList=c.DomUtil.create("div","leaflet-control-layers-base",d);this._separator=c.DomUtil.create("div","leaflet-control-layers-separator",d);this._overlaysList=c.DomUtil.create("div","leaflet-control-layers-overlays",d);a.appendChild(d)},_getLayer:function(a){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&c.stamp(this._layers[b].layer)===a)return this._layers[b]},_addLayer:function(a,b,d){a.on("add remove",this._onLayerChange,this);this._layers.push({layer:a,name:b,overlay:d});this.options.sortLayers&&this._layers.sort(c.bind(function(a,b){return this.options.sortFunction(a.layer,b.layer,a.name,b.name)},this));this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;c.DomUtil.empty(this._baseLayersList);c.DomUtil.empty(this._overlaysList);var a,b,d,f,l=0;for(d=0;d<this._layers.length;d++)f=this._layers[d],this._addItem(f),b=b||f.overlay,a=a||!f.overlay,l+=f.overlay?0:1;this.options.hideSingleBase&&(a=a&&1<l,this._baseLayersList.style.display=a?"":"none");this._separator.style.display=b&&a?"":"none";return this},_onLayerChange:function(a){this._handlingClick||this._update();var b=this._getLayer(c.stamp(a.target));(a=b.overlay?"add"===a.type?"overlayadd":"overlayremove":"add"===a.type?"baselayerchange":null)&&this._map.fire(a,b)},_createRadioElement:function(a,b){var c='\x3cinput type\x3d"radio" class\x3d"leaflet-control-layers-selector" name\x3d"'+a+'"'+(b?' checked\x3d"checked"':"")+"/\x3e",f=e.createElement("div");f.innerHTML=c;return f.firstChild},_addItem:function(a){var b=e.createElement("label"),d=this._map.hasLayer(a.layer),f;a.overlay?(f=e.createElement("input"),f.type="checkbox",f.className="leaflet-control-layers-selector",f.defaultChecked=d):f=this._createRadioElement("leaflet-base-layers",d);f.layerId=c.stamp(a.layer);c.DomEvent.on(f,"click",this._onInputClick,this);d=e.createElement("span");d.innerHTML=" "+a.name;var l=e.createElement("div");b.appendChild(l);l.appendChild(f);l.appendChild(d);(a.overlay?this._overlaysList:this._baseLayersList).appendChild(b);this._checkDisabledLayers();return b},_onInputClick:function(){var a=this._form.getElementsByTagName("input"),b,c,d,l=[],e=[];this._handlingClick=!0;for(var m=a.length-1;0<=m;m--)b=a[m],c=this._getLayer(b.layerId).layer,d=this._map.hasLayer(c),b.checked&&!d?l.push(c):!b.checked&&d&&e.push(c);for(m=0;m<e.length;m++)this._map.removeLayer(e[m]);for(m=0;m<l.length;m++)this._map.addLayer(l[m]);this._handlingClick=!1;this._refocusOnMap()},_checkDisabledLayers:function(){for(var a=this._form.getElementsByTagName("input"),b,c,d=this._map.getZoom(),l=a.length-1;0<=l;l--)b=a[l],c=this._getLayer(b.layerId).layer,b.disabled=c.options.minZoom!==h&&d<c.options.minZoom||c.options.maxZoom!==h&&d>c.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}});c.control.layers=function(a,b,d){return new c.Control.Layers(a,b,d)}})(window,document);(function(n,e,h){L.drawVersion="0.4.9";L.Draw={};L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker"}},handlers:{circle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u52a8\u7ed8\u5236\u5706\uff08\u6309Esc\u53d6\u6d88\uff09"},radius:"Radius"},marker:{tooltip:{start:"\u70b9\u51fb\u5730\u56fe\u7ed8\u5236\u70b9\u4f4d\uff08\u6309Esc\u53d6\u6d88\uff09"}},polygon:{tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u591a\u8fb9\u5f62\uff08\u6309Esc\u53d6\u6d88\uff09",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u591a\u8fb9\u5f62\uff08\u6309Esc\u53d6\u6d88\uff09",end:"\u70b9\u51fb\u9996\u4e2a\u7ed8\u5236\u70b9\u5b8c\u6210\u7ed8\u5236\uff08\u6309Esc\u53d6\u6d88\uff09"}},polyline:{error:"\x3cstrong\x3eError:\x3c/strong\x3e shape edges cannot cross!",tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u7ebf\uff08\u6309Esc\u53d6\u6d88\uff09",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u7ebf\uff08\u6309Esc\u53d6\u6d88\uff09",end:"\u53cc\u51fb\u5b8c\u6210\u7ed8\u5236\uff08\u6309Esc\u53d6\u6d88\uff09"}},rectangle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u52a8\u5f00\u59cb\u7ed8\u5236\u77e9\u5f62\uff08\u6309Esc\u53d6\u6d88\uff09"}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes.",text:"Save"},cancel:{title:"Cancel editing, discards all changes.",text:"Cancel"}},buttons:{edit:"Edit layers.",editDisabled:"No layers to edit.",remove:"Delete layers.",removeDisabled:"No layers to delete."}},handlers:{edit:{tooltip:{text:"Drag handles, or marker to edit feature.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove"}}}}};L.Draw.Event={};L.Draw.Event.CREATED="draw:created";L.Draw.Event.EDITED="draw:edited";L.Draw.Event.DELETED="draw:deleted";L.Draw.Event.DRAWSTART="draw:drawstart";L.Draw.Event.DRAWSTOP="draw:drawstop";L.Draw.Event.DRAWVERTEX="draw:drawvertex";L.Draw.Event.EDITSTART="draw:editstart";L.Draw.Event.EDITMOVE="draw:editmove";L.Draw.Event.EDITRESIZE="draw:editresize";L.Draw.Event.EDITVERTEX="draw:editvertex";L.Draw.Event.EDITSTOP="draw:editstop";L.Draw.Event.DELETESTART="draw:deletestart";L.Draw.Event.DELETESTOP="draw:deletestop";L.Draw=L.Draw||{};L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(b,c){this._map=b;this._container=b._container;this._overlayPane=b._panes.overlayPane;this._popupPane=b._panes.popupPane;c&&c.shapeOptions&&(c.shapeOptions=L.Util.extend({},this.options.shapeOptions,c.shapeOptions));L.setOptions(this,c)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var b=this._map;b&&(L.DomUtil.disableTextSelection(),b.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(b){L.setOptions(this,b)},_fireCreatedEvent:function(b){this._map.fire(L.Draw.Event.CREATED,{layer:b,layerType:this.type})},_cancelDrawing:function(b){this._map.fire("draw:canceled",{layerType:this.type});27===b.keyCode&&this.disable()}});L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4E3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2E3},initialize:function(b,c){L.Browser.touch&&(this.options.icon=this.options.touchIcon);this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error;c&&c.drawError&&(c.drawError=L.Util.extend({},this.options.drawError,c.drawError));this.type=L.Draw.Polyline.TYPE;L.Draw.Feature.prototype.initialize.call(this,b,c)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._clearHideErrorTimeout();this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this);this._map.removeLayer(this._mouseMarker);delete this._mouseMarker;this._clearGuides();this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(1>=this._markers.length)){var b=this._markers.pop(),c=this._poly,d=c.getLatLngs(),a=d.splice(-1,1)[0];this._poly.setLatLngs(d);this._markerGroup.removeLayer(b);2>c.getLatLngs().length&&this._map.removeLayer(c);this._vertexChanged(a,!1)}},addVertex:function(b){2<=this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(b)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(b)),this._poly.addLatLng(b),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(b,!0))},completeShape:function(){1>=this._markers.length||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var b=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),b=this._poly.newLatLngIntersects(b[b.length-1]);!this.options.allowIntersection&&b||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(b){var c=this._map.mouseEventToLayerPoint(b.originalEvent),d=this._map.layerPointToLatLng(c);this._currentLatLng=d;this._updateTooltip(d);this._updateGuide(c);this._mouseMarker.setLatLng(d);L.DomEvent.preventDefault(b.originalEvent)},_vertexChanged:function(b,c){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup});this._updateFinishHandler();this._updateRunningMeasure(b,c);this._clearGuides();this._updateTooltip()},_onMouseDown:function(b){this._clickHandled||this._touchHandled||this._disableMarkers||(this._onMouseMove(b),this._clickHandled=!0,this._disableNewMarkers(),b=b.originalEvent,this._startPoint.call(this,b.clientX,b.clientY))},_startPoint:function(b,c){this._mouseDownOrigin=L.point(b,c)},_onMouseUp:function(b){var c=b.originalEvent;this._endPoint.call(this,c.clientX,c.clientY,b);this._clickHandled=null},_endPoint:function(b,c,d){this._mouseDownOrigin&&(b=L.point(b,c).distanceTo(this._mouseDownOrigin),10>this._calculateFinishDistance(d.latlng)&&L.Browser.touch?this._finishShape():Math.abs(b)<9*(n.devicePixelRatio||1)&&this.addVertex(d.latlng),this._enableNewMarkers());this._mouseDownOrigin=null},_onTouch:function(b){var c=b.originalEvent,d;!c.touches||!c.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(d=c.touches[0].clientX,c=c.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,d,c),this._endPoint.call(this,d,c,b),this._touchHandled=null);this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(b){var c;if(0<this._markers.length){if(this.type===L.Draw.Polyline.TYPE)c=this._markers[this._markers.length-1];else if(this.type===L.Draw.Polygon.TYPE)c=this._markers[0];else return Infinity;c=this._map.latLngToContainerPoint(c.getLatLng());b=new L.Marker(b,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});b=this._map.latLngToContainerPoint(b.getLatLng());c=c.distanceTo(b)}else c=Infinity;return c},_updateFinishHandler:function(){var b=this._markers.length;if(1<b)this._markers[b-1].on("click",this._finishShape,this);2<b&&this._markers[b-2].off("click",this._finishShape,this)},_createMarker:function(b){b=new L.Marker(b,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});this._markerGroup.addLayer(b);return b},_updateGuide:function(b){var c=this._markers?this._markers.length:0;0<c&&(b=b||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[c-1].getLatLng()),b))},_updateTooltip:function(b){var c=this._getTooltipText();b&&this._tooltip.updatePosition(b);this._errorShown||this._tooltip.updateContent(c)},_drawGuide:function(b,c){var d=Math.floor(Math.sqrt(Math.pow(c.x-b.x,2)+Math.pow(c.y-b.y,2))),a=this.options.guidelineDistance,k=this.options.maxGuideLineLength,a=d>k?d-k:a,g;this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));for(;a<d;a+=this.options.guidelineDistance)k=a/d,k={x:Math.floor(b.x*(1-k)+k*c.x),y:Math.floor(b.y*(1-k)+k*c.y)},g=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),g.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(g,k)},_updateGuideColor:function(b){if(this._guidesContainer)for(var c=0,d=this._guidesContainer.childNodes.length;c<d;c++)this._guidesContainer.childNodes[c].style.backgroundColor=b},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var b=this.options.showLength;L.Browser.touch&&(b=!1);0===this._markers.length?b={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(b=b?this._getMeasurementString():"",b=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:b}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:b});return b},_updateRunningMeasure:function(b,c){var d=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(d=b.distanceTo(this._markers[d-(c?2:1)].getLatLng()),this._measurementRunningTotal+=d*(c?1:-1))},_getMeasurementString:function(){var b=this._currentLatLng,c=this._markers[this._markers.length-1].getLatLng(),b=this._measurementRunningTotal+b.distanceTo(c);return L.GeometryUtil.readableDistance(b,this.options.metric,this.options.feet,this.options.nautic)},_showErrorTooltip:function(){this._errorShown=!0;this._tooltip.showAsError().updateContent({text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1;this._clearHideErrorTimeout();this._tooltip.removeError().updateContent(this._getTooltipText());this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){1<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var b=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,b)}});L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(b,c){L.Draw.Polyline.prototype.initialize.call(this,b,c);this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var b=this._markers.length;if(1===b)this._markers[0].on("click",this._finishShape,this);2<b&&(this._markers[b-1].on("dblclick",this._finishShape,this),3<b&&this._markers[b-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var b,c;0===this._markers.length?b=L.drawLocal.draw.handlers.polygon.tooltip.start:3>this._markers.length?b=L.drawLocal.draw.handlers.polygon.tooltip.cont:(b=L.drawLocal.draw.handlers.polygon.tooltip.end,c=this._getMeasurementString());return{text:b,subtext:c}},_getMeasurementString:function(){var b=this._area;return b?L.GeometryUtil.readableArea(b,this.options.metric):null},_shapeIsValid:function(){return 3<=this._markers.length},_vertexChanged:function(b,c){var d;!this.options.allowIntersection&&this.options.showArea&&(d=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(d));L.Draw.Polyline.prototype._vertexChanged.call(this,b,c)},_cleanUpShape:function(){var b=this._markers.length;0<b&&(this._markers[0].off("click",this._finishShape,this),2<b&&this._markers[b-1].off("dblclick",this._finishShape,this))}});L.SimpleShape={};L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(b,c){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end;L.Draw.Feature.prototype.initialize.call(this,b,c)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&((this._mapDraggable=this._map.dragging.enabled())&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),this._shape&&(this._map.removeLayer(this._shape),delete this._shape));this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(b){this._isDrawing=!0;this._startLatLng=b.latlng;L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(b.originalEvent)},_onMouseMove:function(b){b=b.latlng;this._tooltip.updatePosition(b);this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(b))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()}});L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,showArea:!0,clickable:!0},metric:!0},initialize:function(b,c){this.type=L.Draw.Rectangle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,b,c)},_drawShape:function(b){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,b)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,b),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var b=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,b)},_getTooltipText:function(){var b=L.Draw.SimpleShape.prototype._getTooltipText.call(this),c=this.options.showArea,d;this._shape&&(d=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),d=L.GeometryUtil.geodesicArea(d),d=c?L.GeometryUtil.readableArea(d,this.options.metric):"");return{text:b.text,subtext:d}}});L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(b,c){this.type=L.Draw.Circle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,b,c)},_drawShape:function(b){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(b)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(b),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var b=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,b)},_onMouseMove:function(b){var c=b.latlng;b=this.options.showRadius;var d=this.options.metric;this._tooltip.updatePosition(c);if(this._isDrawing){this._drawShape(c);var c=this._shape.getRadius().toFixed(1),a="";b&&(a=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(c,d,this.options.feet,this.options.nautic));this._tooltip.updateContent({text:this._endLabelText,subtext:a})}}});L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2E3},initialize:function(b,c){this.type=L.Draw.Marker.TYPE;L.Draw.Feature.prototype.initialize.call(this,b,c)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).off("click",this._onTouch,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(b){b=b.latlng;this._tooltip.updatePosition(b);this._mouseMarker.setLatLng(b);this._marker?(b=this._mouseMarker.getLatLng(),this._marker.setLatLng(b)):(this._marker=new L.Marker(b,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()},_onTouch:function(b){this._onMouseMove(b);this._onClick()},_fireCreatedEvent:function(){var b=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,b)}});L.Edit=L.Edit||{};L.Edit.Marker=L.Handler.extend({initialize:function(b,c){this._marker=b;L.setOptions(this,c)},addHooks:function(){var b=this._marker;b.dragging.enable();b.on("dragend",this._onDragEnd,b);this._toggleMarkerHighlight()},removeHooks:function(){var b=this._marker;b.dragging.disable();b.off("dragend",this._onDragEnd,b);this._toggleMarkerHighlight()},_onDragEnd:function(b){b=b.target;b.edited=!0;this._map.fire(L.Draw.Event.EDITMOVE,{layer:b})},_toggleMarkerHighlight:function(){var b=this._marker._icon;b&&(b.style.display="none",L.DomUtil.hasClass(b,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(b,"leaflet-edit-marker-selected"),this._offsetMarker(b,-4)):(L.DomUtil.addClass(b,"leaflet-edit-marker-selected"),this._offsetMarker(b,4)),b.style.display="")},_offsetMarker:function(b,c){var d=parseInt(b.style.marginTop,10)-c,a=parseInt(b.style.marginLeft,10)-c;b.style.marginTop=d+"px";b.style.marginLeft=a+"px"}});L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())});L.Edit=L.Edit||{};L.Edit.Poly=L.Handler.extend({options:{},initialize:function(b,c){this.latlngs=[b._latlngs];b._holes&&(this.latlngs=this.latlngs.concat(b._holes));this._poly=b;L.setOptions(this,c);this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(b){for(var c=0;c<this._verticesHandlers.length;c++)b(this._verticesHandlers[c])},addHooks:function(){this._initHandlers();this._eachVertexHandler(function(b){b.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(b){b.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(b){b.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var b=0;b<this.latlngs.length;b++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[b],this.options))},_updateLatLngs:function(b){this.latlngs=[b.layer._latlngs];b.layer._holes&&(this.latlngs=this.latlngs.concat(b.layer._holes))}});L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1E3}},initialize:function(b,c,d){L.Browser.touch&&(this.options.icon=this.options.touchIcon);this._poly=b;d&&d.drawError&&(d.drawError=L.Util.extend({},this.options.drawError,d.drawError));this._latlngs=c;L.setOptions(this,d)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var b=this._poly;b instanceof L.Polygon||(b.options.fill=!1,b.options.editing&&(b.options.editing.fill=!1));b.setStyle(b.options.editing);this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var b=this._poly;b.setStyle(b.options.original);b._map&&(b._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup);this._markers=[];var b=this._defaultShape(),c,d,a;c=0;for(d=b.length;c<d;c++)a=this._createMarker(b[c],c),a.on("click",this._onMarkerClick,this),this._markers.push(a);c=0;for(b=d-1;c<d;b=c++)if(0!==c||L.Polygon&&this._poly instanceof L.Polygon)b=this._markers[b],a=this._markers[c],this._createMiddleMarker(b,a),this._updatePrevNext(b,a)},_createMarker:function(b,c){var d=new L.Marker.Touch(b,{draggable:!0,icon:this.options.icon});d._origLatLng=b;d._index=c;d.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this);this._markerGroup.addLayer(d);return d},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var b=this._defaultShape(),c=[].splice.apply(b,arguments);this._poly._convertLatLngs(b,!0);this._poly.redraw();return c},_removeMarker:function(b){var c=b._index;this._markerGroup.removeLayer(b);this._markers.splice(c,1);this._spliceLatLngs(c,1);this._updateIndexes(c,-1);b.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0;this._poly.fire("edit");this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(b){var c=b.target,d=this._poly;L.extend(c._origLatLng,c._latlng);c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c));c._middleRight&&c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next));if(d.options.poly){var a=d._map._editTooltip;if(!d.options.poly.allowIntersection&&d.intersects()){var k=d.options.color;d.setStyle({color:this.options.drawError.color});0!==L.version.indexOf("0.7")&&c.dragging._draggable._onUp(b);this._onMarkerClick(b);a&&a.updateContent({text:L.drawLocal.draw.handlers.polyline.error});setTimeout(function(){d.setStyle({color:k});a&&a.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1E3)}}this._poly.redraw();this._poly.fire("editdrag")},_onMarkerClick:function(b){var c=L.Polygon&&this._poly instanceof L.Polygon?4:3;b=b.target;this._defaultShape().length<c||(this._removeMarker(b),this._updatePrevNext(b._prev,b._next),b._middleLeft&&this._markerGroup.removeLayer(b._middleLeft),b._middleRight&&this._markerGroup.removeLayer(b._middleRight),b._prev&&b._next?this._createMiddleMarker(b._prev,b._next):b._prev?b._next||(b._prev._middleRight=null):b._next._middleLeft=null,this._fireEdit())},_onTouchMove:function(b){var c=this._map.mouseEventToLayerPoint(b.originalEvent.touches[0]),c=this._map.layerPointToLatLng(c);b=b.target;L.extend(b._origLatLng,c);b._middleLeft&&b._middleLeft.setLatLng(this._getMiddleLatLng(b._prev,b));b._middleRight&&b._middleRight.setLatLng(this._getMiddleLatLng(b,b._next));this._poly.redraw();this.updateMarkers()},_updateIndexes:function(b,c){this._markerGroup.eachLayer(function(d){d._index>b&&(d._index+=c)})},_createMiddleMarker:function(b,c){var d=this._getMiddleLatLng(b,c),a=this._createMarker(d),k,g,f;a.setOpacity(.6);b._middleRight=c._middleLeft=a;g=function(){a.off("touchmove",g,this);var f=c._index;a._index=f;a.off("click",k,this).on("click",this._onMarkerClick,this);d.lat=a.getLatLng().lat;d.lng=a.getLatLng().lng;this._spliceLatLngs(f,0,d);this._markers.splice(f,0,a);a.setOpacity(1);this._updateIndexes(f,1);c._index++;this._updatePrevNext(b,a);this._updatePrevNext(a,c);this._poly.fire("editstart")};f=function(){a.off("dragstart",g,this);a.off("dragend",f,this);a.off("touchmove",g,this);this._createMiddleMarker(b,a);this._createMiddleMarker(a,c)};k=function(){g.call(this);f.call(this);this._fireEdit()};a.on("click",k,this).on("dragstart",g,this).on("dragend",f,this).on("touchmove",g,this);this._markerGroup.addLayer(a)},_updatePrevNext:function(b,c){b&&(b._next=c);c&&(c._prev=b)},_getMiddleLatLng:function(b,c){var d=this._poly._map,a=d.project(b.getLatLng()),k=d.project(c.getLatLng());return d.unproject(a._add(k)._divideBy(2))}});L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this,this.options.poly),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))});L.Edit=L.Edit||{};L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(b,c){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon);this._shape=b;L.Util.setOptions(this,c)},addHooks:function(){var b=this._shape;this._shape._map&&(this._map=this._shape._map,b.setStyle(b.options.editing),b._map&&(this._map=b._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var b=this._shape;b.setStyle(b.options.original);if(b._map){this._unbindMarker(this._moveMarker);for(var b=0,c=this._resizeMarkers.length;b<c;b++)this._unbindMarker(this._resizeMarkers[b]);this._resizeMarkers=null;this._map.removeLayer(this._markerGroup);delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup);this._createMoveMarker();this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(b,c){var d=new L.Marker.Touch(b,{draggable:!0,icon:c,zIndexOffset:10});this._bindMarker(d);this._markerGroup.addLayer(d);return d},_bindMarker:function(b){b.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(b){b.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(b){b.target.setOpacity(0);this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0;this._shape.fire("edit")},_onMarkerDrag:function(b){b=b.target;var c=b.getLatLng();b===this._moveMarker?this._move(c):this._resize(c);this._shape.redraw();this._shape.fire("editdrag")},_onMarkerDragEnd:function(b){b.target.setOpacity(1);this._fireEdit()},_onTouchStart:function(b){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,b);if("function"===typeof this._getCorners){var c=this._getCorners();b=b.target;var d=b._cornerIndex;b.setOpacity(0);this._oppositeCorner=c[(d+2)%4];this._toggleCornerMarkers(0,d)}this._shape.fire("editstart")},_onTouchMove:function(b){var c=this._map.mouseEventToLayerPoint(b.originalEvent.touches[0]),c=this._map.layerPointToLatLng(c);b.target===this._moveMarker?this._move(c):this._resize(c);this._shape.redraw();return!1},_onTouchEnd:function(b){b.target.setOpacity(1);this.updateMarkers();this._fireEdit()},_move:function(){},_resize:function(){}});L.Edit=L.Edit||{};L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var b=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(b,this.options.moveIcon)},_createResizeMarker:function(){var b=this._getCorners();this._resizeMarkers=[];for(var c=0,d=b.length;c<d;c++)this._resizeMarkers.push(this._createMarker(b[c],this.options.resizeIcon)),this._resizeMarkers[c]._cornerIndex=c},_onMarkerDragStart:function(b){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,b);var c=this._getCorners();b=b.target._cornerIndex;this._oppositeCorner=c[(b+2)%4];this._toggleCornerMarkers(0,b)},_onMarkerDragEnd:function(b){var c=b.target,d;c===this._moveMarker&&(d=this._shape.getBounds(),d=d.getCenter(),c.setLatLng(d));this._toggleCornerMarkers(1);this._repositionCornerMarkers();L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,b)},_move:function(b){for(var c=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),d=this._shape.getBounds().getCenter(),a,k=[],g=0,f=c.length;g<f;g++)a=[c[g].lat-d.lat,c[g].lng-d.lng],k.push([b.lat+a[0],b.lng+a[1]]);this._shape.setLatLngs(k);this._repositionCornerMarkers();this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(b){this._shape.setBounds(L.latLngBounds(b,this._oppositeCorner));b=this._shape.getBounds();this._moveMarker.setLatLng(b.getCenter());this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var b=this._shape.getBounds(),c=b.getNorthWest(),d=b.getNorthEast(),a=b.getSouthEast(),b=b.getSouthWest();return[c,d,a,b]},_toggleCornerMarkers:function(b){for(var c=0,d=this._resizeMarkers.length;c<d;c++)this._resizeMarkers[c].setOpacity(b)},_repositionCornerMarkers:function(){for(var b=this._getCorners(),c=0,d=this._resizeMarkers.length;c<d;c++)this._resizeMarkers[c].setLatLng(b[c])}});L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())});L.Edit=L.Edit||{};L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var b=this._shape.getLatLng();this._moveMarker=this._createMarker(b,this.options.moveIcon)},_createResizeMarker:function(){var b=this._shape.getLatLng(),b=this._getResizeMarkerPoint(b);this._resizeMarkers=[];this._resizeMarkers.push(this._createMarker(b,this.options.resizeIcon))},_getResizeMarkerPoint:function(b){var c=this._shape._radius*Math.cos(Math.PI/4);b=this._map.project(b);return this._map.unproject([b.x+c,b.y-c])},_move:function(b){var c=this._getResizeMarkerPoint(b);this._resizeMarkers[0].setLatLng(c);this._shape.setLatLng(b);this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(b){b=this._moveMarker.getLatLng().distanceTo(b);this._shape.setRadius(b);this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}});L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable());this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()});this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})});L.Map.mergeOptions({touchExtend:!0});L.Map.TouchExtend=L.Handler.extend({initialize:function(b){this._map=b;this._container=b._container;this._pane=b._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this);L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this);L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this);this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart);L.DomEvent.off(this._container,"touchend",this._onTouchEnd);L.DomEvent.off(this._container,"touchmove",this._onTouchMove);this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDowm",this._onTouchStart),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave))},_touchEvent:function(b,c){var d={};if("undefined"!==typeof b.touches){if(!b.touches.length)return;d=b.touches[0]}else if("touch"===b.pointerType){if(d=b,!this._filterClick(b))return}else return;var a=this._map.mouseEventToContainerPoint(d),k=this._map.mouseEventToLayerPoint(d),g=this._map.layerPointToLatLng(k);this._map.fire(c,{latlng:g,layerPoint:k,containerPoint:a,pageX:d.pageX,pageY:d.pageY,originalEvent:b})},_filterClick:function(b){var c=b.timeStamp||b.originalEvent.timeStamp,d=L.DomEvent._lastClick&&c-L.DomEvent._lastClick;if(d&&100<d&&500>d||b.target._simulatedClick&&!b._simulated)return L.DomEvent.stop(b),!1;L.DomEvent._lastClick=c;return!0},_onTouchStart:function(b){this._map._loaded&&this._touchEvent(b,"touchstart")},_onTouchEnd:function(b){this._map._loaded&&this._touchEvent(b,"touchend")},_onTouchCancel:function(b){if(this._map._loaded){var c="touchcancel";this._detectIE()&&(c="pointercancel");this._touchEvent(b,c)}},_onTouchLeave:function(b){this._map._loaded&&this._touchEvent(b,"touchleave")},_onTouchMove:function(b){this._map._loaded&&this._touchEvent(b,"touchmove")},_detectIE:function(){var b=n.navigator.userAgent,c=b.indexOf("MSIE ");if(0<c)return parseInt(b.substring(c+5,b.indexOf(".",c)),10);if(0<b.indexOf("Trident/"))return c=b.indexOf("rv:"),parseInt(b.substring(c+3,b.indexOf(".",c)),10);c=b.indexOf("Edge/");return 0<c?parseInt(b.substring(c+5,b.indexOf(".",c)),10):!1}});L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend);L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var b=this._icon,c="dblclick mousedown mouseover mouseout contextmenu touchstart touchend touchmove".split(" ");this._detectIE?c.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):c.concat(["touchcancel"]);L.DomUtil.addClass(b,"leaflet-clickable");L.DomEvent.on(b,"click",this._onMouseClick,this);L.DomEvent.on(b,"keypress",this._onKeyPress,this);for(var d=0;d<c.length;d++)L.DomEvent.on(b,c[d],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var b=n.navigator.userAgent,c=b.indexOf("MSIE ");if(0<c)return parseInt(b.substring(c+5,b.indexOf(".",c)),10);if(0<b.indexOf("Trident/"))return c=b.indexOf("rv:"),parseInt(b.substring(c+3,b.indexOf(".",c)),10);c=b.indexOf("Edge/");return 0<c?parseInt(b.substring(c+5,b.indexOf(".",c)),10):!1}});L.LatLngUtil={cloneLatLngs:function(b){for(var c=[],d=0,a=b.length;d<a;d++)Array.isArray(b[d])?c.push(L.LatLngUtil.cloneLatLngs(b[d])):c.push(this.cloneLatLng(b[d]));return c},cloneLatLng:function(b){return L.latLng(b.lat,b.lng)}};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(b){var c=b.length,d=0,a=Math.PI/180,k,g;if(2<c){for(var f=0;f<c;f++)k=b[f],g=b[(f+1)%c],d+=(g.lng-k.lng)*a*(2+Math.sin(k.lat*a)+Math.sin(g.lat*a));d=40680631590769*d/2}return Math.abs(d)},readableArea:function(b,c){var d;c?d=1E4<=b?(1E-4*b).toFixed(2)+" ha":b.toFixed(2)+" m\x26sup2;":(b/=.836127,d=3097600<=b?(b/3097600).toFixed(2)+" mi\x26sup2;":4840<=b?(b/4840).toFixed(2)+" acres":Math.ceil(b)+" yd\x26sup2;");return d},readableDistance:function(b,c,d,a){switch("string"==typeof c?c:d?"feet":a?"nauticalMile":c?"metric":"yards"){case "metric":b=1E3<b?(b/1E3).toFixed(2)+" km":Math.ceil(b)+" m";break;case "feet":b=Math.ceil(3.28083*b)+" ft";break;case "nauticalMile":b*=.53996;b=(b/1E3).toFixed(2)+" nm";break;default:b*=1.09361,b=1760<b?(b/1760).toFixed(2)+" miles":Math.ceil(b)+" yd"}return b}});L.Util.extend(L.LineUtil,{segmentsIntersect:function(b,c,d,a){return this._checkCounterclockwise(b,d,a)!==this._checkCounterclockwise(c,d,a)&&this._checkCounterclockwise(b,c,d)!==this._checkCounterclockwise(b,c,a)},_checkCounterclockwise:function(b,c,d){return(d.y-b.y)*(c.x-b.x)>(c.y-b.y)*(d.x-b.x)}});L.Polyline.include({intersects:function(){var b=this._getProjectedPoints(),c=b?b.length:0,d,a;if(this._tooFewPointsForIntersection())return!1;for(--c;3<=c;c--)if(d=b[c-1],a=b[c],this._lineSegmentsIntersectsRange(d,a,c-2))return!0;return!1},newLatLngIntersects:function(b,c){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(b),c):!1},newPointIntersects:function(b,c){var d=this._getProjectedPoints(),a=d?d.length:0,d=d?d[a-1]:null,a=a-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(d,b,a,c?1:0)},_tooFewPointsForIntersection:function(b){var c=this._getProjectedPoints(),d=c?c.length:0;return!c||3>=d+(b||0)},_lineSegmentsIntersectsRange:function(b,c,d,a){var k=this._getProjectedPoints(),g;a=a||0;for(var f=d;f>a;f--)if(d=k[f-1],g=k[f],L.LineUtil.segmentsIntersect(b,c,d,g))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var b=[],c=this._defaultShape(),d=0;d<c.length;d++)b.push(this._map.latLngToLayerPoint(c[d]));return b}});L.Polygon.include({intersects:function(){var b=this._getProjectedPoints(),c;if(this._tooFewPointsForIntersection())return!1;if(L.Polyline.prototype.intersects.call(this))return!0;c=b.length;return this._lineSegmentsIntersectsRange(b[c-1],b[0],c-2,1)}});L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(b){if("0.7">L.version)throw Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,b);this._toolbars={};L.DrawToolbar&&this.options.draw&&(b=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=b,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this));L.EditToolbar&&this.options.edit&&(b=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=b,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this));L.toolbar=this},onAdd:function(b){var c=L.DomUtil.create("div","leaflet-draw"),d=!1,a,k;for(k in this._toolbars)this._toolbars.hasOwnProperty(k)&&(a=this._toolbars[k].addToolbar(b))&&(d||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),d=!0),c.appendChild(a));return c},onRemove:function(){for(var b in this._toolbars)this._toolbars.hasOwnProperty(b)&&this._toolbars[b].removeToolbar()},setDrawingOptions:function(b){for(var c in this._toolbars)this._toolbars[c]instanceof L.DrawToolbar&&this._toolbars[c].setOptions(b)},_toolbarEnabled:function(b){b=b.target;for(var c in this._toolbars)this._toolbars[c]!==b&&this._toolbars[c].disable()}});L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1});L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))});L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(b){L.setOptions(this,b);this._modes={};this._actionButtons=[];this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(b){var c=L.DomUtil.create("div","leaflet-draw-section"),d=0,a=this._toolbarClass||"",k=this.getModeHandlers(b);this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar");this._map=b;for(b=0;b<k.length;b++)k[b].enabled&&this._initModeHandler(k[b].handler,this._toolbarContainer,d++,a,k[b].title);if(d)return this._lastButtonIndex=--d,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),c.appendChild(this._toolbarContainer),c.appendChild(this._actionsContainer),c},removeToolbar:function(){for(var b in this._modes)this._modes.hasOwnProperty(b)&&(this._disposeButton(this._modes[b].button,this._modes[b].handler.enable,this._modes[b].handler),this._modes[b].handler.disable(),this._modes[b].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};b=0;for(var c=this._actionButtons.length;b<c;b++)this._disposeButton(this._actionButtons[b].button,this._actionButtons[b].callback,this);this._actionButtons=[];this._actionsContainer=null},_initModeHandler:function(b,c,d,a,k){var g=b.type;this._modes[g]={};this._modes[g].handler=b;this._modes[g].button=this._createButton({type:g,title:k,className:a+"-"+g,container:c,callback:this._modes[g].handler.enable,context:this._modes[g].handler});this._modes[g].buttonIndex=d;this._modes[g].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(b){var c=L.DomUtil.create("a",b.className||"",b.container),d=L.DomUtil.create("span","sr-only",b.container);c.href="#";c.appendChild(d);b.title&&(c.title=b.title,d.innerHTML=b.title);b.text&&(c.innerHTML=b.text,d.innerHTML=b.text);L.DomEvent.on(c,"click",L.DomEvent.stopPropagation).on(c,"mousedown",L.DomEvent.stopPropagation).on(c,"dblclick",L.DomEvent.stopPropagation).on(c,"touchstart",L.DomEvent.stopPropagation).on(c,"click",L.DomEvent.preventDefault).on(c,"click",b.callback,b.context);return c},_disposeButton:function(b,c){L.DomEvent.off(b,"click",L.DomEvent.stopPropagation).off(b,"mousedown",L.DomEvent.stopPropagation).off(b,"dblclick",L.DomEvent.stopPropagation).off(b,"touchstart",L.DomEvent.stopPropagation).off(b,"click",L.DomEvent.preventDefault).off(b,"click",c)},_handlerActivated:function(b){this.disable();this._activeMode=this._modes[b.handler];L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled");this._showActionsToolbar();this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar();L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled");this._activeMode=null;this.fire("disable")},_createActions:function(b){var c=this._actionsContainer;b=this.getActions(b);var d=b.length,a,k;k=0;for(a=this._actionButtons.length;k<a;k++)this._disposeButton(this._actionButtons[k].button,this._actionButtons[k].callback);for(this._actionButtons=[];c.firstChild;)c.removeChild(c.firstChild);for(k=0;k<d;k++)"enabled"in b[k]&&!b[k].enabled||(a=L.DomUtil.create("li","",c),a=this._createButton({title:b[k].title,text:b[k].text,container:a,callback:b[k].callback,context:b[k].context}),this._actionButtons.push({button:a,callback:b[k].callback}))},_showActionsToolbar:function(){var b=this._activeMode.buttonIndex,c=this._lastButtonIndex,d=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler);this._actionsContainer.style.top=d+"px";0===b&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top"));b===c&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom"));this._actionsContainer.style.display="block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none";L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop");L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom");L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top");L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom")}});L.Draw=L.Draw||{};L.Draw.Tooltip=L.Class.extend({initialize:function(b){this._map=b;this._popupPane=b._panes.popupPane;this._container=b.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null;this._singleLineLabel=!1;this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this);this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(b){if(!this._container)return this;b.subtext=b.subtext||"";0!==b.subtext.length||this._singleLineLabel?0<b.subtext.length&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0);this._container.innerHTML=(0<b.subtext.length?'\x3cspan class\x3d"leaflet-draw-tooltip-subtext"\x3e'+b.subtext+"\x3c/span\x3e\x3cbr /\x3e":"")+"\x3cspan\x3e"+b.text+"\x3c/span\x3e";return this},updatePosition:function(b){b=this._map.latLngToLayerPoint(b);var c=this._container;this._container&&(c.style.visibility="inherit",L.DomUtil.setPosition(c,b));return this},showAsError:function(){this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip");return this},removeError:function(){this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip");return this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}});L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(b){for(var c in this.options)this.options.hasOwnProperty(c)&&b[c]&&(b[c]=L.extend({},this.options[c],b[c]));this._toolbarClass="leaflet-draw-draw";L.Toolbar.prototype.initialize.call(this,b)},getModeHandlers:function(b){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(b,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(b,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(b,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(b,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(b,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(b){return[{enabled:b.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:b.completeShape,context:b},{enabled:b.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:b.deleteLastVertex,context:b},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(b){L.setOptions(this,b);for(var c in this._modes)this._modes.hasOwnProperty(c)&&b.hasOwnProperty(c)&&this._modes[c].handler.setOptions(b[c])}});L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(b){b.edit&&("undefined"===typeof b.edit.selectedPathOptions&&(b.edit.selectedPathOptions=this.options.edit.selectedPathOptions),b.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,b.edit.selectedPathOptions));b.remove&&(b.remove=L.extend({},this.options.remove,b.remove));b.poly&&(b.poly=L.extend({},this.options.poly,b.poly));this._toolbarClass="leaflet-draw-edit";L.Toolbar.prototype.initialize.call(this,b);this._selectedFeatureCount=0},getModeHandlers:function(b){var c=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(b,{featureGroup:c,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(b,{featureGroup:c}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(b){b=L.Toolbar.prototype.addToolbar.call(this,b);this._checkDisabled();this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this);return b},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this);L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save();this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var b=0!==this.options.featureGroup.getLayers().length,c;this.options.edit&&(c=this._modes[L.EditToolbar.Edit.TYPE].button,b?L.DomUtil.removeClass(c,"leaflet-disabled"):L.DomUtil.addClass(c,"leaflet-disabled"),c.setAttribute("title",b?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled));this.options.remove&&(c=this._modes[L.EditToolbar.Delete.TYPE].button,b?L.DomUtil.removeClass(c,"leaflet-disabled"):L.DomUtil.addClass(c,"leaflet-disabled"),c.setAttribute("title",b?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}});L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},includes:L.Mixin.Events,initialize:function(b,c){L.Handler.prototype.initialize.call(this,b);L.setOptions(this,c);this._featureGroup=c.featureGroup;if(!(this._featureGroup instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={};this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var b=this._map;b&&(b.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),b._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(b){this._revertLayer(b)},this)},save:function(){var b=new L.LayerGroup;this._featureGroup.eachLayer(function(c){c.edited&&(b.addLayer(c),c.edited=!1)});this._map.fire(L.Draw.Event.EDITED,{layers:b})},_backupLayer:function(b){var c=L.Util.stamp(b);this._uneditedLayerProps[c]||(b instanceof L.Polyline||b instanceof L.Polygon||b instanceof L.Rectangle?this._uneditedLayerProps[c]={latlngs:L.LatLngUtil.cloneLatLngs(b.getLatLngs())}:b instanceof L.Circle?this._uneditedLayerProps[c]={latlng:L.LatLngUtil.cloneLatLng(b.getLatLng()),radius:b.getRadius()}:b instanceof L.Marker&&(this._uneditedLayerProps[c]={latlng:L.LatLngUtil.cloneLatLng(b.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(b){var c=L.Util.stamp(b);b.edited=!1;this._uneditedLayerProps.hasOwnProperty(c)&&(b instanceof L.Polyline||b instanceof L.Polygon||b instanceof L.Rectangle?b.setLatLngs(this._uneditedLayerProps[c].latlngs):b instanceof L.Circle?(b.setLatLng(this._uneditedLayerProps[c].latlng),b.setRadius(this._uneditedLayerProps[c].radius)):b instanceof L.Marker&&b.setLatLng(this._uneditedLayerProps[c].latlng),b.fire("revert-edited",{layer:b}))},_enableLayerEdit:function(b){b=b.layer||b.target||b;var c;this._backupLayer(b);this.options.poly&&(c=L.Util.extend({},this.options.poly),b.options.poly=c);this.options.selectedPathOptions&&(c=L.Util.extend({},this.options.selectedPathOptions),c.maintainColor&&(c.color=b.options.color,c.fillColor=b.options.fillColor),b.options.original=L.extend({},b.options),b.options.editing=c);b instanceof L.Marker?(b.editing&&b.editing.enable(),b.dragging.enable(),b.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):b.editing.enable()},_disableLayerEdit:function(b){b=b.layer||b.target||b;b.edited=!1;b.editing&&b.editing.disable();delete b.options.editing;delete b.options.original;this._selectedPathOptions&&(b instanceof L.Marker?this._toggleMarkerHighlight(b):(b.setStyle(b.options.previousOptions),delete b.options.previousOptions));b instanceof L.Marker?(b.dragging.disable(),b.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):b.editing.disable()},_onMouseMove:function(b){this._tooltip.updatePosition(b.latlng)},_onMarkerDragEnd:function(b){b=b.target;b.edited=!0;this._map.fire(L.Draw.Event.EDITMOVE,{layer:b})},_onTouchMove:function(b){var c=this._map.mouseEventToLayerPoint(b.originalEvent.changedTouches[0]),c=this._map.layerPointToLatLng(c);b.target.setLatLng(c)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}});L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},includes:L.Mixin.Events,initialize:function(b,c){L.Handler.prototype.initialize.call(this,b);L.Util.setOptions(this,c);this._deletableLayers=this.options.featureGroup;if(!(this._deletableLayers instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var b=this._map;b&&(b.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(b){this._deletableLayers.addLayer(b);b.fire("revert-deleted",{layer:b})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},_enableLayerDelete:function(b){(b.layer||b.target||b).on("click",this._removeLayer,this)},_disableLayerDelete:function(b){b=b.layer||b.target||b;b.off("click",this._removeLayer,this);this._deletedLayers.removeLayer(b)},_removeLayer:function(b){b=b.layer||b.target||b;this._deletableLayers.removeLayer(b);this._deletedLayers.addLayer(b);b.fire("deleted")},_onMouseMove:function(b){this._tooltip.updatePosition(b.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})})(window,document);!function(){L.Marker.Measurement=L[L.Layer?"Layer":"Class"].extend({options:{pane:"markerPane"},initialize:function(e,b,c,d,a){L.setOptions(this,a);this._latlng=e;this._measurement=b;this._title=c;this._rotation=d},addTo:function(e){e.addLayer(this);return this},onAdd:function(e){this._map=e;var b=this.getPane?this.getPane():e.getPanes().markerPane,b=this._element=L.DomUtil.create("div","leaflet-zoom-animated leaflet-measure-path-measurement",b),b=L.DomUtil.create("div","",b);b.title=this._title;b.innerHTML=this._measurement;e.on("zoomanim",this._animateZoom,this);this._setPosition()},onRemove:function(e){e.off("zoomanim",this._animateZoom,this);(this.getPane?this.getPane():e.getPanes().markerPane).removeChild(this._element);this._map=null},_setPosition:function(){L.DomUtil.setPosition(this._element,this._map.latLngToLayerPoint(this._latlng));this._element.style.transform+=" rotate("+this._rotation+"rad)"},_animateZoom:function(e){e=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();L.DomUtil.setPosition(this._element,e);this._element.style.transform+=" rotate("+this._rotation+"rad)"}});L.marker.measurement=function(e,b,c,d,a){return new L.Marker.Measurement(e,b,c,d,a)};var n=function(e){var b;this._measurementOptions.imperial?404.685642<e?(e/=4046.85642,b="ac"):(e/=.09290304,b="ft\u00b2"):1E6<e?(e/=1E6,b="km\u00b2"):b="m\u00b2";return 100>e?e.toFixed(1)+" "+b:Math.round(e)+" "+b},e=function(e,b,c){return c?function(){b.apply(this,arguments);return e.apply(this,arguments)}:function(){e.apply(this,arguments);return b.apply(this,arguments)}};L.Polyline.include({showMeasurements:function(e){if(!this._map||this._measurementLayer)return this;this._measurementOptions=L.extend({showOnHover:!1,minPixelDistance:30,showDistances:!0,showArea:!0,lang:{totalLength:"Total length",totalArea:"Total area",segmentLength:"Segment length"}},e||{});this._measurementLayer=L.layerGroup().addTo(this._map);this.updateMeasurements();this._map.on("zoomend",this.updateMeasurements,this);return this},hideMeasurements:function(){this._map.off("zoomend",this.updateMeasurements,this);if(!this._measurementLayer)return this;this._map.removeLayer(this._measurementLayer);this._measurementLayer=null;return this},onAdd:e(L.Polyline.prototype.onAdd,function(){this.options.showMeasurements&&this.showMeasurements(this.options.measurementOptions)}),onRemove:e(L.Polyline.prototype.onRemove,function(){this.hideMeasurements()},!0),setLatLngs:e(L.Polyline.prototype.setLatLngs,function(){return this.updateMeasurements()}),spliceLatLngs:e(L.Polyline.prototype.spliceLatLngs,function(){return this.updateMeasurements()}),formatDistance:function(e){var b;this._measurementOptions.imperial?(b=e/.3048,3E3<b?(e/=1609.344,b="mi"):(e=b,b="ft")):1E3<e?(e/=1E3,b="km"):b="m";return 100>e?e.toFixed(1)+" "+b:Math.round(e)+" "+b},formatArea:n,updateMeasurements:function(){if(!this._measurementLayer)return this;var e=this.getLatLngs(),b=this instanceof L.Polygon,c=this._measurementOptions,d=0,a,k,g,f,l,w,m;e&&e.length&&L.Util.isArray(e[0])&&(e=e[0]);this._measurementLayer.clearLayers();if(this._measurementOptions.showDistances&&1<e.length){a=this._measurementOptions.formatDistance||L.bind(this.formatDistance,this);for(var q=1,p=e.length;b&&q<=p||q<p;q++)k=e[q-1],g=e[q%p],m=k.distanceTo(g),d+=m,f=this._map.latLngToLayerPoint(k),l=this._map.latLngToLayerPoint(g),w=f.distanceTo(l),w>=c.minPixelDistance&&L.marker.measurement(this._map.layerPointToLatLng([(f.x+l.x)/2,(f.y+l.y)/2]),a(m),c.lang.segmentLength,this._getRotation(k,g),c).addTo(this._measurementLayer);b||L.marker.measurement(g,a(d),c.lang.totalLength,0,c).addTo(this._measurementLayer)}if(b&&c.showArea&&2<e.length){a=c.formatArea||L.bind(this.formatArea,this);b=0;d=e.length;if(2<d){for(k=0;k<d;k++)k===d-2?(g=d-2,l=d-1,f=0):k===d-1?(g=d-1,l=0,f=1):(g=k,l=k+1,f=k+2),g=e[g],l=e[l],f=e[f],b+=(f.lng*Math.PI/180-g.lng*Math.PI/180)*Math.sin(l.lat*Math.PI/180);b=40680631590769*b/2}e=Math.abs(b);L.marker.measurement(this.getBounds().getCenter(),a(e),c.lang.totalArea,0,c).addTo(this._measurementLayer)}return this},_getRotation:function(e,b){var c=this._map.project(e),d=this._map.project(b);return Math.atan((d.y-c.y)/(d.x-c.x))}});L.Polyline.addInitHook(function(){this.options.showMeasurements&&this.showMeasurements()});L.Circle.include({showMeasurements:function(e){if(!this._map||this._measurementLayer)return this;this._measurementOptions=L.extend({showOnHover:!1,showArea:!0,lang:{totalArea:"Total area"}},e||{});this._measurementLayer=L.layerGroup().addTo(this._map);this.updateMeasurements();this._map.on("zoomend",this.updateMeasurements,this);return this},hideMeasurements:function(){this._map.on("zoomend",this.updateMeasurements,this);if(!this._measurementLayer)return this;this._map.removeLayer(this._measurementLayer);this._measurementLayer=null;return this},onAdd:e(L.Circle.prototype.onAdd,function(){this.options.showMeasurements&&this.showMeasurements(this.options.measurementOptions)}),onRemove:e(L.Circle.prototype.onRemove,function(){this.hideMeasurements()},!0),setLatLng:e(L.Circle.prototype.setLatLng,function(){this.updateMeasurements()}),setRadius:e(L.Circle.prototype.setRadius,function(){this.updateMeasurements()}),formatArea:n,updateMeasurements:function(){if(this._measurementLayer){var e=this.getLatLng(),b=this._measurementOptions,c=b.formatArea||L.bind(this.formatArea,this);this._measurementLayer.clearLayers();if(b.showArea){var c=b.formatArea||L.bind(this.formatArea,this),d=this.getRadius()/6378137;L.marker.measurement(e,c(81361263181538*Math.PI*(1-Math.cos(d))),b.lang.totalArea,0,b).addTo(this._measurementLayer)}}}});L.Circle.addInitHook(function(){this.options.showMeasurements&&this.showMeasurements()})}();(function(n,e){"object"===typeof exports&&"undefined"!==typeof module?e(exports,require("leaflet")):"function"===typeof define&&define.amd?define(["exports","leaflet"],e):e((n.L=n.L||{},n.L.esri=n.L.esri||{}),n.L)})(this,function(n,e){function h(a){var b="";a.f=a.f||"json";for(var c in a)if(a.hasOwnProperty(c)){var d=a[c],f=Object.prototype.toString.call(d);b.length&&(b+="\x26");d="[object Array]"===f?"[object Object]"===Object.prototype.toString.call(d[0])?JSON.stringify(d):d.join(","):"[object Object]"===f?JSON.stringify(d):"[object Date]"===f?d.valueOf():d;b+=encodeURIComponent(c)+"\x3d"+encodeURIComponent(d)}return b}function b(a,b){var c=new window.XMLHttpRequest;c.onerror=function(d){c.onreadystatechange=e.Util.falseFn;a.call(b,{error:{code:500,message:"XMLHttpRequest error"}},null)};c.onreadystatechange=function(){var d,f;if(4===c.readyState){try{d=JSON.parse(c.responseText)}catch(g){d=null,f={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!f&&d.error&&(f=d.error,d=null);c.onerror=e.Util.falseFn;a.call(b,f,d)}};c.ontimeout=function(){this.onerror()};return c}function c(a,c,d,f){d=b(d,f);d.open("POST",a);"undefined"!==typeof f&&null!==f&&"undefined"!==typeof f.options&&(d.timeout=f.options.timeout);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(h(c));return d}function d(a,c,d,f){d=b(d,f);d.open("GET",a+"?"+h(c),!0);"undefined"!==typeof f&&null!==f&&"undefined"!==typeof f.options&&(d.timeout=f.options.timeout);d.send(null);return d}function a(a,c,d,f){var g=h(c),l=b(d,f),e=(a+"?"+g).length;2E3>=e&&H.cors?l.open("GET",a+"?"+g):2E3<e&&H.cors&&(l.open("POST",a),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));"undefined"!==typeof f&&null!==f&&"undefined"!==typeof f.options&&(l.timeout=f.options.timeout);if(2E3>=e&&H.cors)l.send(null);else if(2E3<e&&H.cors)l.send(g);else{if(2E3>=e&&!H.cors)return k(a,c,d,f);z("a request to "+a+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");return}return l}function k(a,b,c,d){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var f="c"+W;b.callback="window._EsriLeafletCallbacks."+f;window._EsriLeafletCallbacks[f]=function(a){if(!0!==window._EsriLeafletCallbacks[f]){var b,g=Object.prototype.toString.call(a);"[object Object]"!==g&&"[object Array]"!==g&&(b={error:{code:500,message:"Expected array or object as JSONP response"}},a=null);!b&&a.error&&(b=a,a=null);c.call(d,b,a);window._EsriLeafletCallbacks[f]=!0}};var g=e.DomUtil.create("script",null,document.body);g.type="text/javascript";g.src=a+"?"+h(b);g.id=f;W++;return{id:f,url:g.src,abort:function(){window._EsriLeafletCallbacks._callback[f]({code:0,message:"Request aborted."})}}}function g(a){var b;a:{b=a[0];for(var c=0;c<b.length;c++)if(b[c]!==a[a.length-1][c]){b=!1;break a}b=!0}b||a.push(a[0]);return a}function f(a){var b=0,c=0,d=a.length,f=a[c],g;for(c;c<d-1;c++)g=a[c+1],b+=(g[0]-f[0])*(g[1]+f[1]),f=g;return 0<=b}function l(a,b){for(var c=0;c<a.length-1;c++)for(var d=0;d<b.length-1;d++){var f;a:{var g=a[c],l=a[c+1],k=b[d],e=b[d+1],m=(e[0]-k[0])*(g[1]-k[1])-(e[1]-k[1])*(g[0]-k[0]);f=(l[0]-g[0])*(g[1]-k[1])-(l[1]-g[1])*(g[0]-k[0]);g=(e[1]-k[1])*(l[0]-g[0])-(e[0]-k[0])*(l[1]-g[1]);if(0!==g&&(m/=g,f/=g,0<=m&&1>=m&&0<=f&&1>=f)){f=!0;break a}f=!1}if(f)return!0}return!1}function w(a){var b=[];a=a.slice(0);var c=g(a.shift().slice(0));if(4<=c.length)for(f(c)||c.reverse(),b.push(c),c=0;c<a.length;c++){var d=g(a[c].slice(0));4<=d.length&&(f(d)&&d.reverse(),b.push(d))}return b}function m(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function q(a,b){var c={};"number"===typeof a.x&&"number"===typeof a.y&&(c.type="Point",c.coordinates=[a.x,a.y]);a.points&&(c.type="MultiPoint",c.coordinates=a.points.slice(0));a.paths&&(1===a.paths.length?(c.type="LineString",c.coordinates=a.paths[0].slice(0)):(c.type="MultiLineString",c.coordinates=a.paths.slice(0)));if(a.rings){var d=a.rings.slice(0),c=[],k=[],e,w;for(w=0;w<d.length;w++){var h=g(d[w].slice(0));4>h.length||(f(h)?c.push([h]):k.push(h))}for(h=[];k.length;){w=k.pop();for(var p=!1,d=c.length-1;0<=d;d--){var n=e=c[d][0],r=w;e=l(n,r);for(var r=r[0],t=!1,u=-1,v=n.length,x=v-1;++u<v;x=u)(n[u][1]<=r[1]&&r[1]<n[x][1]||n[x][1]<=r[1]&&r[1]<n[u][1])&&r[0]<(n[x][0]-n[u][0])*(r[1]-n[u][1])/(n[x][1]-n[u][1])+n[u][0]&&(t=!t);n=t;if(!e&&n){c[d].push(w);p=!0;break}}p||h.push(w)}for(;h.length;){w=h.pop();k=!1;for(d=c.length-1;0<=d;d--)if(e=c[d][0],l(e,w)){c[d].push(w);k=!0;break}k||c.push([w.reverse()])}c=1===c.length?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}if(a.geometry||a.attributes)c.type="Feature",c.geometry=a.geometry?q(a.geometry):null,c.properties=a.attributes?m(a.attributes):null,a.attributes&&(c.id=a.attributes[b]||a.attributes.OBJECTID||a.attributes.FID);return c}function p(a,b){b=b||"OBJECTID";var c={wkid:4326},d={};switch(a.type){case "Point":d.x=a.coordinates[0];d.y=a.coordinates[1];d.spatialReference=c;break;case "MultiPoint":d.points=a.coordinates.slice(0);d.spatialReference=c;break;case "LineString":d.paths=[a.coordinates.slice(0)];d.spatialReference=c;break;case "MultiLineString":d.paths=a.coordinates.slice(0);d.spatialReference=c;break;case "Polygon":d.rings=w(a.coordinates.slice(0));d.spatialReference=c;break;case "MultiPolygon":for(var f=d,g=a.coordinates.slice(0),l=[],k=0;k<g.length;k++)for(var e=w(g[k]),h=e.length-1;0<=h;h--){var q=e[h].slice(0);l.push(q)}f.rings=l;d.spatialReference=c;break;case "Feature":a.geometry&&(d.geometry=p(a.geometry,b));d.attributes=a.properties?m(a.properties):{};a.id&&(d.attributes[b]=a.id);break;case "FeatureCollection":d=[];for(c=0;c<a.features.length;c++)d.push(p(a.features[c],b));break;case "GeometryCollection":for(d=[],c=0;c<a.geometries.length;c++)d.push(p(a.geometries[c],b))}return d}function r(a){if("NaN"!==a.xmin&&"NaN"!==a.ymin&&"NaN"!==a.xmax&&"NaN"!==a.ymax){var b=e.latLng(a.ymin,a.xmin);a=e.latLng(a.ymax,a.xmax);return e.latLngBounds(b,a)}return null}function t(a){a=e.latLngBounds(a);return{xmin:a.getSouthWest().lng,ymin:a.getSouthWest().lat,xmax:a.getNorthEast().lng,ymax:a.getNorthEast().lat,spatialReference:{wkid:4326}}}function u(a,b){var c,d=a.features||a.results,f=d.length;if(b)c=b;else if(a.objectIdFieldName)c=a.objectIdFieldName;else if(a.fields)for(var g=0;g<=a.fields.length-1;g++){if("esriFieldTypeOID"===a.fields[g].type){c=a.fields[g].name;break}}else if(f)for(g in d[0].attributes)if(g.match(/^(OBJECTID|FID|OID|ID)$/i)){c=g;break}g={type:"FeatureCollection",features:[]};if(f)for(f=d.length-1;0<=f;f--){var l=q(d[f],c);g.features.push(l)}return g}function v(a){a=e.Util.trim(a);"/"!==a[a.length-1]&&(a+="/");return a}function x(a){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(a)}function y(a){var b;switch(a){case "Point":b="esriGeometryPoint";break;case "MultiPoint":b="esriGeometryMultipoint";break;case "LineString":b="esriGeometryPolyline";break;case "MultiLineString":b="esriGeometryPolyline";break;case "Polygon":b="esriGeometryPolygon";break;case "MultiPolygon":b="esriGeometryPolygon"}return b}function z(){console&&console.warn&&console.warn.apply(console,arguments)}function B(a){return a.getSize().x-X.attributionWidthOffset+"px"}function D(a,b){k(a,{},e.Util.bind(function(a,c){if(!a){b._esriAttributions=[];for(var d=0;d<c.contributors.length;d++)for(var f=c.contributors[d],g=0;g<f.coverageAreas.length;g++){var l=f.coverageAreas[g],k=e.latLng(l.bbox[0],l.bbox[1]),m=e.latLng(l.bbox[2],l.bbox[3]);b._esriAttributions.push({attribution:f.attribution,score:l.score,bounds:e.latLngBounds(k,m),minZoom:l.zoomMin,maxZoom:l.zoomMax})}b._esriAttributions.sort(function(a,b){return b.score-a.score});I({target:b})}},this))}function I(a){a=a.target;var b=a._esriAttributions;if(a&&a.attributionControl&&b){for(var c="",d=a.getBounds(),d=e.latLngBounds(d.getSouthWest().wrap(),d.getNorthEast().wrap()),f=a.getZoom(),g=0;g<b.length;g++){var l=b[g],k=l.attribution;!c.match(k)&&l.bounds.intersects(d)&&f>=l.minZoom&&f<=l.maxZoom&&(c+=", "+k)}c=c.substr(2);b=a.attributionControl._container.querySelector(".esri-dynamic-attribution");b.innerHTML=c;b.style.maxWidth=B(a);a.fire("attributionupdated",{attribution:c})}}function M(a){return new Y(a)}function V(a){return new Z(a)}function aa(a){return new ba(a)}function ca(a){return new da(a)}function T(a){return new ea(a)}function fa(a){return new ga(a)}function ha(a){return new ia(a)}function E(a){this.values=[].concat(a||[])}var C="default"in e?e["default"]:e,F=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,G=""===document.documentElement.style.pointerEvents,H={cors:F,pointerEvents:G},X={attributionWidthOffset:55},W=0,N=H.cors?d:k;N.CORS=d;N.JSONP=k;var O={request:a,get:N,post:c},ma={shallowClone:function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},warn:z,cleanUrl:v,isArcgisOnline:x,geojsonTypeToArcGIS:y,responseToFeatureCollection:u,geojsonToArcGIS:function(a,b){return p(a,b)},arcgisToGeoJSON:function(a,b){return q(a,b)},boundsToExtent:t,extentToBounds:r,calcAttributionWidth:B,setEsriAttribution:function(a){},_getAttributionData:D,_updateMapAttribution:I},J=e.Class.extend({options:{proxy:!1,useCors:F},generateSetter:function(a,b){return e.Util.bind(function(b){this.params[a]=b;return this},b)},initialize:function(a){a.request&&a.options?(this._service=a,e.Util.setOptions(this,a.options)):(e.Util.setOptions(this,a),this.options.url=v(a.url));this.params=e.Util.extend({},this.params||{});if(this.setters)for(var b in this.setters)this[b]=this.generateSetter(this.setters[b],this)},token:function(a){this._service?this._service.authenticate(a):this.params.token=a;return this},request:function(a,b){return this._service?this._service.request(this.path,this.params,a,b):this._request("request",this.path,this.params,a,b)},_request:function(a,b,c,d,f){b=this.options.proxy?this.options.proxy+"?"+this.options.url+b:this.options.url+b;return"get"!==a&&"request"!==a||this.options.useCors?O[a](b,c,d,f):O.get.JSONP(b,c,d,f)}}),Y=J.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",token:"token"},path:"query",params:{returnGeometry:!0,where:"1\x3d1",outSr:4326,outFields:"*"},within:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelContains";return this},intersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelIntersects";return this},contains:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelWithin";return this},crosses:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelCrosses";return this},touches:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelTouches";return this},overlaps:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelOverlaps";return this},bboxIntersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelEnvelopeIntersects";return this},indexIntersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelIndexIntersects";return this},nearby:function(a,b){a=e.latLng(a);this.params.geometry=[a.lng,a.lat];this.params.geometryType="esriGeometryPoint";this.params.spatialRel="esriSpatialRelIntersects";this.params.units="esriSRUnit_Meter";this.params.distance=b;this.params.inSr=4326;return this},where:function(a){this.params.where=a;return this},between:function(a,b){this.params.time=[a.valueOf(),b.valueOf()];return this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=c/a.getSize().y*b;return this},orderBy:function(a,b){this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"";this.params.orderByFields+=[a,b||"ASC"].join(" ");return this},run:function(a,b){this._cleanParams();return this.options.isModern||x(this.options.url)?(this.params.f="geojson",this.request(function(c,d){this._trapSQLerrors(c);a.call(b,c,d,d)},this)):this.request(function(c,d){this._trapSQLerrors(c);a.call(b,c,d&&u(d),d)},this)},count:function(a,b){this._cleanParams();this.params.returnCountOnly=!0;return this.request(function(b,c){a.call(this,b,c&&c.count,c)},b)},ids:function(a,b){this._cleanParams();this.params.returnIdsOnly=!0;return this.request(function(b,c){a.call(this,b,c&&c.objectIds,c)},b)},bounds:function(a,b){this._cleanParams();this.params.returnExtentOnly=!0;return this.request(function(c,d){d&&d.extent&&r(d.extent)?a.call(b,c,r(d.extent),d):(c={message:"Invalid Bounds"},a.call(b,c,null,d))},b)},pixelSize:function(a){a=e.point(a);this.params.pixelSize=[a.x,a.y];return this},layer:function(a){this.path=a+"/query";return this},_trapSQLerrors:function(a){a&&"400"===a.code&&z("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly;delete this.params.returnExtentOnly;delete this.params.returnCountOnly},_setGeometry:function(a){this.params.inSr=4326;a instanceof e.LatLngBounds?(this.params.geometry=t(a),this.params.geometryType="esriGeometryEnvelope"):(a.getLatLng&&(a=a.getLatLng()),a instanceof e.LatLng&&(a={type:"Point",coordinates:[a.lng,a.lat]}),a instanceof e.GeoJSON&&(a=a.getLayers()[0].feature.geometry,this.params.geometry=p(a,void 0),this.params.geometryType=y(a.type)),a.toGeoJSON&&(a=a.toGeoJSON()),"Feature"===a.type&&(a=a.geometry),"Point"===a.type||"LineString"===a.type||"Polygon"===a.type||"MultiPolygon"===a.type?(this.params.geometry=p(a,void 0),this.params.geometryType=y(a.type)):z("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}}),Z=J.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(a,b){this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"";this.params.layerDefs+=[a,b].join(":");return this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=c/a.getSize().y*b;return this},run:function(a,b){return this.request(function(c,d){a.call(b,c,d&&u(d),d)},b)}}),P=J.extend({path:"identify",between:function(a,b){this.params.time=[a.valueOf(),b.valueOf()];return this}}),ba=P.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(a){var b=t(a.getBounds());a=a.getSize();this.params.imageDisplay=[a.x,a.y,96];this.params.mapExtent=[b.xmin,b.ymin,b.xmax,b.ymax];return this},at:function(a){a=e.latLng(a);this.params.geometry=[a.lng,a.lat];this.params.geometryType="esriGeometryPoint";return this},layerDef:function(a,b){this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"";this.params.layerDefs+=[a,b].join(":");return this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=c/a.getSize().y*b;return this},run:function(a,b){return this.request(function(c,d){if(c)a.call(b,c,void 0,d);else{var f=u(d);d.results=d.results.reverse();for(var g=0;g<f.features.length;g++)f.features[g].layerId=d.results[g].layerId;a.call(b,void 0,f,d)}})}}),da=P.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(a){a=e.latLng(a);this.params.geometry=JSON.stringify({x:a.lng,y:a.lat,spatialReference:{wkid:4326}});this.params.geometryType="esriGeometryPoint";return this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(a,b){return this.request(function(c,d){a.call(b,c,d&&this._responseToGeoJSON(d),d)},this)},_responseToGeoJSON:function(a){var b=a.location,c=a.catalogItems,d=a.catalogItemVisibilities,b={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[b.x,b.y]},crs:{type:"EPSG",properties:{code:b.spatialReference.wkid}},properties:{OBJECTID:a.objectId,name:a.name,value:a.value},id:a.objectId}};a.properties&&a.properties.Values&&(b.pixel.properties.values=a.properties.Values);if(c&&c.features&&(b.catalogItems=u(c),d&&d.length===b.catalogItems.features.length))for(a=d.length-1;0<=a;a--)b.catalogItems.features[a].properties.catalogItemVisibility=d[a];return b}}),K=e.Evented.extend({options:{proxy:!1,useCors:F,timeout:0},initialize:function(a){a=a||{};this._requestQueue=[];this._authenticating=!1;e.Util.setOptions(this,a);this.options.url=v(this.options.url)},get:function(a,b,c,d){return this._request("get",a,b,c,d)},post:function(a,b,c,d){return this._request("post",a,b,c,d)},request:function(a,b,c,d){return this._request("request",a,b,c,d)},metadata:function(a,b){return this._request("get","",{},a,b)},authenticate:function(a){this._authenticating=!1;this.options.token=a;this._runQueue();return this},getTimeout:function(){return this.options.timeout},setTimeout:function(a){this.options.timeout=a},_request:function(a,b,c,d,f){this.fire("requeststart",{url:this.options.url+b,params:c,method:a},!0);var g=this._createServiceCallback(a,b,c,d,f);this.options.token&&(c.token=this.options.token);if(this._authenticating)this._requestQueue.push([a,b,c,d,f]);else return b=this.options.proxy?this.options.proxy+"?"+this.options.url+b:this.options.url+b,"get"!==a&&"request"!==a||this.options.useCors?O[a](b,c,g,f):O.get.JSONP(b,c,g,f)},_createServiceCallback:function(a,b,c,d,f){return e.Util.bind(function(g,l){!g||499!==g.code&&498!==g.code||(this._authenticating=!0,this._requestQueue.push([a,b,c,d,f]),this.fire("authenticationrequired",{authenticate:e.Util.bind(this.authenticate,this)},!0),g.authenticate=e.Util.bind(this.authenticate,this));d.call(f,g,l);g?this.fire("requesterror",{url:this.options.url+b,params:c,message:g.message,code:g.code,method:a},!0):this.fire("requestsuccess",{url:this.options.url+b,params:c,response:l,method:a},!0);this.fire("requestend",{url:this.options.url+b,params:c,method:a},!0)},this)},_runQueue:function(){for(var a=this._requestQueue.length-1;0<=a;a--){var b=this._requestQueue[a];this[b.shift()].apply(this,b)}this._requestQueue=[]}}),ea=K.extend({identify:function(){return aa(this)},find:function(){return V(this)},query:function(){return M(this)}}),ga=K.extend({query:function(){return M(this)},identify:function(){return ca(this)}}),ia=K.extend({options:{idAttribute:"OBJECTID"},query:function(){return M(this)},addFeature:function(a,b,c){delete a.id;a=p(a,void 0);return this.post("addFeatures",{features:[a]},function(a,d){var f=d&&d.addResults?d.addResults[0]:void 0;b&&b.call(c,a||d.addResults[0].error,f)},c)},updateFeature:function(a,b,c){a=p(a,this.options.idAttribute);return this.post("updateFeatures",{features:[a]},function(a,d){var f=d&&d.updateResults?d.updateResults[0]:void 0;b&&b.call(c,a||d.updateResults[0].error,f)},c)},deleteFeature:function(a,b,c){return this.post("deleteFeatures",{objectIds:a},function(a,d){var f=d&&d.deleteResults?d.deleteResults[0]:void 0;b&&b.call(c,a||d.deleteResults[0].error,f)},c)},deleteFeatures:function(a,b,c){return this.post("deleteFeatures",{objectIds:a},function(a,d){var f=d&&d.deleteResults?d.deleteResults:void 0;b&&b.call(c,a||d.deleteResults[0].error,f)},c)}}),A="https:"!==window.location.protocol?"http:":"https:",Q=e.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:A+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:A+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:G?"esri-labels":"tilePane"}},NationalGeographic:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:G?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:G?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community"}},ImageryLabels:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:G?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:G?"esri-labels":"tilePane"}},ShadedRelief:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:G?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:G?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}}}},initialize:function(a,b){var c;if("object"===typeof a&&a.urlTemplate&&a.options)c=a;else if("string"===typeof a&&Q.TILES[a])c=Q.TILES[a];else throw Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');var d=e.Util.extend(c.options,b);e.Util.setOptions(this,d);this.options.token&&(c.urlTemplate+="?token\x3d"+this.options.token);e.TileLayer.prototype.initialize.call(this,c.urlTemplate,d)},onAdd:function(a){"esri-labels"===this.options.pane&&this._initPane();this.options.attributionUrl&&D(this.options.attributionUrl,a);a.on("moveend",I);e.TileLayer.prototype.onAdd.call(this,a)},onRemove:function(a){a.off("moveend",I);e.TileLayer.prototype.onRemove.call(this,a)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var a=this._map.createPane(this.options.pane);a.style.pointerEvents="none";a.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var a='\x3cspan class\x3d"esri-dynamic-attribution"\x3e'+this.options.attribution+"\x3c/span\x3e";return a}}),U=e.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg\x3d\x3d"},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(a){a.url=v(a.url);a=e.Util.setOptions(this,a);this.tileUrl=a.url+"tile/{z}/{y}/{x}";this.service=T(a);this.service.addEventParent(this);(new RegExp(/tiles.arcgis(online)?\.com/g)).test(a.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),a.subdomains=["1","2","3","4"]);this.options.token&&(this.tileUrl+="?token\x3d"+this.options.token);e.TileLayer.prototype.initialize.call(this,this.tileUrl,a)},getTileUrl:function(a){var b=this._getZoomForUrl();return e.Util.template(this.tileUrl,e.Util.extend({s:this._getSubdomain(a),x:a.x,y:a.y,z:this._lodMap&&this._lodMap[b]?this._lodMap[b]:b},this.options))},createTile:function(a,b){var c=document.createElement("img");L.DomEvent.on(c,"load",L.bind(this._tileOnLoad,this,b,c));L.DomEvent.on(c,"error",L.bind(this._tileOnError,this,b,c));this.options.crossOrigin&&(c.crossOrigin="");c.alt="";if(!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()])c.src=this.getTileUrl(a);else this.once("lodmap",function(){c.src=this.getTileUrl(a)},this);return c},onAdd:function(a){this._lodMap||this.metadata(function(b,c){if(!b&&c.spatialReference){var d=c.spatialReference.latestWkid||c.spatialReference.wkid;!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution()));if(a.options.crs===L.CRS.EPSG3857&&102100===d||3857===d){this._lodMap={};for(var d=c.tileInfo.lods,f=U.MercatorZoomLevels,g=0;g<d.length;g++){var l=d[g],k;for(k in f)if(this._withinPercentage(l.resolution,f[k],this.options.zoomOffsetAllowance)){this._lodMap[k]=l.level;break}}this.fire("lodmap")}else proj4||z("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")}},this);e.TileLayer.prototype.onAdd.call(this,a)},metadata:function(a,b){this.service.metadata(a,b);return this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(a){var b="?token\x3d"+a;this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,b):this.tileUrl+b;this.options.token=a;this.service.authenticate(a);return this},_withinPercentage:function(a,b,c){return Math.abs(a/b-1)<c}}),na=e.ImageOverlay.extend({onAdd:function(a){this._topLeft=a.getPixelBounds().min;e.ImageOverlay.prototype.onAdd.call(this,a)},_reset:function(){this._map.options.crs===e.CRS.EPSG3857?e.ImageOverlay.prototype._reset.call(this):e.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),F=e.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:F,attribution:null,interactive:!1,alt:""},onAdd:function(a){this._update=e.Util.throttle(this._update,this.options.updateInterval,this);a.on("moveend",this._update,this);this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?a.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null);this._update();this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this));this.metadata(function(b,c){!b&&!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(a){this._currentImage&&this._map.removeLayer(this._currentImage);this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this));this._map.off("moveend",this._update,this)},bindPopup:function(a,b){this._lastClick=this._shouldRenderPopup=!1;this._popup=e.popup(b);this._popupFunction=a;this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this));return this},unbindPopup:function(){this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this));this._popup=!1;return this},bringToFront:function(){this.options.position="front";this._currentImage&&this._currentImage.bringToFront();return this},bringToBack:function(){this.options.position="back";this._currentImage&&this._currentImage.bringToBack();return this},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(a){this.options.opacity=a;this._currentImage&&this._currentImage.setOpacity(a);return this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(a,b){this.options.from=a;this.options.to=b;this._update();return this},metadata:function(a,b){this.service.metadata(a,b);return this},authenticate:function(a){this.service.authenticate(a);return this},redraw:function(){this._update()},_renderImage:function(a,b,c){this._map&&(c&&(a="data:"+c+";base64,"+a),(new na(a,b,{opacity:0,crossOrigin:this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive})).addTo(this._map).once("load",function(a){if(this._map){a=a.target;var c=this._currentImage;a._bounds.equals(b)&&a._bounds.equals(this._map.getBounds())?(this._currentImage=a,"front"===this.options.position?this.bringToFront():this.bringToBack(),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),c&&this._map&&this._map.removeLayer(c),c&&c._map&&c._map.removeLayer(c)):this._map.removeLayer(a)}this.fire("load",{bounds:b})},this),this.fire("loading",{bounds:b}))},_update:function(){if(this._map){var a=this._map.getZoom(),b=this._map.getBounds();this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress||(a>this.options.maxZoom||a<this.options.minZoom?this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null):(a=this._buildExportParams(),this._requestExport(a,b)))}},_renderPopup:function(a,b,c,d){a=e.latLng(a);this._shouldRenderPopup&&this._lastClick.equals(a)&&(b=this._popupFunction(b,c,d))&&this._popup.setLatLng(a).setContent(b).openOn(this._map)},_resetPopupState:function(a){this._shouldRenderPopup=!1;this._lastClick=a.latlng}}),ja=F.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"json"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(a){a.url=v(a.url);this.service=fa(a);this.service.addEventParent(this);e.Util.setOptions(this,a)},setPixelType:function(a){this.options.pixelType=a;this._update();return this},getPixelType:function(){return this.options.pixelType},setBandIds:function(a){e.Util.isArray(a)?this.options.bandIds=a.join(","):this.options.bandIds=a.toString();this._update();return this},getBandIds:function(){return this.options.bandIds},setNoData:function(a,b){e.Util.isArray(a)?this.options.noData=a.join(","):this.options.noData=a.toString();b&&(this.options.noDataInterpretation=b);this._update();return this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(a){this.options.renderingRule=a;this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(a){this.options.mosaicRule=a;this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(a){var b=e.Util.bind(function(b,c,d){b||setTimeout(e.Util.bind(function(){this._renderPopup(a.latlng,b,c,d)},this),300)},this),c=this.identify().at(a.latlng);this.options.mosaicRule&&c.setMosaicRule(this.options.mosaicRule);c.run(b);this._shouldRenderPopup=!0;this._lastClick=a.latlng},_buildExportParams:function(){var a=this._map.getBounds(),b=this._map.getSize(),c=this._map.options.crs.project(a._northEast),d=this._map.options.crs.project(a._southWest),f=this._map.latLngToLayerPoint(a._northEast),a=this._map.latLngToLayerPoint(a._southWest);if(0<f.y||a.y<b.y)b.y=a.y-f.y;f=parseInt(this._map.options.crs.code.split(":")[1],10);b={bbox:[d.x,d.y,c.x,c.y].join(),size:b.x+","+b.y,format:this.options.format,transparent:this.options.transparent,bboxSR:f,imageSR:f};this.options.from&&this.options.to&&(b.time=this.options.from.valueOf()+","+this.options.to.valueOf());this.options.pixelType&&(b.pixelType=this.options.pixelType);this.options.interpolation&&(b.interpolation=this.options.interpolation);this.options.compressionQuality&&(b.compressionQuality=this.options.compressionQuality);this.options.bandIds&&(b.bandIds=this.options.bandIds);this.options.noData&&(b.noData=this.options.noData);this.options.noDataInterpretation&&(b.noDataInterpretation=this.options.noDataInterpretation);this.service.options.token&&(b.token=this.service.options.token);this.options.renderingRule&&(b.renderingRule=JSON.stringify(this.options.renderingRule));this.options.mosaicRule&&(b.mosaicRule=JSON.stringify(this.options.mosaicRule));return b},_requestExport:function(a,b){"json"===this.options.f?this.service.request("exportImage",a,function(a,c){a||(this.options.token&&(c.href+="?token\x3d"+this.options.token),this._renderImage(c.href,b))},this):(a.f="image",this._renderImage(this.options.url+"exportImage"+e.Util.getParamString(a),b))}}),ka=F.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png24",transparent:!0,f:"json"},initialize:function(a){a.url=v(a.url);this.service=T(a);this.service.addEventParent(this);(a.proxy||a.token)&&"json"!==a.f&&(a.f="json");e.Util.setOptions(this,a)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(a){this.options.dynamicLayers=a;this._update();return this},getLayers:function(){return this.options.layers},setLayers:function(a){this.options.layers=a;this._update();return this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(a){this.options.layerDefs=a;this._update();return this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(a){this.options.timeOptions=a;this._update();return this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(a){var b=e.Util.bind(function(b,c,d){b||setTimeout(e.Util.bind(function(){this._renderPopup(a.latlng,b,c,d)},this),300)},this),c=this.identify().on(this._map).at(a.latlng);c.simplify(this._map,.5);this.options.layers?c.layers("visible:"+this.options.layers.join(",")):c.layers("visible");c.run(b);this._shouldRenderPopup=!0;this._lastClick=a.latlng},_buildExportParams:function(){var a=this._map.getBounds(),b=this._map.getSize(),c=this._map.options.crs.project(a.getNorthEast()),d=this._map.options.crs.project(a.getSouthWest()),f=parseInt(this._map.options.crs.code.split(":")[1],10),g=this._map.latLngToLayerPoint(a._northEast),a=this._map.latLngToLayerPoint(a._southWest);if(0<g.y||a.y<b.y)b.y=a.y-g.y;b={bbox:[d.x,d.y,c.x,c.y].join(),size:b.x+","+b.y,dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:f,imageSR:f};this.options.dynamicLayers&&(b.dynamicLayers=this.options.dynamicLayers);this.options.layers&&(b.layers="show:"+this.options.layers.join(","));this.options.layerDefs&&(b.layerDefs="string"===typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs));this.options.timeOptions&&(b.timeOptions=JSON.stringify(this.options.timeOptions));this.options.from&&this.options.to&&(b.time=this.options.from.valueOf()+","+this.options.to.valueOf());this.service.options.token&&(b.token=this.service.options.token);this.options.proxy&&(b.proxy=this.options.proxy);return b},_requestExport:function(a,b){"json"===this.options.f?this.service.request("export",a,function(a,c){a||(this.options.token&&(c.href+="?token\x3d"+this.options.token),this.options.proxy&&(c.href=this.options.proxy+"?"+c.href),c.href?this._renderImage(c.href,b):this._renderImage(c.imageData,b,c.contentType))},this):(a.f="image",this._renderImage(this.options.url+"export"+e.Util.getParamString(a),b))}}),R=C.Layer.extend({options:{cellSize:512,updateInterval:150},initialize:function(a){C.setOptions(this,a);this._zooming=!1},onAdd:function(a){this._map=a;this._update=C.Util.throttle(this._update,this.options.updateInterval,this);this._reset();this._update()},onRemove:function(){this._map.removeEventListener(this.getEvents(),this);this._removeCells()},getEvents:function(){return{moveend:this._update,zoomstart:this._zoomstart,zoomend:this._reset}},addTo:function(a){a.addLayer(this);return this},removeFrom:function(a){a.removeLayer(this);return this},_zoomstart:function(){this._zooming=!0},_reset:function(){this._removeCells();this._cells={};this._activeCells={};this._cellsTotal=this._cellsToLoad=0;this._cellNumBounds=this._getCellNumBounds();this._resetWrap();this._zooming=!1},_resetWrap:function(){var a=this._map,b=a.options.crs;if(!b.infinite){var c=this._getCellSize();b.wrapLng&&(this._wrapLng=[Math.floor(a.project([0,b.wrapLng[0]]).x/c),Math.ceil(a.project([0,b.wrapLng[1]]).x/c)]);b.wrapLat&&(this._wrapLat=[Math.floor(a.project([b.wrapLat[0],0]).y/c),Math.ceil(a.project([b.wrapLat[1],0]).y/c)])}},_getCellSize:function(){return this.options.cellSize},_update:function(){if(this._map){var a=this._map.getPixelBounds(),b=this._getCellSize(),a=C.bounds(a.min.divideBy(b).floor(),a.max.divideBy(b).floor());this._removeOtherCells(a);this._addCells(a);this.fire("cellsupdated")}},_addCells:function(a){var b=[],c=a.getCenter(),d=this._map.getZoom(),f,g,l;for(f=a.min.y;f<=a.max.y;f++)for(g=a.min.x;g<=a.max.x;g++)l=C.point(g,f),l.z=d,this._isValidCell(l)&&b.push(l);a=b.length;if(0!==a)for(this._cellsToLoad+=a,this._cellsTotal+=a,b.sort(function(a,b){return a.distanceTo(c)-b.distanceTo(c)}),g=0;g<a;g++)this._addCell(b[g])},_isValidCell:function(a){var b=this._map.options.crs;if(!b.infinite){var c=this._cellNumBounds;if(!b.wrapLng&&(a.x<c.min.x||a.x>c.max.x)||!b.wrapLat&&(a.y<c.min.y||a.y>c.max.y))return!1}if(!this.options.bounds)return!0;a=this._cellCoordsToBounds(a);return C.latLngBounds(this.options.bounds).intersects(a)},_cellCoordsToBounds:function(a){var b=this._map,c=this.options.cellSize,d=a.multiplyBy(c),c=d.add([c,c]),d=b.wrapLatLng(b.unproject(d,a.z));a=b.wrapLatLng(b.unproject(c,a.z));return C.latLngBounds(d,a)},_cellCoordsToKey:function(a){return a.x+":"+a.y},_keyToCellCoords:function(a){var b=a.split(":");a=parseInt(b[0],10);b=parseInt(b[1],10);return C.point(a,b)},_removeOtherCells:function(a){for(var b in this._cells)a.contains(this._keyToCellCoords(b))||this._removeCell(b)},_removeCell:function(a){var b=this._activeCells[a];b&&(delete this._activeCells[a],this.cellLeave&&this.cellLeave(b.bounds,b.coords),this.fire("cellleave",{bounds:b.bounds,coords:b.coords}))},_removeCells:function(){for(var a in this._cells){var b=this._cells[a].bounds,c=this._cells[a].coords;this.cellLeave&&this.cellLeave(b,c);this.fire("cellleave",{bounds:b,coords:c})}},_addCell:function(a){this._wrapCoords(a);var b=this._cellCoordsToKey(a),c=this._cells[b];c&&!this._activeCells[b]&&(this.cellEnter&&this.cellEnter(c.bounds,a),this.fire("cellenter",{bounds:c.bounds,coords:a}),this._activeCells[b]=c);c||(c={coords:a,bounds:this._cellCoordsToBounds(a)},this._cells[b]=c,this._activeCells[b]=c,this.createCell&&this.createCell(c.bounds,a),this.fire("cellcreate",{bounds:c.bounds,coords:a}))},_wrapCoords:function(a){a.x=this._wrapLng?C.Util.wrapNum(a.x,this._wrapLng):a.x;a.y=this._wrapLat?C.Util.wrapNum(a.y,this._wrapLat):a.y},_getCellNumBounds:function(){var a=this._map.getPixelWorldBounds(),b=this._getCellSize();return a?C.bounds(a.min.divideBy(b).floor(),a.max.divideBy(b).ceil().subtract([1,1])):null}});E.prototype.query=function(a){a=this.getIndex(a);return this.values[a]};E.prototype.getIndex=function(a){this.dirty&&this.sort();for(var b=0,c=this.values.length-1,d,f;b<=c;)if(d=(b+c)/2|0,f=this.values[Math.round(d)],+f.value<+a)b=d+1;else if(+f.value>+a)c=d-1;else return d;return Math.abs(~c)};E.prototype.between=function(a,b){var c=this.getIndex(a),d=this.getIndex(b);if(0===c&&0===d)return[];for(;this.values[c-1]&&this.values[c-1].value===a;)c--;for(;this.values[d+1]&&this.values[d+1].value===b;)d++;this.values[d]&&this.values[d].value===b&&this.values[d+1]&&d++;return this.values.slice(c,d)};E.prototype.insert=function(a){this.values.splice(this.getIndex(a.value),0,a);return this};E.prototype.bulkAdd=function(a,b){this.values=this.values.concat([].concat(a||[]));b?this.sort():this.dirty=!0;return this};E.prototype.sort=function(){this.values.sort(function(a,b){return+b.value-+a.value}).reverse();this.dirty=!1;return this};var S=R.extend({options:{attribution:null,where:"1\x3d1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6},initialize:function(a){R.prototype.initialize.call(this,a);a.url=v(a.url);a=e.setOptions(this,a);this.service=ha(a);this.service.addEventParent(this);if("*"!==this.options.fields[0]){a=!1;for(var b=0;b<this.options.fields.length;b++)this.options.fields[b].match(/^(OBJECTID|FID|OID|ID)$/i)&&(a=!0);!1===a&&z("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new E,this._endTimeIndex=new E):this.options.timeField&&(this._timeIndex=new E);this._cache={};this._currentSnapshot=[];this._activeRequests=0},onAdd:function(a){this.service.metadata(function(b,c){if(!b){var d=c.supportedQueryFormats,f=!1;!1===this.service.options.isModern&&(f=!0);!f&&d&&-1!==d.indexOf("geoJSON")&&(this.service.options.isModern=!0);!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution()))}},this);a.on("zoomend",this._handleZoomChange,this);return R.prototype.onAdd.call(this,a)},onRemove:function(a){a.off("zoomend",this._handleZoomChange,this);return R.prototype.onRemove.call(this,a)},getAttribution:function(){return this.options.attribution},createCell:function(a,b){this._visibleZoom()&&this._requestFeatures(a,b)},_requestFeatures:function(a,b,c){this._activeRequests++;1===this._activeRequests&&this.fire("loading",{bounds:a},!0);return this._buildQuery(a).run(function(d,f,g){g&&g.exceededTransferLimit&&this.fire("drawlimitexceeded");!d&&f&&f.features.length&&e.Util.requestAnimFrame(e.Util.bind(function(){this._addFeatures(f.features,b);this._postProcessFeatures(a)},this));d||!f||f.features.length||this._postProcessFeatures(a);d&&this._postProcessFeatures(a);c&&c.call(this,d,f)},this)},_postProcessFeatures:function(a){this._activeRequests--;0>=this._activeRequests&&this.fire("load",{bounds:a})},_cacheKey:function(a){return a.z+":"+a.x+":"+a.y},_addFeatures:function(a,b){var c=this._cacheKey(b);this._cache[c]=this._cache[c]||[];for(var d=a.length-1;0<=d;d--){var f=a[d].id;-1===this._currentSnapshot.indexOf(f)&&this._currentSnapshot.push(f);-1===this._cache[c].indexOf(f)&&this._cache[c].push(f)}this.options.timeField&&this._buildTimeIndexes(a);this.createLayers(a)},_buildQuery:function(a){a=this.service.query().intersects(a).where(this.options.where).fields(this.options.fields).precision(this.options.precision);this.options.simplifyFactor&&a.simplify(this._map,this.options.simplifyFactor);"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&a.between(this.options.from,this.options.to);return a},setWhere:function(a,b,c){this.options.where=a&&a.length?a:"1\x3d1";var d=[],f=[],g=0,l=null;a=e.Util.bind(function(a,k){a&&(l=a);if(k)for(var m=k.features.length-1;0<=m;m--)f.push(k.features[m].id);g--;0>=g&&(this._currentSnapshot=f,e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(d);this.addLayers(f);b&&b.call(c,l)},this)))},this);for(var k=this._currentSnapshot.length-1;0<=k;k--)d.push(this._currentSnapshot[k]);for(var m in this._activeCells)g++,k=this._keyToCellCoords(m),k=this._cellCoordsToBounds(k),this._requestFeatures(k,m,a);return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(a,b,c,d){var f=this.options.from,g=this.options.to,l=0,k=null,m=e.Util.bind(function(e){e&&(k=e);this._filterExistingFeatures(f,g,a,b);l--;c&&0>=l&&c.call(d,k)},this);this.options.from=a;this.options.to=b;this._filterExistingFeatures(f,g,a,b);if("server"===this.options.timeFilterMode)for(var w in this._activeCells){l++;var h=this._keyToCellCoords(w),h=this._cellCoordsToBounds(h);this._requestFeatures(h,w,m)}return this},refresh:function(){for(var a in this._activeCells){var b=this._keyToCellCoords(a),b=this._cellCoordsToBounds(b);this._requestFeatures(b,a)}if(this.redraw)this.once("load",function(){this.eachFeature(function(a){this._redraw(a.feature.id)},this)},this)},_filterExistingFeatures:function(a,b,c,d){var f=a&&b?this._getFeaturesInTimeRange(a,b):this._currentSnapshot,g=this._getFeaturesInTimeRange(c,d);if(g.indexOf)for(a=0;a<g.length;a++)b=f.indexOf(g[a]),0<=b&&f.splice(b,1);e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(f);this.addLayers(g)},this))},_getFeaturesInTimeRange:function(a,b){var c=[],d;if(this.options.timeField.start&&this.options.timeField.end){d=this._startTimeIndex.between(a,b);var f=this._endTimeIndex.between(a,b);d=d.concat(f)}else d=this._timeIndex.between(a,b);for(f=d.length-1;0<=f;f--)c.push(d[f].id);return c},_buildTimeIndexes:function(a){var b,c;if(this.options.timeField.start&&this.options.timeField.end){var d=[],f=[];for(b=a.length-1;0<=b;b--)c=a[b],d.push({id:c.id,value:new Date(c.properties[this.options.timeField.start])}),f.push({id:c.id,value:new Date(c.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(d);this._endTimeIndex.bulkAdd(f)}else{d=[];for(b=a.length-1;0<=b;b--)c=a[b],d.push({id:c.id,value:new Date(c.properties[this.options.timeField])});this._timeIndex.bulkAdd(d)}},_featureWithinTimeRange:function(a){if(!this.options.from||!this.options.to)return!0;var b=+this.options.from.valueOf(),c=+this.options.to.valueOf();if("string"===typeof this.options.timeField){var d=+a.properties[this.options.timeField];return d>=b&&d<=c}if(this.options.timeField.start&&this.options.timeField.end)return d=+a.properties[this.options.timeField.start],a=+a.properties[this.options.timeField.end],d>=b&&d<=c||a>=b&&a<=c},_visibleZoom:function(){if(!this._map)return!1;var a=this._map.getZoom();return a>this.options.maxZoom||a<this.options.minZoom?!1:!0},_handleZoomChange:function(){if(this._visibleZoom())for(var a in this._activeCells){var b=this._cacheKey(this._activeCells[a].coords);this._cache[b]&&this.addLayers(this._cache[b])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(a){this.service.authenticate(a);return this},metadata:function(a,b){this.service.metadata(a,b);return this},query:function(){return this.service.query()},_getMetadata:function(a){this._metadata?a(void 0,this._metadata):this.metadata(e.Util.bind(function(b,c){this._metadata=c;a(b,this._metadata)},this))},addFeature:function(a,b,c){this._getMetadata(e.Util.bind(function(d,f){d?b&&b.call(this,d,null):this.service.addFeature(a,e.Util.bind(function(d,g){d||(a.properties[f.objectIdField]=g.objectId,a.id=g.objectId,this.createLayers([a]));b&&b.call(c,d,g)},this))},this))},updateFeature:function(a,b,c){this.service.updateFeature(a,function(d,f){d||(this.removeLayers([a.id],!0),this.createLayers([a]));b&&b.call(c,d,f)},this)},deleteFeature:function(a,b,c){this.service.deleteFeature(a,function(a,d){!a&&d.objectId&&this.removeLayers([d.objectId],!0);b&&b.call(c,a,d)},this)},deleteFeatures:function(a,b,c){return this.service.deleteFeatures(a,function(a,d){if(!a&&0<d.length)for(var f=0;f<d.length;f++)this.removeLayers([d[f].objectId],!0);b&&b.call(c,a,d)},this)}}),la=S.extend({options:{cacheLayers:!0},initialize:function(a){S.prototype.initialize.call(this,a);this._originalStyle=this.options.style;this._layers={}},onRemove:function(a){for(var b in this._layers)a.removeLayer(this._layers[b]),this.fire("removefeature",{feature:this._layers[b].feature,permanent:!1},!0);return S.prototype.onRemove.call(this,a)},createNewLayer:function(a){a=e.GeoJSON.geometryToLayer(a,this.options);a.defaultOptions=a.options;return a},_updateLayer:function(a,b){var c=[],c=this.options.coordsToLatLng||e.GeoJSON.coordsToLatLng;b.properties&&(a.feature.properties=b.properties);switch(b.geometry.type){case "Point":c=e.GeoJSON.coordsToLatLng(b.geometry.coordinates);a.setLatLng(c);break;case "LineString":c=e.GeoJSON.coordsToLatLngs(b.geometry.coordinates,0,c);a.setLatLngs(c);break;case "MultiLineString":c=e.GeoJSON.coordsToLatLngs(b.geometry.coordinates,1,c);a.setLatLngs(c);break;case "Polygon":c=e.GeoJSON.coordsToLatLngs(b.geometry.coordinates,1,c);a.setLatLngs(c);break;case "MultiPolygon":c=e.GeoJSON.coordsToLatLngs(b.geometry.coordinates,2,c),a.setLatLngs(c)}},createLayers:function(a){for(var b=a.length-1;0<=b;b--){var c=a[b],d=this._layers[c.id];this._visibleZoom()&&d&&!this._map.hasLayer(d)&&(this._map.addLayer(d),this.fire("addfeature",{feature:d.feature},!0));d&&0<this.options.simplifyFactor&&(d.setLatLngs||d.setLatLng)&&this._updateLayer(d,c);if(!d){d=this.createNewLayer(c);d.feature=c;d.addEventParent(this);if(this.options.onEachFeature)this.options.onEachFeature(d.feature,d);this._layers[d.feature.id]=d;this.setFeatureStyle(d.feature.id,this.options.style);this.fire("createfeature",{feature:d.feature},!0);this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(c))&&this._map.addLayer(d)}}},addLayers:function(a){for(var b=a.length-1;0<=b;b--){var c=this._layers[a[b]];c&&this._map.addLayer(c)}},removeLayers:function(a,b){for(var c=a.length-1;0<=c;c--){var d=a[c],f=this._layers[d];f&&(this.fire("removefeature",{feature:f.feature,permanent:b},!0),this._map.removeLayer(f));f&&b&&delete this._layers[d]}},cellEnter:function(a,b){this._visibleZoom()&&!this._zooming&&this._map&&e.Util.requestAnimFrame(e.Util.bind(function(){var a=this._cacheKey(b),c=this._cellCoordsToKey(b),a=this._cache[a];this._activeCells[c]&&a&&this.addLayers(a)},this))},cellLeave:function(a,b){this._zooming||e.Util.requestAnimFrame(e.Util.bind(function(){if(this._map){var a=this._cacheKey(b),c=this._cellCoordsToKey(b),d=this._cache[a],f=this._map.getBounds();if(!this._activeCells[c]&&d){for(var g=!0,l=0;l<d.length;l++){var k=this._layers[d[l]];k&&k.getBounds&&f.intersects(k.getBounds())&&(g=!1)}g&&this.removeLayers(d,!this.options.cacheLayers);!this.options.cacheLayers&&g&&(delete this._cache[a],delete this._cells[c],delete this._activeCells[c])}}},this))},resetStyle:function(){this.options.style=this._originalStyle;this.eachFeature(function(a){this.resetFeatureStyle(a.feature.id)},this);return this},setStyle:function(a){this.options.style=a;this.eachFeature(function(b){this.setFeatureStyle(b.feature.id,a)},this);return this},resetFeatureStyle:function(a){var b=this._layers[a],c=this._originalStyle||L.Path.prototype.options;b&&(e.Util.extend(b.options,b.defaultOptions),this.setFeatureStyle(a,c));return this},setFeatureStyle:function(a,b){var c=this._layers[a];"function"===typeof b&&(b=b(c.feature));c.setStyle&&c.setStyle(b);return this},eachActiveFeature:function(a,b){if(this._map){var c=this._map.getBounds(),d;for(d in this._layers)c.intersects(this._layers[d].getBounds())&&-1!==this._currentSnapshot.indexOf(this._layers[d].feature.id)&&a.call(b,this._layers[d])}return this},eachFeature:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getFeature:function(a){return this._layers[a]},bringToBack:function(){this.eachFeature(function(a){a.bringToBack&&a.bringToBack()})},bringToFront:function(){this.eachFeature(function(a){a.bringToFront&&a.bringToFront()})},redraw:function(a){a&&this._redraw(a);return this},_redraw:function(a){a=this._layers[a];var b=a.feature;if(a&&a.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var c=this.options.pointToLayer(b,e.latLng(b.geometry.coordinates[1],b.geometry.coordinates[0])).options.icon;a.setIcon(c)}a&&a.setStyle&&this.options.pointToLayer&&(c=this.options.pointToLayer(b,e.latLng(b.geometry.coordinates[1],b.geometry.coordinates[0])).options,this.setFeatureStyle(b.id,c));a&&a.setStyle&&this.options.style&&this.resetStyle(b.id)}});n.VERSION="2.0.8";n.Support=H;n.options=X;n.Util=ma;n.get=N;n.post=c;n.request=a;n.Task=J;n.task=function(a){return new J(a)};n.Query=Y;n.query=M;n.Find=Z;n.find=V;n.Identify=P;n.identify=function(a){return new P(a)};n.IdentifyFeatures=ba;n.identifyFeatures=aa;n.IdentifyImage=da;n.identifyImage=ca;n.Service=K;n.service=function(a){return new K(a)};n.MapService=ea;n.mapService=T;n.ImageService=ga;n.imageService=fa;n.FeatureLayerService=ia;n.featureLayerService=ha;n.BasemapLayer=Q;n.basemapLayer=function(a,b){return new Q(a,b)};n.TiledMapLayer=U;n.tiledMapLayer=function(a,b){return new U(a,b)};n.RasterLayer=F;n.ImageMapLayer=ja;n.imageMapLayer=function(a,b){return new ja(a,b)};n.DynamicMapLayer=ka;n.dynamicMapLayer=function(a,b){return new ka(a,b)};n.FeatureManager=S;n.FeatureLayer=la;n.featureLayer=function(a){return new la(a)}});(function(n){"object"===typeof exports&&"undefined"!==typeof module?module.exports=n():"function"===typeof define&&define.amd?define([],n):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).proj4=n()})(function(){return function e(h,b,c){function d(g,f){if(!b[g]){if(!h[g]){var l="function"==typeof require&&require;if(!f&&l)return l(g,!0);if(a)return a(g,!0);l=Error("Cannot find module '"+g+"'");throw l.code="MODULE_NOT_FOUND",l;}l=b[g]={exports:{}};h[g][0].call(l.exports,function(a){var b=h[g][1][a];return d(b?b:a)},l,l.exports,e,h,b,c)}return b[g].exports}for(var a="function"==typeof require&&require,k=0;k<c.length;k++)d(c[k]);return d}({"./includedProjections":[function(e,h,b){var c=[e("./lib/projections/tmerc"),e("./lib/projections/utm"),e("./lib/projections/sterea"),e("./lib/projections/stere"),e("./lib/projections/somerc"),e("./lib/projections/omerc"),e("./lib/projections/lcc"),e("./lib/projections/krovak"),e("./lib/projections/cass"),e("./lib/projections/laea"),e("./lib/projections/aea"),e("./lib/projections/gnom"),e("./lib/projections/cea"),e("./lib/projections/eqc"),e("./lib/projections/poly"),e("./lib/projections/nzmg"),e("./lib/projections/mill"),e("./lib/projections/sinu"),e("./lib/projections/moll"),e("./lib/projections/eqdc"),e("./lib/projections/vandg"),e("./lib/projections/aeqd"),e("./lib/projections/ortho")];h.exports=function(b){c.forEach(function(a){b.Proj.projections.add(a)})}},{"./lib/projections/aea":42,"./lib/projections/aeqd":43,"./lib/projections/cass":44,"./lib/projections/cea":45,"./lib/projections/eqc":46,"./lib/projections/eqdc":47,"./lib/projections/gnom":49,"./lib/projections/krovak":50,"./lib/projections/laea":51,"./lib/projections/lcc":52,"./lib/projections/mill":55,"./lib/projections/moll":56,"./lib/projections/nzmg":57,"./lib/projections/omerc":58,"./lib/projections/ortho":59,"./lib/projections/poly":60,"./lib/projections/sinu":61,"./lib/projections/somerc":62,"./lib/projections/stere":63,"./lib/projections/sterea":64,"./lib/projections/tmerc":65,"./lib/projections/utm":66,"./lib/projections/vandg":67}],"./lib/version":[function(e,h,b){h.exports="2.3.17"},{}],1:[function(e,h,b){function c(a,b,d){if(!(this instanceof c))return new c(a,b,d);Array.isArray(a)?(this.x=a[0],this.y=a[1],this.z=a[2]||0):"object"===typeof a?(this.x=a.x,this.y=a.y,this.z=a.z||0):"string"===typeof a&&"undefined"===typeof b?(a=a.split(","),this.x=parseFloat(a[0],10),this.y=parseFloat(a[1],10),this.z=parseFloat(a[2],10)||0):(this.x=a,this.y=b,this.z=d||0);console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var d=e("mgrs");c.fromMGRS=function(a){return new c(d.toPoint(a))};c.prototype.toMGRS=function(a){return d.forward([this.x,this.y],a)};h.exports=c},{mgrs:70}],2:[function(e,h,b){function c(b,e){if(!(this instanceof c))return new c(b);e=e||function(a){if(a)throw a;};var m=d(b);if("object"!==typeof m)e(b);else{var h=c.projections.get(m.projName);if(h){if(m.datumCode&&"none"!==m.datumCode){var p=g[m.datumCode];p&&(m.datum_params=p.towgs84?p.towgs84.split(","):null,m.ellps=p.ellipse,m.datumName=p.datumName?p.datumName:m.datumCode)}m.k0=m.k0||1;m.axis=m.axis||"enu";var p=k.sphere(m.a,m.b,m.rf,m.ellps,m.sphere),r=k.eccentricity(p.a,p.b,p.rf,m.R_A),t=m.datum||f(m.datumCode,m.datum_params,p.a,p.b,r.es,r.ep2);a(this,m);a(this,h);this.a=p.a;this.b=p.b;this.rf=p.rf;this.sphere=p.sphere;this.es=r.es;this.e=r.e;this.ep2=r.ep2;this.datum=t;this.init();e(null,this)}else e(b)}}var d=e("./parseCode"),a=e("./extend");b=e("./projections");var k=e("./deriveConstants"),g=e("./constants/Datum"),f=e("./datum");c.projections=b;c.projections.start();h.exports=c},{"./constants/Datum":26,"./datum":31,"./deriveConstants":35,"./extend":36,"./parseCode":39,"./projections":41}],3:[function(e,h,b){h.exports=function(b,d,a){var k=a.x,g=a.y,f=a.z||0,l,e,m,h={};for(m=0;3>m;m++)if(!d||2!==m||void 0!==a.z)switch(0===m?(l=k,e="x"):1===m?(l=g,e="y"):(l=f,e="z"),b.axis[m]){case "e":h[e]=l;break;case "w":h[e]=-l;break;case "n":h[e]=l;break;case "s":h[e]=-l;break;case "u":void 0!==a[e]&&(h.z=l);break;case "d":void 0!==a[e]&&(h.z=-l);break;default:return null}return h}},{}],4:[function(e,h,b){var c=Math.PI/2,d=e("./sign");h.exports=function(a){return Math.abs(a)<c?a:a-d(a)*Math.PI}},{"./sign":22}],5:[function(e,h,b){var c=2*Math.PI,d=e("./sign");h.exports=function(a){return 3.14159265359>=Math.abs(a)?a:a-d(a)*c}},{"./sign":22}],6:[function(e,h,b){var c=e("./adjust_lon");h.exports=function(b,a){if(void 0===b)return b=Math.floor(30*(c(a)+Math.PI)/Math.PI),0>b?0:60<=b?59:b;if(0<b&&60>=b)return b-1}},{"./adjust_lon":5}],7:[function(e,h,b){h.exports=function(b){1<Math.abs(b)&&(b=1<b?1:-1);return Math.asin(b)}},{}],8:[function(e,h,b){h.exports=function(b){return 1-.25*b*(1+b/16*(3+1.25*b))}},{}],9:[function(e,h,b){h.exports=function(b){return.375*b*(1+.25*b*(1+.46875*b))}},{}],10:[function(e,h,b){h.exports=function(b){return.05859375*b*b*(1+.75*b)}},{}],11:[function(e,h,b){h.exports=function(b){return 35/3072*b*b*b}},{}],12:[function(e,h,b){h.exports=function(b,d,a){d*=a;return b/Math.sqrt(1-d*d)}},{}],13:[function(e,h,b){h.exports=function(b,d,a,k,g){var f,l;f=b/d;for(var e=0;15>e;e++)if(l=(b-(d*f-a*Math.sin(2*f)+k*Math.sin(4*f)-g*Math.sin(6*f)))/(d-2*a*Math.cos(2*f)+4*k*Math.cos(4*f)-6*g*Math.cos(6*f)),f+=l,1E-10>=Math.abs(l))return f;return NaN}},{}],14:[function(e,h,b){var c=Math.PI/2;h.exports=function(b,a){if(1E-6>Math.abs(Math.abs(a)-(1-(1-b*b)/(2*b)*Math.log((1-b)/(1+b)))))return 0>a?-1*c:c;for(var k=Math.asin(.5*a),g,f,l,e=0;30>e;e++)if(g=Math.sin(k),f=Math.cos(k),l=b*g,g=Math.pow(1-l*l,2)/(2*f)*(a/(1-b*b)-g/(1-l*l)+.5/b*Math.log((1-l)/(1+l))),k+=g,1E-10>=Math.abs(g))return k;return NaN}},{}],15:[function(e,h,b){h.exports=function(b,d,a,k,g){return b*g-d*Math.sin(2*g)+a*Math.sin(4*g)-k*Math.sin(6*g)}},{}],16:[function(e,h,b){h.exports=function(b,d,a){b*=d;return a/Math.sqrt(1-b*b)}},{}],17:[function(e,h,b){var c=Math.PI/2;h.exports=function(b,a){for(var k=.5*b,g,f=c-2*Math.atan(a),l=0;15>=l;l++)if(g=b*Math.sin(f),g=c-2*Math.atan(a*Math.pow((1-g)/(1+g),k))-f,f+=g,1E-10>=Math.abs(g))return f;return-9999}},{}],18:[function(e,h,b){h.exports=function(b){var d=[];d[0]=1-b*(.25+b*(.046875+b*(.01953125+.01068115234375*b)));d[1]=b*(.75-b*(.046875+b*(.01953125+.01068115234375*b)));var a=b*b;d[2]=a*(.46875-b*(.013020833333333334+.007120768229166667*b));a*=b;d[3]=a*(.3645833333333333-.005696614583333333*b);d[4]=a*b*.3076171875;return d}},{}],19:[function(e,h,b){var c=e("./pj_mlfn");h.exports=function(b,a,k){for(var g=1/(1-a),f=b,l=20;l;--l){var e=Math.sin(f),m=1-a*e*e,m=(c(f,e,Math.cos(f),k)-b)*m*Math.sqrt(m)*g,f=f-m;if(1E-10>Math.abs(m))break}return f}},{"./pj_mlfn":20}],20:[function(e,h,b){h.exports=function(b,d,a,k){a*=d;d*=d;return k[0]*b-a*(k[1]+d*(k[2]+d*(k[3]+d*k[4])))}},{}],21:[function(e,h,b){h.exports=function(b,d){var a;return 1E-7<b?(a=b*d,(1-b*b)*(d/(1-a*a)-.5/b*Math.log((1-a)/(1+a)))):2*d}},{}],22:[function(e,h,b){h.exports=function(b){return 0>b?-1:1}},{}],23:[function(e,h,b){h.exports=function(b,d){return Math.pow((1-b)/(1+b),d)}},{}],24:[function(e,h,b){h.exports=function(b){var d={x:b[0],y:b[1]};2<b.length&&(d.z=b[2]);3<b.length&&(d.m=b[3]);return d}},{}],25:[function(e,h,b){var c=Math.PI/2;h.exports=function(b,a,k){k*=b;k=Math.pow((1-k)/(1+k),.5*b);return Math.tan(.5*(c-a))/k}},{}],26:[function(e,h,b){b.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};b.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};b.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};b.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};b.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};b.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};b.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};b.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"};b.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};b.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};b.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};b.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};b.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};b.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};b.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};b.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],27:[function(e,h,b){b.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};b.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};b.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};b.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};b.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"};b.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};b.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};b.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"};b.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};b.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl \x26 S. Amer. 1969"};b.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};b.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"};b.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};b.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"};b.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."};b.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"};b.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};b.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};b.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"};b.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"};b.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"};b.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"};b.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"};b.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah \x26 Sarawak)"};b.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};b.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};b.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};b.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};b.hough={a:6378270,rf:297,ellipseName:"Hough"};b.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};b.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};b.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};b.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};b.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"};b.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};b.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};b.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"};b.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"};b.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};b.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};b.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};b.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};b.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r\x3d6370997)"}},{}],28:[function(e,h,b){b.greenwich=0;b.lisbon=-9.131906111111;b.paris=2.337229166667;b.bogota=-74.080916666667;b.madrid=-3.687938888889;b.rome=12.452333333333;b.bern=7.439583333333;b.jakarta=106.807719444444;b.ferro=-17.666666666667;b.brussels=4.367975;b.stockholm=18.058277777778;b.athens=23.7163375;b.oslo=10.722916666667},{}],29:[function(e,h,b){b.ft={to_meter:.3048};b["us-ft"]={to_meter:1200/3937}},{}],30:[function(e,h,b){function c(a,b,c){return Array.isArray(c)?(a=k(a,b,c),3===c.length?[a.x,a.y,a.z]:[a.x,a.y]):k(a,b,c)}function d(b){return b instanceof a?b:b.oProj?b.oProj:a(b)}var a=e("./Proj"),k=e("./transform"),g=a("WGS84");h.exports=function(a,b,k){a=d(a);var e=!1;if("undefined"===typeof b)b=a,a=g,e=!0;else if("undefined"!==typeof b.x||Array.isArray(b))k=b,b=a,a=g,e=!0;b=d(b);if(k)return c(a,b,k);k={forward:function(d){return c(a,b,d)},inverse:function(d){return c(b,a,d)}};e&&(k.oProj=b);return k}},{"./Proj":2,"./transform":68}],31:[function(e,h,b){h.exports=function(b,d,a,k,g,f){var l={datum_type:4};b&&"none"===b&&(l.datum_type=5);if(d){l.datum_params=d.map(parseFloat);if(0!==l.datum_params[0]||0!==l.datum_params[1]||0!==l.datum_params[2])l.datum_type=1;3<l.datum_params.length&&(0!==l.datum_params[3]||0!==l.datum_params[4]||0!==l.datum_params[5]||0!==l.datum_params[6])&&(l.datum_type=2,l.datum_params[3]*=4.84813681109536E-6,l.datum_params[4]*=4.84813681109536E-6,l.datum_params[5]*=4.84813681109536E-6,l.datum_params[6]=l.datum_params[6]/1E6+1)}l.a=a;l.b=k;l.es=g;l.ep2=f;return l}},{}],32:[function(e,h,b){var c=Math.PI/2;b.compareDatums=function(b,a){return b.datum_type!==a.datum_type?!1:b.a!==a.a||5E-11<Math.abs(this.es-a.es)?!1:1===b.datum_type?this.datum_params[0]===a.datum_params[0]&&b.datum_params[1]===a.datum_params[1]&&b.datum_params[2]===a.datum_params[2]:2===b.datum_type?b.datum_params[0]===a.datum_params[0]&&b.datum_params[1]===a.datum_params[1]&&b.datum_params[2]===a.datum_params[2]&&b.datum_params[3]===a.datum_params[3]&&b.datum_params[4]===a.datum_params[4]&&b.datum_params[5]===a.datum_params[5]&&b.datum_params[6]===a.datum_params[6]:!0};b.geodeticToGeocentric=function(b,a,k){var g=b.x,f=b.y;b=b.z?b.z:0;var l;if(f<-c&&f>-1.001*c)f=-c;else if(f>c&&f<1.001*c)f=c;else if(f<-c||f>c)return null;g>Math.PI&&(g-=2*Math.PI);l=Math.sin(f);f=Math.cos(f);k/=Math.sqrt(1-a*l*l);return{x:(k+b)*f*Math.cos(g),y:(k+b)*f*Math.sin(g),z:(k*(1-a)+b)*l}};b.geocentricToGeodetic=function(b,a,c,g){var f,l,e,m,h,p,r,t=b.x;m=b.y;var u=b.z?b.z:0,v;g=Math.sqrt(t*t+m*m);f=Math.sqrt(t*t+m*m+u*u);if(1E-12>g/c){if(t=0,1E-12>f/c)return{x:b.x,y:b.y,z:b.z}}else t=Math.atan2(m,t);b=u/f;f=g/f;l=1/Math.sqrt(1-a*(2-a)*f*f);m=f*(1-a)*l;h=b*l;r=0;do r++,e=c/Math.sqrt(1-a*h*h),v=g*m+u*h-e*(1-a*h*h),e=a*e/(e+v),l=1/Math.sqrt(1-e*(2-e)*f*f),e=f*(1-e)*l,l*=b,p=l*m-e*h,m=e,h=l;while(1E-24<p*p&&30>r);return{x:t,y:Math.atan(l/Math.abs(e)),z:v}};b.geocentricToWgs84=function(b,a,c){if(1===a)return{x:b.x+c[0],y:b.y+c[1],z:b.z+c[2]};if(2===a){a=c[3];var g=c[4],f=c[5],l=c[6];return{x:l*(b.x-f*b.y+g*b.z)+c[0],y:l*(f*b.x+b.y-a*b.z)+c[1],z:l*(-g*b.x+a*b.y+b.z)+c[2]}}};b.geocentricFromWgs84=function(b,a,c){if(1===a)return{x:b.x-c[0],y:b.y-c[1],z:b.z-c[2]};if(2===a){a=c[3];var g=c[4],f=c[5],l=c[6],e=(b.x-c[0])/l,m=(b.y-c[1])/l;b=(b.z-c[2])/l;return{x:e+f*m-g*b,y:-f*e+m+a*b,z:g*e-a*m+b}}}},{}],33:[function(e,h,b){function c(a){return 1===a||2===a}var d=e("./datumUtils");h.exports=function(a,b,g){if(d.compareDatums(a,b)||5===a.datum_type||5===b.datum_type||a.es===b.es&&a.a===b.a&&!c(a.datum_type)&&!c(b.datum_type))return g;g=d.geodeticToGeocentric(g,a.es,a.a);c(a.datum_type)&&(g=d.geocentricToWgs84(g,a.datum_type,a.datum_params));c(b.datum_type)&&(g=d.geocentricFromWgs84(g,b.datum_type,b.datum_params));return d.geocentricToGeodetic(g,b.es,b.a,b.b)}},{"./datumUtils":32}],34:[function(e,h,b){function c(b){var g=this;if(2===arguments.length){var f=arguments[1];"string"===typeof f?"+"===f.charAt(0)?c[b]=d(arguments[1]):c[b]=a(arguments[1]):c[b]=f}else if(1===arguments.length){if(Array.isArray(b))return b.map(function(a){Array.isArray(a)?c.apply(g,a):c(a)});if("string"===typeof b){if(b in c)return c[b]}else"EPSG"in b?c["EPSG:"+b.EPSG]=b:"ESRI"in b?c["ESRI:"+b.ESRI]=b:"IAU2000"in b?c["IAU2000:"+b.IAU2000]=b:console.log(b)}}b=e("./global");var d=e("./projString"),a=e("./wkt");b(c);h.exports=c},{"./global":37,"./projString":40,"./wkt":69}],35:[function(e,h,b){var c=e("./constants/Ellipsoid");b.eccentricity=function(b,a,c,g){c=b*b;a*=a;var f=(c-a)/c,l=0;g?(b*=1-f*(.16666666666666666+f*(.04722222222222222+.022156084656084655*f)),c=b*b,f=0):l=Math.sqrt(f);return{es:f,e:l,ep2:(c-a)/a}};b.sphere=function(b,a,e,g,f){b||(e=c[g],e||(e=c.WGS84),b=e.a,a=e.b,e=e.rf);e&&!a&&(a=(1-1/e)*b);if(0===e||1E-10>Math.abs(b-a))f=!0,a=b;return{a:b,b:a,rf:e,sphere:f}}},{"./constants/Ellipsoid":27}],36:[function(e,h,b){h.exports=function(b,d){b=b||{};var a,e;if(!d)return b;for(e in d)a=d[e],void 0!==a&&(b[e]=a);return b}},{}],37:[function(e,h,b){h.exports=function(b){b("EPSG:4326","+title\x3dWGS 84 (long/lat) +proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +units\x3ddegrees");b("EPSG:4269","+title\x3dNAD83 (long/lat) +proj\x3dlonglat +a\x3d6378137.0 +b\x3d6356752.31414036 +ellps\x3dGRS80 +datum\x3dNAD83 +units\x3ddegrees");b("EPSG:3857","+title\x3dWGS 84 / Pseudo-Mercator +proj\x3dmerc +a\x3d6378137 +b\x3d6378137 +lat_ts\x3d0.0 +lon_0\x3d0.0 +x_0\x3d0.0 +y_0\x3d0 +k\x3d1.0 +units\x3dm +nadgrids\x3d@null +no_defs");b.WGS84=b["EPSG:4326"];b["EPSG:3785"]=b["EPSG:3857"];b.GOOGLE=b["EPSG:3857"];b["EPSG:900913"]=b["EPSG:3857"];b["EPSG:102113"]=b["EPSG:3857"]}},{}],38:[function(e,h,b){b=e("./core");b.defaultDatum="WGS84";b.Proj=e("./Proj");b.WGS84=new b.Proj("WGS84");b.Point=e("./Point");b.toPoint=e("./common/toPoint");b.defs=e("./defs");b.transform=e("./transform");b.mgrs=e("mgrs");b.version=e("./version");e("./includedProjections")(b);h.exports=b},{"./Point":1,"./Proj":2,"./common/toPoint":24,"./core":30,"./defs":34,"./includedProjections":"./includedProjections","./transform":68,"./version":"./lib/version",mgrs:70}],39:[function(e,h,b){function c(a){return g.some(function(b){return-1<a.indexOf(b)})}var d=e("./defs"),a=e("./wkt"),k=e("./projString"),g=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];h.exports=function(b){if("string"===typeof b){if(b in d)return d[b];if(c(b))return a(b);if("+"===b[0])return k(b)}else return b}},{"./defs":34,"./projString":40,"./wkt":69}],40:[function(e,h,b){var c=e("./constants/PrimeMeridian"),d=e("./constants/units");h.exports=function(a){var b={};a=a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,b){var c=b.split("\x3d");c.push(!0);a[c[0].toLowerCase()]=c[1];return a},{});var g,f,l,e={proj:"projName",datum:"datumCode",rf:function(a){b.rf=parseFloat(a)},lat_0:function(a){b.lat0=.017453292519943295*a},lat_1:function(a){b.lat1=.017453292519943295*a},lat_2:function(a){b.lat2=.017453292519943295*a},lat_ts:function(a){b.lat_ts=.017453292519943295*a},lon_0:function(a){b.long0=.017453292519943295*a},lon_1:function(a){b.long1=.017453292519943295*a},lon_2:function(a){b.long2=.017453292519943295*a},alpha:function(a){b.alpha=.017453292519943295*parseFloat(a)},lonc:function(a){b.longc=.017453292519943295*a},x_0:function(a){b.x0=parseFloat(a)},y_0:function(a){b.y0=parseFloat(a)},k_0:function(a){b.k0=parseFloat(a)},k:function(a){b.k0=parseFloat(a)},a:function(a){b.a=parseFloat(a)},b:function(a){b.b=parseFloat(a)},r_a:function(){b.R_A=!0},zone:function(a){b.zone=parseInt(a,10)},south:function(){b.utmSouth=!0},towgs84:function(a){b.datum_params=a.split(",").map(function(a){return parseFloat(a)})},to_meter:function(a){b.to_meter=parseFloat(a)},units:function(a){b.units=a;d[a]&&(b.to_meter=d[a].to_meter)},from_greenwich:function(a){b.from_greenwich=.017453292519943295*a},pm:function(a){b.from_greenwich=.017453292519943295*(c[a]?c[a]:parseFloat(a))},nadgrids:function(a){"@null"===a?b.datumCode="none":b.nadgrids=a},axis:function(a){3===a.length&&-1!=="ewnsud".indexOf(a.substr(0,1))&&-1!=="ewnsud".indexOf(a.substr(1,1))&&-1!=="ewnsud".indexOf(a.substr(2,1))&&(b.axis=a)}};for(g in a)f=a[g],g in e?(l=e[g],"function"===typeof l?l(f):b[l]=f):b[g]=f;"string"===typeof b.datumCode&&"WGS84"!==b.datumCode&&(b.datumCode=b.datumCode.toLowerCase());return b}},{"./constants/PrimeMeridian":28,"./constants/units":29}],41:[function(e,h,b){function c(b,c){var d=k.length;if(!b.names)return console.log(c),!0;k[d]=b;b.names.forEach(function(b){a[b.toLowerCase()]=d});return this}var d=[e("./projections/merc"),e("./projections/longlat")],a={},k=[];b.add=c;b.get=function(b){if(!b)return!1;b=b.toLowerCase();if("undefined"!==typeof a[b]&&k[a[b]])return k[a[b]]};b.start=function(){d.forEach(c)}},{"./projections/longlat":53,"./projections/merc":54}],42:[function(e,h,b){var c=e("../common/msfnz"),d=e("../common/qsfnz"),a=e("../common/adjust_lon"),k=e("../common/asinz");b.init=function(){1E-10>Math.abs(this.lat1+this.lat2)||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.con=this.t1=this.sin_po,this.ms1=c(this.e3,this.sin_po,this.cos_po),this.qs1=d(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=c(this.e3,this.sin_po,this.cos_po),this.qs2=d(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=d(this.e3,this.sin_po,this.cos_po),this.ns0=1E-10<Math.abs(this.lat1-this.lat2)?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)};b.forward=function(b){var c=b.x,l=b.y;this.sin_phi=Math.sin(l);this.cos_phi=Math.cos(l);var l=d(this.e3,this.sin_phi,this.cos_phi),l=this.a*Math.sqrt(this.c-this.ns0*l)/this.ns0,c=this.ns0*a(c-this.long0),e=this.rh-l*Math.cos(c)+this.y0;b.x=l*Math.sin(c)+this.x0;b.y=e;return b};b.inverse=function(b){var c,d,e;b.x-=this.x0;b.y=this.rh-b.y+this.y0;0<=this.ns0?(c=Math.sqrt(b.x*b.x+b.y*b.y),d=1):(c=-Math.sqrt(b.x*b.x+b.y*b.y),d=-1);e=0;0!==c&&(e=Math.atan2(d*b.x,d*b.y));d=c*this.ns0/this.a;this.sphere?c=Math.asin((this.c-d*d)/(2*this.ns0)):(c=(this.c-d*d)/this.ns0,c=this.phi1z(this.e3,c));e=a(e/this.ns0+this.long0);b.x=e;b.y=c;return b};b.phi1z=function(a,b){var c,d,e,h,p=k(.5*b);if(1E-10>a)return p;for(var r=a*a,t=1;25>=t;t++)if(c=Math.sin(p),d=Math.cos(p),e=a*c,h=1-e*e,c=.5*h*h/d*(b/(1-r)-c/h+.5/a*Math.log((1-e)/(1+e))),p+=c,1E-7>=Math.abs(c))return p;return null};b.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":7,"../common/msfnz":16,"../common/qsfnz":21}],43:[function(e,h,b){var c=e("../common/adjust_lon"),d=Math.PI/2,a=e("../common/mlfn"),k=e("../common/e0fn"),g=e("../common/e1fn"),f=e("../common/e2fn"),l=e("../common/e3fn"),w=e("../common/gN"),m=e("../common/asinz"),q=e("../common/imlfn");b.init=function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)};b.forward=function(b){var e=b.y,m=Math.sin(b.y),h=Math.cos(b.y),q=c(b.x-this.long0),x,y,z,B,D;this.sphere?1E-10>=Math.abs(this.sin_p12-1)?(b.x=this.x0+this.a*(d-e)*Math.sin(q),b.y=this.y0-this.a*(d-e)*Math.cos(q)):1E-10>=Math.abs(this.sin_p12+1)?(b.x=this.x0+this.a*(d+e)*Math.sin(q),b.y=this.y0+this.a*(d+e)*Math.cos(q)):(e=this.sin_p12*m+this.cos_p12*h*Math.cos(q),e=Math.acos(e),e/=Math.sin(e),b.x=this.x0+this.a*e*h*Math.sin(q),b.y=this.y0+this.a*e*(this.cos_p12*m-this.sin_p12*h*Math.cos(q))):(x=k(this.es),y=g(this.es),z=f(this.es),B=l(this.es),1E-10>=Math.abs(this.sin_p12-1)?(h=this.a*a(x,y,z,B,d),e=this.a*a(x,y,z,B,e),b.x=this.x0+(h-e)*Math.sin(q),b.y=this.y0-(h-e)*Math.cos(q)):1E-10>=Math.abs(this.sin_p12+1)?(h=this.a*a(x,y,z,B,d),e=this.a*a(x,y,z,B,e),b.x=this.x0+(h+e)*Math.sin(q),b.y=this.y0+(h+e)*Math.cos(q)):(x=m/h,e=w(this.a,this.e,this.sin_p12),m=w(this.a,this.e,m),m=Math.atan((1-this.es)*x+this.es*e*this.sin_p12/(m*h)),h=Math.atan2(Math.sin(q),this.cos_p12*Math.tan(m)-this.sin_p12*Math.cos(q)),x=0===h?Math.asin(this.cos_p12*Math.sin(m)-this.sin_p12*Math.cos(m)):1E-10>=Math.abs(Math.abs(h)-Math.PI)?-Math.asin(this.cos_p12*Math.sin(m)-this.sin_p12*Math.cos(m)):Math.asin(Math.sin(q)*Math.cos(m)/Math.sin(h)),q=this.e*this.sin_p12/Math.sqrt(1-this.es),y=this.e*this.cos_p12*Math.cos(h)/Math.sqrt(1-this.es),m=q*y,y*=y,z=x*x,B=z*x,D=B*x,e=e*x*(1-z*y*(1-y)/6+B/8*m*(1-2*y)+D/120*(y*(4-7*y)-3*q*q*(1-7*y))-D*x/48*m),b.x=this.x0+e*Math.sin(h),b.y=this.y0+e*Math.cos(h)));return b};b.inverse=function(b){b.x-=this.x0;b.y-=this.y0;var e,h,u,v,x,y;if(this.sphere){if(e=Math.sqrt(b.x*b.x+b.y*b.y),!(e>2*d*this.a))return h=e/this.a,u=Math.sin(h),v=Math.cos(h),h=this.long0,1E-10>=Math.abs(e)?x=this.lat0:(x=m(v*this.sin_p12+b.y*u*this.cos_p12/e),h=Math.abs(this.lat0)-d,h=1E-10>=Math.abs(h)?0<=this.lat0?c(this.long0+Math.atan2(b.x,-b.y)):c(this.long0-Math.atan2(-b.x,b.y)):c(this.long0+Math.atan2(b.x*u,e*this.cos_p12*v-b.y*this.sin_p12*u))),b.x=h,b.y=x,b}else return u=k(this.es),h=g(this.es),v=f(this.es),x=l(this.es),1E-10>=Math.abs(this.sin_p12-1)?(y=this.a*a(u,h,v,x,d),e=Math.sqrt(b.x*b.x+b.y*b.y),x=q((y-e)/this.a,u,h,v,x),h=c(this.long0+Math.atan2(b.x,-1*b.y))):1E-10>=Math.abs(this.sin_p12+1)?(y=this.a*a(u,h,v,x,d),e=Math.sqrt(b.x*b.x+b.y*b.y),x=q((e-y)/this.a,u,h,v,x),h=c(this.long0+Math.atan2(b.x,b.y))):(e=Math.sqrt(b.x*b.x+b.y*b.y),u=Math.atan2(b.x,b.y),x=w(this.a,this.e,this.sin_p12),h=Math.cos(u),v=this.e*this.cos_p12*h,v=-v*v/(1-this.es),y=3*this.es*(1-v)*this.sin_p12*this.cos_p12*h/(1-this.es),x=e/x,e=x-v*(1+v)*Math.pow(x,3)/6-y*(1+3*v)*Math.pow(x,4)/24,v=1-v*e*e/2-x*e*e*e/6,x=Math.asin(this.sin_p12*Math.cos(e)+this.cos_p12*Math.sin(e)*h),h=c(this.long0+Math.asin(Math.sin(u)*Math.sin(e)/Math.cos(x))),x=Math.atan((1-this.es*v*this.sin_p12/Math.sin(x))*Math.tan(x)/(1-this.es))),b.x=h,b.y=x,b};b.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":7,"../common/e0fn":8,"../common/e1fn":9,"../common/e2fn":10,"../common/e3fn":11,"../common/gN":12,"../common/imlfn":13,"../common/mlfn":15}],44:[function(e,h,b){var c=e("../common/mlfn"),d=e("../common/e0fn"),a=e("../common/e1fn"),k=e("../common/e2fn"),g=e("../common/e3fn"),f=e("../common/gN"),l=e("../common/adjust_lon"),w=e("../common/adjust_lat"),m=e("../common/imlfn"),q=Math.PI/2;b.init=function(){this.sphere||(this.e0=d(this.es),this.e1=a(this.es),this.e2=k(this.es),this.e3=g(this.es),this.ml0=this.a*c(this.e0,this.e1,this.e2,this.e3,this.lat0))};b.forward=function(a){var b,d,g=a.x,e=a.y,g=l(g-this.long0);if(this.sphere)b=this.a*Math.asin(Math.cos(e)*Math.sin(g)),d=this.a*(Math.atan2(Math.tan(e),Math.cos(g))-this.lat0);else{d=Math.sin(e);var k=Math.cos(e),m=f(this.a,this.e,d),h=Math.tan(e)*Math.tan(e);b=g*Math.cos(e);var g=b*b,w=this.es*k*k/(1-this.es),e=this.a*c(this.e0,this.e1,this.e2,this.e3,e);b=m*b*(1-g*h*(1/6-(8-h+8*w)*g/120));d=e-this.ml0+m*d/k*g*(.5+(5-h+6*w)*g/24)}a.x=b+this.x0;a.y=d+this.y0;return a};b.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b=a.x/this.a,c=a.y/this.a,d;if(this.sphere)d=c+this.lat0,c=Math.asin(Math.sin(d)*Math.cos(b)),d=Math.atan2(Math.tan(b),Math.cos(d));else{d=m(this.ml0/this.a+c,this.e0,this.e1,this.e2,this.e3);if(1E-10>=Math.abs(Math.abs(d)-q))return a.x=this.long0,a.y=q,0>c&&(a.y*=-1),a;var c=f(this.a,this.e,Math.sin(d)),g=Math.pow(Math.tan(d),2),b=b*this.a/c,e=b*b,c=d-c*Math.tan(d)/(c*c*c/this.a/this.a*(1-this.es))*b*b*(.5-(1+3*g)*b*b/24);d=b*(1-e*(g/3+(1+3*g)*g*e/15))/Math.cos(d)}a.x=l(d+this.long0);a.y=w(c);return a};b.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":8,"../common/e1fn":9,"../common/e2fn":10,"../common/e3fn":11,"../common/gN":12,"../common/imlfn":13,"../common/mlfn":15}],45:[function(e,h,b){var c=e("../common/adjust_lon"),d=e("../common/qsfnz"),a=e("../common/msfnz"),k=e("../common/iqsfnz");b.init=function(){this.sphere||(this.k0=a(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))};b.forward=function(a){var b=a.y,e;e=c(a.x-this.long0);this.sphere?(e=this.x0+this.a*e*Math.cos(this.lat_ts),b=this.y0+this.a*Math.sin(b)/Math.cos(this.lat_ts)):(b=d(this.e,Math.sin(b)),e=this.x0+this.a*this.k0*e,b=this.y0+this.a*b*.5/this.k0);a.x=e;a.y=b;return a};b.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b,d;this.sphere?(b=c(this.long0+a.x/this.a/Math.cos(this.lat_ts)),d=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(d=k(this.e,2*a.y*this.k0/this.a),b=c(this.long0+a.x/(this.a*this.k0)));a.x=b;a.y=d;return a};b.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":14,"../common/msfnz":16,"../common/qsfnz":21}],46:[function(e,h,b){var c=e("../common/adjust_lon"),d=e("../common/adjust_lat");b.init=function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)};b.forward=function(a){var b=a.y,g=c(a.x-this.long0),b=d(b-this.lat0);a.x=this.x0+this.a*g*this.rc;a.y=this.y0+this.a*b;return a};b.inverse=function(a){var b=a.y;a.x=c(this.long0+(a.x-this.x0)/(this.a*this.rc));a.y=d(this.lat0+(b-this.y0)/this.a);return a};b.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],47:[function(e,h,b){var c=e("../common/e0fn"),d=e("../common/e1fn"),a=e("../common/e2fn"),k=e("../common/e3fn"),g=e("../common/msfnz"),f=e("../common/mlfn"),l=e("../common/adjust_lon"),w=e("../common/adjust_lat"),m=e("../common/imlfn");b.init=function(){1E-10>Math.abs(this.lat1+this.lat2)||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=c(this.es),this.e1=d(this.es),this.e2=a(this.es),this.e3=k(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=g(this.e,this.sinphi,this.cosphi),this.ml1=f(this.e0,this.e1,this.e2,this.e3,this.lat1),1E-10>Math.abs(this.lat1-this.lat2)?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=g(this.e,this.sinphi,this.cosphi),this.ml2=f(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=f(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))};b.forward=function(a){var b=a.x,c=a.y;this.sphere||(c=f(this.e0,this.e1,this.e2,this.e3,c));var c=this.a*(this.g-c),b=this.ns*l(b-this.long0),d=this.y0+this.rh-c*Math.cos(b);a.x=this.x0+c*Math.sin(b);a.y=d;return a};b.inverse=function(a){a.x-=this.x0;a.y=this.rh-a.y+this.y0;var b,c,d;0<=this.ns?(c=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(c=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);d=0;0!==c&&(d=Math.atan2(b*a.x,b*a.y));this.sphere?(d=l(this.long0+d/this.ns),c=w(this.g-c/this.a)):(c=m(this.g-c/this.a,this.e0,this.e1,this.e2,this.e3),d=l(this.long0+d/this.ns));a.x=d;a.y=c;return a};b.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":8,"../common/e1fn":9,"../common/e2fn":10,"../common/e3fn":11,"../common/imlfn":13,"../common/mlfn":15,"../common/msfnz":16}],48:[function(e,h,b){var c=Math.PI/4,d=e("../common/srat"),a=Math.PI/2;b.init=function(){var a=Math.sin(this.lat0),b=Math.cos(this.lat0),b=b*b;this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a);this.C=Math.sqrt(1+this.es*b*b/(1-this.es));this.phic0=Math.asin(a/this.C);this.ratexp=.5*this.C*this.e;this.K=Math.tan(.5*this.phic0+c)/(Math.pow(Math.tan(.5*this.lat0+c),this.C)*d(this.e*a,this.ratexp))};b.forward=function(b){var g=b.x,f=b.y;b.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*f+c),this.C)*d(this.e*Math.sin(f),this.ratexp))-a;b.x=this.C*g;return b};b.inverse=function(b){for(var g=b.x/this.C,f=b.y,e=Math.pow(Math.tan(.5*f+c)/this.K,1/this.C),h=20;0<h;--h){f=2*Math.atan(e*d(this.e*Math.sin(b.y),-.5*this.e))-a;if(1E-14>Math.abs(f-b.y))break;b.y=f}if(!h)return null;b.x=g;b.y=f;return b};b.names=["gauss"]},{"../common/srat":23}],49:[function(e,h,b){var c=e("../common/adjust_lon"),d=e("../common/asinz");b.init=function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1E3*this.a;this.rc=1};b.forward=function(a){var b,d,f,e,h;d=a.y;f=c(a.x-this.long0);b=Math.sin(d);d=Math.cos(d);e=Math.cos(f);h=this.sin_p14*b+this.cos_p14*d*e;0<h||1E-10>=Math.abs(h)?(f=this.x0+1*this.a*d*Math.sin(f)/h,b=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*d*e)/h):(f=this.x0+this.infinity_dist*d*Math.sin(f),b=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*d*e));a.x=f;a.y=b;return a};b.inverse=function(a){var b,g,f,e;a.x=(a.x-this.x0)/this.a;a.y=(a.y-this.y0)/this.a;a.x/=this.k0;a.y/=this.k0;(b=Math.sqrt(a.x*a.x+a.y*a.y))?(e=Math.atan2(b,this.rc),g=Math.sin(e),f=Math.cos(e),e=d(f*this.sin_p14+a.y*g*this.cos_p14/b),b=Math.atan2(a.x*g,b*this.cos_p14*f-a.y*this.sin_p14*g),b=c(this.long0+b)):(e=this.phic0,b=0);a.x=b;a.y=e;return a};b.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":7}],50:[function(e,h,b){var c=e("../common/adjust_lon");b.init=function(){this.a=6377397.155;this.es=.006674372230614;this.e=Math.sqrt(this.es);this.lat0||(this.lat0=.863937979737193);this.long0||(this.long0=.4334234309119251);this.k0||(this.k0=.9999);this.s45=.785398163397448;this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq};b.forward=function(b){var a,e,g;a=b.y;g=c(b.x-this.long0);a=2*(Math.atan(this.k*Math.pow(Math.tan(a/2+this.s45),this.alfa)/Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.alfa*this.e/2))-this.s45);e=-g*this.alfa;g=Math.asin(Math.cos(this.ad)*Math.sin(a)+Math.sin(this.ad)*Math.cos(a)*Math.cos(e));a=this.n*Math.asin(Math.cos(a)*Math.sin(e)/Math.cos(g));g=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(g/2+this.s45),this.n);b.y=g*Math.cos(a)/1;b.x=g*Math.sin(a)/1;this.czech||(b.y*=-1,b.x*=-1);return b};b.inverse=function(b){var a,c,g;a=b.x;b.x=b.y;b.y=a;this.czech||(b.y*=-1,b.x*=-1);a=Math.sqrt(b.x*b.x+b.y*b.y);g=Math.atan2(b.y,b.x)/Math.sin(this.s0);c=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);a=Math.asin(Math.cos(this.ad)*Math.sin(c)-Math.sin(this.ad)*Math.cos(c)*Math.cos(g));b.x=this.long0-Math.asin(Math.cos(c)*Math.sin(g)/Math.cos(a))/this.alfa;g=a;var f=c=0;do b.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(a/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(g))/(1-this.e*Math.sin(g)),this.e/2))-this.s45),1E-10>Math.abs(g-b.y)&&(c=1),g=b.y,f+=1;while(0===c&&15>f);return 15<=f?null:b};b.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],51:[function(e,h,b){var c=Math.PI/2,d=Math.PI/4,a=e("../common/qsfnz"),k=e("../common/adjust_lon");b.S_POLE=1;b.N_POLE=2;b.EQUIT=3;b.OBLIQ=4;b.init=function(){var b=Math.abs(this.lat0);this.mode=1E-10>Math.abs(b-c)?0>this.lat0?this.S_POLE:this.N_POLE:1E-10>Math.abs(b)?this.EQUIT:this.OBLIQ;if(0<this.es)switch(this.qp=a(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),b=Math.sin(this.lat0),this.sinb1=a(this.e,b)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*b*b)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))};b.forward=function(b){var f,e,h,m,q,p,r,t;m=b.x;var u=b.y;m=k(m-this.long0);if(this.sphere)if(q=Math.sin(u),p=Math.cos(u),h=Math.cos(m),this.mode===this.OBLIQ||this.mode===this.EQUIT){e=this.mode===this.EQUIT?1+p*h:1+this.sinph0*q+this.cosph0*p*h;if(1E-10>=e)return null;e=Math.sqrt(2/e);f=e*p*Math.sin(m);e*=this.mode===this.EQUIT?q:this.cosph0*q-this.sinph0*p*h}else{if(this.mode===this.N_POLE||this.mode===this.S_POLE){this.mode===this.N_POLE&&(h=-h);if(1E-10>Math.abs(u+this.phi0))return null;e=d-.5*u;e=2*(this.mode===this.S_POLE?Math.cos(e):Math.sin(e));f=e*Math.sin(m);e*=h}}else{t=r=p=0;h=Math.cos(m);m=Math.sin(m);q=Math.sin(u);q=a(this.e,q);if(this.mode===this.OBLIQ||this.mode===this.EQUIT)p=q/this.qp,r=Math.sqrt(1-p*p);switch(this.mode){case this.OBLIQ:t=1+this.sinb1*p+this.cosb1*r*h;break;case this.EQUIT:t=1+r*h;break;case this.N_POLE:t=c+u;q=this.qp-q;break;case this.S_POLE:t=u-c,q=this.qp+q}if(1E-10>Math.abs(t))return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:t=Math.sqrt(2/t);e=this.mode===this.OBLIQ?this.ymf*t*(this.cosb1*p-this.sinb1*r*h):(t=Math.sqrt(2/(1+r*h)))*p*this.ymf;f=this.xmf*t*r*m;break;case this.N_POLE:case this.S_POLE:0<=q?(f=(t=Math.sqrt(q))*m,e=h*(this.mode===this.S_POLE?t:-t)):f=e=0}}b.x=this.a*f+this.x0;b.y=this.a*e+this.y0;return b};b.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b=a.x/this.a,d=a.y/this.a,e,m,h,p;if(this.sphere){p=m=0;h=Math.sqrt(b*b+d*d);e=.5*h;if(1<e)return null;e=2*Math.asin(e);if(this.mode===this.OBLIQ||this.mode===this.EQUIT)p=Math.sin(e),m=Math.cos(e);switch(this.mode){case this.EQUIT:e=1E-10>=Math.abs(h)?0:Math.asin(d*p/h);b*=p;d=m*h;break;case this.OBLIQ:e=1E-10>=Math.abs(h)?this.phi0:Math.asin(m*this.sinph0+d*p*this.cosph0/h);b=b*p*this.cosph0;d=(m-Math.sin(e)*this.sinph0)*h;break;case this.N_POLE:d=-d;e=c-e;break;case this.S_POLE:e-=c}b=0!==d||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(b,d):0}else{e=0;if(this.mode===this.OBLIQ||this.mode===this.EQUIT){b/=this.dd;d*=this.dd;p=Math.sqrt(b*b+d*d);if(1E-10>p)return a.x=0,a.y=this.phi0,a;h=2*Math.asin(.5*p/this.rq);m=Math.cos(h);b*=h=Math.sin(h);this.mode===this.OBLIQ?(e=m*this.sinb1+d*h*this.cosb1/p,d=p*this.cosb1*m-d*this.sinb1*h):(e=d*h/p,d=p*m)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){this.mode===this.N_POLE&&(d=-d);e=b*b+d*d;if(!e)return a.x=0,a.y=this.phi0,a;e=1-e/this.qp;this.mode===this.S_POLE&&(e=-e)}b=Math.atan2(b,d);e=this.authlat(Math.asin(e),this.apa)}a.x=k(this.long0+b);a.y=e;return a};b.P00=.3333333333333333;b.P01=.17222222222222222;b.P02=.10257936507936508;b.P10=.06388888888888888;b.P11=.0664021164021164;b.P20=.016415012942191543;b.authset=function(a){var b,c=[];c[0]=a*this.P00;b=a*a;c[0]+=b*this.P01;c[1]=b*this.P10;b*=a;c[0]+=b*this.P02;c[1]+=b*this.P11;c[2]=b*this.P20;return c};b.authlat=function(a,b){var c=a+a;return a+b[0]*Math.sin(c)+b[1]*Math.sin(c+c)+b[2]*Math.sin(c+c+c)};b.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":21}],52:[function(e,h,b){var c=e("../common/msfnz"),d=e("../common/tsfnz"),a=Math.PI/2,k=e("../common/sign"),g=e("../common/adjust_lon"),f=e("../common/phi2z");b.init=function(){this.lat2||(this.lat2=this.lat1);this.k0||(this.k0=1);this.x0=this.x0||0;this.y0=this.y0||0;if(!(1E-10>Math.abs(this.lat1+this.lat2))){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var a=Math.sin(this.lat1),b=c(this.e,a,Math.cos(this.lat1)),f=d(this.e,this.lat1,a),g=Math.sin(this.lat2),e=c(this.e,g,Math.cos(this.lat2)),g=d(this.e,this.lat2,g),k=d(this.e,this.lat0,Math.sin(this.lat0));this.ns=1E-10<Math.abs(this.lat1-this.lat2)?Math.log(b/e)/Math.log(f/g):a;isNaN(this.ns)&&(this.ns=a);this.f0=b/(this.ns*Math.pow(f,this.ns));this.rh=this.a*this.f0*Math.pow(k,this.ns);this.title||(this.title="Lambert Conformal Conic")}};b.forward=function(b){var c=b.x,f=b.y;1E-10>=Math.abs(2*Math.abs(f)-Math.PI)&&(f=k(f)*(a-2E-10));var e=Math.abs(Math.abs(f)-a);if(1E-10<e)f=d(this.e,f,Math.sin(f)),f=this.a*this.f0*Math.pow(f,this.ns);else{e=f*this.ns;if(0>=e)return null;f=0}c=this.ns*g(c-this.long0);b.x=this.k0*f*Math.sin(c)+this.x0;b.y=this.k0*(this.rh-f*Math.cos(c))+this.y0;return b};b.inverse=function(b){var c,d,e,k=(b.x-this.x0)/this.k0,h=this.rh-(b.y-this.y0)/this.k0;0<this.ns?(c=Math.sqrt(k*k+h*h),d=1):(c=-Math.sqrt(k*k+h*h),d=-1);e=0;0!==c&&(e=Math.atan2(d*k,d*h));if(0!==c||0<this.ns){if(d=1/this.ns,c=Math.pow(c/(this.a*this.f0),d),c=f(this.e,c),-9999===c)return null}else c=-a;e=g(e/this.ns+this.long0);b.x=e;b.y=c;return b};b.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":16,"../common/phi2z":17,"../common/sign":22,"../common/tsfnz":25}],53:[function(e,h,b){function c(b){return b}b.init=function(){};b.forward=c;b.inverse=c;b.names=["longlat","identity"]},{}],54:[function(e,h,b){var c=e("../common/msfnz"),d=Math.PI/2,a=e("../common/adjust_lon"),k=Math.PI/4,g=e("../common/tsfnz"),f=e("../common/phi2z");b.init=function(){var a=this.b/this.a;this.es=1-a*a;"x0"in this||(this.x0=0);"y0"in this||(this.y0=0);this.e=Math.sqrt(this.es);this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):c(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)};b.forward=function(b){var c=b.x,f=b.y;if(90<57.29577951308232*f&&-90>57.29577951308232*f&&180<57.29577951308232*c&&-180>57.29577951308232*c||1E-10>=Math.abs(Math.abs(f)-d))return null;this.sphere?(c=this.x0+this.a*this.k0*a(c-this.long0),f=this.y0+this.a*this.k0*Math.log(Math.tan(k+.5*f))):(f=g(this.e,f,Math.sin(f)),c=this.x0+this.a*this.k0*a(c-this.long0),f=this.y0-this.a*this.k0*Math.log(f));b.x=c;b.y=f;return b};b.inverse=function(b){var c=b.x-this.x0,g=b.y-this.y0;if(this.sphere)g=d-2*Math.atan(Math.exp(-g/(this.a*this.k0)));else if(g=f(this.e,Math.exp(-g/(this.a*this.k0))),-9999===g)return null;c=a(this.long0+c/(this.a*this.k0));b.x=c;b.y=g;return b};b.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":16,"../common/phi2z":17,"../common/tsfnz":25}],55:[function(e,h,b){var c=e("../common/adjust_lon");b.init=function(){};b.forward=function(b){var a=b.y,e=c(b.x-this.long0),a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+a/2.5))*1.25;b.x=this.x0+this.a*e;b.y=a;return b};b.inverse=function(b){b.x-=this.x0;b.y-=this.y0;var a=c(this.long0+b.x/this.a),e=2.5*(Math.atan(Math.exp(.8*b.y/this.a))-Math.PI/4);b.x=a;b.y=e;return b};b.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],56:[function(e,h,b){var c=e("../common/adjust_lon");b.init=function(){};b.forward=function(b){for(var a=b.y,e=c(b.x-this.long0),g=a,f=Math.PI*Math.sin(a),l=0;;l++){var h=-(g+Math.sin(g)-f)/(1+Math.cos(g)),g=g+h;if(1E-10>Math.abs(h))break}g/=2;1E-10>Math.PI/2-Math.abs(a)&&(e=0);a=1.4142135623731*this.a*Math.sin(g)+this.y0;b.x=.900316316158*this.a*e*Math.cos(g)+this.x0;b.y=a;return b};b.inverse=function(b){var a;b.x-=this.x0;b.y-=this.y0;a=b.y/(1.4142135623731*this.a);.999999999999<Math.abs(a)&&(a=.999999999999);a=Math.asin(a);var e=c(this.long0+b.x/(.900316316158*this.a*Math.cos(a)));e<-Math.PI&&(e=-Math.PI);e>Math.PI&&(e=Math.PI);a=(2*a+Math.sin(2*a))/Math.PI;1<Math.abs(a)&&(a=1);a=Math.asin(a);b.x=e;b.y=a;return b};b.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],57:[function(e,h,b){b.iterations=1;b.init=function(){this.A=[];this.A[1]=.6399175073;this.A[2]=-.1358797613;this.A[3]=.063294409;this.A[4]=-.02526853;this.A[5]=.0117879;this.A[6]=-.0055161;this.A[7]=.0026906;this.A[8]=-.001333;this.A[9]=6.7E-4;this.A[10]=-3.4E-4;this.B_re=[];this.B_im=[];this.B_re[1]=.7557853228;this.B_im[1]=0;this.B_re[2]=.249204646;this.B_im[2]=.003371507;this.B_re[3]=-.001541739;this.B_im[3]=.04105856;this.B_re[4]=-.10162907;this.B_im[4]=.01727609;this.B_re[5]=-.26623489;this.B_im[5]=-.36249218;this.B_re[6]=-.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-.577245789;this.C_im[2]=-.007809598;this.C_re[3]=.508307513;this.C_im[3]=-.112208952;this.C_re[4]=-.15094762;this.C_im[4]=.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=.5185406398;this.D[3]=-.03333098;this.D[4]=-.1052906;this.D[5]=-.0368594;this.D[6]=.007317;this.D[7]=.0122;this.D[8]=.00394;this.D[9]=-.0013};b.forward=function(b){var d,a=(b.y-this.lat0)/4.84813681109536E-6*1E-5,e=b.x-this.long0,g=1,f=0;for(d=1;10>=d;d++)g*=a,f+=this.A[d]*g;var a=f,g=1,l=0,h=0,m=0;for(d=1;6>=d;d++)f=g*a-l*e,l=l*a+g*e,g=f,h=h+this.B_re[d]*g-this.B_im[d]*l,m=m+this.B_im[d]*g+this.B_re[d]*l;b.x=m*this.a+this.x0;b.y=h*this.a+this.y0;return b};b.inverse=function(b){var d,a=(b.y-this.y0)/this.a,e=(b.x-this.x0)/this.a,g=1,f=0,l,h=0,m=0;for(d=1;6>=d;d++)l=g*a-f*e,f=f*a+g*e,g=l,h=h+this.C_re[d]*g-this.C_im[d]*f,m=m+this.C_im[d]*g+this.C_re[d]*f;for(g=0;g<this.iterations;g++){var q=h,p=m,r;l=a;f=e;for(d=2;6>=d;d++)r=q*h-p*m,p=p*h+q*m,q=r,l+=(d-1)*(this.B_re[d]*q-this.B_im[d]*p),f+=(d-1)*(this.B_im[d]*q+this.B_re[d]*p);var q=1,p=0,t=this.B_re[1],u=this.B_im[1];for(d=2;6>=d;d++)r=q*h-p*m,p=p*h+q*m,q=r,t+=d*(this.B_re[d]*q-this.B_im[d]*p),u+=d*(this.B_im[d]*q+this.B_re[d]*p);m=t*t+u*u;h=(l*t+f*u)/m;m=(f*t-l*u)/m}a=h;e=1;h=0;for(d=1;9>=d;d++)e*=a,h+=this.D[d]*e;d=this.lat0+.484813681109536*h;b.x=this.long0+m;b.y=d;return b};b.names=["New_Zealand_Map_Grid","nzmg"]},{}],58:[function(e,h,b){var c=e("../common/tsfnz"),d=e("../common/adjust_lon"),a=e("../common/phi2z"),k=Math.PI/2,g=Math.PI/4;b.init=function(){this.no_off=this.no_off||!1;this.no_rot=this.no_rot||!1;isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),b=Math.cos(this.lat0),g=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(b,4));this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-g*g);a=c(this.e,this.lat0,a);b=this.bl/b*Math.sqrt((1-this.es)/(1-g*g));1>b*b&&(b=1);var e;if(isNaN(this.longc)){g=c(this.e,this.lat1,Math.sin(this.lat1));e=c(this.e,this.lat2,Math.sin(this.lat2));this.el=0<=this.lat0?(b+Math.sqrt(b*b-1))*Math.pow(a,this.bl):(b-Math.sqrt(b*b-1))*Math.pow(a,this.bl);var g=Math.pow(g,this.bl),k=Math.pow(e,this.bl);e=this.el/g;a=.5*(e-1/e);e=(this.el*this.el-k*g)/(this.el*this.el+k*g);g=(k-g)/(k+g);k=d(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(e*Math.tan(.5*this.bl*k)/g)/this.bl;this.long0=d(this.long0);g=d(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*g)/a);this.alpha=Math.asin(b*Math.sin(this.gamma0))}else e=0<=this.lat0?b+Math.sqrt(b*b-1):b-Math.sqrt(b*b-1),this.el=e*Math.pow(a,this.bl),this.gamma0=Math.asin(Math.sin(this.alpha)/b),this.long0=this.longc-Math.asin(.5*(e-1/e)*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:0<=this.lat0?this.al/this.bl*Math.atan2(Math.sqrt(b*b-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(b*b-1),Math.cos(this.alpha))};b.forward=function(a){var b=a.y,e=d(a.x-this.long0);if(1E-10>=Math.abs(Math.abs(b)-k))e=0<b?-1:1,b=this.al/this.bl*Math.log(Math.tan(g+e*this.gamma0*.5)),e=-1*e*k*this.al/this.bl;else var b=c(this.e,b,Math.sin(b)),b=this.el/Math.pow(b,this.bl),h=.5*(b-1/b),q=Math.sin(this.bl*e),b=(h*Math.sin(this.gamma0)-q*Math.cos(this.gamma0))/(.5*(b+1/b)),b=1E-10>=Math.abs(Math.abs(b)-1)?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-b)/(1+b))/this.bl,e=1E-10>=Math.abs(Math.cos(this.bl*e))?this.al*this.bl*e:this.al*Math.atan2(h*Math.cos(this.gamma0)+q*Math.sin(this.gamma0),Math.cos(this.bl*e))/this.bl;this.no_rot?(a.x=this.x0+e,a.y=this.y0+b):(e-=this.uc,a.x=this.x0+b*Math.cos(this.alpha)+e*Math.sin(this.alpha),a.y=this.y0+e*Math.cos(this.alpha)-b*Math.sin(this.alpha));return a};b.inverse=function(b){var c,g;this.no_rot?(g=b.y-this.y0,c=b.x-this.x0):(g=(b.x-this.x0)*Math.cos(this.alpha)-(b.y-this.y0)*Math.sin(this.alpha),c=(b.y-this.y0)*Math.cos(this.alpha)+(b.x-this.x0)*Math.sin(this.alpha),c+=this.uc);var e=Math.exp(-1*this.bl*g/this.al);g=.5*(e-1/e);var h=Math.sin(this.bl*c/this.al),e=(h*Math.cos(this.gamma0)+g*Math.sin(this.gamma0))/(.5*(e+1/e)),p=Math.pow(this.el/Math.sqrt((1+e)/(1-e)),1/this.bl);1E-10>Math.abs(e-1)?(b.x=this.long0,b.y=k):1E-10>Math.abs(e+1)?(b.x=this.long0,b.y=-1*k):(b.y=a(this.e,p),b.x=d(this.long0-Math.atan2(g*Math.cos(this.gamma0)-h*Math.sin(this.gamma0),Math.cos(this.bl*c/this.al))/this.bl));return b};b.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":17,"../common/tsfnz":25}],59:[function(e,h,b){var c=e("../common/adjust_lon"),d=e("../common/asinz"),a=Math.PI/2;b.init=function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0)};b.forward=function(a){var b,d,e,h,m,q,p;d=a.y;e=c(a.x-this.long0);b=Math.sin(d);d=Math.cos(d);h=Math.cos(e);m=this.sin_p14*b+this.cos_p14*d*h;if(0<m||1E-10>=Math.abs(m))q=1*this.a*d*Math.sin(e),p=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*d*h);a.x=q;a.y=p;return a};b.inverse=function(b){var e,f,l,h,m;b.x-=this.x0;b.y-=this.y0;e=Math.sqrt(b.x*b.x+b.y*b.y);f=d(e/this.a);l=Math.sin(f);f=Math.cos(f);h=this.long0;if(1E-10>=Math.abs(e))return m=this.lat0,b.x=h,b.y=m,b;m=d(f*this.sin_p14+b.y*l*this.cos_p14/e);if(1E-10>=Math.abs(Math.abs(this.lat0)-a))return h=0<=this.lat0?c(this.long0+Math.atan2(b.x,-b.y)):c(this.long0-Math.atan2(-b.x,b.y)),b.x=h,b.y=m,b;h=c(this.long0+Math.atan2(b.x*l,e*this.cos_p14*f-b.y*this.sin_p14*l));b.x=h;b.y=m;return b};b.names=["ortho"]},{"../common/adjust_lon":5,"../common/asinz":7}],60:[function(e,h,b){var c=e("../common/e0fn"),d=e("../common/e1fn"),a=e("../common/e2fn"),k=e("../common/e3fn"),g=e("../common/adjust_lon"),f=e("../common/adjust_lat"),l=e("../common/mlfn"),w=e("../common/gN");b.init=function(){this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=c(this.es);this.e1=d(this.es);this.e2=a(this.es);this.e3=k(this.es);this.ml0=this.a*l(this.e0,this.e1,this.e2,this.e3,this.lat0)};b.forward=function(a){var b=a.y,c,d;c=g(a.x-this.long0);d=c*Math.sin(b);if(this.sphere)1E-10>=Math.abs(b)?(c*=this.a,b=-1*this.a*this.lat0):(c=this.a*Math.sin(d)/Math.tan(b),b=this.a*(f(b-this.lat0)+(1-Math.cos(d))/Math.tan(b)));else if(1E-10>=Math.abs(b))c*=this.a,b=-1*this.ml0;else{var e=w(this.a,this.e,Math.sin(b))/Math.tan(b);c=e*Math.sin(d);b=this.a*l(this.e0,this.e1,this.e2,this.e3,b)-this.ml0+e*(1-Math.cos(d))}a.x=c+this.x0;a.y=b+this.y0;return a};b.inverse=function(a){var b,c,d,f,e,h,k;b=a.x-this.x0;d=a.y-this.y0;if(this.sphere)if(1E-10>=Math.abs(d+this.a*this.lat0))b=g(b/this.a+this.long0),c=0;else{f=this.lat0+d/this.a;e=b*b/this.a/this.a+f*f;h=f;for(d=20;d;--d)if(k=Math.tan(h),k=-1*(f*(h*k+1)-h-.5*(h*h+e)*k)/((h-f)/k-1),h+=k,1E-10>=Math.abs(k)){c=h;break}b=g(this.long0+Math.asin(b*Math.tan(h)/this.a)/Math.sin(c))}else if(1E-10>=Math.abs(d+this.ml0))c=0,b=g(this.long0+b/this.a);else{f=(this.ml0+d)/this.a;e=b*b/this.a/this.a+f*f;h=f;var w,z;for(d=20;d;--d)if(k=this.e*Math.sin(h),k=Math.sqrt(1-k*k)*Math.tan(h),w=this.a*l(this.e0,this.e1,this.e2,this.e3,h),z=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),w/=this.a,k=(f*(k*w+1)-w-.5*k*(w*w+e))/(this.es*Math.sin(2*h)*(w*w+e-2*f*w)/(4*k)+(f-w)*(k*z-2/Math.sin(2*h))-z),h-=k,1E-10>=Math.abs(k)){c=h;break}k=Math.sqrt(1-this.es*Math.pow(Math.sin(c),2))*Math.tan(c);b=g(this.long0+Math.asin(b*k/this.a)/Math.sin(c))}a.x=b;a.y=c;return a};b.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":8,"../common/e1fn":9,"../common/e2fn":10,"../common/e3fn":11,"../common/gN":12,"../common/mlfn":15}],61:[function(e,h,b){var c=e("../common/adjust_lon"),d=e("../common/adjust_lat"),a=e("../common/pj_enfn"),k=e("../common/pj_mlfn"),g=e("../common/pj_inv_mlfn"),f=Math.PI/2,l=e("../common/asinz");b.init=function(){this.sphere?(this.n=1,this.es=this.m=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=a(this.es)};b.forward=function(a){var b,d;b=a.x;d=a.y;b=c(b-this.long0);if(this.sphere){if(this.m)for(var f=this.n*Math.sin(d),e=20;e;--e){var g=(this.m*d+Math.sin(d)-f)/(this.m+Math.cos(d));d-=g;if(1E-10>Math.abs(g))break}else d=1!==this.n?Math.asin(this.n*Math.sin(d)):d;b=this.a*this.C_x*b*(this.m+Math.cos(d));d*=this.a*this.C_y}else f=Math.sin(d),e=Math.cos(d),d=this.a*k(d,f,e,this.en),b=this.a*b*e/Math.sqrt(1-this.es*f*f);a.x=b;a.y=d;return a};b.inverse=function(a){var b,e,h;a.x-=this.x0;e=a.x/this.a;a.y-=this.y0;b=a.y/this.a;this.sphere?(b/=this.C_y,e/=this.C_x*(this.m+Math.cos(b)),this.m?b=l((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=l(Math.sin(b)/this.n)),e=c(e+this.long0),b=d(b)):(b=g(a.y/this.a,this.es,this.en),h=Math.abs(b),h<f?(h=Math.sin(b),e=this.long0+a.x*Math.sqrt(1-this.es*h*h)/(this.a*Math.cos(b)),e=c(e)):h-1E-10<f&&(e=this.long0));a.x=e;a.y=b;return a};b.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":7,"../common/pj_enfn":18,"../common/pj_inv_mlfn":19,"../common/pj_mlfn":20}],62:[function(e,h,b){b.init=function(){var b=this.lat0;this.lambda0=this.long0;var d=Math.sin(b),a=this.a,e=1/this.rf,e=2*e-Math.pow(e,2),g=this.e=Math.sqrt(e);this.R=this.k0*a*Math.sqrt(1-e)/(1-e*Math.pow(d,2));this.alpha=Math.sqrt(1+e/(1-e)*Math.pow(Math.cos(b),4));this.b0=Math.asin(d/this.alpha);this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-this.alpha*Math.log(Math.tan(Math.PI/4+b/2))+this.alpha*g/2*Math.log((1+g*d)/(1-g*d))};b.forward=function(b){var d=2*(Math.atan(Math.exp(-this.alpha*(Math.log(Math.tan(Math.PI/4-b.y/2))+this.e/2*Math.log((1+this.e*Math.sin(b.y))/(1-this.e*Math.sin(b.y))))+this.K))-Math.PI/4),a=this.alpha*(b.x-this.lambda0),e=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(d)+Math.cos(this.b0)*Math.cos(a))),d=Math.asin(Math.cos(this.b0)*Math.sin(d)-Math.sin(this.b0)*Math.cos(d)*Math.cos(a));b.y=this.R/2*Math.log((1+Math.sin(d))/(1-Math.sin(d)))+this.y0;b.x=this.R*e+this.x0;return b};b.inverse=function(b){for(var d=(b.x-this.x0)/this.R,a=2*(Math.atan(Math.exp((b.y-this.y0)/this.R))-Math.PI/4),e=Math.asin(Math.cos(this.b0)*Math.sin(a)+Math.sin(this.b0)*Math.cos(a)*Math.cos(d)),d=this.lambda0+Math.atan(Math.sin(d)/(Math.cos(this.b0)*Math.cos(d)-Math.sin(this.b0)*Math.tan(a)))/this.alpha,a=0,g=e,f=-1E3,l=0;1E-7<Math.abs(g-f);){if(20<++l)return;a=1/this.alpha*(Math.log(Math.tan(Math.PI/4+e/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(g))/2));f=g;g=2*Math.atan(Math.exp(a))-Math.PI/2}b.x=d;b.y=g;return b};b.names=["somerc"]},{}],63:[function(e,h,b){var c=Math.PI/2,d=e("../common/sign"),a=e("../common/msfnz"),k=e("../common/tsfnz"),g=e("../common/phi2z"),f=e("../common/adjust_lon");b.ssfn_=function(a,b,d){b*=d;return Math.tan(.5*(c+a))*Math.pow((1-b)/(1+b),.5*d)};b.init=function(){this.coslat0=Math.cos(this.lat0);this.sinlat0=Math.sin(this.lat0);this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&1E-10>=Math.abs(this.coslat0)&&(this.k0=.5*(1+d(this.lat0)*Math.sin(this.lat_ts))):(1E-10>=Math.abs(this.coslat0)&&(this.con=0<this.lat0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&1E-10>=Math.abs(this.coslat0)&&(this.k0=.5*this.cons*a(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/k(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=a(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-c,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))};b.forward=function(a){var b=a.x,d=a.y,e=Math.sin(d),g=Math.cos(d),h,t=f(b-this.long0);if(1E-10>=Math.abs(Math.abs(b-this.long0)-Math.PI)&&1E-10>=Math.abs(d+this.lat0))return a.x=NaN,a.y=NaN,a;if(this.sphere)b=2*this.k0/(1+this.sinlat0*e+this.coslat0*g*Math.cos(t)),a.x=this.a*b*g*Math.sin(t)+this.x0,a.y=this.a*b*(this.coslat0*e-this.sinlat0*g*Math.cos(t))+this.y0;else{h=2*Math.atan(this.ssfn_(d,e,this.e))-c;g=Math.cos(h);h=Math.sin(h);if(1E-10>=Math.abs(this.coslat0))return e=k(this.e,d*this.con,this.con*e),e=2*this.a*this.k0*e/this.cons,a.x=this.x0+e*Math.sin(b-this.long0),a.y=this.y0-this.con*e*Math.cos(b-this.long0),a;1E-10>Math.abs(this.sinlat0)?(b=2*this.a*this.k0/(1+g*Math.cos(t)),a.y=b*h):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*h+this.cosX0*g*Math.cos(t))),a.y=b*(this.cosX0*h-this.sinX0*g*Math.cos(t))+this.y0);a.x=b*g*Math.sin(t)+this.x0}return a};b.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b,d,e,h=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere){e=2*Math.atan(h/(.5*this.a*this.k0));b=this.long0;d=this.lat0;if(1E-10>=h)return a.x=b,a.y=d,a;d=Math.asin(Math.cos(e)*this.sinlat0+a.y*Math.sin(e)*this.coslat0/h);b=1E-10>Math.abs(this.coslat0)?0<this.lat0?f(this.long0+Math.atan2(a.x,-1*a.y)):f(this.long0+Math.atan2(a.x,a.y)):f(this.long0+Math.atan2(a.x*Math.sin(e),h*this.coslat0*Math.cos(e)-a.y*this.sinlat0*Math.sin(e)));a.x=b;a.y=d;return a}if(1E-10>=Math.abs(this.coslat0)){if(1E-10>=h)return d=this.lat0,b=this.long0,a.x=b,a.y=d,a;a.x*=this.con;a.y*=this.con;b=h*this.cons/(2*this.a*this.k0);d=this.con*g(this.e,b);b=this.con*f(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else d=2*Math.atan(h*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,1E-10>=h?e=this.X0:(e=Math.asin(Math.cos(d)*this.sinX0+a.y*Math.sin(d)*this.cosX0/h),b=f(this.long0+Math.atan2(a.x*Math.sin(d),h*this.cosX0*Math.cos(d)-a.y*this.sinX0*Math.sin(d)))),d=-1*g(this.e,Math.tan(.5*(c+e)));a.x=b;a.y=d;return a};b.names=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"]},{"../common/adjust_lon":5,"../common/msfnz":16,"../common/phi2z":17,"../common/sign":22,"../common/tsfnz":25}],64:[function(e,h,b){var c=e("./gauss"),d=e("../common/adjust_lon");b.init=function(){c.init.apply(this);this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))};b.forward=function(a){var b,e,f,h;a.x=d(a.x-this.long0);c.forward.apply(this,[a]);b=Math.sin(a.y);e=Math.cos(a.y);f=Math.cos(a.x);h=this.k0*this.R2/(1+this.sinc0*b+this.cosc0*e*f);a.x=h*e*Math.sin(a.x);a.y=h*(this.cosc0*b-this.sinc0*e*f);a.x=this.a*a.x+this.x0;a.y=this.a*a.y+this.y0;return a};b.inverse=function(a){var b,e,f,h;a.x=(a.x-this.x0)/this.a;a.y=(a.y-this.y0)/this.a;a.x/=this.k0;a.y/=this.k0;(h=Math.sqrt(a.x*a.x+a.y*a.y))?(f=2*Math.atan2(h,this.R2),b=Math.sin(f),e=Math.cos(f),f=Math.asin(e*this.sinc0+a.y*b*this.cosc0/h),b=Math.atan2(a.x*b,h*this.cosc0*e-a.y*this.sinc0*b)):(f=this.phic0,b=0);a.x=b;a.y=f;c.inverse.apply(this,[a]);a.x=d(a.x+this.long0);return a};b.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":48}],65:[function(e,h,b){var c=e("../common/pj_enfn"),d=e("../common/pj_mlfn"),a=e("../common/pj_inv_mlfn"),k=e("../common/adjust_lon"),g=Math.PI/2,f=e("../common/sign");b.init=function(){this.x0=void 0!==this.x0?this.x0:0;this.y0=void 0!==this.y0?this.y0:0;this.long0=void 0!==this.long0?this.long0:0;this.lat0=void 0!==this.lat0?this.lat0:0;this.es&&(this.en=c(this.es),this.ml0=d(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))};b.forward=function(a){var b=a.y,c=k(a.x-this.long0),f,e=Math.sin(b),g=Math.cos(b);if(this.es){var h=g*c,u=Math.pow(h,2),v=this.ep2*Math.pow(g,2),x=Math.pow(v,2),y=Math.pow(1E-10<Math.abs(g)?Math.tan(b):0,2),z=Math.pow(y,2);f=1-this.es*Math.pow(e,2);h/=Math.sqrt(f);b=d(b,e,g,this.en);f=this.a*this.k0*h*(1+u/6*(1-y+v+u/20*(5-18*y+z+14*v-58*y*v+u/42*(61+179*z-z*y-479*y))))+this.x0;c=this.a*this.k0*(b-this.ml0+e*c*h/2*(1+u/12*(5-y+9*v+4*x+u/30*(61+z-58*y+270*v-330*y*v+u/56*(1385+543*z-z*y-3111*y)))))+this.y0}else{e=g*Math.sin(c);if(1E-10>Math.abs(Math.abs(e)-1))return 93;f=.5*this.a*this.k0*Math.log((1+e)/(1-e))+this.x0;c=g*Math.cos(c)/Math.sqrt(1-Math.pow(e,2));e=Math.abs(c);if(1<=e){if(1E-10<e-1)return 93;c=0}else c=Math.acos(c);0>b&&(c=-c);c=this.a*this.k0*(c-this.lat0)+this.y0}a.x=f;a.y=c;return a};b.inverse=function(b){var c,d,e=1/this.a*(b.x-this.x0),h=1/this.a*(b.y-this.y0);if(this.es)if(c=this.ml0+h/this.k0,d=a(c,this.es,this.en),Math.abs(d)<g){var h=Math.cos(d),r=1E-10<Math.abs(h)?Math.tan(d):0,t=this.ep2*Math.pow(h,2),u=Math.pow(t,2),v=Math.pow(r,2),x=Math.pow(v,2);c=1-this.es*Math.pow(Math.sin(d),2);var e=e*Math.sqrt(c)/this.k0,y=Math.pow(e,2);c=d-c*r*y/(1-this.es)*.5*(1-y/12*(5+3*v-9*t*v+t-4*u-y/30*(61+90*v-252*t*v+45*x+46*t-y/56*(1385+3633*v+4095*x+1574*x*v))));d=k(this.long0+e*(1-y/6*(1+2*v+t-y/20*(5+28*v+24*x+8*t*v+6*t-y/42*(61+662*v+1320*x+720*x*v))))/h)}else c=g*f(h),d=0;else c=Math.exp(e/this.k0),d=.5*(c-1/c),t=Math.cos(this.lat0+h/this.k0),c=Math.sqrt((1-Math.pow(t,2))/(1+Math.pow(d,2))),c=Math.asin(c),0>h&&(c=-c),d=0===d&&0===t?0:k(Math.atan2(d,t)+this.long0);b.x=d;b.y=c;return b};b.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/pj_enfn":18,"../common/pj_inv_mlfn":19,"../common/pj_mlfn":20,"../common/sign":22}],66:[function(e,h,b){var c=e("../common/adjust_zone"),d=e("./tmerc");b.dependsOn="tmerc";b.init=function(){var a=c(this.zone,this.long0);if(void 0===a)throw Error("unknown utm zone");this.lat0=0;this.long0=(a+.5)*Math.PI/30-Math.PI;this.x0=5E5;this.y0=this.utmSouth?1E7:0;this.k0=.9996;d.init.apply(this);this.forward=d.forward;this.inverse=d.inverse};b.names=["Universal Transverse Mercator System","utm"]},{"../common/adjust_zone":6,"./tmerc":65}],67:[function(e,h,b){var c=e("../common/adjust_lon"),d=e("../common/asinz");b.init=function(){this.R=this.a};b.forward=function(a){var b=a.y,e=c(a.x-this.long0),f=d(2*Math.abs(b/Math.PI)),h=.5*Math.abs(Math.PI/e-e/Math.PI),w=h*h,m=Math.sin(f),f=Math.cos(f),f=f/(m+f-1),m=f*(2/m-1),q=m*m,p=Math.PI*this.R*(h*(f-q)+Math.sqrt(w*(f-q)*(f-q)-(q+w)*(f*f-q)))/(q+w);0>e&&(p=-p);e=this.x0+p;f=w+f;p=Math.PI*this.R*(m*f-h*Math.sqrt((q+w)*(w+1)-f*f))/(q+w);b=0<=b?this.y0+p:this.y0-p;a.x=e;a.y=b;return a};b.inverse=function(a){var b,d,f,e,h,m,q,p;a.x-=this.x0;a.y-=this.y0;h=Math.PI*this.R;b=a.x/h;f=a.y/h;e=b*b+f*f;h=-Math.abs(f)*(1+e);d=h-2*f*f+b*b;m=-2*h+1+2*f*f+e*e;q=(h-d*d/3/m)/m;p=2*Math.sqrt(-q/3);h=3*(f*f/m+(2*d*d*d/m/m/m-9*h*d/m/m)/27)/q/p;1<Math.abs(h)&&(h=0<=h?1:-1);h=Math.acos(h)/3;d=0<=a.y?(-p*Math.cos(h+Math.PI/3)-d/3/m)*Math.PI:-(-p*Math.cos(h+Math.PI/3)-d/3/m)*Math.PI;b=1E-10>Math.abs(b)?this.long0:c(this.long0+Math.PI*(e-1+Math.sqrt(1+2*(b*b-f*f)+e*e))/2/b);a.x=b;a.y=d;return a};b.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":7}],68:[function(e,h,b){var c=e("./datum_transform"),d=e("./adjust_axis"),a=e("./Proj"),k=e("./common/toPoint");h.exports=function f(b,e,h){var q;Array.isArray(h)&&(h=k(h));b.datum&&e.datum&&((1===b.datum.datum_type||2===b.datum.datum_type)&&"WGS84"!==e.datumCode||(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==b.datumCode)&&(q=new a("WGS84"),h=f(b,q,h),b=q);"enu"!==b.axis&&(h=d(b,!1,h));"longlat"===b.projName?h={x:.017453292519943295*h.x,y:.017453292519943295*h.y}:(b.to_meter&&(h={x:h.x*b.to_meter,y:h.y*b.to_meter}),h=b.inverse(h));b.from_greenwich&&(h.x+=b.from_greenwich);h=c(b.datum,e.datum,h);e.from_greenwich&&(h={x:h.x-e.grom_greenwich,y:h.y});"longlat"===e.projName?h={x:57.29577951308232*h.x,y:57.29577951308232*h.y}:(h=e.forward(h),e.to_meter&&(h={x:h.x/e.to_meter,y:h.y/e.to_meter}));return"enu"!==e.axis?d(e,!0,h):h}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":24,"./datum_transform":33}],69:[function(e,h,b){function c(a,b,c){a[b]=c.map(function(a){var b={};d(a,b);return b}).reduce(function(a,b){return g(a,b)},{})}function d(a,b){var e;Array.isArray(a)?(e=a.shift(),"PARAMETER"===e&&(e=a.shift()),1===a.length?Array.isArray(a[0])?(b[e]={},d(a[0],b[e])):b[e]=a[0]:a.length?"TOWGS84"===e?b[e]=a:(b[e]={},-1<["UNIT","PRIMEM","VERT_DATUM"].indexOf(e)?(b[e]={name:a[0].toLowerCase(),convert:a[1]},3===a.length&&(b[e].auth=a[2])):"SPHEROID"===e?(b[e]={name:a[0],a:a[1],rf:a[2]},4===a.length&&(b[e].auth=a[3])):-1<"GEOGCS GEOCCS DATUM VERT_CS COMPD_CS LOCAL_CS FITTED_CS LOCAL_DATUM".split(" ").indexOf(e)?(a[0]=["name",a[0]],c(b,e,a)):a.every(function(a){return Array.isArray(a)})?c(b,e,a):d(a,b[e])):b[e]=!0):b[a]=!0}function a(a){return.017453292519943295*a}function k(b){function c(a){var d=b.to_meter||1;return parseFloat(a,10)*d}"GEOGCS"===b.type?b.projName="longlat":"LOCAL_CS"===b.type?(b.projName="identity",b.local=!0):b.projName="object"===typeof b.PROJECTION?Object.keys(b.PROJECTION)[0]:b.PROJECTION;b.UNIT&&(b.units=b.UNIT.name.toLowerCase(),"metre"===b.units&&(b.units="meter"),b.UNIT.convert&&("GEOGCS"===b.type?b.DATUM&&b.DATUM.SPHEROID&&(b.to_meter=parseFloat(b.UNIT.convert,10)*b.DATUM.SPHEROID.a):b.to_meter=parseFloat(b.UNIT.convert,10)));if(b.GEOGCS){b.datumCode=b.GEOGCS.DATUM?b.GEOGCS.DATUM.name.toLowerCase():b.GEOGCS.name.toLowerCase();"d_"===b.datumCode.slice(0,2)&&(b.datumCode=b.datumCode.slice(2));if("new_zealand_geodetic_datum_1949"===b.datumCode||"new_zealand_1949"===b.datumCode)b.datumCode="nzgd49";"wgs_1984"===b.datumCode&&("Mercator_Auxiliary_Sphere"===b.PROJECTION&&(b.sphere=!0),b.datumCode="wgs84");"_ferro"===b.datumCode.slice(-6)&&(b.datumCode=b.datumCode.slice(0,-6));"_jakarta"===b.datumCode.slice(-8)&&(b.datumCode=b.datumCode.slice(0,-8));~b.datumCode.indexOf("belge")&&(b.datumCode="rnb72");b.GEOGCS.DATUM&&b.GEOGCS.DATUM.SPHEROID&&(b.ellps=b.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===b.ellps.toLowerCase().slice(0,13)&&(b.ellps="intl"),b.a=b.GEOGCS.DATUM.SPHEROID.a,b.rf=parseFloat(b.GEOGCS.DATUM.SPHEROID.rf,10));~b.datumCode.indexOf("osgb_1936")&&(b.datumCode="osgb36")}b.b&&!isFinite(b.b)&&(b.b=b.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",a],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",a],["x0","false_easting",c],["y0","false_northing",c],["long0","central_meridian",a],["lat0","latitude_of_origin",a],["lat0","standard_parallel_1",a],["lat1","standard_parallel_1",a],["lat2","standard_parallel_2",a],["alpha","azimuth",a],["srsCode","name"]].forEach(function(a){var c=a[0],d=a[1];!(c in b)&&d in b&&(b[c]=b[d],3===a.length&&(b[c]=a[2](b[c])))});b.long0||!b.longc||"Albers_Conic_Equal_Area"!==b.projName&&"Lambert_Azimuthal_Equal_Area"!==b.projName||(b.long0=b.longc);b.lat_ts||!b.lat1||"Stereographic_South_Pole"!==b.projName&&"Polar Stereographic (variant B)"!==b.projName||(b.lat0=.017453292519943295*(0<b.lat1?90:-90),b.lat_ts=b.lat1)}var g=e("./extend");h.exports=function(a,b){var c=JSON.parse((","+a).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]').replace(/,\["VERTCS".+/,"")),e=c.shift(),h=c.shift();c.unshift(["name",h]);c.unshift(["type",e]);c.unshift("output");e={};d(c,e);k(e.output);return g(b,e.output)}},{"./extend":36}],70:[function(e,h,b){function c(a){var b=a.zoneNumber;if(0>b||60<b)return null;var d=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),e,h,k,p,r;p=a.easting-5E5;h=a.northing;"N">a.zoneLetter&&(h-=1E7);h=h/.9996/6367449.145945056;r=h+(3*d/2-27*d*d*d/32)*Math.sin(2*h)+(21*d*d/16-55*d*d*d*d/32)*Math.sin(4*h)+151*d*d*d/96*Math.sin(6*h);e=6378137/Math.sqrt(1-.00669438*Math.sin(r)*Math.sin(r));d=Math.tan(r)*Math.tan(r);h=.006739496752268451*Math.cos(r)*Math.cos(r);k=6335439.32722994/Math.pow(1-.00669438*Math.sin(r)*Math.sin(r),1.5);p/=.9996*e;e=r-e*Math.tan(r)/k*(p*p/2-(5+3*d+10*h-4*h*h-.06065547077041606)*p*p*p*p/24+(61+90*d+298*h+45*d*d-1.6983531815716497-3*h*h)*p*p*p*p*p*p/720);e=e/Math.PI*180;p=(p-(1+2*d+h)*p*p*p/6+(5-2*h+28*d-3*h*h+.05391597401814761+24*d*d)*p*p*p*p*p/120)/Math.cos(r);p=6*(b-1)-180+3+p/Math.PI*180;a.accuracy?(a=c({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber}),a={top:a.lat,right:a.lon,bottom:e,left:p}):a={lat:e,lon:p};return a}function d(a){a%=6;0===a&&(a=6);return a}function a(a){if(a&&0===a.length)throw"MGRSPoint coverting from nothing";for(var b=a.length,c=null,e="",h,q=0;!/[A-Z]/.test(h=a.charAt(q));){if(2<=q)throw"MGRSPoint bad conversion from: "+a;e+=h;q++}e=parseInt(e,10);if(0===q||q+3>b)throw"MGRSPoint bad conversion from: "+a;h=a.charAt(q++);if("A">=h||"B"===h||"Y"===h||"Z"<=h||"I"===h||"O"===h)throw"MGRSPoint zone letter "+h+" not handled: "+a;var c=a.substring(q,q+=2),p=d(e),r;r=c.charAt(0);for(var t="AJSAJS".charCodeAt(p-1),u=1E5,v=!1;t!==r.charCodeAt(0);){t++;73===t&&t++;79===t&&t++;if(90<t){if(v)throw"Bad character: "+r;t=65;v=!0}u+=1E5}r=u;c=c.charAt(1);if("V"<c)throw"MGRSPoint given invalid Northing "+c;p="AFAFAF".charCodeAt(p-1);t=0;for(u=!1;p!==c.charCodeAt(0);){p++;73===p&&p++;79===p&&p++;if(86<p){if(u)throw"Bad character: "+c;p=65;u=!0}t+=1E5}for(p=t;p<k(h);)p+=2E6;b-=q;if(0!==b%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var b=b/2,t=c=0,x;0<b&&(x=1E5/Math.pow(10,b),c=a.substring(q,q+b),c=parseFloat(c)*x,a=a.substring(q+b),t=parseFloat(a)*x);return{easting:c+r,northing:t+p,zoneLetter:h,zoneNumber:e,accuracy:x}}function k(a){var b;switch(a){case "C":b=11E5;break;case "D":b=2E6;break;case "E":b=28E5;break;case "F":b=37E5;break;case "G":b=46E5;break;case "H":b=55E5;break;case "J":b=64E5;break;case "K":b=73E5;break;case "L":b=82E5;break;case "M":b=91E5;break;case "N":b=0;break;case "P":b=8E5;break;case "Q":b=17E5;break;case "R":b=26E5;break;case "S":b=35E5;break;case "T":b=44E5;break;case "U":b=53E5;break;case "V":b=62E5;break;case "W":b=7E6;break;case "X":b=79E5;break;default:b=-1}if(0<=b)return b;throw"Invalid zone letter: "+a;}b.forward=function(a,b){var c,e,h,k=a[1],p=a[0],r;c=Math.PI/180*k;h=Math.PI/180*p;var t,u;u=Math.floor((p+180)/6)+1;180===p&&(u=60);56<=k&&64>k&&3<=p&&12>p&&(u=32);72<=k&&84>k&&(0<=p&&9>p?u=31:9<=p&&21>p?u=33:21<=p&&33>p?u=35:33<=p&&42>p&&(u=37));t=Math.PI/180*(6*(u-1)-180+3);p=6378137/Math.sqrt(1-.00669438*Math.sin(c)*Math.sin(c));r=Math.tan(c)*Math.tan(c);e=.006739496752268451*Math.cos(c)*Math.cos(c);h=Math.cos(c)*(h-t);c=.9996*(6378137*(.9983242984503243*c-.002514607064228144*Math.sin(2*c)+2.639046602129982E-6*Math.sin(4*c)-3.4180461016968582E-9*Math.sin(6*c))+p*Math.tan(c)*(h*h/2+(5-r+9*e+4*e*e)*h*h*h*h/24+(61-58*r+r*r+600*e-2.2240339282485886)*h*h*h*h*h*h/720));0>k&&(c+=1E7);c=Math.round(c);e=Math.round(.9996*p*(h+(1-r+e)*h*h*h/6+(5-18*r+r*r+72*e-.39089081163157013)*h*h*h*h*h/120)+5E5);h=u;r="Z";84>=k&&72<=k?r="X":72>k&&64<=k?r="W":64>k&&56<=k?r="V":56>k&&48<=k?r="U":48>k&&40<=k?r="T":40>k&&32<=k?r="S":32>k&&24<=k?r="R":24>k&&16<=k?r="Q":16>k&&8<=k?r="P":8>k&&0<=k?r="N":0>k&&-8<=k?r="M":-8>k&&-16<=k?r="L":-16>k&&-24<=k?r="K":-24>k&&-32<=k?r="J":-32>k&&-40<=k?r="H":-40>k&&-48<=k?r="G":-48>k&&-56<=k?r="F":-56>k&&-64<=k?r="E":-64>k&&-72<=k?r="D":-72>k&&-80<=k&&(r="C");k=b||5;u="00000"+e;p="00000"+c;r=h+r;t=d(h);e=Math.floor(e/1E5);h=Math.floor(c/1E5)%20;--t;c="AJSAJS".charCodeAt(t);t="AFAFAF".charCodeAt(t);e=c+e-1;h=t+h;var v=!1;90<e&&(e=e-90+65-1,v=!0);(73===e||73>c&&73<e||(73<e||73>c)&&v)&&e++;if(79===e||79>c&&79<e||(79<e||79>c)&&v)e++,73===e&&e++;90<e&&(e=e-90+65-1);86<h?(h=h-86+65-1,v=!0):v=!1;(73===h||73>t&&73<h||(73<h||73>t)&&v)&&h++;if(79===h||79>t&&79<h||(79<h||79>t)&&v)h++,73===h&&h++;86<h&&(h=h-86+65-1);c=String.fromCharCode(e)+String.fromCharCode(h);return r+c+u.substr(u.length-5,k)+p.substr(p.length-5,k)};b.inverse=function(b){b=c(a(b.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat,b.lon,b.lat]:[b.left,b.bottom,b.right,b.top]};b.toPoint=function(b){b=c(a(b.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat]:[(b.left+b.right)/2,(b.top+b.bottom)/2]}},{}]},{},[38])(38)});(function(n){var e,h;if("function"===typeof define&&define.amd)define(["leaflet","proj4"],n);else if("object"===typeof module&&"object"===typeof module.exports)e=require("leaflet"),h=require("proj4"),module.exports=n(e,h);else{if("undefined"===typeof window.L||"undefined"===typeof window.proj4)throw"Leaflet and proj4 must be loaded first";n(window.L,window.proj4)}})(function(n,e){n.Proj={};n.Proj._isProj4Obj=function(e){return"undefined"!==typeof e.inverse&&"undefined"!==typeof e.forward};n.Proj.Projection=n.Class.extend({initialize:function(e,b,c){var d=n.Proj._isProj4Obj(e);this._proj=d?e:this._projFromCodeDef(e,b);this.bounds=d?b:c},project:function(e){e=this._proj.forward([e.lng,e.lat]);return new n.Point(e[0],e[1])},unproject:function(e,b){var c=this._proj.inverse([e.x,e.y]);return new n.LatLng(c[1],c[0],b)},_projFromCodeDef:function(h,b){if(b)e.defs(h,b);else if(void 0===e.defs[h]){var c=h.split(":");3<c.length&&(h=c[c.length-3]+":"+c[c.length-1]);if(void 0===e.defs[h])throw"No projection definition for code "+h;}return e(h)}});n.Proj.CRS=n.Class.extend({includes:n.CRS,options:{transformation:new n.Transformation(1,0,-1,0)},initialize:function(e,b,c){var d;n.Proj._isProj4Obj(e)?(d=e.srsCode,c=b||{},this.projection=new n.Proj.Projection(e,c.bounds)):(d=e,c=c||{},this.projection=new n.Proj.Projection(d,b,c.bounds));n.Util.setOptions(this,c);this.code=d;this.transformation=this.options.transformation;this.options.origin&&(this.transformation=new n.Transformation(1,-this.options.origin[0],-1,this.options.origin[1]));if(this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions)for(this._scales=[],e=this.options.resolutions.length-1;0<=e;e--)this.options.resolutions[e]&&(this._scales[e]=1/this.options.resolutions[e]);this.infinite=!this.options.bounds},scale:function(e){var b=Math.floor(e),c;if(e===b)return this._scales[e];c=this._scales[b];return c+(this._scales[b+1]-c)*(e-b)},zoom:function(e){var b=this._closestElement(this._scales,e),c=this._scales.indexOf(b),d;if(e===b)return c;d=this._scales[c+1];return void 0===d?Infinity:(e-b)/(d-b)+c},distance:n.CRS.Earth.distance,R:n.CRS.Earth.R,_closestElement:function(e,b){for(var c,d=e.length;d--;)e[d]<=b&&(void 0===c||c<e[d])&&(c=e[d]);return c}});n.Proj.GeoJSON=n.GeoJSON.extend({initialize:function(e,b){this._callLevel=0;n.GeoJSON.prototype.initialize.call(this,e,b)},addData:function(e){var b;e&&(e.crs&&"name"===e.crs.type?b=new n.Proj.CRS(e.crs.properties.name):e.crs&&e.crs.type&&(b=new n.Proj.CRS(e.crs.type+":"+e.crs.properties.code)),void 0!==b&&(this.options.coordsToLatLng=function(c){c=n.point(c[0],c[1]);return b.projection.unproject(c)}));this._callLevel++;try{n.GeoJSON.prototype.addData.call(this,e)}finally{this._callLevel--,0===this._callLevel&&delete this.options.coordsToLatLng}}});n.Proj.geoJson=function(e,b){return new n.Proj.GeoJSON(e,b)};n.Proj.ImageOverlay=n.ImageOverlay.extend({initialize:function(e,b,c){n.ImageOverlay.prototype.initialize.call(this,e,null,c);this._projectedBounds=b},_animateZoom:function(e){var b=this._map.getZoomScale(e.zoom),c=n.point(this._projectedBounds.min.x,this._projectedBounds.max.y);e=this._projectedToNewLayerPoint(c,e.zoom,e.center);n.DomUtil.setTransform(this._image,e,b)},_reset:function(){var e=this._map.getZoom(),b=this._map.getPixelOrigin(),e=n.bounds(this._transform(this._projectedBounds.min,e)._subtract(b),this._transform(this._projectedBounds.max,e)._subtract(b)),b=e.getSize();n.DomUtil.setPosition(this._image,e.min);this._image.style.width=b.x+"px";this._image.style.height=b.y+"px"},_projectedToNewLayerPoint:function(e,b,c){var d=this._map.getSize()._divideBy(2);c=this._map.project(c,b)._subtract(d)._round().add(this._map._getMapPanePos());return this._transform(e,b)._subtract(c)},_transform:function(e,b){var c=this._map.options.crs,d=c.transformation,c=c.scale(b);return d.transform(e,c)}});n.Proj.imageOverlay=function(e,b,c){return new n.Proj.ImageOverlay(e,b,c)};return n.Proj});L.TileLayer.ChinaProvider=L.TileLayer.extend({initialize:function(n,e){var h=L.TileLayer.ChinaProvider.providers,b=n.split("."),c=b[0],b=h[c][b[1]][b[2]];e.subdomains=h[c].Subdomains;L.TileLayer.prototype.initialize.call(this,b,e)}});L.TileLayer.ChinaProvider.providers={TianDiTu:{Normal:{Map:"http://t{s}.tianditu.cn/DataServer?T\x3dvec_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}",Annotion:"http://t{s}.tianditu.cn/DataServer?T\x3dcva_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}"},Satellite:{Map:"http://t{s}.tianditu.cn/DataServer?T\x3dimg_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}",Annotion:"http://t{s}.tianditu.cn/DataServer?T\x3dcia_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}"},Terrain:{Map:"http://t{s}.tianditu.cn/DataServer?T\x3dter_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}",Annotion:"http://t{s}.tianditu.cn/DataServer?T\x3dcta_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}"},Subdomains:"01234567".split("")},GaoDe:{Normal:{Map:"http://webrd0{s}.is.autonavi.com/appmaptile?lang\x3dzh_cn\x26size\x3d1\x26scale\x3d1\x26style\x3d8\x26x\x3d{x}\x26y\x3d{y}\x26z\x3d{z}"},Satellite:{Map:"http://webst0{s}.is.autonavi.com/appmaptile?style\x3d6\x26x\x3d{x}\x26y\x3d{y}\x26z\x3d{z}",Annotion:"http://webst0{s}.is.autonavi.com/appmaptile?style\x3d8\x26x\x3d{x}\x26y\x3d{y}\x26z\x3d{z}"},Subdomains:["1","2","3","4"]},Google:{Normal:{Map:"http://www.google.cn/maps/vt?lyrs\x3dm@189\x26gl\x3dcn\x26x\x3d{x}\x26y\x3d{y}\x26z\x3d{z}"},Satellite:{Map:"http://www.google.cn/maps/vt?lyrs\x3ds@189\x26gl\x3dcn\x26x\x3d{x}\x26y\x3d{y}\x26z\x3d{z}"},Subdomains:[]},Geoq:{Normal:{Map:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}",Color:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetColor/MapServer/tile/{z}/{y}/{x}",PurplishBlue:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}",Gray:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetGray/MapServer/tile/{z}/{y}/{x}",Warm:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetWarm/MapServer/tile/{z}/{y}/{x}",Cold:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetCold/MapServer/tile/{z}/{y}/{x}"},Subdomains:[]}};L.tileLayer.chinaProvider=function(n,e){return new L.TileLayer.ChinaProvider(n,e)};(function(n){var e;if("function"===typeof define&&define.amd)define(["leaflet"],n);else if("undefined"!==typeof module)e=require("leaflet"),module.exports=n(e);else{if("undefined"===typeof window.L)throw Error("Leaflet must be loaded first");n(window.L)}})(function(n){n.Circle.SECTIONS_COUNT=64;n.Circle.toPolygon=function(e,h,b){b=b||e._map;if(!b)throw Error("Can't figure out points without adding the feature to the map");var c=[],d=b.options.crs,a=2*Math.PI,k=0,g;d===n.CRS.EPSG3857?(g=b.latLngToLayerPoint.bind(b),d=b.layerPointToLatLng.bind(b),b=e._radius):(g=d.projection.project.bind(d.projection),d=d.projection.unproject.bind(d.projection),b=e._mRadius);e=g(e._latlng);h=h||n.Circle.SECTIONS_COUNT;for(var f=0;f<h;f++)k-=a/h,g=new n.Point(e.x+b*Math.cos(k),e.y+b*Math.sin(k)),0<f&&g.equals(c[f-1])||c.push(d(g));return c};n.Circle.prototype.toPolygon=function(e,h){return n.Circle.toPolygon(this,e,h||this._map)}});(function(n){var e;if("function"===typeof define&&define.amd)define(["leaflet"],n);else if("undefined"!==typeof module)e=require("leaflet"),module.exports=n(e);else{if("undefined"===typeof window.L)throw"Leaflet must be loaded first";n(window.L)}})(function(n){n.Polyline._flat=n.Polyline._flat||function(e){return!n.Util.isArray(e[0])||"object"!==typeof e[0][0]&&"undefined"!==typeof e[0][0]};n.GeometryUtil=n.extend(n.GeometryUtil||{},{distance:function(e,h,b){return e.latLngToLayerPoint(h).distanceTo(e.latLngToLayerPoint(b))},distanceSegment:function(e,h,b,c){h=e.latLngToLayerPoint(h);b=e.latLngToLayerPoint(b);e=e.latLngToLayerPoint(c);return n.LineUtil.pointToSegmentDistance(h,b,e)},readableDistance:function(e,h){var b;"imperial"!==h?b=1E3<e?(e/1E3).toFixed(2)+" km":Math.ceil(e)+" m":(e*=1.09361,b=1760<e?(e/1760).toFixed(2)+" miles":Math.ceil(e)+" yd");return b},belongsSegment:function(e,h,b,c){c=void 0===c?.2:c;var d=h.distanceTo(b);return(h.distanceTo(e)+e.distanceTo(b)-d)/d<c},length:function(e){e=n.GeometryUtil.accumulatedLengths(e);return 0<e.length?e[e.length-1]:0},accumulatedLengths:function(e){"function"==typeof e.getLatLngs&&(e=e.getLatLngs());if(0===e.length)return[];for(var h=0,b=[0],c=0,d=e.length-1;c<d;c++)h+=e[c].distanceTo(e[c+1]),b.push(h);return b},closestOnSegment:function(e,h,b,c){var d=e.getMaxZoom();Infinity===d&&(d=e.getZoom());h=e.project(h,d);b=e.project(b,d);c=e.project(c,d);c=n.LineUtil.closestPointOnSegment(h,b,c);return e.unproject(c,d)},closest:function(e,h,b,c){var d,a=Infinity,k=null,g;if(h instanceof Array){if(h[0]instanceof Array&&"number"!==typeof h[0][0]){for(g=0;g<h.length;g++){var f=n.GeometryUtil.closest(e,h[g],b,c);f.distance<a&&(a=f.distance,k=f)}return k}if(h[0]instanceof n.LatLng||"number"===typeof h[0][0]||"number"===typeof h[0].lat)h=n.polyline(h);else return k}if(!(h instanceof n.Polyline))return k;d=JSON.parse(JSON.stringify(h.getLatLngs().slice(0)));if(h instanceof n.Polygon){var l=function(a){if(n.Polyline._flat(a))a.push(a[0]);else for(var b=0;b<a.length;b++)l(a[b])};l(d)}if(n.Polyline._flat(d)){if(c){g=0;for(h=d.length;g<h;g++)f=d[g],c=n.GeometryUtil.distance(e,b,f),c<a&&(a=c,k=f,k.distance=c);return k}g=0;for(h=d.length;g<h-1;g++){var f=d[g],w=d[g+1];c=n.GeometryUtil.distanceSegment(e,b,f,w);c<=a&&(a=c,k=n.GeometryUtil.closestOnSegment(e,b,f,w),k.distance=c)}}else for(g=0;g<d.length;g++)f=n.GeometryUtil.closest(e,d[g],b,c),f.distance<a&&(a=f.distance,k=f);return k},closestLayer:function(e,h,b){for(var c=Infinity,d=null,a=null,k=Infinity,g=0,f=h.length;g<f;g++){var l=h[g];if(l instanceof n.LayerGroup)a=n.GeometryUtil.closestLayer(e,l.getLayers(),b),a.distance<c&&(c=a.distance,d=a);else{if("function"==typeof l.getLatLng)a=l.getLatLng(),k=n.GeometryUtil.distance(e,b,a);else if(a=n.GeometryUtil.closest(e,l,b))k=a.distance;k<c&&(c=k,d={layer:l,latlng:a,distance:k})}}return d},nClosestLayers:function(e,h,b,c){c="number"===typeof c?c:h.length;if(1>c||1>h.length)return null;for(var d=[],a,k,g=0,f=h.length;g<f;g++){var l=h[g];if(l instanceof n.LayerGroup)k=n.GeometryUtil.closestLayer(e,l.getLayers(),b),d.push(k);else{if("function"==typeof l.getLatLng)k=l.getLatLng(),a=n.GeometryUtil.distance(e,b,k);else if(k=n.GeometryUtil.closest(e,l,b))a=k.distance;d.push({layer:l,latlng:k,distance:a})}}d.sort(function(a,b){return a.distance-b.distance});return d.length>c?d.slice(0,c):d},layersWithin:function(e,h,b,c){c="number"==typeof c?c:Infinity;for(var d=[],a=null,k=0,g=0,f=h.length;g<f;g++){var l=h[g];if("function"==typeof l.getLatLng)a=l.getLatLng(),k=n.GeometryUtil.distance(e,b,a);else if(a=n.GeometryUtil.closest(e,l,b))k=a.distance;a&&k<c&&d.push({layer:l,latlng:a,distance:k})}return d.sort(function(a,b){return a.distance-b.distance})},closestLayerSnap:function(e,h,b,c,d){c="number"==typeof c?c:Infinity;d="boolean"==typeof d?d:!0;h=n.GeometryUtil.closestLayer(e,h,b);if(!h||h.distance>c)return null;d&&"function"==typeof h.layer.getLatLngs&&(d=n.GeometryUtil.closest(e,h.layer,h.latlng,!0),d.distance<c&&(h.latlng=d,h.distance=n.GeometryUtil.distance(e,d,b)));return h},interpolateOnPointSegment:function(e,h,b){return n.point(e.x*(1-b)+b*h.x,e.y*(1-b)+b*h.y)},interpolateOnLine:function(e,h,b){h=h instanceof n.Polyline?h.getLatLngs():h;var c=h.length;if(2>c)return null;b=Math.max(Math.min(b,1),0);if(0===b)return{latLng:h[0]instanceof n.LatLng?h[0]:n.latLng(h[0]),predecessor:-1};if(1==b)return{latLng:h[h.length-1]instanceof n.LatLng?h[h.length-1]:n.latLng(h[h.length-1]),predecessor:h.length-2};var d=e.getMaxZoom();Infinity===d&&(d=e.getZoom());for(var a=[],k=0,g=0;g<c;g++)a[g]=e.project(h[g],d),0<g&&(k+=a[g-1].distanceTo(a[g]));b*=k;var k=a[0],g=a[1],f=0,l=k.distanceTo(g);for(h=1;h<c&&l<b;h++)k=g,f=l,g=a[h],l+=k.distanceTo(g);c=n.GeometryUtil.interpolateOnPointSegment(k,g,0!==l-f?(b-f)/(l-f):0);return{latLng:e.unproject(c,d),predecessor:h-2}},locateOnLine:function(e,h,b){var c=h.getLatLngs();if(b.equals(c[0]))return 0;if(b.equals(c[c.length-1]))return 1;e=n.GeometryUtil.closest(e,h,b,!1);for(var d=n.GeometryUtil.accumulatedLengths(c),a=d[d.length-1],k=0,g=!1,f=0,l=c.length-1;f<l;f++){var w=c[f],m=c[f+1],k=d[f];if(n.GeometryUtil.belongsSegment(e,w,m)){k+=w.distanceTo(e);g=!0;break}}if(!g)throw"Could not interpolate "+b.toString()+" within "+h.toString();return k/a},reverse:function(e){return n.polyline(e.getLatLngs().slice(0).reverse())},extract:function(e,h,b,c){if(b>c)return n.GeometryUtil.extract(e,n.GeometryUtil.reverse(h),1-b,1-c);b=Math.max(Math.min(b,1),0);c=Math.max(Math.min(c,1),0);var d=h.getLatLngs(),a=n.GeometryUtil.interpolateOnLine(e,h,b),k=n.GeometryUtil.interpolateOnLine(e,h,c);if(b==c)return[n.GeometryUtil.interpolateOnLine(e,h,c).latLng];-1==a.predecessor&&(a.predecessor=0);-1==k.predecessor&&(k.predecessor=0);e=d.slice(a.predecessor+1,k.predecessor+1);e.unshift(a.latLng);e.push(k.latLng);return e},isBefore:function(e,h){if(!h)return!1;var b=e.getLatLngs(),c=h.getLatLngs();return b[b.length-1].equals(c[0])},isAfter:function(e,h){if(!h)return!1;var b=e.getLatLngs(),c=h.getLatLngs();return b[0].equals(c[c.length-1])},startsAtExtremity:function(e,h){if(!h)return!1;var b=e.getLatLngs(),c=h.getLatLngs(),b=b[0];return b.equals(c[0])||b.equals(c[c.length-1])},computeAngle:function(e,h){return 180*Math.atan2(h.y-e.y,h.x-e.x)/Math.PI},computeSlope:function(e,h){var b=(h.y-e.y)/(h.x-e.x);return{a:b,b:e.y-b*e.x}},rotatePoint:function(e,h,b,c){var d=e.getMaxZoom();Infinity===d&&(d=e.getZoom());b=b*Math.PI/180;h=e.project(h,d);c=e.project(c,d);return e.unproject(new n.Point(Math.cos(b)*(h.x-c.x)-Math.sin(b)*(h.y-c.y)+c.x,Math.sin(b)*(h.x-c.x)+Math.cos(b)*(h.y-c.y)+c.y),d)},bearing:function(e,h){var b=Math.PI/180,c=e.lat*b,d=h.lat*b,a=e.lng*b,b=h.lng*b,c=(180*Math.atan2(Math.sin(b-a)*Math.cos(d),Math.cos(c)*Math.sin(d)-Math.sin(c)*Math.cos(d)*Math.cos(b-a))/Math.PI+360)%360;return 180<=c?c-360:c},destination:function(e,h,b){var c=Math.PI/180,d=180/Math.PI,a=e.lat*c;h=(h+360)%360*c;var k=Math.sin(a),a=Math.cos(a),g=Math.cos(b/6378137),f=Math.sin(b/6378137);b=Math.asin(k*g+a*f*Math.cos(h));e=e.lng*c+Math.atan2(Math.sin(h)*f*a,g-k*Math.sin(b));e*=d;return n.latLng([b*d,180<e?e-360:-180>e?e+360:e])}});return n.GeometryUtil});(function(n){L.Icon.Pulse=L.DivIcon.extend({options:{className:"",iconSize:[12,12],color:"red",animate:!0,heartbeat:1},initialize:function(e){L.setOptions(this,e);var h="lpi-"+(new Date).getTime()+"-"+Math.round(1E5*Math.random()),b=["background-color: "+this.options.color],c=["box-shadow: 0 0 6px 2px "+this.options.color,"animation: pulsate "+this.options.heartbeat+"s ease-out","animation-iteration-count: infinite","animation-delay: 0s"];this.options.animate||(c.push("animation: none"),c.push("box-shadow:none"));b=["."+h+"{"+b.join(";")+";}","."+h+":after{"+c.join(";")+";}"].join("");c=document.createElement("style");c.styleSheet?c.styleSheet.cssText=b:c.appendChild(document.createTextNode(b));document.getElementsByTagName("head")[0].appendChild(c);this.options.className=this.options.className+" leaflet-pulsing-icon "+h;L.DivIcon.prototype.initialize.call(this,e)}});L.icon.pulse=function(e){return new L.Icon.Pulse(e)};L.Marker.Pulse=L.Marker.extend({initialize:function(e,h){h.icon=L.icon.pulse(h);L.Marker.prototype.initialize.call(this,e,h)}});L.marker.pulse=function(e,h){return new L.Marker.Pulse(e,h)}})(window);!function(n,e,h){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(b){L.Util.setOptions(this,b);this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction);this._featureGroup=L.featureGroup();this._featureGroup.addEventParent(this);this._nonPointGroup=L.featureGroup();this._nonPointGroup.addEventParent(this);this._inZoomAnimation=0;this._needsClustering=[];this._needsRemoving=[];this._currentShownBounds=null;this._queue=[];b=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,b?this._withAnimation:this._noAnimation);this._markerCluster=b?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(b){if(b instanceof L.LayerGroup)return this.addLayers([b]);if(!b.getLatLng)return this._nonPointGroup.addLayer(b),this;if(!this._map)return this._needsClustering.push(b),this;if(this.hasLayer(b))return this;this._unspiderfy&&this._unspiderfy();this._addLayer(b,this._maxZoom);this._topClusterLevel._recalculateBounds();this._refreshClustersIcons();var c=b,d=this._zoom;if(b.__parent)for(;c.__parent._zoom>=d;)c=c.__parent;return this._currentShownBounds.contains(c.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(b,c):this._animationAddLayerNonAnimated(b,c)),this},removeLayer:function(b){return b instanceof L.LayerGroup?this.removeLayers([b]):b.getLatLng?this._map?b.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(b)),this._removeLayer(b,!0),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),b.off("move",this._childMarkerMoved,this),this._featureGroup.hasLayer(b)&&(this._featureGroup.removeLayer(b),b.clusterShow&&b.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,b)&&this.hasLayer(b)&&this._needsRemoving.push(b),this):(this._nonPointGroup.removeLayer(b),this)},addLayers:function(b){if(!L.Util.isArray(b))return this.addLayer(b);var c,d=this._featureGroup,a=this._nonPointGroup,e=this.options.chunkedLoading,g=this.options.chunkInterval,f=this.options.chunkProgress,h=b.length,n=0,m=!0;if(this._map){var q=(new Date).getTime(),p=L.bind(function(){for(var r=(new Date).getTime();h>n&&!(e&&0===n%200&&(new Date).getTime()-r>g);n++)if(c=b[n],c instanceof L.LayerGroup)m&&(b=b.slice(),m=!1),this._extractNonGroupLayers(c,b),h=b.length;else if(c.getLatLng){if(!this.hasLayer(c)&&(this._addLayer(c,this._maxZoom),c.__parent&&2===c.__parent.getChildCount())){var u=c.__parent.getAllChildMarkers();d.removeLayer(u[0]===c?u[1]:u[0])}}else a.addLayer(c);f&&f(n,h,(new Date).getTime()-q);n===h?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(p,this.options.chunkDelay)},this);p()}else for(var r=this._needsClustering;h>n;n++)c=b[n],c instanceof L.LayerGroup?(m&&(b=b.slice(),m=!1),this._extractNonGroupLayers(c,b),h=b.length):c.getLatLng?this.hasLayer(c)||r.push(c):a.addLayer(c);return this},removeLayers:function(b){var c,d,a=b.length,e=this._featureGroup,g=this._nonPointGroup,f=!0;if(!this._map){for(c=0;a>c;c++)d=b[c],d instanceof L.LayerGroup?(f&&(b=b.slice(),f=!1),this._extractNonGroupLayers(d,b),a=b.length):(this._arraySplice(this._needsClustering,d),g.removeLayer(d),this.hasLayer(d)&&this._needsRemoving.push(d));return this}if(this._unspiderfy){this._unspiderfy();var h=b.slice(),n=a;for(c=0;n>c;c++)d=h[c],d instanceof L.LayerGroup?(this._extractNonGroupLayers(d,h),n=h.length):this._unspiderfyLayer(d)}for(c=0;a>c;c++)d=b[c],d instanceof L.LayerGroup?(f&&(b=b.slice(),f=!1),this._extractNonGroupLayers(d,b),a=b.length):d.__parent?(this._removeLayer(d,!0,!0),e.hasLayer(d)&&(e.removeLayer(d),d.clusterShow&&d.clusterShow())):g.removeLayer(d);return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(b){b.off("move",this._childMarkerMoved,this);delete b.__parent}),this._map&&this._generateInitialClusters(),this},getBounds:function(){var b=new L.LatLngBounds;this._topClusterLevel&&b.extend(this._topClusterLevel._bounds);for(var c=this._needsClustering.length-1;0<=c;c--)b.extend(this._needsClustering[c].getLatLng());return b.extend(this._nonPointGroup.getBounds()),b},eachLayer:function(b,c){var d,a=this._needsClustering.slice(),e=this._needsRemoving;this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(a);for(d=a.length-1;0<=d;d--)-1===e.indexOf(a[d])&&b.call(c,a[d]);this._nonPointGroup.eachLayer(b,c)},getLayers:function(){var b=[];return this.eachLayer(function(c){b.push(c)}),b},getLayer:function(b){var c=null;return b=parseInt(b,10),this.eachLayer(function(d){L.stamp(d)===b&&(c=d)}),c},hasLayer:function(b){if(!b)return!1;var c,d=this._needsClustering;for(c=d.length-1;0<=c;c--)if(d[c]===b)return!0;d=this._needsRemoving;for(c=d.length-1;0<=c;c--)if(d[c]===b)return!1;return!(!b.__parent||b.__parent._group!==this)||this._nonPointGroup.hasLayer(b)},zoomToShowLayer:function(b,c){"function"!=typeof c&&(c=function(){});var d=function(){!b._icon&&!b.__parent._icon||this._inZoomAnimation||(this._map.off("moveend",d,this),this.off("animationend",d,this),b._icon?c():b.__parent._icon&&(this.once("spiderfied",c,this),b.__parent.spiderfy()))};if(b._icon&&this._map.getBounds().contains(b.getLatLng()))c();else if(b.__parent._zoom<Math.round(this._map._zoom))this._map.on("moveend",d,this),this._map.panTo(b.getLatLng());else{var a=function(){this._map.off("movestart",a,this);a=null};this._map.on("movestart",a,this);this._map.on("moveend",d,this);this.on("animationend",d,this);b.__parent.zoomToBounds();a&&d.call(this)}},onAdd:function(b){this._map=b;var c,d;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";this._featureGroup.addTo(b);this._nonPointGroup.addTo(b);this._gridClusters||this._generateInitialClusters();this._maxLat=b.options.crs.projection.MAX_LATITUDE;b=0;for(c=this._needsRemoving.length;c>b;b++)d=this._needsRemoving[b],this._removeLayer(d,!0);this._needsRemoving=[];this._zoom=Math.round(this._map._zoom);this._currentShownBounds=this._getExpandedVisibleBounds();this._map.on("zoomend",this._zoomEnd,this);this._map.on("moveend",this._moveEnd,this);this._spiderfierOnAdd&&this._spiderfierOnAdd();this._bindEvents();c=this._needsClustering;this._needsClustering=[];this.addLayers(c)},onRemove:function(b){b.off("zoomend",this._zoomEnd,this);b.off("moveend",this._moveEnd,this);this._unbindEvents();this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","");this._spiderfierOnRemove&&this._spiderfierOnRemove();delete this._maxLat;this._hideCoverage();this._featureGroup.remove();this._nonPointGroup.remove();this._featureGroup.clearLayers();this._map=null},getVisibleParent:function(b){for(;b&&!b._icon;)b=b.__parent;return b||null},_arraySplice:function(b,c){for(var d=b.length-1;0<=d;d--)if(b[d]===c)return b.splice(d,1),!0},_removeFromGridUnclustered:function(b,c){for(var d=this._map,a=this._gridUnclustered;0<=c&&a[c].removeObject(b,d.project(b.getLatLng(),c));c--);},_childMarkerMoved:function(b){this._ignoreMove||(b.target._latlng=b.oldLatLng,this.removeLayer(b.target),b.target._latlng=b.latlng,this.addLayer(b.target))},_removeLayer:function(b,c,d){var a=this._gridClusters,e=this._gridUnclustered,g=this._featureGroup,f=this._map;c&&this._removeFromGridUnclustered(b,this._maxZoom);var h,n=b.__parent;for(this._arraySplice(n._markers,b);n&&(n._childCount--,n._boundsNeedUpdate=!0,!(0>n._zoom));)c&&1>=n._childCount?(h=n._markers[0]===b?n._markers[1]:n._markers[0],a[n._zoom].removeObject(n,f.project(n._cLatLng,n._zoom)),e[n._zoom].addObject(h,f.project(h.getLatLng(),n._zoom)),this._arraySplice(n.__parent._childClusters,n),n.__parent._markers.push(h),h.__parent=n.__parent,n._icon&&(g.removeLayer(n),d||g.addLayer(h))):n._iconNeedsUpdate=!0,n=n.__parent;delete b.__parent},_isOrIsParent:function(b,c){for(;c;){if(b===c)return!0;c=c.parentNode}return!1},fire:function(b,c,d){if(c&&c.layer instanceof L.MarkerCluster){if(c.originalEvent&&this._isOrIsParent(c.layer._icon,c.originalEvent.relatedTarget))return;b="cluster"+b}L.FeatureGroup.prototype.fire.call(this,b,c,d)},listens:function(b,c){return L.FeatureGroup.prototype.listens.call(this,b,c)||L.FeatureGroup.prototype.listens.call(this,"cluster"+b,c)},_defaultIconCreateFunction:function(b){b=b.getChildCount();var c=" marker-cluster-";return c+=10>b?"small":100>b?"medium":"large",new L.DivIcon({html:"\x3cdiv\x3e\x3cspan\x3e"+b+"\x3c/span\x3e\x3c/div\x3e",className:"marker-cluster"+c,iconSize:new L.Point(40,40)})},_bindEvents:function(){var b=this._map,c=this.options.showCoverageOnHover,d=this.options.zoomToBoundsOnClick;(this.options.spiderfyOnMaxZoom||d)&&this.on("clusterclick",this._zoomOrSpiderfy,this);c&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),b.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(b){for(var c=b.layer,d=c;1===d._childClusters.length;)d=d._childClusters[0];d._zoom===this._maxZoom&&d._childCount===c._childCount&&this.options.spiderfyOnMaxZoom?c.spiderfy():this.options.zoomToBoundsOnClick&&c.zoomToBounds();b.originalEvent&&13===b.originalEvent.keyCode&&this._map._container.focus()},_showCoverage:function(b){var c=this._map;this._inZoomAnimation||(this._shownPolygon&&c.removeLayer(this._shownPolygon),2<b.layer.getChildCount()&&b.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(b.layer.getConvexHull(),this.options.polygonOptions),c.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var b=this.options.showCoverageOnHover,c=this.options.zoomToBoundsOnClick,d=this._map;(this.options.spiderfyOnMaxZoom||c)&&this.off("clusterclick",this._zoomOrSpiderfy,this);b&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),d.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var b=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,b);this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),b);this._currentShownBounds=b}},_generateInitialClusters:function(){var b=this._map.getMaxZoom(),c=this.options.maxClusterRadius,d=c;"function"!=typeof c&&(d=function(){return c});this.options.disableClusteringAtZoom&&(b=this.options.disableClusteringAtZoom-1);this._maxZoom=b;this._gridClusters={};for(this._gridUnclustered={};0<=b;b--)this._gridClusters[b]=new L.DistanceGrid(d(b)),this._gridUnclustered[b]=new L.DistanceGrid(d(b));this._topClusterLevel=new this._markerCluster(this,-1)},_addLayer:function(b,c){var d,a,e=this._gridClusters;a=this._gridUnclustered;this.options.singleMarkerMode&&this._overrideMarkerIcon(b);for(b.on("move",this._childMarkerMoved,this);0<=c;c--){d=this._map.project(b.getLatLng(),c);var g=e[c].getNearObject(d);if(g)return g._addChild(b),b.__parent=g,void 0;if(g=a[c].getNearObject(d)){(d=g.__parent)&&this._removeLayer(g,!1);a=new this._markerCluster(this,c,g,b);e[c].addObject(a,this._map.project(a._cLatLng,c));g.__parent=a;var f=b.__parent=a;for(a=c-1;a>d._zoom;a--)f=new this._markerCluster(this,a,f),e[a].addObject(f,this._map.project(g.getLatLng(),a));return d._addChild(f),this._removeFromGridUnclustered(g,c),void 0}a[c].addObject(b,d)}this._topClusterLevel._addChild(b);b.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(b){b instanceof L.MarkerCluster&&b._iconNeedsUpdate&&b._updateIcon()})},_enqueue:function(b){this._queue.push(b);this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var b=0;b<this._queue.length;b++)this._queue[b].call(this);this._queue.length=0;clearTimeout(this._queueTimeout);this._queueTimeout=null},_mergeSplitClusters:function(){var b=Math.round(this._map._zoom);this._processQueue();this._zoom<b&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,b)):this._zoom>b?(this._animationStart(),this._animationZoomOut(this._zoom,b)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(b){var c=this._maxLat;return c!==h&&(b.getNorth()>=c&&(b._northEast.lat=1/0),b.getSouth()<=-c&&(b._southWest.lat=-1/0)),b},_animationAddLayerNonAnimated:function(b,c){if(c===b)this._featureGroup.addLayer(b);else if(2===c._childCount){c._addToMap();var d=c.getAllChildMarkers();this._featureGroup.removeLayer(d[0]);this._featureGroup.removeLayer(d[1])}else c._updateIcon()},_extractNonGroupLayers:function(b,c){var d,a=b.getLayers(),e=0;for(c=c||[];e<a.length;e++)d=a[e],d instanceof L.LayerGroup?this._extractNonGroupLayers(d,c):c.push(d);return c},_overrideMarkerIcon:function(b){return b.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[b]}})}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))});L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(b,c){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,b);this._topClusterLevel._recursivelyAddChildrenToMap(null,c,this._getExpandedVisibleBounds());this.fire("animationend")},_animationZoomOut:function(b,c){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,b);this._topClusterLevel._recursivelyAddChildrenToMap(null,c,this._getExpandedVisibleBounds());this.fire("animationend")},_animationAddLayer:function(b,c){this._animationAddLayerNonAnimated(b,c)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim";this._inZoomAnimation++},_animationZoomIn:function(b,c){var d,a=this._getExpandedVisibleBounds(),e=this._featureGroup;this._ignoreMove=!0;this._topClusterLevel._recursively(a,b,0,function(g){var f=g._latlng,h=g._markers;a.contains(f)||(f=null);g._isSingleParent()&&b+1===c?(e.removeLayer(g),g._recursivelyAddChildrenToMap(null,c,a)):(g.clusterHide(),g._recursivelyAddChildrenToMap(f,c,a));for(d=h.length-1;0<=d;d--)g=h[d],a.contains(g._latlng)||e.removeLayer(g)});this._forceLayout();this._topClusterLevel._recursivelyBecomeVisible(a,c);e.eachLayer(function(a){a instanceof L.MarkerCluster||!a._icon||a.clusterShow()});this._topClusterLevel._recursively(a,b,c,function(a){a._recursivelyRestoreChildPositions(c)});this._ignoreMove=!1;this._enqueue(function(){this._topClusterLevel._recursively(a,b,0,function(a){e.removeLayer(a);a.clusterShow()});this._animationEnd()})},_animationZoomOut:function(b,c){this._animationZoomOutSingle(this._topClusterLevel,b-1,c);this._topClusterLevel._recursivelyAddChildrenToMap(null,c,this._getExpandedVisibleBounds());this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,b,this._getExpandedVisibleBounds())},_animationAddLayer:function(b,c){var d=this,a=this._featureGroup;a.addLayer(b);c!==b&&(2<c._childCount?(c._updateIcon(),this._forceLayout(),this._animationStart(),b._setPos(this._map.latLngToLayerPoint(c.getLatLng())),b.clusterHide(),this._enqueue(function(){a.removeLayer(b);b.clusterShow();d._animationEnd()})):(this._forceLayout(),d._animationStart(),d._animationZoomOutSingle(c,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(b,c,d){var a=this._getExpandedVisibleBounds();b._recursivelyAnimateChildrenInAndAddSelfToMap(a,c+1,d);var e=this;this._forceLayout();b._recursivelyBecomeVisible(a,d);this._enqueue(function(){if(1===b._childCount){var g=b._markers[0];this._ignoreMove=!0;g.setLatLng(g.getLatLng());this._ignoreMove=!1;g.clusterShow&&g.clusterShow()}else b._recursively(a,d,0,function(b){b._recursivelyRemoveChildrenFromMap(a,c+1)});e._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""));this._inZoomAnimation--;this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(e.body.offsetWidth)}});L.markerClusterGroup=function(b){return new L.MarkerClusterGroup(b)};L.MarkerCluster=L.Marker.extend({initialize:function(b,c,d,a){L.Marker.prototype.initialize.call(this,d?d._cLatLng||d.getLatLng():new L.LatLng(0,0),{icon:this});this._group=b;this._zoom=c;this._markers=[];this._childClusters=[];this._childCount=0;this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._bounds=new L.LatLngBounds;d&&this._addChild(d);a&&this._addChild(a)},getAllChildMarkers:function(b){b=b||[];for(var c=this._childClusters.length-1;0<=c;c--)this._childClusters[c].getAllChildMarkers(b);for(c=this._markers.length-1;0<=c;c--)b.push(this._markers[c]);return b},getChildCount:function(){return this._childCount},zoomToBounds:function(){var b,c=this._childClusters.slice();b=this._group._map;for(var d=b.getBoundsZoom(this._bounds),a=this._zoom+1,e=b.getZoom();0<c.length&&d>a;){a++;var g=[];for(b=0;b<c.length;b++)g=g.concat(c[b]._childClusters);c=g}d>a?this._group._map.setView(this._latlng,a):e>=d?this._group._map.setView(this._latlng,e+1):this._group._map.fitBounds(this._bounds)},getBounds:function(){var b=new L.LatLngBounds;return b.extend(this._bounds),b},_updateIcon:function(){this._iconNeedsUpdate=!0;this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(b,c){this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._setClusterCenter(b);b instanceof L.MarkerCluster?(c||(this._childClusters.push(b),b.__parent=this),this._childCount+=b._childCount):(c||this._markers.push(b),this._childCount++);this.__parent&&this.__parent._addChild(b,!0)},_setClusterCenter:function(b){this._cLatLng||(this._cLatLng=b._cLatLng||b._latlng)},_resetBounds:function(){var b=this._bounds;b._southWest&&(b._southWest.lat=1/0,b._southWest.lng=1/0);b._northEast&&(b._northEast.lat=-1/0,b._northEast.lng=-1/0)},_recalculateBounds:function(){var b,c,d;c=this._markers;var a=this._childClusters,e=0,g=0,f=this._childCount;if(0!==f){this._resetBounds();for(b=0;b<c.length;b++)d=c[b]._latlng,this._bounds.extend(d),e+=d.lat,g+=d.lng;for(b=0;b<a.length;b++)c=a[b],c._boundsNeedUpdate&&c._recalculateBounds(),this._bounds.extend(c._bounds),d=c._wLatLng,c=c._childCount,e+=d.lat*c,g+=d.lng*c;this._latlng=this._wLatLng=new L.LatLng(e/f,g/f);this._boundsNeedUpdate=!1}},_addToMap:function(b){b&&(this._backupLatlng=this._latlng,this.setLatLng(b));this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(b,c,d){this._recursively(b,0,d-1,function(a){var b,d=a._markers;for(a=d.length-1;0<=a;a--)b=d[a],b._icon&&(b._setPos(c),b.clusterHide())},function(a){var b,d=a._childClusters;for(a=d.length-1;0<=a;a--)b=d[a],b._icon&&(b._setPos(c),b.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(b,c,d){this._recursively(b,d,0,function(a){a._recursivelyAnimateChildrenIn(b,a._group._map.latLngToLayerPoint(a.getLatLng()).round(),c);a._isSingleParent()&&c-1===d?(a.clusterShow(),a._recursivelyRemoveChildrenFromMap(b,c)):a.clusterHide();a._addToMap()})},_recursivelyBecomeVisible:function(b,c){this._recursively(b,0,c,null,function(b){b.clusterShow()})},_recursivelyAddChildrenToMap:function(b,c,d){this._recursively(d,-1,c,function(a){if(c!==a._zoom)for(var e=a._markers.length-1;0<=e;e--){var g=a._markers[e];d.contains(g._latlng)&&(b&&(g._backupLatlng=g.getLatLng(),g.setLatLng(b),g.clusterHide&&g.clusterHide()),a._group._featureGroup.addLayer(g))}},function(a){a._addToMap(b)})},_recursivelyRestoreChildPositions:function(b){for(var c=this._markers.length-1;0<=c;c--){var d=this._markers[c];d._backupLatlng&&(d.setLatLng(d._backupLatlng),delete d._backupLatlng)}if(b-1===this._zoom)for(b=this._childClusters.length-1;0<=b;b--)this._childClusters[b]._restorePosition();else for(c=this._childClusters.length-1;0<=c;c--)this._childClusters[c]._recursivelyRestoreChildPositions(b)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(b,c,d){var a,e;this._recursively(b,-1,c-1,function(b){for(e=b._markers.length-1;0<=e;e--)a=b._markers[e],d&&d.contains(a._latlng)||(b._group._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow())},function(b){for(e=b._childClusters.length-1;0<=e;e--)a=b._childClusters[e],d&&d.contains(a._latlng)||(b._group._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow())})},_recursively:function(b,c,d,a,e){var g,f,h=this._childClusters;g=this._zoom;if(g>=c&&(a&&a(this),e&&g===d&&e(this)),c>g||d>g)for(g=h.length-1;0<=g;g--)f=h[g],b.intersects(f._bounds)&&f._recursively(b,c,d,a,e)},_isSingleParent:function(){return 0<this._childClusters.length&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){return this.options.opacityWhenUnclustered=this.options.opacity||1,this.setOpacity(0)},clusterShow:function(){var b=this.setOpacity(this.options.opacity||this.options.opacityWhenUnclustered);return delete this.options.opacityWhenUnclustered,b}});L.DistanceGrid=function(b){this._cellSize=b;this._sqCellSize=b*b;this._grid={};this._objectPoint={}};L.DistanceGrid.prototype={addObject:function(b,c){var d=this._getCoord(c.x),a=this._getCoord(c.y),e=this._grid,a=e[a]=e[a]||{},d=a[d]=a[d]||[],a=L.Util.stamp(b);this._objectPoint[a]=c;d.push(b)},updateObject:function(b,c){this.removeObject(b);this.addObject(b,c)},removeObject:function(b,c){var d,a,e=this._getCoord(c.x);d=this._getCoord(c.y);a=this._grid;var g=a[d]=a[d]||{},f=g[e]=g[e]||[];delete this._objectPoint[L.Util.stamp(b)];d=0;for(a=f.length;a>d;d++)if(f[d]===b)return f.splice(d,1),1===a&&delete g[e],!0},eachObject:function(b,c){var d,a,e,g,f,h,n,m=this._grid;for(d in m)for(a in f=m[d],f)for(h=f[a],e=0,g=h.length;g>e;e++)(n=b.call(c,h[e]))&&(e--,g--)},getNearObject:function(b){var c,d,a,e,g,f,h,n,m=this._getCoord(b.x),q=this._getCoord(b.y),p=this._objectPoint,r=this._sqCellSize,t=null;for(c=q-1;q+1>=c;c++)if(e=this._grid[c])for(d=m-1;m+1>=d;d++)if(g=e[d])for(a=0,f=g.length;f>a;a++)h=g[a],n=this._sqDist(p[L.Util.stamp(h)],b),r>n&&(r=n,t=h);return t},_getCoord:function(b){return Math.floor(b/this._cellSize)},_sqDist:function(b,c){var d=c.x-b.x,a=c.y-b.y;return d*d+a*a}};(function(){L.QuickHull={getDistant:function(b,c){return(c[0].lng-c[1].lng)*(b.lat-c[0].lat)+(c[1].lat-c[0].lat)*(b.lng-c[0].lng)},findMostDistantPointFromBaseLine:function(b,c){var d,a,e,g=0,f=null,h=[];for(d=c.length-1;0<=d;d--)a=c[d],e=this.getDistant(a,b),0<e&&(h.push(a),e>g&&(g=e,f=a));return{maxPoint:f,newPoints:h}},buildConvexHull:function(b,c){var d=[],a=this.findMostDistantPointFromBaseLine(b,c);return a.maxPoint?(d=d.concat(this.buildConvexHull([b[0],a.maxPoint],a.newPoints)),d.concat(this.buildConvexHull([a.maxPoint,b[1]],a.newPoints))):[b[0]]},getConvexHull:function(b){var c,d=!1,a=!1,e=!1,g=!1,f=null,h=null,n=null,m=null,q=null,p=null;for(c=b.length-1;0<=c;c--){var r=b[c];(!1===d||r.lat>d)&&(f=r,d=r.lat);(!1===a||r.lat<a)&&(h=r,a=r.lat);(!1===e||r.lng>e)&&(n=r,e=r.lng);(!1===g||r.lng<g)&&(m=r,g=r.lng)}a!==d?(p=h,q=f):(p=m,q=n);return[].concat(this.buildConvexHull([p,q],b),this.buildConvexHull([q,p],b))}}})();L.MarkerCluster.include({getConvexHull:function(){var b,c,d=this.getAllChildMarkers(),a=[];for(c=d.length-1;0<=c;c--)b=d[c].getLatLng(),a.push(b);return L.QuickHull.getConvexHull(a)}});L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var b,c=this.getAllChildMarkers(),d=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy();this._group._spiderfied=this;c.length>=this._circleSpiralSwitchover?b=this._generatePointsSpiral(c.length,d):(d.y+=10,b=this._generatePointsCircle(c.length,d));this._animationSpiderfy(c,b)}},unspiderfy:function(b){this._group._inZoomAnimation||(this._animationUnspiderfy(b),this._group._spiderfied=null)},_generatePointsCircle:function(b,c){var d,a,e=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+b)/this._2PI,g=this._2PI/b,f=[];f.length=b;for(d=b-1;0<=d;d--)a=this._circleStartAngle+d*g,f[d]=(new L.Point(c.x+e*Math.cos(a),c.y+e*Math.sin(a)))._round();return f},_generatePointsSpiral:function(b,c){var d;d=this._group.options.spiderfyDistanceMultiplier;var a=d*this._spiralLengthStart,e=d*this._spiralFootSeparation,g=d*this._spiralLengthFactor*this._2PI,f=0,h=[];h.length=b;for(d=b-1;0<=d;d--)f+=e/a+5E-4*d,h[d]=(new L.Point(c.x+a*Math.cos(f),c.y+a*Math.sin(f)))._round(),a+=g/f;return h},_noanimationUnspiderfy:function(){var b,c,d=this._group,a=d._map,e=d._featureGroup,g=this.getAllChildMarkers();d._ignoreMove=!0;this.setOpacity(1);for(c=g.length-1;0<=c;c--)b=g[c],e.removeLayer(b),b._preSpiderfyLatlng&&(b.setLatLng(b._preSpiderfyLatlng),delete b._preSpiderfyLatlng),b.setZIndexOffset&&b.setZIndexOffset(0),b._spiderLeg&&(a.removeLayer(b._spiderLeg),delete b._spiderLeg);d.fire("unspiderfied",{cluster:this,markers:g});d._ignoreMove=!1;d._spiderfied=null}});L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(b,c){var d,a,e,g,f=this._group,h=f._map,n=f._featureGroup,m=this._group.options.spiderLegPolylineOptions;f._ignoreMove=!0;for(d=0;d<b.length;d++)g=h.layerPointToLatLng(c[d]),a=b[d],e=new L.Polyline([this._latlng,g],m),h.addLayer(e),a._spiderLeg=e,a._preSpiderfyLatlng=a._latlng,a.setLatLng(g),a.setZIndexOffset&&a.setZIndexOffset(1E6),n.addLayer(a);this.setOpacity(.3);f._ignoreMove=!1;f.fire("spiderfied",{cluster:this,markers:b})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}});L.MarkerCluster.include({_animationSpiderfy:function(b,c){var d,a,e,g,f,l,n=this,m=this._group,q=m._map,p=m._featureGroup,r=this._latlng,t=q.latLngToLayerPoint(r),u=L.Path.SVG,v=L.extend({},this._group.options.spiderLegPolylineOptions),x=v.opacity;x===h&&(x=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity);u?(v.opacity=0,v.className=(v.className||"")+" leaflet-cluster-spider-leg"):v.opacity=x;m._ignoreMove=!0;for(d=0;d<b.length;d++)a=b[d],l=q.layerPointToLatLng(c[d]),e=new L.Polyline([r,l],v),q.addLayer(e),a._spiderLeg=e,u&&(g=e._path,f=g.getTotalLength()+.1,g.style.strokeDasharray=f,g.style.strokeDashoffset=f),a.setZIndexOffset&&a.setZIndexOffset(1E6),a.clusterHide&&a.clusterHide(),p.addLayer(a),a._setPos&&a._setPos(t);m._forceLayout();m._animationStart();for(d=b.length-1;0<=d;d--)l=q.layerPointToLatLng(c[d]),a=b[d],a._preSpiderfyLatlng=a._latlng,a.setLatLng(l),a.clusterShow&&a.clusterShow(),u&&(e=a._spiderLeg,g=e._path,g.style.strokeDashoffset=0,e.setStyle({opacity:x}));this.setOpacity(.3);m._ignoreMove=!1;setTimeout(function(){m._animationEnd();m.fire("spiderfied",{cluster:n,markers:b})},200)},_animationUnspiderfy:function(b){var c,d,a,e,g,f,h=this,n=this._group,m=n._map,q=n._featureGroup;b=b?m._latLngToNewLayerPoint(this._latlng,b.zoom,b.center):m.latLngToLayerPoint(this._latlng);var p=this.getAllChildMarkers(),r=L.Path.SVG;n._ignoreMove=!0;n._animationStart();this.setOpacity(1);for(d=p.length-1;0<=d;d--)c=p[d],c._preSpiderfyLatlng&&(c.setLatLng(c._preSpiderfyLatlng),delete c._preSpiderfyLatlng,f=!0,c._setPos&&(c._setPos(b),f=!1),c.clusterHide&&(c.clusterHide(),f=!1),f&&q.removeLayer(c),r&&(a=c._spiderLeg,e=a._path,g=e.getTotalLength()+.1,e.style.strokeDashoffset=g,a.setStyle({opacity:0})));n._ignoreMove=!1;setTimeout(function(){var a=0;for(d=p.length-1;0<=d;d--)c=p[d],c._spiderLeg&&a++;for(d=p.length-1;0<=d;d--)c=p[d],c._spiderLeg&&(c.clusterShow&&c.clusterShow(),c.setZIndexOffset&&c.setZIndexOffset(0),1<a&&q.removeLayer(c),m.removeLayer(c._spiderLeg),delete c._spiderLeg);n._animationEnd();n.fire("unspiderfied",{cluster:h,markers:p})},200)}});L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this);this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this);this._map.on("zoomend",this._noanimationUnspiderfy,this);L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this);this._map.off("zoomstart",this._unspiderfyZoomStart,this);this._map.off("zoomanim",this._unspiderfyZoomAnim,this);this._map.off("zoomend",this._noanimationUnspiderfy,this);this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(b){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(b))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(b){this._spiderfied&&this._spiderfied.unspiderfy(b)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(b){b._spiderLeg&&(this._featureGroup.removeLayer(b),b.clusterShow&&b.clusterShow(),b.setZIndexOffset&&b.setZIndexOffset(0),this._map.removeLayer(b._spiderLeg),delete b._spiderLeg)}});L.MarkerClusterGroup.include({refreshClusters:function(b){return b?b instanceof L.MarkerClusterGroup?b=b._topClusterLevel.getAllChildMarkers():b instanceof L.LayerGroup?b=b._layers:b instanceof L.MarkerCluster?b=b.getAllChildMarkers():b instanceof L.Marker&&(b=[b]):b=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(b),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(b),this},_flagParentsIconsNeedUpdate:function(b){var c,d;for(c in b)for(d=b[c].__parent;d;)d._iconNeedsUpdate=!0,d=d.__parent},_refreshSingleMarkerModeMarkers:function(b){var c,d;for(c in b)d=b[c],this.hasLayer(d)&&d.setIcon(this._overrideMarkerIcon(d))}});L.Marker.include({refreshIconOptions:function(b,c){var d=this.options.icon;return L.setOptions(d,b),this.setIcon(d),c&&this.__parent&&this.__parent._group.refreshClusters(this),this}})}(window,document);!function(){function n(e){return this instanceof n?(this._canvas=e="string"==typeof e?document.getElementById(e):e,this._ctx=e.getContext("2d"),this._width=e.width,this._height=e.height,this._max=1,void this.clear()):new n(e)}n.prototype={defaultRadius:12,defaultGradient:{"0.4":"blue","0.6":"cyan","0.7":"lime","0.8":"yellow",1:"red"},data:function(e,h){return this._data=e,this},max:function(e){return this._max=e,this},add:function(e){return this._data.push(e),this},clear:function(){return this._data=[],this},radius:function(e,h){h=h||15;var b=this._circle=document.createElement("canvas"),c=b.getContext("2d"),d=this._r=e+h;return b.width=b.height=2*d,c.shadowOffsetX=c.shadowOffsetY=200,c.shadowBlur=h,c.shadowColor="black",c.beginPath(),c.arc(d-200,d-200,e,0,2*Math.PI,!0),c.closePath(),c.fill(),this},gradient:function(e){var h=document.createElement("canvas"),b=h.getContext("2d"),c=b.createLinearGradient(0,0,0,256);h.width=1;h.height=256;for(var d in e)c.addColorStop(d,e[d]);return b.fillStyle=c,b.fillRect(0,0,1,256),this._grad=b.getImageData(0,0,1,256).data,this},draw:function(e){this._circle||this.radius(this.defaultRadius);this._grad||this.gradient(this.defaultGradient);var h=this._ctx;h.clearRect(0,0,this._width,this._height);for(var b,c=0,d=this._data.length;d>c;c++)b=this._data[c],h.globalAlpha=Math.max(b[2]/this._max,e||.05),h.drawImage(this._circle,b[0]-this._r,b[1]-this._r);e=h.getImageData(0,0,this._width,this._height);return this._colorize(e.data,this._grad),h.putImageData(e,0,0),this},_colorize:function(e,h){for(var b,c=3,d=e.length;d>c;c+=4)(b=4*e[c])&&(e[c-3]=h[b],e[c-2]=h[b+1],e[c-1]=h[b+2])}};window.simpleheat=n}();L.HeatLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(n,e){this._latlngs=n;L.setOptions(this,e)},setLatLngs:function(n){this._latlngs=n;return this.redraw()},addLatLng:function(n){this._latlngs.push(n);return this.redraw()},setOptions:function(n){L.setOptions(this,n);this._heat&&this._updateOptions();return this.redraw()},redraw:function(){this._heat&&!this._frame&&this._map&&!this._map._animating&&(this._frame=L.Util.requestAnimFrame(this._redraw,this));return this},onAdd:function(n){this._map=n;this._canvas||this._initCanvas();this.options.pane?this.getPane().appendChild(this._canvas):n._panes.overlayPane.appendChild(this._canvas);n.on("moveend",this._reset,this);if(n.options.zoomAnimation&&L.Browser.any3d)n.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(n){this.options.pane?this.getPane().removeChild(this._canvas):n.getPanes().overlayPane.removeChild(this._canvas);n.off("moveend",this._reset,this);n.options.zoomAnimation&&n.off("zoomanim",this._animateZoom,this)},addTo:function(n){n.addLayer(this);return this},_initCanvas:function(){var n=this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer leaflet-layer"),e=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);n.style[e]="50% 50%";e=this._map.getSize();n.width=e.x;n.height=e.y;L.DomUtil.addClass(n,"leaflet-zoom-"+(this._map.options.zoomAnimation&&L.Browser.any3d?"animated":"hide"));this._heat=simpleheat(n);this._updateOptions()},_updateOptions:function(){this._heat.radius(this.options.radius||this._heat.defaultRadius,this.options.blur);this.options.gradient&&this._heat.gradient(this.options.gradient);this.options.max&&this._heat.max(this.options.max)},_reset:function(){var n=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,n);n=this._map.getSize();this._heat._width!==n.x&&(this._canvas.width=this._heat._width=n.x);this._heat._height!==n.y&&(this._canvas.height=this._heat._height=n.y);this._redraw()},_redraw:function(){if(this._map){var n=[],e=this._heat._r,h=this._map.getSize(),b=new L.Bounds(L.point([-e,-e]),h.add([e,e])),h=void 0===this.options.max?1:this.options.max,c=void 0===this.options.maxZoom?this._map.getMaxZoom():this.options.maxZoom,c=1/Math.pow(2,Math.max(0,Math.min(c-this._map.getZoom(),12))),d=e/2,e=[],a=this._map._getMapPanePos(),k=a.x%d,g=a.y%d,f,l,w,m,q,p,a=0;for(f=this._latlngs.length;a<f;a++)l=this._map.latLngToContainerPoint(this._latlngs[a]),b.contains(l)&&(m=Math.floor((l.x-k)/d)+2,q=Math.floor((l.y-g)/d)+2,p=(void 0!==this._latlngs[a].alt?this._latlngs[a].alt:void 0!==this._latlngs[a][2]?+this._latlngs[a][2]:1)*c,e[q]=e[q]||[],(w=e[q][m])?(w[0]=(w[0]*w[2]+l.x*p)/(w[2]+p),w[1]=(w[1]*w[2]+l.y*p)/(w[2]+p),w[2]+=p):e[q][m]=[l.x,l.y,p]);a=0;for(f=e.length;a<f;a++)if(e[a])for(b=0,c=e[a].length;b<c;b++)(w=e[a][b])&&n.push([Math.round(w[0]),Math.round(w[1]),Math.min(w[2],h)]);this._heat.data(n).draw(this.options.minOpacity);this._frame=null}},_animateZoom:function(n){var e=this._map.getZoomScale(n.zoom);n=this._map._getCenterOffset(n.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,n,e):this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(n)+" scale("+e+")"}});L.heatLayer=function(n,e){return new L.HeatLayer(n,e)};