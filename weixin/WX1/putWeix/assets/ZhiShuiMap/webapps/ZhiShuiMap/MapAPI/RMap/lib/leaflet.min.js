///<jscompress sourcefile="leaflet-src.js" />
/*
 Leaflet 1.0.3+ed36a04, a JS library for interactive maps. http://leafletjs.com
 (c) 2010-2016 Vladimir Agafonkin, (c) 2010-2011 CloudMade
*////<jscompress sourcefile="leaflet.draw-src.js" />
/*
 Leaflet.draw 0.4.9, a plugin that adds drawing and editing tools to Leaflet powered maps.
 (c) 2012-2017, Jacob Toye, Jon West, Smartrak, Leaflet

 https://github.com/Leaflet/Leaflet.draw
 http://leafletjs.com
 *////<jscompress sourcefile="esri-leaflet-debug.js" />
/* esri-leaflet - v2.0.8 - Tue Mar 21 2017 16:09:38 GMT-0700 (PDT)
 * Copyright (c) 2017 Environmental Systems Research Institute, Inc.
 * Apache-2.0 *////<jscompress sourcefile="leaflet.circle.topolygon-src.js" />
/**
 * @preserve Licensed under MIT License
 *//*
 Licensed under MIT License
*/
(function(n,e,k){function b(){var a=n.L;c.noConflict=function(){n.L=a;return this};n.L=c}var c={version:"1.0.3+ed36a04"};"object"===typeof module&&"object"===typeof module.exports?module.exports=c:"function"===typeof define&&define.amd&&define(c);"undefined"!==typeof n&&b();c.Util={extend:function(a){var d,c,b,l;c=1;for(b=arguments.length;c<b;c++)for(d in l=arguments[c],l)a[d]=l[d];return a},create:Object.create||function(){function a(){}return function(d){a.prototype=d;return new a}}(),bind:function(a,d){var c=Array.prototype.slice;if(a.bind)return a.bind.apply(a,c.call(arguments,1));var b=c.call(arguments,2);return function(){return a.apply(d,b.length?b.concat(c.call(arguments)):arguments)}},stamp:function(a){a._leaflet_id=a._leaflet_id||++c.Util.lastId;return a._leaflet_id},lastId:0,throttle:function(a,d,c){var b,l,h,m;m=function(){b=!1;l&&(h.apply(c,l),l=!1)};return h=function(){b?l=arguments:(a.apply(c,arguments),setTimeout(m,d),b=!0)}},wrapNum:function(a,c,f){var b=c[1];c=c[0];var l=b-c;return a===b&&f?a:((a-c)%l+l)%l+c},falseFn:function(){return!1},formatNum:function(a,c){var f=Math.pow(10,c||5);return Math.round(a*f)/f},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return c.Util.trim(a).split(/\s+/)},setOptions:function(a,d){a.hasOwnProperty("options")||(a.options=a.options?c.Util.create(a.options):{});for(var f in d)a.options[f]=d[f];return a.options},getParamString:function(a,c,f){var b=[],l;for(l in a)b.push(encodeURIComponent(f?l.toUpperCase():l)+"\x3d"+encodeURIComponent(a[l]));return(c&&-1!==c.indexOf("?")?"\x26":"?")+b.join("\x26")},template:function(a,d){return a.replace(c.Util.templateRe,function(a,c){var b=d[c];if(b===k)throw Error("No value provided for variable "+a);"function"===typeof b&&(b=b(d));return b})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},indexOf:function(a,c){for(var f=0;f<a.length;f++)if(a[f]===c)return f;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d"};(function(){function a(a){return n["webkit"+a]||n["moz"+a]||n["ms"+a]}function d(a){var c=+new Date,d=Math.max(0,16-(c-f));f=c+d;return n.setTimeout(a,d)}var f=0,b=n.requestAnimationFrame||a("RequestAnimationFrame")||d,l=n.cancelAnimationFrame||a("CancelAnimationFrame")||a("CancelRequestAnimationFrame")||function(a){n.clearTimeout(a)};c.Util.requestAnimFrame=function(a,f,l){if(l&&b===d)a.call(f);else return b.call(n,c.bind(a,f))};c.Util.cancelAnimFrame=function(a){a&&l.call(n,a)}})();c.extend=c.Util.extend;c.bind=c.Util.bind;c.stamp=c.Util.stamp;c.setOptions=c.Util.setOptions;c.Class=function(){};c.Class.extend=function(a){var d=function(){this.initialize&&this.initialize.apply(this,arguments);this.callInitHooks()},f=d.__super__=this.prototype,b=c.Util.create(f);b.constructor=d;d.prototype=b;for(var l in this)this.hasOwnProperty(l)&&"prototype"!==l&&(d[l]=this[l]);a.statics&&(c.extend(d,a.statics),delete a.statics);a.includes&&(c.Util.extend.apply(null,[b].concat(a.includes)),delete a.includes);b.options&&(a.options=c.Util.extend(c.Util.create(b.options),a.options));c.extend(b,a);b._initHooks=[];b.callInitHooks=function(){if(!this._initHooksCalled){f.callInitHooks&&f.callInitHooks.call(this);this._initHooksCalled=!0;for(var a=0,c=b._initHooks.length;a<c;a++)b._initHooks[a].call(this)}};return d};c.Class.include=function(a){c.extend(this.prototype,a);return this};c.Class.mergeOptions=function(a){c.extend(this.prototype.options,a);return this};c.Class.addInitHook=function(a){var c=Array.prototype.slice.call(arguments,1);this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push("function"===typeof a?a:function(){this[a].apply(this,c)});return this};c.Evented=c.Class.extend({on:function(a,d,f){if("object"===typeof a)for(var b in a)this._on(b,a[b],d);else{a=c.Util.splitWords(a);b=0;for(var l=a.length;b<l;b++)this._on(a[b],d,f)}return this},off:function(a,d,f){if(a)if("object"===typeof a)for(var b in a)this._off(b,a[b],d);else{a=c.Util.splitWords(a);b=0;for(var l=a.length;b<l;b++)this._off(a[b],d,f)}else delete this._events;return this},_on:function(a,c,f){this._events=this._events||{};var b=this._events[a];b||(b=[],this._events[a]=b);f===this&&(f=k);a={fn:c,ctx:f};for(var l=0,h=b.length;l<h;l++)if(b[l].fn===c&&b[l].ctx===f)return;b.push(a)},_off:function(a,d,f){var b,l,h;if(this._events&&(b=this._events[a]))if(d){if(f===this&&(f=k),b)for(l=0,h=b.length;l<h;l++){var m=b[l];if(m.ctx===f&&m.fn===d){m.fn=c.Util.falseFn;this._firingCount&&(this._events[a]=b=b.slice());b.splice(l,1);break}}}else{l=0;for(h=b.length;l<h;l++)b[l].fn=c.Util.falseFn;delete this._events[a]}},fire:function(a,d,f){if(!this.listens(a,f))return this;d=c.Util.extend({},d,{type:a,target:this});if(this._events&&(a=this._events[a])){this._firingCount=this._firingCount+1||1;for(var b=0,l=a.length;b<l;b++){var h=a[b];h.fn.call(h.ctx||this,d)}this._firingCount--}f&&this._propagateEvent(d);return this},listens:function(a,c){var f=this._events&&this._events[a];if(f&&f.length)return!0;if(c)for(var b in this._eventParents)if(this._eventParents[b].listens(a,c))return!0;return!1},once:function(a,d,f){if("object"===typeof a){for(var b in a)this.once(b,a[b],d);return this}var l=c.bind(function(){this.off(a,d,f).off(a,l,f)},this);return this.on(a,d,f).on(a,l,f)},addEventParent:function(a){this._eventParents=this._eventParents||{};this._eventParents[c.stamp(a)]=a;return this},removeEventParent:function(a){this._eventParents&&delete this._eventParents[c.stamp(a)];return this},_propagateEvent:function(a){for(var d in this._eventParents)this._eventParents[d].fire(a.type,c.extend({layer:a.target},a),!0)}});var h=c.Evented.prototype;h.addEventListener=h.on;h.removeEventListener=h.clearAllEventListeners=h.off;h.addOneTimeEventListener=h.once;h.fireEvent=h.fire;h.hasEventListeners=h.listens;c.Mixin={Events:h};(function(){var a=navigator.userAgent.toLowerCase(),d=e.documentElement,f="ActiveXObject"in n,b=-1!==a.indexOf("webkit"),l=-1!==a.indexOf("phantom"),h=-1!==a.search("android [23]"),m=-1!==a.indexOf("chrome"),k=-1!==a.indexOf("gecko")&&!b&&!n.opera&&!f,p=0===navigator.platform.indexOf("Win"),q="undefined"!==typeof orientation||-1!==a.indexOf("mobile"),r=!n.PointerEvent&&n.MSPointerEvent,t=n.PointerEvent||r,v=f&&"transition"in d.style,w="WebKitCSSMatrix"in n&&"m11"in new n.WebKitCSSMatrix&&!h,x="MozPerspective"in d.style,d="OTransition"in d.style,z=!n.L_NO_TOUCH&&(t||"ontouchstart"in n||n.DocumentTouch&&e instanceof n.DocumentTouch);c.Browser={ie:f,ielt9:f&&!e.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in e),webkit:b,gecko:k,android:-1!==a.indexOf("android"),android23:h,chrome:m,safari:!m&&-1!==a.indexOf("safari"),win:p,ie3d:v,webkit3d:w,gecko3d:x,opera12:d,any3d:!n.L_DISABLE_3D&&(v||w||x)&&!d&&!l,mobile:q,mobileWebkit:q&&b,mobileWebkit3d:q&&w,mobileOpera:q&&n.opera,mobileGecko:q&&k,touch:!!z,msPointer:!!r,pointer:!!t,retina:1<(n.devicePixelRatio||n.screen.deviceXDPI/n.screen.logicalXDPI)}})();c.Point=function(a,c,f){this.x=f?Math.round(a):a;this.y=f?Math.round(c):c};c.Point.prototype={clone:function(){return new c.Point(this.x,this.y)},add:function(a){return this.clone()._add(c.point(a))},_add:function(a){this.x+=a.x;this.y+=a.y;return this},subtract:function(a){return this.clone()._subtract(c.point(a))},_subtract:function(a){this.x-=a.x;this.y-=a.y;return this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){this.x/=a;this.y/=a;return this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){this.x*=a;this.y*=a;return this},scaleBy:function(a){return new c.Point(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new c.Point(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},floor:function(){return this.clone()._floor()},_floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){return this.clone()._ceil()},_ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},distanceTo:function(a){a=c.point(a);var d=a.x-this.x;a=a.y-this.y;return Math.sqrt(d*d+a*a)},equals:function(a){a=c.point(a);return a.x===this.x&&a.y===this.y},contains:function(a){a=c.point(a);return Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+c.Util.formatNum(this.x)+", "+c.Util.formatNum(this.y)+")"}};c.point=function(a,d,f){return a instanceof c.Point?a:c.Util.isArray(a)?new c.Point(a[0],a[1]):a===k||null===a?a:"object"===typeof a&&"x"in a&&"y"in a?new c.Point(a.x,a.y):new c.Point(a,d,f)};c.Bounds=function(a,c){if(a)for(var f=c?[a,c]:a,b=0,l=f.length;b<l;b++)this.extend(f[b])};c.Bounds.prototype={extend:function(a){a=c.point(a);this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone());return this},getCenter:function(a){return new c.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new c.Point(this.min.x,this.max.y)},getTopRight:function(){return new c.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var d;a="number"===typeof a[0]||a instanceof c.Point?c.point(a):c.bounds(a);a instanceof c.Bounds?(d=a.min,a=a.max):d=a;return d.x>=this.min.x&&a.x<=this.max.x&&d.y>=this.min.y&&a.y<=this.max.y},intersects:function(a){a=c.bounds(a);var d=this.min,f=this.max,b=a.min;a=a.max;var l=a.y>=d.y&&b.y<=f.y;return a.x>=d.x&&b.x<=f.x&&l},overlaps:function(a){a=c.bounds(a);var d=this.min,f=this.max,b=a.min;a=a.max;var l=a.y>d.y&&b.y<f.y;return a.x>d.x&&b.x<f.x&&l},isValid:function(){return!(!this.min||!this.max)}};c.bounds=function(a,d){return!a||a instanceof c.Bounds?a:new c.Bounds(a,d)};c.Transformation=function(a,c,f,b){this._a=a;this._b=c;this._c=f;this._d=b};c.Transformation.prototype={transform:function(a,c){return this._transform(a.clone(),c)},_transform:function(a,c){c=c||1;a.x=c*(this._a*a.x+this._b);a.y=c*(this._c*a.y+this._d);return a},untransform:function(a,d){d=d||1;return new c.Point((a.x/d-this._b)/this._a,(a.y/d-this._d)/this._c)}};c.DomUtil={get:function(a){return"string"===typeof a?e.getElementById(a):a},getStyle:function(a,c){var f=a.style[c]||a.currentStyle&&a.currentStyle[c];f&&"auto"!==f||!e.defaultView||(f=(f=e.defaultView.getComputedStyle(a,null))?f[c]:null);return"auto"===f?null:f},create:function(a,c,f){a=e.createElement(a);a.className=c||"";f&&f.appendChild(a);return a},remove:function(a){var c=a.parentNode;c&&c.removeChild(a)},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},toFront:function(a){a.parentNode.appendChild(a)},toBack:function(a){var c=a.parentNode;c.insertBefore(a,c.firstChild)},hasClass:function(a,d){if(a.classList!==k)return a.classList.contains(d);var f=c.DomUtil.getClass(a);return 0<f.length&&(new RegExp("(^|\\s)"+d+"(\\s|$)")).test(f)},addClass:function(a,d){if(a.classList!==k)for(var f=c.Util.splitWords(d),b=0,l=f.length;b<l;b++)a.classList.add(f[b]);else c.DomUtil.hasClass(a,d)||(f=c.DomUtil.getClass(a),c.DomUtil.setClass(a,(f?f+" ":"")+d))},removeClass:function(a,d){a.classList!==k?a.classList.remove(d):c.DomUtil.setClass(a,c.Util.trim((" "+c.DomUtil.getClass(a)+" ").replace(" "+d+" "," ")))},setClass:function(a,c){a.className.baseVal===k?a.className=c:a.className.baseVal=c},getClass:function(a){return a.className.baseVal===k?a.className:a.className.baseVal},setOpacity:function(a,d){"opacity"in a.style?a.style.opacity=d:"filter"in a.style&&c.DomUtil._setOpacityIE(a,d)},_setOpacityIE:function(a,c){var f=!1;try{f=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(b){if(1===c)return}c=Math.round(100*c);f?(f.Enabled=100!==c,f.Opacity=c):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity\x3d"+c+")"},testProp:function(a){for(var c=e.documentElement.style,f=0;f<a.length;f++)if(a[f]in c)return a[f];return!1},setTransform:function(a,d,f){d=d||new c.Point(0,0);a.style[c.DomUtil.TRANSFORM]=(c.Browser.ie3d?"translate("+d.x+"px,"+d.y+"px)":"translate3d("+d.x+"px,"+d.y+"px,0)")+(f?" scale("+f+")":"")},setPosition:function(a,d){a._leaflet_pos=d;c.Browser.any3d?c.DomUtil.setTransform(a,d):(a.style.left=d.x+"px",a.style.top=d.y+"px")},getPosition:function(a){return a._leaflet_pos||new c.Point(0,0)}};(function(){c.DomUtil.TRANSFORM=c.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var a=c.DomUtil.TRANSITION=c.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);c.DomUtil.TRANSITION_END="webkitTransition"===a||"OTransition"===a?a+"End":"transitionend";if("onselectstart"in e)c.DomUtil.disableTextSelection=function(){c.DomEvent.on(n,"selectstart",c.DomEvent.preventDefault)},c.DomUtil.enableTextSelection=function(){c.DomEvent.off(n,"selectstart",c.DomEvent.preventDefault)};else{var d=c.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);c.DomUtil.disableTextSelection=function(){if(d){var a=e.documentElement.style;this._userSelect=a[d];a[d]="none"}};c.DomUtil.enableTextSelection=function(){d&&(e.documentElement.style[d]=this._userSelect,delete this._userSelect)}}c.DomUtil.disableImageDrag=function(){c.DomEvent.on(n,"dragstart",c.DomEvent.preventDefault)};c.DomUtil.enableImageDrag=function(){c.DomEvent.off(n,"dragstart",c.DomEvent.preventDefault)};c.DomUtil.preventOutline=function(a){for(;-1===a.tabIndex;)a=a.parentNode;a&&a.style&&(c.DomUtil.restoreOutline(),this._outlineElement=a,this._outlineStyle=a.style.outline,a.style.outline="none",c.DomEvent.on(n,"keydown",c.DomUtil.restoreOutline,this))};c.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,c.DomEvent.off(n,"keydown",c.DomUtil.restoreOutline,this))}})();c.LatLng=function(a,c,f){if(isNaN(a)||isNaN(c))throw Error("Invalid LatLng object: ("+a+", "+c+")");this.lat=+a;this.lng=+c;f!==k&&(this.alt=+f)};c.LatLng.prototype={equals:function(a,d){if(!a)return!1;a=c.latLng(a);return Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=(d===k?1E-9:d)},toString:function(a){return"LatLng("+c.Util.formatNum(this.lat,a)+", "+c.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){return c.CRS.Earth.distance(this,c.latLng(a))},wrap:function(){return c.CRS.Earth.wrapLatLng(this)},toBounds:function(a){a=180*a/40075017;var d=a/Math.cos(Math.PI/180*this.lat);return c.latLngBounds([this.lat-a,this.lng-d],[this.lat+a,this.lng+d])},clone:function(){return new c.LatLng(this.lat,this.lng,this.alt)}};c.latLng=function(a,d,f){return a instanceof c.LatLng?a:c.Util.isArray(a)&&"object"!==typeof a[0]?3===a.length?new c.LatLng(a[0],a[1],a[2]):2===a.length?new c.LatLng(a[0],a[1]):null:a===k||null===a?a:"object"===typeof a&&"lat"in a?new c.LatLng(a.lat,"lng"in a?a.lng:a.lon,a.alt):d===k?null:new c.LatLng(a,d,f)};c.LatLngBounds=function(a,c){if(a)for(var f=c?[a,c]:a,b=0,l=f.length;b<l;b++)this.extend(f[b])};c.LatLngBounds.prototype={extend:function(a){var d=this._southWest,f=this._northEast,b;if(a instanceof c.LatLng)b=a;else if(a instanceof c.LatLngBounds){if(b=a._southWest,a=a._northEast,!b||!a)return this}else return a?this.extend(c.latLng(a)||c.latLngBounds(a)):this;d||f?(d.lat=Math.min(b.lat,d.lat),d.lng=Math.min(b.lng,d.lng),f.lat=Math.max(a.lat,f.lat),f.lng=Math.max(a.lng,f.lng)):(this._southWest=new c.LatLng(b.lat,b.lng),this._northEast=new c.LatLng(a.lat,a.lng));return this},pad:function(a){var d=this._southWest,f=this._northEast,b=Math.abs(d.lat-f.lat)*a;a*=Math.abs(d.lng-f.lng);return new c.LatLngBounds(new c.LatLng(d.lat-b,d.lng-a),new c.LatLng(f.lat+b,f.lng+a))},getCenter:function(){return new c.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new c.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new c.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"===typeof a[0]||a instanceof c.LatLng||"lat"in a?c.latLng(a):c.latLngBounds(a);var d=this._southWest,f=this._northEast,b;a instanceof c.LatLngBounds?(b=a.getSouthWest(),a=a.getNorthEast()):b=a;return b.lat>=d.lat&&a.lat<=f.lat&&b.lng>=d.lng&&a.lng<=f.lng},intersects:function(a){a=c.latLngBounds(a);var d=this._southWest,f=this._northEast,b=a.getSouthWest();a=a.getNorthEast();var l=a.lng>=d.lng&&b.lng<=f.lng;return a.lat>=d.lat&&b.lat<=f.lat&&l},overlaps:function(a){a=c.latLngBounds(a);var d=this._southWest,f=this._northEast,b=a.getSouthWest();a=a.getNorthEast();var l=a.lng>d.lng&&b.lng<f.lng;return a.lat>d.lat&&b.lat<f.lat&&l},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(a){if(!a)return!1;a=c.latLngBounds(a);return this._southWest.equals(a.getSouthWest())&&this._northEast.equals(a.getNorthEast())},isValid:function(){return!(!this._southWest||!this._northEast)}};c.latLngBounds=function(a,d){return a instanceof c.LatLngBounds?a:new c.LatLngBounds(a,d)};c.Projection={};c.Projection.LonLat={project:function(a){return new c.Point(a.lng,a.lat)},unproject:function(a){return new c.LatLng(a.y,a.x)},bounds:c.bounds([-180,-90],[180,90])};c.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(a){var d=Math.PI/180,f=this.MAX_LATITUDE,f=Math.sin(Math.max(Math.min(f,a.lat),-f)*d);return new c.Point(this.R*a.lng*d,this.R*Math.log((1+f)/(1-f))/2)},unproject:function(a){var d=180/Math.PI;return new c.LatLng((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*d,a.x*d/this.R)},bounds:function(){var a=6378137*Math.PI;return c.bounds([-a,-a],[a,a])}()};c.CRS={latLngToPoint:function(a,c){var f=this.projection.project(a),b=this.scale(c);return this.transformation._transform(f,b)},pointToLatLng:function(a,c){var f=this.scale(c),f=this.transformation.untransform(a,f);return this.projection.unproject(f)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var d=this.projection.bounds,f=this.scale(a);a=this.transformation.transform(d.min,f);d=this.transformation.transform(d.max,f);return c.bounds(a,d)},infinite:!1,wrapLatLng:function(a){var d=this.wrapLng?c.Util.wrapNum(a.lng,this.wrapLng,!0):a.lng,f=this.wrapLat?c.Util.wrapNum(a.lat,this.wrapLat,!0):a.lat;return c.latLng(f,d,a.alt)},wrapLatLngBounds:function(a){var d=a.getCenter(),f=this.wrapLatLng(d),b=d.lat-f.lat,d=d.lng-f.lng;if(0===b&&0===d)return a;f=a.getSouthWest();a=a.getNorthEast();f=c.latLng({lat:f.lat-b,lng:f.lng-d});b=c.latLng({lat:a.lat-b,lng:a.lng-d});return new c.LatLngBounds(f,b)}};c.CRS.Simple=c.extend({},c.CRS,{projection:c.Projection.LonLat,transformation:new c.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,c){var f=c.lng-a.lng,b=c.lat-a.lat;return Math.sqrt(f*f+b*b)},infinite:!0});c.CRS.Earth=c.extend({},c.CRS,{wrapLng:[-180,180],R:6371E3,distance:function(a,c){var f=Math.PI/180,b=a.lat*f,l=c.lat*f;return this.R*Math.acos(Math.min(Math.sin(b)*Math.sin(l)+Math.cos(b)*Math.cos(l)*Math.cos((c.lng-a.lng)*f),1))}});c.CRS.EPSG3857=c.extend({},c.CRS.Earth,{code:"EPSG:3857",projection:c.Projection.SphericalMercator,transformation:function(){var a=.5/(Math.PI*c.Projection.SphericalMercator.R);return new c.Transformation(a,.5,-a,.5)}()});c.CRS.EPSG900913=c.extend({},c.CRS.EPSG3857,{code:"EPSG:900913"});c.CRS.EPSG4326=c.extend({},c.CRS.Earth,{code:"EPSG:4326",projection:c.Projection.LonLat,transformation:new c.Transformation(1/180,1,-1/180,.5)});c.Map=c.Evented.extend({options:{crs:c.CRS.EPSG3857,center:k,zoom:k,minZoom:k,maxZoom:k,layers:[],maxBounds:k,renderer:k,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,d){d=c.setOptions(this,d);this._initContainer(a);this._initLayout();this._onResize=c.bind(this._onResize,this);this._initEvents();d.maxBounds&&this.setMaxBounds(d.maxBounds);d.zoom!==k&&(this._zoom=this._limitZoom(d.zoom));d.center&&d.zoom!==k&&this.setView(c.latLng(d.center),d.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._sizeChanged=!0;this.callInitHooks();if(this._zoomAnimated=c.DomUtil.TRANSITION&&c.Browser.any3d&&!c.Browser.mobileOpera&&this.options.zoomAnimation)this._createAnimProxy(),c.DomEvent.on(this._proxy,c.DomUtil.TRANSITION_END,this._catchTransitionEnd,this);this._addLayers(this.options.layers)},setView:function(a,d,f){d=d===k?this._zoom:this._limitZoom(d);a=this._limitCenter(c.latLng(a),d,this.options.maxBounds);f=f||{};this._stop();if(this._loaded&&!f.reset&&!0!==f&&(f.animate!==k&&(f.zoom=c.extend({animate:f.animate},f.zoom),f.pan=c.extend({animate:f.animate,duration:f.duration},f.pan)),this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,d,f.zoom):this._tryAnimatedPan(a,f.pan)))return clearTimeout(this._sizeTimer),this;this._resetView(a,d);return this},setZoom:function(a,c){return this._loaded?this.setView(this.getCenter(),a,{zoom:c}):(this._zoom=a,this)},zoomIn:function(a,d){a=a||(c.Browser.any3d?this.options.zoomDelta:1);return this.setZoom(this._zoom+a,d)},zoomOut:function(a,d){a=a||(c.Browser.any3d?this.options.zoomDelta:1);return this.setZoom(this._zoom-a,d)},setZoomAround:function(a,d,f){var b=this.getZoomScale(d),l=this.getSize().divideBy(2);a=(a instanceof c.Point?a:this.latLngToContainerPoint(a)).subtract(l).multiplyBy(1-1/b);l=this.containerPointToLatLng(l.add(a));return this.setView(l,d,{zoom:f})},_getBoundsCenterZoom:function(a,d){d=d||{};a=a.getBounds?a.getBounds():c.latLngBounds(a);var f=c.point(d.paddingTopLeft||d.padding||[0,0]),b=c.point(d.paddingBottomRight||d.padding||[0,0]),l=this.getBoundsZoom(a,!1,f.add(b)),l="number"===typeof d.maxZoom?Math.min(d.maxZoom,l):l,f=b.subtract(f).divideBy(2),b=this.project(a.getSouthWest(),l),h=this.project(a.getNorthEast(),l);return{center:this.unproject(b.add(h).divideBy(2).add(f),l),zoom:l}},fitBounds:function(a,d){a=c.latLngBounds(a);if(!a.isValid())throw Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(a,d);return this.setView(f.center,f.zoom,d)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,c){return this.setView(a,this._zoom,{pan:c})},panBy:function(a,d){a=c.point(a).round();d=d||{};if(!a.x&&!a.y)return this.fire("moveend");if(!0!==d.animate&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;this._panAnim||(this._panAnim=new c.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this));d.noMoveStart||this.fire("movestart");if(!1!==d.animate){c.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,f,d.duration||.25,d.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,d,f){function b(a){a=(w*w-v*v+2.0164*(a?-1:1)*2.0164*x*x)/(4.0328*(a?w:v)*x);a=Math.sqrt(a*a+1)-a;return 1E-9>a?-18:Math.log(a)}function l(a){return(Math.exp(a)+Math.exp(-a))/2}function h(a){return v*(l(z)/l(z+1.42*a))}function m(a){var c=l(z);a=z+1.42*a;a=(Math.exp(a)-Math.exp(-a))/2/l(a);return v*(c*a-(Math.exp(z)-Math.exp(-z))/2)/2.0164}function e(){var f=(Date.now()-B)/I,b=(1-Math.pow(1-f,1.5))*D;1>=f?(this._flyToFrame=c.Util.requestAnimFrame(e,this),this._move(this.unproject(p.add(q.subtract(p).multiplyBy(m(b)/x)),t),this.getScaleZoom(v/h(b),t),{flyTo:!0})):this._move(a,d)._moveEnd(!0)}f=f||{};if(!1===f.animate||!c.Browser.any3d)return this.setView(a,d,f);this._stop();var p=this.project(this.getCenter()),q=this.project(a),n=this.getSize(),t=this._zoom;a=c.latLng(a);d=d===k?t:d;var v=Math.max(n.x,n.y),w=v*this.getZoomScale(t,d),x=q.distanceTo(p)||1,z=b(0),B=Date.now(),D=(b(1)-z)/1.42,I=f.duration?1E3*f.duration:800*D;this._moveStart(!0);e.call(this);return this},flyToBounds:function(a,c){var f=this._getBoundsCenterZoom(a,c);return this.flyTo(f.center,f.zoom,c)},setMaxBounds:function(a){a=c.latLngBounds(a);if(a.isValid())this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds);else return this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds);this.options.maxBounds=a;this._loaded&&this._panInsideMaxBounds();return this.on("moveend",this._panInsideMaxBounds)},setMinZoom:function(a){this.options.minZoom=a;return this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(a):this},setMaxZoom:function(a){this.options.maxZoom=a;return this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(a):this},panInsideBounds:function(a,d){this._enforcingBounds=!0;var f=this.getCenter(),b=this._limitCenter(f,this._zoom,c.latLngBounds(a));f.equals(b)||this.panTo(b,d);this._enforcingBounds=!1;return this},invalidateSize:function(a){if(!this._loaded)return this;a=c.extend({animate:!1,pan:!0},!0===a?{animate:!0}:a);var d=this.getSize();this._sizeChanged=!0;this._lastCenter=null;var f=this.getSize(),b=d.divideBy(2).round(),l=f.divideBy(2).round(),b=b.subtract(l);if(!b.x&&!b.y)return this;a.animate&&a.pan?this.panBy(b):(a.pan&&this._rawPanBy(b),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c.bind(this.fire,this,"moveend"),200)):this.fire("moveend"));return this.fire("resize",{oldSize:d,newSize:f})},stop:function(){this.setZoom(this._limitZoom(this._zoom));this.options.zoomSnap||this.fire("viewreset");return this._stop()},locate:function(a){a=this._locateOptions=c.extend({timeout:1E4,watch:!1},a);if(!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=c.bind(this._handleGeolocationResponse,this),f=c.bind(this._handleGeolocationError,this);a.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,f,a):navigator.geolocation.getCurrentPosition(d,f,a);return this},stopLocate:function(){navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId);this._locateOptions&&(this._locateOptions.setView=!1);return this},_handleGeolocationError:function(a){var c=a.code;a=a.message||(1===c?"permission denied":2===c?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:c,message:"Geolocation error: "+a+"."})},_handleGeolocationResponse:function(a){var d=new c.LatLng(a.coords.latitude,a.coords.longitude),f=d.toBounds(a.coords.accuracy),b=this._locateOptions;if(b.setView){var l=this.getBoundsZoom(f);this.setView(d,b.maxZoom?Math.min(l,b.maxZoom):l)}var d={latlng:d,bounds:f,timestamp:a.timestamp},h;for(h in a.coords)"number"===typeof a.coords[h]&&(d[h]=a.coords[h]);this.fire("locationfound",d)},addHandler:function(a,c){if(!c)return this;var f=this[a]=new c(this);this._handlers.push(f);this.options[a]&&f.enable();return this},remove:function(){this._initEvents(!0);if(this._containerId!==this._container._leaflet_id)throw Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(d){this._containerId=this._container._leaflet_id=k}c.DomUtil.remove(this._mapPane);this._clearControlPos&&this._clearControlPos();this._clearHandlers();this._loaded&&this.fire("unload");for(var a in this._layers)this._layers[a].remove();return this},createPane:function(a,d){var f="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),f=c.DomUtil.create("div",f,d||this._mapPane);a&&(this._panes[a]=f);return f},getCenter:function(){this._checkIfLoaded();return this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),d=this.unproject(a.getBottomLeft()),a=this.unproject(a.getTopRight());return new c.LatLngBounds(d,a)},getMinZoom:function(){return this.options.minZoom===k?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===k?this._layersMaxZoom===k?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,d,f){a=c.latLngBounds(a);f=c.point(f||[0,0]);var b=this.getZoom()||0,l=this.getMinZoom(),h=this.getMaxZoom(),m=a.getNorthWest();a=a.getSouthEast();f=this.getSize().subtract(f);m=c.bounds(this.project(a,b),this.project(m,b)).getSize();a=c.Browser.any3d?this.options.zoomSnap:1;b=this.getScaleZoom(Math.min(f.x/m.x,f.y/m.y),b);a&&(b=a/100*Math.round(b/(a/100)),b=d?Math.ceil(b/a)*a:Math.floor(b/a)*a);return Math.max(l,Math.min(h,b))},getSize:function(){if(!this._size||this._sizeChanged)this._size=new c.Point(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1;return this._size.clone()},getPixelBounds:function(a,d){var f=this._getTopLeftPoint(a,d);return new c.Bounds(f,f.add(this.getSize()))},getPixelOrigin:function(){this._checkIfLoaded();return this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===k?this.getZoom():a)},getPane:function(a){return"string"===typeof a?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,c){var f=this.options.crs;c=c===k?this._zoom:c;return f.scale(a)/f.scale(c)},getScaleZoom:function(a,c){var f=this.options.crs;c=c===k?this._zoom:c;f=f.zoom(a*f.scale(c));return isNaN(f)?Infinity:f},project:function(a,d){d=d===k?this._zoom:d;return this.options.crs.latLngToPoint(c.latLng(a),d)},unproject:function(a,d){d=d===k?this._zoom:d;return this.options.crs.pointToLatLng(c.point(a),d)},layerPointToLatLng:function(a){a=c.point(a).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(a){return this.project(c.latLng(a))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(c.latLng(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(c.latLngBounds(a))},distance:function(a,d){return this.options.crs.distance(c.latLng(a),c.latLng(d))},containerPointToLayerPoint:function(a){return c.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return c.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){a=this.containerPointToLayerPoint(c.point(a));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(c.latLng(a)))},mouseEventToContainerPoint:function(a){return c.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){a=this._container=c.DomUtil.get(a);if(!a)throw Error("Map container not found.");if(a._leaflet_id)throw Error("Map container is already initialized.");c.DomEvent.addListener(a,"scroll",this._onScroll,this);this._containerId=c.Util.stamp(a)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&c.Browser.any3d;c.DomUtil.addClass(a,"leaflet-container"+(c.Browser.touch?" leaflet-touch":"")+(c.Browser.retina?" leaflet-retina":"")+(c.Browser.ielt9?" leaflet-oldie":"")+(c.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=c.DomUtil.getStyle(a,"position");"absolute"!==d&&"relative"!==d&&"fixed"!==d&&(a.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={};this._mapPane=this.createPane("mapPane",this._container);c.DomUtil.setPosition(this._mapPane,new c.Point(0,0));this.createPane("tilePane");this.createPane("shadowPane");this.createPane("overlayPane");this.createPane("markerPane");this.createPane("tooltipPane");this.createPane("popupPane");this.options.markerZoomAnimation||(c.DomUtil.addClass(a.markerPane,"leaflet-zoom-hide"),c.DomUtil.addClass(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,d){c.DomUtil.setPosition(this._mapPane,new c.Point(0,0));var f=!this._loaded;this._loaded=!0;d=this._limitZoom(d);this.fire("viewprereset");var b=this._zoom!==d;this._moveStart(b)._move(a,d)._moveEnd(b);this.fire("viewreset");f&&this.fire("load")},_moveStart:function(a){a&&this.fire("zoomstart");return this.fire("movestart")},_move:function(a,c,f){c===k&&(c=this._zoom);var b=this._zoom!==c;this._zoom=c;this._lastCenter=a;this._pixelOrigin=this._getNewPixelOrigin(a);(b||f&&f.pinch)&&this.fire("zoom",f);return this.fire("move",f)},_moveEnd:function(a){a&&this.fire("zoomend");return this.fire("moveend")},_stop:function(){c.Util.cancelAnimFrame(this._flyToFrame);this._panAnim&&this._panAnim.stop();return this},_rawPanBy:function(a){c.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");},_initEvents:function(a){if(c.DomEvent){this._targets={};this._targets[c.stamp(this._container)]=this;a=a?"off":"on";c.DomEvent[a](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this);if(this.options.trackResize)c.DomEvent[a](n,"resize",this._onResize,this);if(c.Browser.any3d&&this.options.transform3DLimit)this[a]("moveend",this._onMoveEnd)}},_onResize:function(){c.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=c.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0;this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,d){for(var f=[],b,l="mouseout"===d||"mouseover"===d,h=a.target||a.srcElement,m=!1;h;){if((b=this._targets[c.stamp(h)])&&("click"===d||"preclick"===d)&&!a._simulated&&this._draggableMoved(b)){m=!0;break}if(b&&b.listens(d,!0)){if(l&&!c.DomEvent._isExternalTarget(h,a))break;f.push(b);if(l)break}if(h===this._container)break;h=h.parentNode}f.length||m||l||!c.DomEvent._isExternalTarget(h,a)||(f=[this]);return f},_handleDOMEvent:function(a){if(this._loaded&&!c.DomEvent._skipped(a)){var d="keypress"===a.type&&13===a.keyCode?"click":a.type;"mousedown"===d&&c.DomUtil.preventOutline(a.target||a.srcElement);this._fireDOMEvent(a,d)}},_fireDOMEvent:function(a,d,f){if("click"===a.type){var b=c.Util.extend({},a);b.type="preclick";this._fireDOMEvent(b,b.type,f)}if(!a._stopped&&(f=(f||[]).concat(this._findEventTargets(a,d)),f.length)){var l=f[0];"contextmenu"===d&&l.listens(d,!0)&&c.DomEvent.preventDefault(a);b={originalEvent:a};if("keypress"!==a.type){var h=l instanceof c.Marker;b.containerPoint=h?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(a);b.layerPoint=this.containerPointToLayerPoint(b.containerPoint);b.latlng=h?l.getLatLng():this.layerPointToLatLng(b.layerPoint)}for(a=0;a<f.length&&!(f[a].fire(d,b,!0),b.originalEvent._stopped||f[a].options.nonBubblingEvents&&-1!==c.Util.indexOf(f[a].options.nonBubblingEvents,d));a++);}},_draggableMoved:function(a){a=a.dragging&&a.dragging.enabled()?a:this;return a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,c=this._handlers.length;a<c;a++)this._handlers[a].disable()},whenReady:function(a,c){if(this._loaded)a.call(c||this,{target:this});else this.on("load",a,c);return this},_getMapPanePos:function(){return c.DomUtil.getPosition(this._mapPane)||new c.Point(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,c){return(a&&c!==k?this._getNewPixelOrigin(a,c):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,c){var f=this.getSize()._divideBy(2);return this.project(a,c)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,c,f){f=this._getNewPixelOrigin(f,c);return this.project(a,c)._subtract(f)},_latLngBoundsToNewLayerBounds:function(a,d,f){f=this._getNewPixelOrigin(f,d);return c.bounds([this.project(a.getSouthWest(),d)._subtract(f),this.project(a.getNorthWest(),d)._subtract(f),this.project(a.getSouthEast(),d)._subtract(f),this.project(a.getNorthEast(),d)._subtract(f)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,d,f){if(!f)return a;var b=this.project(a,d),l=this.getSize().divideBy(2),l=new c.Bounds(b.subtract(l),b.add(l));f=this._getBoundsOffset(l,f,d);return f.round().equals([0,0])?a:this.unproject(b.add(f),d)},_limitOffset:function(a,d){if(!d)return a;var f=this.getPixelBounds(),f=new c.Bounds(f.min.add(a),f.max.add(a));return a.add(this._getBoundsOffset(f,d))},_getBoundsOffset:function(a,d,f){f=c.bounds(this.project(d.getNorthEast(),f),this.project(d.getSouthWest(),f));d=f.min.subtract(a.min);f=f.max.subtract(a.max);a=this._rebound(d.x,-f.x);d=this._rebound(d.y,-f.y);return new c.Point(a,d)},_rebound:function(a,c){return 0<a+c?Math.round(a-c)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(c))},_limitZoom:function(a){var d=this.getMinZoom(),f=this.getMaxZoom(),b=c.Browser.any3d?this.options.zoomSnap:1;b&&(a=Math.round(a/b)*b);return Math.max(d,Math.min(f,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){c.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(a,c){var b=this._getCenterOffset(a)._floor();if(!0!==(c&&c.animate)&&!this.getSize().contains(b))return!1;this.panBy(b,c);return!0},_createAnimProxy:function(){var a=this._proxy=c.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a);this.on("zoomanim",function(d){var b=c.DomUtil.TRANSFORM,g=a.style[b];c.DomUtil.setTransform(a,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1));g===a.style[b]&&this._animatingZoom&&this._onZoomTransitionEnd()},this);this.on("load moveend",function(){var d=this.getCenter(),b=this.getZoom();c.DomUtil.setTransform(a,this.project(d,b),this.getZoomScale(b,1))},this)},_catchTransitionEnd:function(a){this._animatingZoom&&0<=a.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,d,b){if(this._animatingZoom)return!0;b=b||{};if(!this._zoomAnimated||!1===b.animate||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var g=this.getZoomScale(d),g=this._getCenterOffset(a)._divideBy(1-1/g);if(!0!==b.animate&&!this.getSize().contains(g))return!1;c.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(a,d,!0)},this);return!0},_animateZoom:function(a,d,b,g){b&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=d,c.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"));this.fire("zoomanim",{center:a,zoom:d,noUpdate:g});setTimeout(c.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(c.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),c.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}});c.map=function(a,d){return new c.Map(a,d)};c.Layer=c.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[],attribution:null},addTo:function(a){a.addLayer(this);return this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){a&&a.removeLayer(this);return this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){this._map._targets[c.stamp(a)]=this;return this},removeInteractiveTarget:function(a){delete this._map._targets[c.stamp(a)];return this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var c=a.target;if(c.hasLayer(this)){this._map=c;this._zoomAnimated=c._zoomAnimated;if(this.getEvents){var b=this.getEvents();c.on(b,this);this.once("remove",function(){c.off(b,this)},this)}this.onAdd(c);this.getAttribution&&c.attributionControl&&c.attributionControl.addAttribution(this.getAttribution());this.fire("add");c.fire("layeradd",{layer:this})}}});c.Map.include({addLayer:function(a){var d=c.stamp(a);if(this._layers[d])return this;this._layers[d]=a;a._mapToAdd=this;a.beforeAdd&&a.beforeAdd(this);this.whenReady(a._layerAdd,a);return this},removeLayer:function(a){var d=c.stamp(a);if(!this._layers[d])return this;if(this._loaded)a.onRemove(this);a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution());delete this._layers[d];this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove"));a._map=a._mapToAdd=null;return this},hasLayer:function(a){return!!a&&c.stamp(a)in this._layers},eachLayer:function(a,c){for(var b in this._layers)a.call(c,this._layers[b]);return this},_addLayers:function(a){a=a?c.Util.isArray(a)?a:[a]:[];for(var d=0,b=a.length;d<b;d++)this.addLayer(a[d])},_addZoomLimit:function(a){if(isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))this._zoomBoundLayers[c.stamp(a)]=a,this._updateZoomLevels()},_removeZoomLimit:function(a){a=c.stamp(a);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var a=Infinity,c=-Infinity,b=this._getZoomSpan(),g;for(g in this._zoomBoundLayers)var l=this._zoomBoundLayers[g].options,a=l.minZoom===k?a:Math.min(a,l.minZoom),c=l.maxZoom===k?c:Math.max(c,l.maxZoom);this._layersMaxZoom=-Infinity===c?k:c;this._layersMinZoom=Infinity===a?k:a;b!==this._getZoomSpan()&&this.fire("zoomlevelschange");this.options.maxZoom===k&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom);this.options.minZoom===k&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});c.DomEvent={on:function(a,d,b,g){if("object"===typeof d)for(var l in d)this._on(a,l,d[l],b);else{d=c.Util.splitWords(d);l=0;for(var h=d.length;l<h;l++)this._on(a,d[l],b,g)}return this},off:function(a,d,b,g){if("object"===typeof d)for(var l in d)this._off(a,l,d[l],b);else{d=c.Util.splitWords(d);l=0;for(var h=d.length;l<h;l++)this._off(a,d[l],b,g)}return this},_on:function(a,d,b,g){var l=d+c.stamp(b)+(g?"_"+c.stamp(g):"");if(a._leaflet_events&&a._leaflet_events[l])return this;var h=function(c){return b.call(g||a,c||n.event)},m=h;c.Browser.pointer&&0===d.indexOf("touch")?this.addPointerListener(a,d,h,l):!c.Browser.touch||"dblclick"!==d||!this.addDoubleTapListener||c.Browser.pointer&&c.Browser.chrome?"addEventListener"in a?"mousewheel"===d?a.addEventListener("onwheel"in a?"wheel":"mousewheel",h,!1):"mouseenter"===d||"mouseleave"===d?(h=function(d){d=d||n.event;c.DomEvent._isExternalTarget(a,d)&&m(d)},a.addEventListener("mouseenter"===d?"mouseover":"mouseout",h,!1)):("click"===d&&c.Browser.android&&(h=function(a){return c.DomEvent._filterClick(a,m)}),a.addEventListener(d,h,!1)):"attachEvent"in a&&a.attachEvent("on"+d,h):this.addDoubleTapListener(a,h,l);a._leaflet_events=a._leaflet_events||{};a._leaflet_events[l]=h;return this},_off:function(a,d,b,g){b=d+c.stamp(b)+(g?"_"+c.stamp(g):"");g=a._leaflet_events&&a._leaflet_events[b];if(!g)return this;c.Browser.pointer&&0===d.indexOf("touch")?this.removePointerListener(a,d,b):c.Browser.touch&&"dblclick"===d&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,b):"removeEventListener"in a?"mousewheel"===d?a.removeEventListener("onwheel"in a?"wheel":"mousewheel",g,!1):a.removeEventListener("mouseenter"===d?"mouseover":"mouseleave"===d?"mouseout":d,g,!1):"detachEvent"in a&&a.detachEvent("on"+d,g);a._leaflet_events[b]=null;return this},stopPropagation:function(a){a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0;c.DomEvent._skipped(a);return this},disableScrollPropagation:function(a){return c.DomEvent.on(a,"mousewheel",c.DomEvent.stopPropagation)},disableClickPropagation:function(a){var d=c.DomEvent.stopPropagation;c.DomEvent.on(a,c.Draggable.START.join(" "),d);return c.DomEvent.on(a,{click:c.DomEvent._fakeStop,dblclick:d})},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;return this},stop:function(a){return c.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,d){if(!d)return new c.Point(a.clientX,a.clientY);var b=d.getBoundingClientRect();return new c.Point(a.clientX-b.left-d.clientLeft,a.clientY-b.top-d.clientTop)},_wheelPxFactor:c.Browser.win&&c.Browser.chrome?2:c.Browser.gecko?n.devicePixelRatio:1,getWheelDelta:function(a){return c.Browser.edge?a.wheelDeltaY/2:a.deltaY&&0===a.deltaMode?-a.deltaY/c.DomEvent._wheelPxFactor:a.deltaY&&1===a.deltaMode?20*-a.deltaY:a.deltaY&&2===a.deltaMode?60*-a.deltaY:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&32765>Math.abs(a.detail)?20*-a.detail:a.detail?a.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(a){c.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var c=this._skipEvents[a.type];this._skipEvents[a.type]=!1;return c},_isExternalTarget:function(a,c){var b=c.relatedTarget;if(!b)return!0;try{for(;b&&b!==a;)b=b.parentNode}catch(g){return!1}return b!==a},_filterClick:function(a,d){var b=a.timeStamp||a.originalEvent&&a.originalEvent.timeStamp,g=c.DomEvent._lastClick&&b-c.DomEvent._lastClick;g&&100<g&&500>g||a.target._simulatedClick&&!a._simulated?c.DomEvent.stop(a):(c.DomEvent._lastClick=b,d(a))}};c.DomEvent.addListener=c.DomEvent.on;c.DomEvent.removeListener=c.DomEvent.off;c.PosAnimation=c.Evented.extend({run:function(a,d,b,g){this.stop();this._el=a;this._inProgress=!0;this._duration=b||.25;this._easeOutPower=1/Math.max(g||.5,.2);this._startPos=c.DomUtil.getPosition(a);this._offset=d.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=c.Util.requestAnimFrame(this._animate,this);this._step()},_step:function(a){var c=+new Date-this._startTime,b=1E3*this._duration;c<b?this._runFrame(this._easeOut(c/b),a):(this._runFrame(1),this._complete())},_runFrame:function(a,d){var b=this._startPos.add(this._offset.multiplyBy(a));d&&b._round();c.DomUtil.setPosition(this._el,b);this.fire("step")},_complete:function(){c.Util.cancelAnimFrame(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}});c.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:c.bounds([-2.003750834279E7,-1.549657073972E7],[2.003750834279E7,1.876465623138E7]),project:function(a){var d=Math.PI/180,b=this.R,g=a.lat*d,l=this.R_MINOR/b,l=Math.sqrt(1-l*l),h=l*Math.sin(g),g=-b*Math.log(Math.max(Math.tan(Math.PI/4-g/2)/Math.pow((1-h)/(1+h),l/2),1E-10));return new c.Point(a.lng*d*b,g)},unproject:function(a){for(var d=180/Math.PI,b=this.R,g=this.R_MINOR/b,g=Math.sqrt(1-g*g),l=Math.exp(-a.y/b),h=Math.PI/2-2*Math.atan(l),m=0,e=.1;15>m&&1E-7<Math.abs(e);m++)e=g*Math.sin(h),e=Math.pow((1-e)/(1+e),g/2),e=Math.PI/2-2*Math.atan(l*e)-h,h+=e;return new c.LatLng(h*d,a.x*d/b)}};c.CRS.EPSG3395=c.extend({},c.CRS.Earth,{code:"EPSG:3395",projection:c.Projection.Mercator,transformation:function(){var a=.5/(Math.PI*c.Projection.Mercator.R);return new c.Transformation(a,.5,-a,.5)}()});c.GridLayer=c.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:c.Browser.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:k,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){c.setOptions(this,a)},onAdd:function(){this._initContainer();this._levels={};this._tiles={};this._resetView();this._update()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles();c.DomUtil.remove(this._container);a._removeZoomLimit(this);this._tileZoom=this._container=null},bringToFront:function(){this._map&&(c.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max));return this},bringToBack:function(){this._map&&(c.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min));return this},getContainer:function(){return this._container},setOpacity:function(a){this.options.opacity=a;this._updateOpacity();return this},setZIndex:function(a){this.options.zIndex=a;this._updateZIndex();return this},isLoading:function(){return this._loading},redraw:function(){this._map&&(this._removeAllTiles(),this._update());return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};this.options.updateWhenIdle||(this._onMove||(this._onMove=c.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove);this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},createTile:function(){return e.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof c.Point?a:new c.Point(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==k&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var c=this.getPane().children,b=-a(-Infinity,Infinity),g=0,l=c.length,h;g<l;g++)h=c[g].style.zIndex,c[g]!==this._container&&h&&(b=a(b,+h));isFinite(b)&&(this.options.zIndex=b+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!c.Browser.ielt9){c.DomUtil.setOpacity(this._container,this.options.opacity);var a=+new Date,d=!1,b=!1,g;for(g in this._tiles){var l=this._tiles[g];if(l.current&&l.loaded){var h=Math.min(1,(a-l.loaded)/200);c.DomUtil.setOpacity(l.el,h);1>h?d=!0:(l.active&&(b=!0),l.active=!0)}}b&&!this._noPrune&&this._pruneTiles();d&&(c.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=c.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=c.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),1>this.options.opacity&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,d=this.options.maxZoom;if(a===k)return k;for(var b in this._levels)this._levels[b].el.children.length||b===a?this._levels[b].el.style.zIndex=d-Math.abs(a-b):(c.DomUtil.remove(this._levels[b].el),this._removeTilesAtZoom(b),delete this._levels[b]);b=this._levels[a];var g=this._map;b||(b=this._levels[a]={},b.el=c.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=d,b.origin=g.project(g.unproject(g.getPixelOrigin()),a).round(),b.zoom=a,this._setZoomTransform(b,g.getCenter(),g.getZoom()),c.Util.falseFn(b.el.offsetWidth));return this._level=b},_pruneTiles:function(){if(this._map){var a,c;c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom)this._removeAllTiles();else{for(a in this._tiles)c=this._tiles[a],c.retain=c.current;for(a in this._tiles)c=this._tiles[a],c.current&&!c.active&&(c=c.coords,this._retainParent(c.x,c.y,c.z,c.z-5)||this._retainChildren(c.x,c.y,c.z,c.z+2));for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}}},_removeTilesAtZoom:function(a){for(var c in this._tiles)this._tiles[c].coords.z===a&&this._removeTile(c)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)c.DomUtil.remove(this._levels[a].el),delete this._levels[a];this._removeAllTiles();this._tileZoom=null},_retainParent:function(a,d,b,g){a=Math.floor(a/2);d=Math.floor(d/2);--b;var l=new c.Point(+a,+d);l.z=+b;l=this._tileCoordsToKey(l);if((l=this._tiles[l])&&l.active)return l.retain=!0;l&&l.loaded&&(l.retain=!0);return b>g?this._retainParent(a,d,b,g):!1},_retainChildren:function(a,d,b,g){for(var l=2*a;l<2*a+2;l++)for(var h=2*d;h<2*d+2;h++){var m=new c.Point(l,h);m.z=b+1;m=this._tileCoordsToKey(m);(m=this._tiles[m])&&m.active?m.retain=!0:(m&&m.loaded&&(m.retain=!0),b+1<g&&this._retainChildren(l,h,b+1,g))}},_resetView:function(a){a=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_setView:function(a,c,b,g){var l=Math.round(c);if(this.options.maxZoom!==k&&l>this.options.maxZoom||this.options.minZoom!==k&&l<this.options.minZoom)l=k;var h=this.options.updateWhenZooming&&l!==this._tileZoom;if(!g||h)this._tileZoom=l,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),l!==k&&this._update(a),b||this._pruneTiles(),this._noPrune=!!b;this._setZoomTransforms(a,c)},_setZoomTransforms:function(a,c){for(var b in this._levels)this._setZoomTransform(this._levels[b],a,c)},_setZoomTransform:function(a,d,b){var g=this._map.getZoomScale(b,a.zoom);d=a.origin.multiplyBy(g).subtract(this._map._getNewPixelOrigin(d,b)).round();c.Browser.any3d?c.DomUtil.setTransform(a.el,d,g):c.DomUtil.setPosition(a.el,d)},_resetGrid:function(){var a=this._map,c=a.options.crs,b=this._tileSize=this.getTileSize(),g=this._tileZoom,l=this._map.getPixelWorldBounds(this._tileZoom);l&&(this._globalTileRange=this._pxBoundsToTileRange(l));this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,c.wrapLng[0]],g).x/b.x),Math.ceil(a.project([0,c.wrapLng[1]],g).x/b.y)];this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([c.wrapLat[0],0],g).y/b.x),Math.ceil(a.project([c.wrapLat[1],0],g).y/b.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(a){var d=this._map,b=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),b=d.getZoomScale(b,this._tileZoom);a=d.project(a,this._tileZoom).floor();d=d.getSize().divideBy(2*b);return new c.Bounds(a.subtract(d),a.add(d))},_update:function(a){var d=this._map;if(d){var b=d.getZoom();a===k&&(a=d.getCenter());if(this._tileZoom!==k){var d=this._getTiledPixelBounds(a),g=this._pxBoundsToTileRange(d),l=g.getCenter(),d=[],h=this.options.keepBuffer,h=new c.Bounds(g.getBottomLeft().subtract([h,-h]),g.getTopRight().add([h,-h])),m;for(m in this._tiles){var u=this._tiles[m].coords;u.z===this._tileZoom&&h.contains(c.point(u.x,u.y))||(this._tiles[m].current=!1)}if(1<Math.abs(b-this._tileZoom))this._setView(a,b);else{for(b=g.min.y;b<=g.max.y;b++)for(a=g.min.x;a<=g.max.x;a++)m=new c.Point(a,b),m.z=this._tileZoom,this._isValidTile(m)&&((h=this._tiles[this._tileCoordsToKey(m)])?h.current=!0:d.push(m));d.sort(function(a,c){return a.distanceTo(l)-c.distanceTo(l)});if(0!==d.length){this._loading||(this._loading=!0,this.fire("loading"));g=e.createDocumentFragment();for(a=0;a<d.length;a++)this._addTile(d[a],g);this._level.el.appendChild(g)}}}}},_isValidTile:function(a){var d=this._map.options.crs;if(!d.infinite){var b=this._globalTileRange;if(!d.wrapLng&&(a.x<b.min.x||a.x>b.max.x)||!d.wrapLat&&(a.y<b.min.y||a.y>b.max.y))return!1}if(!this.options.bounds)return!0;a=this._tileCoordsToBounds(a);return c.latLngBounds(this.options.bounds).overlaps(a)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToBounds:function(a){var d=this._map,b=this.getTileSize(),g=a.scaleBy(b),b=g.add(b),g=d.unproject(g,a.z);a=d.unproject(b,a.z);a=new c.LatLngBounds(g,a);this.options.noWrap||d.wrapLatLngBounds(a);return a},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){a=a.split(":");var d=new c.Point(+a[0],+a[1]);d.z=+a[2];return d},_removeTile:function(a){var d=this._tiles[a];d&&(c.DomUtil.remove(d.el),delete this._tiles[a],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){c.DomUtil.addClass(a,"leaflet-tile");var d=this.getTileSize();a.style.width=d.x+"px";a.style.height=d.y+"px";a.onselectstart=c.Util.falseFn;a.onmousemove=c.Util.falseFn;c.Browser.ielt9&&1>this.options.opacity&&c.DomUtil.setOpacity(a,this.options.opacity);c.Browser.android&&!c.Browser.android23&&(a.style.WebkitBackfaceVisibility="hidden")},_addTile:function(a,d){var b=this._getTilePos(a),g=this._tileCoordsToKey(a),l=this.createTile(this._wrapCoords(a),c.bind(this._tileReady,this,a));this._initTile(l);2>this.createTile.length&&c.Util.requestAnimFrame(c.bind(this._tileReady,this,a,null,l));c.DomUtil.setPosition(l,b);this._tiles[g]={el:l,coords:a,current:!0};d.appendChild(l);this.fire("tileloadstart",{tile:l,coords:a})},_tileReady:function(a,d,b){this._map&&(d&&this.fire("tileerror",{error:d,tile:b,coords:a}),b=this._tileCoordsToKey(a),b=this._tiles[b])&&(b.loaded=+new Date,this._map._fadeAnimated?(c.DomUtil.setOpacity(b.el,0),c.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=c.Util.requestAnimFrame(this._updateOpacity,this)):(b.active=!0,this._pruneTiles()),d||(c.DomUtil.addClass(b.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:b.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),c.Browser.ielt9||!this._map._fadeAnimated?c.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(c.bind(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var d=new c.Point(this._wrapX?c.Util.wrapNum(a.x,this._wrapX):a.x,this._wrapY?c.Util.wrapNum(a.y,this._wrapY):a.y);d.z=a.z;return d},_pxBoundsToTileRange:function(a){var d=this.getTileSize();return new c.Bounds(a.min.unscaleBy(d).floor(),a.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});c.gridLayer=function(a){return new c.GridLayer(a)};c.TileLayer=c.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,minNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(a,d){this._url=a;d=c.setOptions(this,d);d.detectRetina&&c.Browser.retina&&0<d.maxZoom&&(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom++):(d.zoomOffset++,d.maxZoom--),d.minZoom=Math.max(0,d.minZoom));"string"===typeof d.subdomains&&(d.subdomains=d.subdomains.split(""));if(!c.Browser.android)this.on("tileunload",this._onTileRemove)},setUrl:function(a,c){this._url=a;c||this.redraw();return this},createTile:function(a,d){var b=e.createElement("img");c.DomEvent.on(b,"load",c.bind(this._tileOnLoad,this,d,b));c.DomEvent.on(b,"error",c.bind(this._tileOnError,this,d,b));this.options.crossOrigin&&(b.crossOrigin="");b.alt="";b.setAttribute("role","presentation");b.src=this.getTileUrl(a);return b},getTileUrl:function(a){var d={r:c.Browser.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};this._map&&!this._map.options.crs.infinite&&(a=this._globalTileRange.max.y-a.y,this.options.tms&&(d.y=a),d["-y"]=a);return c.Util.template(this._url,c.extend(d,this.options))},_tileOnLoad:function(a,d){c.Browser.ielt9?setTimeout(c.bind(a,this,null,d),0):a(null,d)},_tileOnError:function(a,c,b){var g=this.options.errorTileUrl;g&&c.src!==g&&(c.src=g);a(b,c)},getTileSize:function(){var a=this._map,d=c.GridLayer.prototype.getTileSize.call(this),b=this._tileZoom+this.options.zoomOffset,g=this.options.minNativeZoom,l=this.options.maxNativeZoom;return null!==g&&b<g?d.divideBy(a.getZoomScale(g,b)).round():null!==l&&b>l?d.divideBy(a.getZoomScale(l,b)).round():d},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,c=this.options.maxZoom,b=this.options.zoomOffset,g=this.options.minNativeZoom,l=this.options.maxNativeZoom;this.options.zoomReverse&&(a=c-a);a+=b;return null!==g&&a<g?g:null!==l&&a>l?l:a},_getSubdomain:function(a){return this.options.subdomains[Math.abs(a.x+a.y)%this.options.subdomains.length]},_abortLoading:function(){var a,d;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&(d=this._tiles[a].el,d.onload=c.Util.falseFn,d.onerror=c.Util.falseFn,d.complete||(d.src=c.Util.emptyImageUrl,c.DomUtil.remove(d)))}});c.tileLayer=function(a,d){return new c.TileLayer(a,d)};c.TileLayer.WMS=c.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,d){this._url=a;var b=c.extend({},this.defaultWmsParams),g;for(g in d)g in this.options||(b[g]=d[g]);d=c.setOptions(this,d);b.width=b.height=d.tileSize*(d.detectRetina&&c.Browser.retina?2:1);this.wmsParams=b},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;c.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var d=this._tileCoordsToBounds(a),b=this._crs.project(d.getNorthWest()),d=this._crs.project(d.getSouthEast()),b=(1.3<=this._wmsVersion&&this._crs===c.CRS.EPSG4326?[d.y,b.x,b.y,d.x]:[b.x,d.y,d.x,b.y]).join(",");a=c.TileLayer.prototype.getTileUrl.call(this,a);return a+c.Util.getParamString(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"\x26BBOX\x3d":"\x26bbox\x3d")+b},setParams:function(a,d){c.extend(this.wmsParams,a);d||this.redraw();return this}});c.tileLayer.wms=function(a,d){return new c.TileLayer.WMS(a,d)};c.ImageOverlay=c.Layer.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1},initialize:function(a,d,b){this._url=a;this._bounds=c.latLngBounds(d);c.setOptions(this,b)},onAdd:function(){this._image||(this._initImage(),1>this.options.opacity&&this._updateOpacity());this.options.interactive&&(c.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image));this.getPane().appendChild(this._image);this._reset()},onRemove:function(){c.DomUtil.remove(this._image);this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){this.options.opacity=a;this._image&&this._updateOpacity();return this},setStyle:function(a){a.opacity&&this.setOpacity(a.opacity);return this},bringToFront:function(){this._map&&c.DomUtil.toFront(this._image);return this},bringToBack:function(){this._map&&c.DomUtil.toBack(this._image);return this},setUrl:function(a){this._url=a;this._image&&(this._image.src=a);return this},setBounds:function(a){this._bounds=a;this._map&&this._reset();return this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._image=c.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));a.onselectstart=c.Util.falseFn;a.onmousemove=c.Util.falseFn;a.onload=c.bind(this.fire,this,"load");this.options.crossOrigin&&(a.crossOrigin="");a.src=this._url;a.alt=this.options.alt},_animateZoom:function(a){var d=this._map.getZoomScale(a.zoom);a=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;c.DomUtil.setTransform(this._image,a,d)},_reset:function(){var a=this._image,d=new c.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),b=d.getSize();c.DomUtil.setPosition(a,d.min);a.style.width=b.x+"px";a.style.height=b.y+"px"},_updateOpacity:function(){c.DomUtil.setOpacity(this._image,this.options.opacity)}});c.imageOverlay=function(a,d,b){return new c.ImageOverlay(a,d,b)};c.Icon=c.Class.extend({initialize:function(a){c.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,c){var b=this._getIconUrl(a);if(!b){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}b=this._createImg(b,c&&"IMG"===c.tagName?c:null);this._setIconStyles(b,a);return b},_setIconStyles:function(a,d){var b=this.options,g=b[d+"Size"];"number"===typeof g&&(g=[g,g]);var g=c.point(g),l=c.point("shadow"===d&&b.shadowAnchor||b.iconAnchor||g&&g.divideBy(2,!0));a.className="leaflet-marker-"+d+" "+(b.className||"");l&&(a.style.marginLeft=-l.x+"px",a.style.marginTop=-l.y+"px");g&&(a.style.width=g.x+"px",a.style.height=g.y+"px")},_createImg:function(a,c){c=c||e.createElement("img");c.src=a;return c},_getIconUrl:function(a){return c.Browser.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});c.icon=function(a){return new c.Icon(a)};c.Icon.Default=c.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){c.Icon.Default.imagePath||(c.Icon.Default.imagePath=this._detectIconPath());return(this.options.imagePath||c.Icon.Default.imagePath)+c.Icon.prototype._getIconUrl.call(this,a)},_detectIconPath:function(){var a=c.DomUtil.create("div","leaflet-default-icon-path",e.body),d=c.DomUtil.getStyle(a,"background-image")||c.DomUtil.getStyle(a,"backgroundImage");e.body.removeChild(a);return 0===d.indexOf("url")?d.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,""):""}});c.Marker=c.Layer.extend({options:{icon:new c.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(a,d){c.setOptions(this,d);this._latlng=c.latLng(a)},onAdd:function(a){if(this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation)a.on("zoomanim",this._animateZoom,this);this._initIcon();this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks());this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this);this._removeIcon();this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var d=this._latlng;this._latlng=c.latLng(a);this.update();return this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(a){this.options.zIndexOffset=a;return this.update()},setIcon:function(a){this.options.icon=a;this._map&&(this._initIcon(),this.update());this._popup&&this.bindPopup(this._popup,this._popup.options);return this},getElement:function(){return this._icon},update:function(){if(this._icon){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),b=a.icon.createIcon(this._icon),g=!1;b!==this._icon&&(this._icon&&this._removeIcon(),g=!0,a.title&&(b.title=a.title),a.alt&&(b.alt=a.alt));c.DomUtil.addClass(b,d);a.keyboard&&(b.tabIndex="0");this._icon=b;if(a.riseOnHover)this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var b=a.icon.createShadow(this._shadow),l=!1;b!==this._shadow&&(this._removeShadow(),l=!0);b&&(c.DomUtil.addClass(b,d),b.alt="");this._shadow=b;1>a.opacity&&this._updateOpacity();g&&this.getPane().appendChild(this._icon);this._initInteraction();b&&l&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex});c.DomUtil.remove(this._icon);this.removeInteractiveTarget(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&c.DomUtil.remove(this._shadow);this._shadow=null},_setPos:function(a){c.DomUtil.setPosition(this._icon,a);this._shadow&&c.DomUtil.setPosition(this._shadow,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(c.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),c.Handler.MarkerDrag)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable());this.dragging=new c.Handler.MarkerDrag(this);a&&this.dragging.enable()}},setOpacity:function(a){this.options.opacity=a;this._map&&this._updateOpacity();return this},_updateOpacity:function(){var a=this.options.opacity;c.DomUtil.setOpacity(this._icon,a);this._shadow&&c.DomUtil.setOpacity(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}});c.marker=function(a,d){return new c.Marker(a,d)};c.DivIcon=c.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){a=a&&"DIV"===a.tagName?a:e.createElement("div");var d=this.options;a.innerHTML=!1!==d.html?d.html:"";d.bgPos&&(d=c.point(d.bgPos),a.style.backgroundPosition=-d.x+"px "+-d.y+"px");this._setIconStyles(a,"icon");return a},createShadow:function(){return null}});c.divIcon=function(a){return new c.DivIcon(a)};c.DivOverlay=c.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(a,d){c.setOptions(this,a);this._source=d},onAdd:function(a){this._zoomAnimated=a._zoomAnimated;this._container||this._initLayout();a._fadeAnimated&&c.DomUtil.setOpacity(this._container,0);clearTimeout(this._removeTimeout);this.getPane().appendChild(this._container);this.update();a._fadeAnimated&&c.DomUtil.setOpacity(this._container,1);this.bringToFront()},onRemove:function(a){a._fadeAnimated?(c.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(c.bind(c.DomUtil.remove,c.DomUtil,this._container),200)):c.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(a){this._latlng=c.latLng(a);this._map&&(this._updatePosition(),this._adjustPan());return this},getContent:function(){return this._content},setContent:function(a){this._content=a;this.update();return this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){this._map&&c.DomUtil.toFront(this._container);return this},bringToBack:function(){this._map&&c.DomUtil.toBack(this._container);return this},_updateContent:function(){if(this._content){var a=this._contentNode,c="function"===typeof this._content?this._content(this._source||this):this._content;if("string"===typeof c)a.innerHTML=c;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),d=c.point(this.options.offset),b=this._getAnchor();this._zoomAnimated?c.DomUtil.setPosition(this._container,a.add(b)):d=d.add(a).add(b);a=this._containerBottom=-d.y;d=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=a+"px";this._container.style.left=d+"px"}},_getAnchor:function(){return[0,0]}});c.Popup=c.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(a){a.openPopup(this);return this},onAdd:function(a){c.DivOverlay.prototype.onAdd.call(this,a);a.fire("popupopen",{popup:this});if(this._source&&(this._source.fire("popupopen",{popup:this},!0),!(this._source instanceof c.Path)))this._source.on("preclick",c.DomEvent.stopPropagation)},onRemove:function(a){c.DivOverlay.prototype.onRemove.call(this,a);a.fire("popupclose",{popup:this});this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof c.Path||this._source.off("preclick",c.DomEvent.stopPropagation))},getEvents:function(){var a=c.DivOverlay.prototype.getEvents.call(this);if("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)a.preclick=this._close;this.options.keepInView&&(a.moveend=this._adjustPan);return a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a=this._container=c.DomUtil.create("div","leaflet-popup "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var d=this._closeButton=c.DomUtil.create("a","leaflet-popup-close-button",a);d.href="#close";d.innerHTML="\x26#215;";c.DomEvent.on(d,"click",this._onCloseButtonClick,this)}d=this._wrapper=c.DomUtil.create("div","leaflet-popup-content-wrapper",a);this._contentNode=c.DomUtil.create("div","leaflet-popup-content",d);c.DomEvent.disableClickPropagation(d).disableScrollPropagation(this._contentNode).on(d,"contextmenu",c.DomEvent.stopPropagation);this._tipContainer=c.DomUtil.create("div","leaflet-popup-tip-container",a);this._tip=c.DomUtil.create("div","leaflet-popup-tip",this._tipContainer)},_updateLayout:function(){var a=this._contentNode,d=a.style;d.width="";d.whiteSpace="nowrap";var b=a.offsetWidth,b=Math.min(b,this.options.maxWidth),b=Math.max(b,this.options.minWidth);d.width=b+1+"px";d.whiteSpace="";d.height="";var b=a.offsetHeight,g=this.options.maxHeight;g&&b>g?(d.height=g+"px",c.DomUtil.addClass(a,"leaflet-popup-scrolled")):c.DomUtil.removeClass(a,"leaflet-popup-scrolled");this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);var d=this._getAnchor();c.DomUtil.setPosition(this._container,a.add(d))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var a=this._map,d=parseInt(c.DomUtil.getStyle(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+d,b=this._containerWidth,g=new c.Point(this._containerLeft,-d-this._containerBottom);g._add(c.DomUtil.getPosition(this._container));var g=a.layerPointToContainerPoint(g),l=c.point(this.options.autoPanPadding),h=c.point(this.options.autoPanPaddingTopLeft||l),l=c.point(this.options.autoPanPaddingBottomRight||l),m=a.getSize(),e=0,k=0;g.x+b+l.x>m.x&&(e=g.x+b-m.x+l.x);0>g.x-e-h.x&&(e=g.x-h.x);g.y+d+l.y>m.y&&(k=g.y+d-m.y+l.y);0>g.y-k-h.y&&(k=g.y-h.y);(e||k)&&a.fire("autopanstart").panBy([e,k])}},_onCloseButtonClick:function(a){this._close();c.DomEvent.stop(a)},_getAnchor:function(){return c.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});c.popup=function(a,d){return new c.Popup(a,d)};c.Map.mergeOptions({closePopupOnClick:!0});c.Map.include({openPopup:function(a,d,b){a instanceof c.Popup||(a=(new c.Popup(b)).setContent(a));d&&a.setLatLng(d);if(this.hasLayer(a))return this;this._popup&&this._popup.options.autoClose&&this.closePopup();this._popup=a;return this.addLayer(a)},closePopup:function(a){a&&a!==this._popup||(a=this._popup,this._popup=null);a&&this.removeLayer(a);return this}});c.Layer.include({bindPopup:function(a,d){if(a instanceof c.Popup)c.setOptions(a,d),this._popup=a,a._source=this;else{if(!this._popup||d)this._popup=new c.Popup(d,this);this._popup.setContent(a)}this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0);return this},unbindPopup:function(){this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null);return this},openPopup:function(a,d){a instanceof c.Layer||(d=a,a=this);if(a instanceof c.FeatureGroup)for(var b in this._layers){a=this._layers[b];break}d||(d=a.getCenter?a.getCenter():a.getLatLng());this._popup&&this._map&&(this._popup._source=a,this._popup.update(),this._map.openPopup(this._popup,d));return this},closePopup:function(){this._popup&&this._popup._close();return this},togglePopup:function(a){this._popup&&(this._popup._map?this.closePopup():this.openPopup(a));return this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){this._popup&&this._popup.setContent(a);return this},getPopup:function(){return this._popup},_openPopup:function(a){var d=a.layer||a.target;this._popup&&this._map&&(c.DomEvent.stop(a),d instanceof c.Path?this.openPopup(a.layer||a.target,a.latlng):this._map.hasLayer(this._popup)&&this._popup._source===d?this.closePopup():this.openPopup(d,a.latlng))},_movePopup:function(a){this._popup.setLatLng(a.latlng)}});c.Tooltip=c.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(a){c.DivOverlay.prototype.onAdd.call(this,a);this.setOpacity(this.options.opacity);a.fire("tooltipopen",{tooltip:this});this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(a){c.DivOverlay.prototype.onRemove.call(this,a);a.fire("tooltipclose",{tooltip:this});this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var a=c.DivOverlay.prototype.getEvents.call(this);c.Browser.touch&&!this.options.permanent&&(a.preclick=this._close);return a},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=c.DomUtil.create("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var d=this._map,b=this._container,g=d.latLngToContainerPoint(d.getCenter()),d=d.layerPointToContainerPoint(a),l=this.options.direction,h=b.offsetWidth,m=b.offsetHeight,e=c.point(this.options.offset),k=this._getAnchor();"top"===l?a=a.add(c.point(-h/2+e.x,-m+e.y+k.y,!0)):"bottom"===l?a=a.subtract(c.point(h/2-e.x,-e.y,!0)):"center"===l?a=a.subtract(c.point(h/2+e.x,m/2-k.y+e.y,!0)):"right"===l||"auto"===l&&d.x<g.x?(l="right",a=a.add(c.point(e.x+k.x,k.y-m/2+e.y,!0))):(l="left",a=a.subtract(c.point(h+k.x-e.x,m/2-k.y-e.y,!0)));c.DomUtil.removeClass(b,"leaflet-tooltip-right");c.DomUtil.removeClass(b,"leaflet-tooltip-left");c.DomUtil.removeClass(b,"leaflet-tooltip-top");c.DomUtil.removeClass(b,"leaflet-tooltip-bottom");c.DomUtil.addClass(b,"leaflet-tooltip-"+l);c.DomUtil.setPosition(b,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a;this._container&&c.DomUtil.setOpacity(this._container,a)},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(a)},_getAnchor:function(){return c.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});c.tooltip=function(a,d){return new c.Tooltip(a,d)};c.Map.include({openTooltip:function(a,d,b){a instanceof c.Tooltip||(a=(new c.Tooltip(b)).setContent(a));d&&a.setLatLng(d);return this.hasLayer(a)?this:this.addLayer(a)},closeTooltip:function(a){a&&this.removeLayer(a);return this}});c.Layer.include({bindTooltip:function(a,d){if(a instanceof c.Tooltip)c.setOptions(a,d),this._tooltip=a,a._source=this;else{if(!this._tooltip||d)this._tooltip=c.tooltip(d,this);this._tooltip.setContent(a)}this._initTooltipInteractions();this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip();return this},unbindTooltip:function(){this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null);return this},_initTooltipInteractions:function(a){if(a||!this._tooltipHandlersAdded){var d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),c.Browser.touch&&(d.click=this._openTooltip));this[a?"off":"on"](d);this._tooltipHandlersAdded=!a}},openTooltip:function(a,d){a instanceof c.Layer||(d=a,a=this);if(a instanceof c.FeatureGroup)for(var b in this._layers){a=this._layers[b];break}d||(d=a.getCenter?a.getCenter():a.getLatLng());this._tooltip&&this._map&&(this._tooltip._source=a,this._tooltip.update(),this._map.openTooltip(this._tooltip,d),this._tooltip.options.interactive&&this._tooltip._container&&(c.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container)));return this},closeTooltip:function(){this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(c.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container)));return this},toggleTooltip:function(a){this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(a));return this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){this._tooltip&&this._tooltip.setContent(a);return this},getTooltip:function(){return this._tooltip},_openTooltip:function(a){var c=a.layer||a.target;this._tooltip&&this._map&&this.openTooltip(c,this._tooltip.options.sticky?a.latlng:k)},_moveTooltip:function(a){var c=a.latlng;this._tooltip.options.sticky&&a.originalEvent&&(a=this._map.mouseEventToContainerPoint(a.originalEvent),a=this._map.containerPointToLayerPoint(a),c=this._map.layerPointToLatLng(a));this._tooltip.setLatLng(c)}});c.LayerGroup=c.Layer.extend({initialize:function(a){this._layers={};var c,b;if(a)for(c=0,b=a.length;c<b;c++)this.addLayer(a[c])},addLayer:function(a){var c=this.getLayerId(a);this._layers[c]=a;this._map&&this._map.addLayer(a);return this},removeLayer:function(a){a=a in this._layers?a:this.getLayerId(a);this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]);delete this._layers[a];return this},hasLayer:function(a){return!!a&&(a in this._layers||this.getLayerId(a)in this._layers)},clearLayers:function(){for(var a in this._layers)this.removeLayer(this._layers[a]);return this},invoke:function(a){var c=Array.prototype.slice.call(arguments,1),b,g;for(b in this._layers)g=this._layers[b],g[a]&&g[a].apply(g,c);return this},onAdd:function(a){for(var c in this._layers)a.addLayer(this._layers[c])},onRemove:function(a){for(var c in this._layers)a.removeLayer(this._layers[c])},eachLayer:function(a,c){for(var b in this._layers)a.call(c,this._layers[b]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[],c;for(c in this._layers)a.push(this._layers[c]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return c.stamp(a)}});c.layerGroup=function(a){return new c.LayerGroup(a)};c.FeatureGroup=c.LayerGroup.extend({addLayer:function(a){if(this.hasLayer(a))return this;a.addEventParent(this);c.LayerGroup.prototype.addLayer.call(this,a);return this.fire("layeradd",{layer:a})},removeLayer:function(a){if(!this.hasLayer(a))return this;a in this._layers&&(a=this._layers[a]);a.removeEventParent(this);c.LayerGroup.prototype.removeLayer.call(this,a);return this.fire("layerremove",{layer:a})},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new c.LatLngBounds,b;for(b in this._layers){var f=this._layers[b];a.extend(f.getBounds?f.getBounds():f.getLatLng())}return a}});c.featureGroup=function(a){return new c.FeatureGroup(a)};c.Renderer=c.Layer.extend({options:{padding:.1},initialize:function(a){c.setOptions(this,a);c.stamp(this);this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&c.DomUtil.addClass(this._container,"leaflet-zoom-animated"));this.getPane().appendChild(this._container);this._update();this.on("update",this._updatePaths,this)},onRemove:function(){c.DomUtil.remove(this._container);this.off("update",this._updatePaths,this)},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};this._zoomAnimated&&(a.zoomanim=this._onAnimZoom);return a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,b){var f=this._map.getZoomScale(b,this._zoom),g=c.DomUtil.getPosition(this._container),l=this._map.getSize().multiplyBy(.5+this.options.padding),h=this._map.project(this._center,b),h=this._map.project(a,b).subtract(h),g=l.multiplyBy(-f).add(g).add(l).subtract(h);c.Browser.any3d?c.DomUtil.setTransform(this._container,g,f):c.DomUtil.setPosition(this._container,g)},_reset:function(){this._update();this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,b=this._map.getSize(),f=this._map.containerPointToLayerPoint(b.multiplyBy(-a)).round();this._bounds=new c.Bounds(f,f.add(b.multiplyBy(1+2*a)).round());this._center=this._map.getCenter();this._zoom=this._map.getZoom()}});c.Map.include({getRenderer:function(a){a=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;a||(a=this._renderer=this.options.preferCanvas&&c.canvas()||c.svg());this.hasLayer(a)||this.addLayer(a);return a},_getPaneRenderer:function(a){if("overlayPane"===a||a===k)return!1;var b=this._paneRenderers[a];b===k&&(b=c.SVG&&c.svg({pane:a})||c.Canvas&&c.canvas({pane:a}),this._paneRenderers[a]=b);return b}});c.Path=c.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this);this._reset();this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){this._map&&this._renderer._updatePath(this);return this},setStyle:function(a){c.setOptions(this,a);this._renderer&&this._renderer._updateStyle(this);return this},bringToFront:function(){this._renderer&&this._renderer._bringToFront(this);return this},bringToBack:function(){this._renderer&&this._renderer._bringToBack(this);return this},getElement:function(){return this._path},_reset:function(){this._project();this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(c.Browser.touch?10:0)}});c.LineUtil={simplify:function(a,c){if(!c||!a.length)return a.slice();var b=c*c;a=this._reducePoints(a,b);return a=this._simplifyDP(a,b)},pointToSegmentDistance:function(a,c,b){return Math.sqrt(this._sqClosestPointOnSegment(a,c,b,!0))},closestPointOnSegment:function(a,c,b){return this._sqClosestPointOnSegment(a,c,b)},_simplifyDP:function(a,c){var b=a.length,g=new (typeof Uint8Array!==k+""?Uint8Array:Array)(b);g[0]=g[b-1]=1;this._simplifyDPStep(a,g,c,0,b-1);var l,h=[];for(l=0;l<b;l++)g[l]&&h.push(a[l]);return h},_simplifyDPStep:function(a,c,b,g,l){var h=0,m,e,k;for(e=g+1;e<=l-1;e++)k=this._sqClosestPointOnSegment(a[e],a[g],a[l],!0),k>h&&(m=e,h=k);h>b&&(c[m]=1,this._simplifyDPStep(a,c,b,g,m),this._simplifyDPStep(a,c,b,m,l))},_reducePoints:function(a,c){for(var b=[a[0]],g=1,l=0,h=a.length;g<h;g++)this._sqDist(a[g],a[l])>c&&(b.push(a[g]),l=g);l<h-1&&b.push(a[h-1]);return b},clipSegment:function(a,c,b,g,l){g=g?this._lastCode:this._getBitCode(a,b);var h=this._getBitCode(c,b),m,e,k;for(this._lastCode=h;;){if(!(g|h))return[a,c];if(g&h)return!1;m=g||h;e=this._getEdgeIntersection(a,c,m,b,l);k=this._getBitCode(e,b);m===g?(a=e,g=k):(c=e,h=k)}},_getEdgeIntersection:function(a,b,f,g,l){var h=b.x-a.x;b=b.y-a.y;var m=g.min;g=g.max;var e,k;f&8?(e=a.x+h*(g.y-a.y)/b,k=g.y):f&4?(e=a.x+h*(m.y-a.y)/b,k=m.y):f&2?(e=g.x,k=a.y+b*(g.x-a.x)/h):f&1&&(e=m.x,k=a.y+b*(m.x-a.x)/h);return new c.Point(e,k,l)},_getBitCode:function(a,c){var b=0;a.x<c.min.x?b|=1:a.x>c.max.x&&(b|=2);a.y<c.min.y?b|=4:a.y>c.max.y&&(b|=8);return b},_sqDist:function(a,c){var b=c.x-a.x,g=c.y-a.y;return b*b+g*g},_sqClosestPointOnSegment:function(a,b,f,g){var l=b.x;b=b.y;var h=f.x-l,m=f.y-b,e=h*h+m*m;0<e&&(e=((a.x-l)*h+(a.y-b)*m)/e,1<e?(l=f.x,b=f.y):0<e&&(l+=h*e,b+=m*e));h=a.x-l;m=a.y-b;return g?h*h+m*m:new c.Point(l,b)}};c.Polyline=c.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,b){c.setOptions(this,b);this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){this._setLatLngs(a);return this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var b=Infinity,f=null,g=c.LineUtil._sqClosestPointOnSegment,l,h,m=0,e=this._parts.length;m<e;m++)for(var k=this._parts[m],q=1,n=k.length;q<n;q++){l=k[q-1];h=k[q];var t=g(a,l,h,!0);t<b&&(b=t,f=g(a,l,h))}f&&(f.distance=Math.sqrt(b));return f},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,c,b,g,l,h,m=this._rings[0],e=m.length;if(!e)return null;for(c=a=0;a<e-1;a++)c+=m[a].distanceTo(m[a+1])/2;if(0===c)return this._map.layerPointToLatLng(m[0]);for(g=a=0;a<e-1;a++)if(l=m[a],h=m[a+1],b=l.distanceTo(h),g+=b,g>c)return a=(g-c)/b,this._map.layerPointToLatLng([h.x-a*(h.x-l.x),h.y-a*(h.y-l.y)])},getBounds:function(){return this._bounds},addLatLng:function(a,b){b=b||this._defaultShape();a=c.latLng(a);b.push(a);this._bounds.extend(a);return this.redraw()},_setLatLngs:function(a){this._bounds=new c.LatLngBounds;this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return c.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var b=[],f=c.Polyline._flat(a),g=0,l=a.length;g<l;g++)f?(b[g]=c.latLng(a[g]),this._bounds.extend(b[g])):b[g]=this._convertLatLngs(a[g]);return b},_project:function(){var a=new c.Bounds;this._rings=[];this._projectLatlngs(this._latlngs,this._rings,a);var b=this._clickTolerance(),b=new c.Point(b,b);this._bounds.isValid()&&a.isValid()&&(a.min._subtract(b),a.max._add(b),this._pxBounds=a)},_projectLatlngs:function(a,b,f){var g=a.length,l,h;if(a[0]instanceof c.LatLng){h=[];for(l=0;l<g;l++)h[l]=this._map.latLngToLayerPoint(a[l]),f.extend(h[l]);b.push(h)}else for(l=0;l<g;l++)this._projectLatlngs(a[l],b,f)},_clipPoints:function(){var a=this._renderer._bounds;this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else{var b=this._parts,f,g,l,h,m,e,k;l=f=0;for(h=this._rings.length;f<h;f++)for(k=this._rings[f],g=0,m=k.length;g<m-1;g++)if(e=c.LineUtil.clipSegment(k[g],k[g+1],a,g,!0))if(b[l]=b[l]||[],b[l].push(e[0]),e[1]!==k[g+1]||g===m-2)b[l].push(e[1]),l++}},_simplifyPoints:function(){for(var a=this._parts,b=this.options.smoothFactor,f=0,g=a.length;f<g;f++)a[f]=c.LineUtil.simplify(a[f],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}});c.polyline=function(a,b){return new c.Polyline(a,b)};c.Polyline._flat=function(a){return!c.Util.isArray(a[0])||"object"!==typeof a[0][0]&&"undefined"!==typeof a[0][0]};c.PolyUtil={};c.PolyUtil.clipPolygon=function(a,b,f){var g,l=[1,4,2,8],h,m,e,k,q,n,t=c.LineUtil;h=0;for(q=a.length;h<q;h++)a[h]._code=t._getBitCode(a[h],b);for(e=0;4>e;e++){n=l[e];g=[];h=0;q=a.length;for(m=q-1;h<q;m=h++)(k=a[h],m=a[m],k._code&n)?m._code&n||(m=t._getEdgeIntersection(m,k,n,b,f),m._code=t._getBitCode(m,b),g.push(m)):(m._code&n&&(m=t._getEdgeIntersection(m,k,n,b,f),m._code=t._getBitCode(m,b),g.push(m)),g.push(k));a=g}return a};c.Polygon=c.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,c,b,g,l,h,m,e=this._rings[0],k=e.length;if(!k)return null;a=l=h=m=0;for(c=k-1;a<k;c=a++)b=e[a],c=e[c],g=b.y*c.x-c.y*b.x,h+=(b.x+c.x)*g,m+=(b.y+c.y)*g,l+=3*g;return this._map.layerPointToLatLng(0===l?e[0]:[h/l,m/l])},_convertLatLngs:function(a){a=c.Polyline.prototype._convertLatLngs.call(this,a);var b=a.length;2<=b&&a[0]instanceof c.LatLng&&a[0].equals(a[b-1])&&a.pop();return a},_setLatLngs:function(a){c.Polyline.prototype._setLatLngs.call(this,a);c.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return c.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,b=this.options.weight,b=new c.Point(b,b),a=new c.Bounds(a.min.subtract(b),a.max.add(b));this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else for(var b=0,f=this._rings.length,g;b<f;b++)g=c.PolyUtil.clipPolygon(this._rings[b],a,!0),g.length&&this._parts.push(g)},_updatePath:function(){this._renderer._updatePoly(this,!0)}});c.polygon=function(a,b){return new c.Polygon(a,b)};c.Rectangle=c.Polygon.extend({initialize:function(a,b){c.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),b)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){a=c.latLngBounds(a);return[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});c.rectangle=function(a,b){return new c.Rectangle(a,b)};c.CircleMarker=c.Path.extend({options:{fill:!0,radius:10},initialize:function(a,b){c.setOptions(this,b);this._latlng=c.latLng(a);this._radius=this.options.radius},setLatLng:function(a){this._latlng=c.latLng(a);this.redraw();return this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){this.options.radius=this._radius=a;return this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var b=a&&a.radius||this._radius;c.Path.prototype.setStyle.call(this,a);this.setRadius(b);return this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var a=this._radius,b=this._radiusY||a,f=this._clickTolerance(),a=[a+f,b+f];this._pxBounds=new c.Bounds(this._point.subtract(a),this._point.add(a))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}});c.circleMarker=function(a,b){return new c.CircleMarker(a,b)};c.Circle=c.CircleMarker.extend({initialize:function(a,b,f){"number"===typeof b&&(b=c.extend({},f,{radius:b}));c.setOptions(this,b);this._latlng=c.latLng(a);if(isNaN(this.options.radius))throw Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){this._mRadius=a;return this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new c.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:c.Path.prototype.setStyle,_project:function(){var a=this._latlng.lng,b=this._latlng.lat,f=this._map,g=f.options.crs;if(g.distance===c.CRS.Earth.distance){var l=Math.PI/180,g=this._mRadius/c.CRS.Earth.R/l,h=f.project([b+g,a]),m=f.project([b-g,a]),m=h.add(m).divideBy(2),e=f.unproject(m).lat,l=Math.acos((Math.cos(g*l)-Math.sin(b*l)*Math.sin(e*l))/(Math.cos(b*l)*Math.cos(e*l)))/l;if(isNaN(l)||0===l)l=g/Math.cos(Math.PI/180*b);this._point=m.subtract(f.getPixelOrigin());this._radius=isNaN(l)?0:Math.max(Math.round(m.x-f.project([e,a-l]).x),1);this._radiusY=Math.max(Math.round(m.y-h.y),1)}else a=g.unproject(g.project(this._latlng).subtract([this._mRadius,0])),this._point=f.latLngToLayerPoint(this._latlng),this._radius=this._point.x-f.latLngToLayerPoint(a).x;this._updateBounds()}});c.circle=function(a,b,f){return new c.Circle(a,b,f)};c.SVG=c.Renderer.extend({getEvents:function(){var a=c.Renderer.prototype.getEvents.call(this);a.zoomstart=this._onZoomStart;return a},_initContainer:function(){this._container=c.SVG.create("svg");this._container.setAttribute("pointer-events","none");this._rootGroup=c.SVG.create("g");this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){c.Renderer.prototype._update.call(this);var a=this._bounds,b=a.getSize(),f=this._container;this._svgSize&&this._svgSize.equals(b)||(this._svgSize=b,f.setAttribute("width",b.x),f.setAttribute("height",b.y));c.DomUtil.setPosition(f,a.min);f.setAttribute("viewBox",[a.min.x,a.min.y,b.x,b.y].join(" "));this.fire("update")}},_initPath:function(a){var b=a._path=c.SVG.create("path");a.options.className&&c.DomUtil.addClass(b,a.options.className);a.options.interactive&&c.DomUtil.addClass(b,"leaflet-interactive");this._updateStyle(a);this._layers[c.stamp(a)]=a},_addPath:function(a){this._rootGroup.appendChild(a._path);a.addInteractiveTarget(a._path)},_removePath:function(a){c.DomUtil.remove(a._path);a.removeInteractiveTarget(a._path);delete this._layers[c.stamp(a)]},_updatePath:function(a){a._project();a._update()},_updateStyle:function(a){var c=a._path;a=a.options;c&&(a.stroke?(c.setAttribute("stroke",a.color),c.setAttribute("stroke-opacity",a.opacity),c.setAttribute("stroke-width",a.weight),c.setAttribute("stroke-linecap",a.lineCap),c.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?c.setAttribute("stroke-dasharray",a.dashArray):c.removeAttribute("stroke-dasharray"),a.dashOffset?c.setAttribute("stroke-dashoffset",a.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),a.fill?(c.setAttribute("fill",a.fillColor||a.color),c.setAttribute("fill-opacity",a.fillOpacity),c.setAttribute("fill-rule",a.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(a,b){this._setPath(a,c.SVG.pointsToPath(a._parts,b))},_updateCircle:function(a){var c=a._point,b=a._radius,g="a"+b+","+(a._radiusY||b)+" 0 1,0 ",c=a._empty()?"M0 0":"M"+(c.x-b)+","+c.y+g+2*b+",0 "+g+2*-b+",0 ";this._setPath(a,c)},_setPath:function(a,c){a._path.setAttribute("d",c)},_bringToFront:function(a){c.DomUtil.toFront(a._path)},_bringToBack:function(a){c.DomUtil.toBack(a._path)}});c.extend(c.SVG,{create:function(a){return e.createElementNS("http://www.w3.org/2000/svg",a)},pointsToPath:function(a,b){var f="",g,l,h,m,e,k;g=0;for(h=a.length;g<h;g++){e=a[g];l=0;for(m=e.length;l<m;l++)k=e[l],f+=(l?"L":"M")+k.x+" "+k.y;f+=b?c.Browser.svg?"z":"x":""}return f||"M0 0"}});c.Browser.svg=!(!e.createElementNS||!c.SVG.create("svg").createSVGRect);c.svg=function(a){return c.Browser.svg||c.Browser.vml?new c.SVG(a):null};c.Browser.vml=!c.Browser.svg&&function(){try{var a=e.createElement("div");a.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';var c=a.firstChild;c.style.behavior="url(#default#VML)";return c&&"object"===typeof c.adj}catch(b){return!1}}();c.SVG.include(c.Browser.vml?{_initContainer:function(){this._container=c.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(c.Renderer.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var b=a._container=c.SVG.create("shape");c.DomUtil.addClass(b,"leaflet-vml-shape "+(this.options.className||""));b.coordsize="1 1";a._path=c.SVG.create("path");b.appendChild(a._path);this._updateStyle(a);this._layers[c.stamp(a)]=a},_addPath:function(a){var c=a._container;this._container.appendChild(c);a.options.interactive&&a.addInteractiveTarget(c)},_removePath:function(a){var b=a._container;c.DomUtil.remove(b);a.removeInteractiveTarget(b);delete this._layers[c.stamp(a)]},_updateStyle:function(a){var b=a._stroke,f=a._fill,g=a.options,l=a._container;l.stroked=!!g.stroke;l.filled=!!g.fill;g.stroke?(b||(b=a._stroke=c.SVG.create("stroke")),l.appendChild(b),b.weight=g.weight+"px",b.color=g.color,b.opacity=g.opacity,b.dashStyle=g.dashArray?c.Util.isArray(g.dashArray)?g.dashArray.join(" "):g.dashArray.replace(/( *, *)/g," "):"",b.endcap=g.lineCap.replace("butt","flat"),b.joinstyle=g.lineJoin):b&&(l.removeChild(b),a._stroke=null);g.fill?(f||(f=a._fill=c.SVG.create("fill")),l.appendChild(f),f.color=g.fillColor||g.color,f.opacity=g.fillOpacity):f&&(l.removeChild(f),a._fill=null)},_updateCircle:function(a){var c=a._point.round(),b=Math.round(a._radius),g=Math.round(a._radiusY||b);this._setPath(a,a._empty()?"M0 0":"AL "+c.x+","+c.y+" "+b+","+g+" 0,23592600")},_setPath:function(a,c){a._path.v=c},_bringToFront:function(a){c.DomUtil.toFront(a._container)},_bringToBack:function(a){c.DomUtil.toBack(a._container)}}:{});c.Browser.vml&&(c.SVG.create=function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return e.createElement("\x3clvml:"+a+' class\x3d"lvml"\x3e')}}catch(a){return function(a){return e.createElement("\x3c"+a+' xmlns\x3d"urn:schemas-microsoft.com:vml" class\x3d"lvml"\x3e')}}}());c.Canvas=c.Renderer.extend({getEvents:function(){var a=c.Renderer.prototype.getEvents.call(this);a.viewprereset=this._onViewPreReset;return a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){c.Renderer.prototype.onAdd.call(this);this._draw()},_initContainer:function(){var a=this._container=e.createElement("canvas");c.DomEvent.on(a,"mousemove",c.Util.throttle(this._onMouseMove,32,this),this).on(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(a,"mouseout",this._handleMouseOut,this);this._ctx=a.getContext("2d")},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var c in this._layers)a=this._layers[c],a._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={};c.Renderer.prototype._update.call(this);var a=this._bounds,b=this._container,f=a.getSize(),g=c.Browser.retina?2:1;c.DomUtil.setPosition(b,a.min);b.width=g*f.x;b.height=g*f.y;b.style.width=f.x+"px";b.style.height=f.y+"px";c.Browser.retina&&this._ctx.scale(2,2);this._ctx.translate(-a.min.x,-a.min.y);this.fire("update")}},_reset:function(){c.Renderer.prototype._reset.call(this);this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a);this._layers[c.stamp(a)]=a;a=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a);this._drawLast=a;this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var b=a._order,f=b.next,b=b.prev;f?f.prev=b:this._drawLast=b;b?b.next=f:this._drawFirst=f;delete a._order;delete this._layers[c.stamp(a)];this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a);a._project();a._update();this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a);this._requestRedraw(a)},_updateDashArray:function(a){if(a.options.dashArray){var c=a.options.dashArray.split(","),b=[],g;for(g=0;g<c.length;g++)b.push(Number(c[g]));a.options._dashArray=b}},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||c.Util.requestAnimFrame(this._redraw,this))},_extendRedrawBounds:function(a){var b=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new c.Bounds;this._redrawBounds.extend(a._pxBounds.min.subtract([b,b]));this._redrawBounds.extend(a._pxBounds.max.add([b,b]))},_redraw:function(){this._redrawRequest=null;this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil());this._clear();this._draw();this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var c=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,c.x,c.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var a,c=this._redrawBounds;this._ctx.save();c&&(a=c.getSize(),this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,a.x,a.y),this._ctx.clip());this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)a=b.layer,(!c||a._pxBounds&&a._pxBounds.intersects(c))&&a._updatePath();this._drawing=!1;this._ctx.restore()},_updatePoly:function(a,c){if(this._drawing){var b,g,l,h,m=a._parts,e=m.length,k=this._ctx;if(e){this._drawnLayers[a._leaflet_id]=a;k.beginPath();k.setLineDash&&k.setLineDash(a.options&&a.options._dashArray||[]);for(b=0;b<e;b++){g=0;for(l=m[b].length;g<l;g++)h=m[b][g],k[g?"lineTo":"moveTo"](h.x,h.y);c&&k.closePath()}this._fillStroke(k,a)}}},_updateCircle:function(a){if(this._drawing&&!a._empty()){var c=a._point,b=this._ctx,g=a._radius,l=(a._radiusY||g)/g;this._drawnLayers[a._leaflet_id]=a;1!==l&&(b.save(),b.scale(1,l));b.beginPath();b.arc(c.x,c.y/l,g,0,2*Math.PI,!1);1!==l&&b.restore();this._fillStroke(b,a)}},_fillStroke:function(a,c){var b=c.options;b.fill&&(a.globalAlpha=b.fillOpacity,a.fillStyle=b.fillColor||b.color,a.fill(b.fillRule||"evenodd"));b.stroke&&0!==b.weight&&(a.globalAlpha=b.opacity,a.lineWidth=b.weight,a.strokeStyle=b.color,a.lineCap=b.lineCap,a.lineJoin=b.lineJoin,a.stroke())},_onClick:function(a){for(var b=this._map.mouseEventToLayerPoint(a),f,g,l=this._drawFirst;l;l=l.next)f=l.layer,f.options.interactive&&f._containsPoint(b)&&!this._map._draggableMoved(f)&&(g=f);g&&(c.DomEvent._fakeStop(a),this._fireEvent([g],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var c=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,c)}},_handleMouseOut:function(a){var b=this._hoveredLayer;b&&(c.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([b],a,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(a,b){for(var f,g,l=this._drawFirst;l;l=l.next)f=l.layer,f.options.interactive&&f._containsPoint(b)&&(g=f);g!==this._hoveredLayer&&(this._handleMouseOut(a),g&&(c.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([g],a,"mouseover"),this._hoveredLayer=g));this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a)},_fireEvent:function(a,c,b){this._map._fireDOMEvent(c,b||c.type,a)},_bringToFront:function(a){var c=a._order,b=c.next,g=c.prev;b&&((b.prev=g)?g.next=b:b&&(this._drawFirst=b),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(a))},_bringToBack:function(a){var c=a._order,b=c.next,g=c.prev;g&&((g.next=b)?b.prev=g:g&&(this._drawLast=g),c.prev=null,c.next=this._drawFirst,this._drawFirst=this._drawFirst.prev=c,this._requestRedraw(a))}});c.Browser.canvas=!!e.createElement("canvas").getContext;c.canvas=function(a){return c.Browser.canvas?new c.Canvas(a):null};c.Polyline.prototype._containsPoint=function(a,b){var f,g,l,h,m,e,k=this._clickTolerance();if(!this._pxBounds.contains(a))return!1;f=0;for(h=this._parts.length;f<h;f++)for(e=this._parts[f],g=0,m=e.length,l=m-1;g<m;l=g++)if((b||0!==g)&&c.LineUtil.pointToSegmentDistance(a,e[l],e[g])<=k)return!0;return!1};c.Polygon.prototype._containsPoint=function(a){var b=!1,f,g,l,h,m,e,k;if(!this._pxBounds.contains(a))return!1;h=0;for(e=this._parts.length;h<e;h++)for(f=this._parts[h],m=0,k=f.length,l=k-1;m<k;l=m++)g=f[m],l=f[l],g.y>a.y!==l.y>a.y&&a.x<(l.x-g.x)*(a.y-g.y)/(l.y-g.y)+g.x&&(b=!b);return b||c.Polyline.prototype._containsPoint.call(this,a,!0)};c.CircleMarker.prototype._containsPoint=function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()};c.GeoJSON=c.FeatureGroup.extend({initialize:function(a,b){c.setOptions(this,b);this._layers={};a&&this.addData(a)},addData:function(a){var b=c.Util.isArray(a)?a:a.features,f,g;if(b){a=0;for(f=b.length;a<f;a++)g=b[a],(g.geometries||g.geometry||g.features||g.coordinates)&&this.addData(g);return this}b=this.options;if(b.filter&&!b.filter(a))return this;f=c.GeoJSON.geometryToLayer(a,b);if(!f)return this;f.feature=c.GeoJSON.asFeature(a);f.defaultOptions=f.options;this.resetStyle(f);if(b.onEachFeature)b.onEachFeature(a,f);return this.addLayer(f)},resetStyle:function(a){a.options=c.Util.extend({},a.defaultOptions);this._setLayerStyle(a,this.options.style);return this},setStyle:function(a){return this.eachLayer(function(c){this._setLayerStyle(c,a)},this)},_setLayerStyle:function(a,c){"function"===typeof c&&(c=c(a.feature));a.setStyle&&a.setStyle(c)}});c.extend(c.GeoJSON,{geometryToLayer:function(a,b){var f="Feature"===a.type?a.geometry:a,g=f?f.coordinates:null,l=[],h=b&&b.pointToLayer,m=b&&b.coordsToLatLng||this.coordsToLatLng,e,k;if(!g&&!f)return null;switch(f.type){case "Point":return f=m(g),h?h(a,f):new c.Marker(f);case "MultiPoint":e=0;for(k=g.length;e<k;e++)f=m(g[e]),l.push(h?h(a,f):new c.Marker(f));return new c.FeatureGroup(l);case "LineString":case "MultiLineString":return l=this.coordsToLatLngs(g,"LineString"===f.type?0:1,m),new c.Polyline(l,b);case "Polygon":case "MultiPolygon":return l=this.coordsToLatLngs(g,"Polygon"===f.type?1:2,m),new c.Polygon(l,b);case "GeometryCollection":e=0;for(k=f.geometries.length;e<k;e++)(g=this.geometryToLayer({geometry:f.geometries[e],type:"Feature",properties:a.properties},b))&&l.push(g);return new c.FeatureGroup(l);default:throw Error("Invalid GeoJSON object.");}},coordsToLatLng:function(a){return new c.LatLng(a[1],a[0],a[2])},coordsToLatLngs:function(a,c,b){for(var g=[],l=0,h=a.length,m;l<h;l++)m=c?this.coordsToLatLngs(a[l],c-1,b):(b||this.coordsToLatLng)(a[l]),g.push(m);return g},latLngToCoords:function(a){return a.alt!==k?[a.lng,a.lat,a.alt]:[a.lng,a.lat]},latLngsToCoords:function(a,b,f){for(var g=[],l=0,h=a.length;l<h;l++)g.push(b?c.GeoJSON.latLngsToCoords(a[l],b-1,f):c.GeoJSON.latLngToCoords(a[l]));!b&&f&&g.push(g[0]);return g},getFeature:function(a,b){return a.feature?c.extend({},a.feature,{geometry:b}):c.GeoJSON.asFeature(b)},asFeature:function(a){return"Feature"===a.type||"FeatureCollection"===a.type?a:{type:"Feature",properties:{},geometry:a}}});h={toGeoJSON:function(){return c.GeoJSON.getFeature(this,{type:"Point",coordinates:c.GeoJSON.latLngToCoords(this.getLatLng())})}};c.Marker.include(h);c.Circle.include(h);c.CircleMarker.include(h);c.Polyline.prototype.toGeoJSON=function(){var a=!c.Polyline._flat(this._latlngs),b=c.GeoJSON.latLngsToCoords(this._latlngs,a?1:0);return c.GeoJSON.getFeature(this,{type:(a?"Multi":"")+"LineString",coordinates:b})};c.Polygon.prototype.toGeoJSON=function(){var a=!c.Polyline._flat(this._latlngs),b=a&&!c.Polyline._flat(this._latlngs[0]),f=c.GeoJSON.latLngsToCoords(this._latlngs,b?2:a?1:0,!0);a||(f=[f]);return c.GeoJSON.getFeature(this,{type:(b?"Multi":"")+"Polygon",coordinates:f})};c.LayerGroup.include({toMultiPoint:function(){var a=[];this.eachLayer(function(c){a.push(c.toGeoJSON().geometry.coordinates)});return c.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===a)return this.toMultiPoint();var b="GeometryCollection"===a,f=[];this.eachLayer(function(a){a.toGeoJSON&&(a=a.toGeoJSON(),f.push(b?a.geometry:c.GeoJSON.asFeature(a)))});return b?c.GeoJSON.getFeature(this,{geometries:f,type:"GeometryCollection"}):{type:"FeatureCollection",features:f}}});c.geoJSON=function(a,b){return new c.GeoJSON(a,b)};c.geoJson=c.geoJSON;c.Draggable=c.Evented.extend({options:{clickTolerance:3},statics:{START:c.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,c,b){this._element=a;this._dragStartTarget=c||a;this._preventOutline=b},enable:function(){this._enabled||(c.DomEvent.on(this._dragStartTarget,c.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(c.Draggable._dragging===this&&this.finishDrag(),c.DomEvent.off(this._dragStartTarget,c.Draggable.START.join(" "),this._onDown,this),this._moved=this._enabled=!1)},_onDown:function(a){if(!a._simulated&&this._enabled&&(this._moved=!1,!(c.DomUtil.hasClass(this._element,"leaflet-zoom-anim")||c.Draggable._dragging||a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(c.Draggable._dragging=this,this._preventOutline&&c.DomUtil.preventOutline(this._element),c.DomUtil.disableImageDrag(),c.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var b=a.touches?a.touches[0]:a;this._startPoint=new c.Point(b.clientX,b.clientY);c.DomEvent.on(e,c.Draggable.MOVE[a.type],this._onMove,this).on(e,c.Draggable.END[a.type],this._onUp,this)}},_onMove:function(a){if(!a._simulated&&this._enabled)if(a.touches&&1<a.touches.length)this._moved=!0;else{var b=a.touches&&1===a.touches.length?a.touches[0]:a,b=(new c.Point(b.clientX,b.clientY)).subtract(this._startPoint);!b.x&&!b.y||Math.abs(b.x)+Math.abs(b.y)<this.options.clickTolerance||(c.DomEvent.preventDefault(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=c.DomUtil.getPosition(this._element).subtract(b),c.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,n.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),c.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(b),this._moving=!0,c.Util.cancelAnimFrame(this._animRequest),this._lastEvent=a,this._animRequest=c.Util.requestAnimFrame(this._updatePosition,this,!0))}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a);c.DomUtil.setPosition(this._element,this._newPos);this.fire("drag",a)},_onUp:function(a){!a._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){c.DomUtil.removeClass(e.body,"leaflet-dragging");this._lastTarget&&(c.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var a in c.Draggable.MOVE)c.DomEvent.off(e,c.Draggable.MOVE[a],this._onMove,this).off(e,c.Draggable.END[a],this._onUp,this);c.DomUtil.enableImageDrag();c.DomUtil.enableTextSelection();this._moved&&this._moving&&(c.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1;c.Draggable._dragging=!1}});c.Handler=c.Class.extend({initialize:function(a){this._map=a},enable:function(){if(this._enabled)return this;this._enabled=!0;this.addHooks();return this},disable:function(){if(!this._enabled)return this;this._enabled=!1;this.removeHooks();return this},enabled:function(){return!!this._enabled}});c.Map.mergeOptions({dragging:!0,inertia:!c.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});c.Map.Drag=c.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new c.Draggable(a._mapPane,a._container);this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);this._draggable.on("predrag",this._onPreDragLimit,this);a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}c.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag");this._draggable.enable();this._positions=[];this._times=[]},removeHooks:function(){c.DomUtil.removeClass(this._map._container,"leaflet-grab");c.DomUtil.removeClass(this._map._container,"leaflet-touch-drag");this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var a=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=c.latLngBounds(this._map.options.maxBounds);this._offsetLimit=c.bounds(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize()));this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart");a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var c=this._lastTime=+new Date,b=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(b);this._times.push(c);50<c-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move",a).fire("drag",a)},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(a).x;this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,c){return a-(a-c)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var a=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;a.x<c.min.x&&(a.x=this._viscousLimit(a.x,c.min.x));a.y<c.min.y&&(a.y=this._viscousLimit(a.y,c.min.y));a.x>c.max.x&&(a.x=this._viscousLimit(a.x,c.max.x));a.y>c.max.y&&(a.y=this._viscousLimit(a.y,c.max.y));this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,c=Math.round(a/2),b=this._initialWorldOffset,g=this._draggable._newPos.x,l=(g-c+b)%a+c-b,a=(g+c+b)%a-c-b,b=Math.abs(l+b)<Math.abs(a+b)?l:a;this._draggable._absPos=this._draggable._newPos.clone();this._draggable._newPos.x=b},_onDragEnd:function(a){var b=this._map,f=b.options,g=!f.inertia||2>this._times.length;b.fire("dragend",a);if(g)b.fire("moveend");else{a=this._lastPos.subtract(this._positions[0]);var l=f.easeLinearity,g=a.multiplyBy(l/((this._lastTime-this._times[0])/1E3)),h=g.distanceTo([0,0]);a=Math.min(f.inertiaMaxSpeed,h);var g=g.multiplyBy(a/h),m=a/(f.inertiaDeceleration*l),e=g.multiplyBy(-m/2).round();e.x||e.y?(e=b._limitOffset(e,b.options.maxBounds),c.Util.requestAnimFrame(function(){b.panBy(e,{duration:m,easeLinearity:l,noMoveStart:!0,animate:!0})})):b.fire("moveend")}}});c.Map.addInitHook("addHandler","dragging",c.Map.Drag);c.Map.mergeOptions({doubleClickZoom:!0});c.Map.DoubleClickZoom=c.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var c=this._map,b=c.getZoom(),g=c.options.zoomDelta,b=a.originalEvent.shiftKey?b-g:b+g;"center"===c.options.doubleClickZoom?c.setZoom(b):c.setZoomAround(a.containerPoint,b)}});c.Map.addInitHook("addHandler","doubleClickZoom",c.Map.DoubleClickZoom);c.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});c.Map.ScrollWheelZoom=c.Handler.extend({addHooks:function(){c.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this);this._delta=0},removeHooks:function(){c.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var b=c.DomEvent.getWheelDelta(a),f=this._map.options.wheelDebounceTime;this._delta+=b;this._lastMousePos=this._map.mouseEventToContainerPoint(a);this._startTime||(this._startTime=+new Date);b=Math.max(f-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(c.bind(this._performZoom,this),b);c.DomEvent.stop(a)},_performZoom:function(){var a=this._map,c=a.getZoom(),b=this._map.options.zoomSnap||0;a._stop();var g=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,b=b?Math.ceil(g/b)*b:g,b=a._limitZoom(c+(0<this._delta?b:-b))-c;this._delta=0;this._startTime=null;b&&("center"===a.options.scrollWheelZoom?a.setZoom(c+b):a.setZoomAround(this._lastMousePos,c+b))}});c.Map.addInitHook("addHandler","scrollWheelZoom",c.Map.ScrollWheelZoom);c.extend(c.DomEvent,{_touchstart:c.Browser.msPointer?"MSPointerDown":c.Browser.pointer?"pointerdown":"touchstart",_touchend:c.Browser.msPointer?"MSPointerUp":c.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(a,b,f){function g(a){var b;if(c.Browser.pointer){if(!c.Browser.edge||"mouse"===a.pointerType)return;b=c.DomEvent._pointersCount}else b=a.touches.length;if(!(1<b)){b=Date.now();var d=b-(h||b);m=a.touches?a.touches[0]:a;e=0<d&&250>=d;h=b}}function l(a){if(e&&!m.cancelBubble){if(c.Browser.pointer){if(!c.Browser.edge||"mouse"===a.pointerType)return;a={};var f,g;for(g in m)f=m[g],a[g]=f&&f.bind?f.bind(m):f;m=a}m.type="dblclick";b(m);h=null}}var h,m,e=!1,k=this._touchstart,q=this._touchend;a["_leaflet_"+k+f]=g;a["_leaflet_"+q+f]=l;a["_leaflet_dblclick"+f]=b;a.addEventListener(k,g,!1);a.addEventListener(q,l,!1);a.addEventListener("dblclick",b,!1);return this},removeDoubleTapListener:function(a,b){var f=a["_leaflet_"+this._touchend+b],g=a["_leaflet_dblclick"+b];a.removeEventListener(this._touchstart,a["_leaflet_"+this._touchstart+b],!1);a.removeEventListener(this._touchend,f,!1);c.Browser.edge||a.removeEventListener("dblclick",g,!1);return this}});c.extend(c.DomEvent,{POINTER_DOWN:c.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:c.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:c.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:c.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(a,c,b,g){"touchstart"===c?this._addPointerStart(a,b,g):"touchmove"===c?this._addPointerMove(a,b,g):"touchend"===c&&this._addPointerEnd(a,b,g);return this},removePointerListener:function(a,c,b){b=a["_leaflet_"+c+b];"touchstart"===c?a.removeEventListener(this.POINTER_DOWN,b,!1):"touchmove"===c?a.removeEventListener(this.POINTER_MOVE,b,!1):"touchend"===c&&(a.removeEventListener(this.POINTER_UP,b,!1),a.removeEventListener(this.POINTER_CANCEL,b,!1));return this},_addPointerStart:function(a,b,f){var g=c.bind(function(a){if("mouse"!==a.pointerType&&a.MSPOINTER_TYPE_MOUSE&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE)if(0>this.TAG_WHITE_LIST.indexOf(a.target.tagName))c.DomEvent.preventDefault(a);else return;this._handlePointer(a,b)},this);a["_leaflet_touchstart"+f]=g;a.addEventListener(this.POINTER_DOWN,g,!1);this._pointerDocListener||(a=c.bind(this._globalPointerUp,this),e.documentElement.addEventListener(this.POINTER_DOWN,c.bind(this._globalPointerDown,this),!0),e.documentElement.addEventListener(this.POINTER_MOVE,c.bind(this._globalPointerMove,this),!0),e.documentElement.addEventListener(this.POINTER_UP,a,!0),e.documentElement.addEventListener(this.POINTER_CANCEL,a,!0),this._pointerDocListener=!0)},_globalPointerDown:function(a){this._pointers[a.pointerId]=a;this._pointersCount++},_globalPointerMove:function(a){this._pointers[a.pointerId]&&(this._pointers[a.pointerId]=a)},_globalPointerUp:function(a){delete this._pointers[a.pointerId];this._pointersCount--},_handlePointer:function(a,c){a.touches=[];for(var b in this._pointers)a.touches.push(this._pointers[b]);a.changedTouches=[a];c(a)},_addPointerMove:function(a,b,f){var g=c.bind(function(a){(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons)&&this._handlePointer(a,b)},this);a["_leaflet_touchmove"+f]=g;a.addEventListener(this.POINTER_MOVE,g,!1)},_addPointerEnd:function(a,b,f){var g=c.bind(function(a){this._handlePointer(a,b)},this);a["_leaflet_touchend"+f]=g;a.addEventListener(this.POINTER_UP,g,!1);a.addEventListener(this.POINTER_CANCEL,g,!1)}});c.Map.mergeOptions({touchZoom:c.Browser.touch&&!c.Browser.android23,bounceAtZoomLimits:!0});c.Map.TouchZoom=c.Handler.extend({addHooks:function(){c.DomUtil.addClass(this._map._container,"leaflet-touch-zoom");c.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){c.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom");c.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var b=this._map;if(a.touches&&2===a.touches.length&&!b._animatingZoom&&!this._zooming){var f=b.mouseEventToContainerPoint(a.touches[0]),g=b.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=b.getSize()._divideBy(2);this._startLatLng=b.containerPointToLatLng(this._centerPoint);"center"!==b.options.touchZoom&&(this._pinchStartLatLng=b.containerPointToLatLng(f.add(g)._divideBy(2)));this._startDist=f.distanceTo(g);this._startZoom=b.getZoom();this._moved=!1;this._zooming=!0;b._stop();c.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this);c.DomEvent.preventDefault(a)}},_onTouchMove:function(a){if(a.touches&&2===a.touches.length&&this._zooming){var b=this._map,f=b.mouseEventToContainerPoint(a.touches[0]),g=b.mouseEventToContainerPoint(a.touches[1]),l=f.distanceTo(g)/this._startDist;this._zoom=b.getScaleZoom(l,this._startZoom);!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&1>l||this._zoom>b.getMaxZoom()&&1<l)&&(this._zoom=b._limitZoom(this._zoom));if("center"===b.options.touchZoom){if(this._center=this._startLatLng,1===l)return}else{f=f._add(g)._divideBy(2)._subtract(this._centerPoint);if(1===l&&0===f.x&&0===f.y)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(f),this._zoom)}this._moved||(b._moveStart(!0),this._moved=!0);c.Util.cancelAnimFrame(this._animRequest);b=c.bind(b._move,b,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=c.Util.requestAnimFrame(b,this,!0);c.DomEvent.preventDefault(a)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,c.Util.cancelAnimFrame(this._animRequest),c.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});c.Map.addInitHook("addHandler","touchZoom",c.Map.TouchZoom);c.Map.mergeOptions({tap:!0,tapTolerance:15});c.Map.Tap=c.Handler.extend({addHooks:function(){c.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){c.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches)if(c.DomEvent.preventDefault(a),this._fireClick=!0,1<a.touches.length)this._fireClick=!1,clearTimeout(this._holdTimeout);else{var b=a.touches[0];a=b.target;this._startPos=this._newPos=new c.Point(b.clientX,b.clientY);a.tagName&&"a"===a.tagName.toLowerCase()&&c.DomUtil.addClass(a,"leaflet-active");this._holdTimeout=setTimeout(c.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",b))},this),1E3);this._simulateEvent("mousedown",b);c.DomEvent.on(e,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(a){clearTimeout(this._holdTimeout);c.DomEvent.off(e,{touchmove:this._onMove,touchend:this._onUp},this);if(this._fireClick&&a&&a.changedTouches){a=a.changedTouches[0];var b=a.target;b&&b.tagName&&"a"===b.tagName.toLowerCase()&&c.DomUtil.removeClass(b,"leaflet-active");this._simulateEvent("mouseup",a);this._isTapValid()&&this._simulateEvent("click",a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){a=a.touches[0];this._newPos=new c.Point(a.clientX,a.clientY);this._simulateEvent("mousemove",a)},_simulateEvent:function(a,c){var b=e.createEvent("MouseEvents");b._simulated=!0;c.target._simulatedClick=!0;b.initMouseEvent(a,!0,!0,n,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null);c.target.dispatchEvent(b)}});c.Browser.touch&&!c.Browser.pointer&&c.Map.addInitHook("addHandler","tap",c.Map.Tap);c.Map.mergeOptions({boxZoom:!0});c.Map.BoxZoom=c.Handler.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane},addHooks:function(){c.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){c.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(a){if(!a.shiftKey||1!==a.which&&1!==a.button)return!1;this._resetState();c.DomUtil.disableTextSelection();c.DomUtil.disableImageDrag();this._startPoint=this._map.mouseEventToContainerPoint(a);c.DomEvent.on(e,{contextmenu:c.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=c.DomUtil.create("div","leaflet-zoom-box",this._container),c.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart"));this._point=this._map.mouseEventToContainerPoint(a);a=new c.Bounds(this._point,this._startPoint);var b=a.getSize();c.DomUtil.setPosition(this._box,a.min);this._box.style.width=b.x+"px";this._box.style.height=b.y+"px"},_finish:function(){this._moved&&(c.DomUtil.remove(this._box),c.DomUtil.removeClass(this._container,"leaflet-crosshair"));c.DomUtil.enableTextSelection();c.DomUtil.enableImageDrag();c.DomEvent.off(e,{contextmenu:c.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(1===a.which||1===a.button)this._finish(),this._moved&&(setTimeout(c.bind(this._resetState,this),0),a=new c.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a}))},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});c.Map.addInitHook("addHandler","boxZoom",c.Map.BoxZoom);c.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80});c.Map.Keyboard=c.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a;this._setPanDelta(a.options.keyboardPanDelta);this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;0>=a.tabIndex&&(a.tabIndex="0");c.DomEvent.on(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks();c.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=e.body,c=e.documentElement,b=a.scrollTop||c.scrollTop,a=a.scrollLeft||c.scrollLeft;this._map._container.focus();n.scrollTo(a,b)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanDelta:function(a){var c=this._panKeys={},b=this.keyCodes,g,l;g=0;for(l=b.left.length;g<l;g++)c[b.left[g]]=[-1*a,0];g=0;for(l=b.right.length;g<l;g++)c[b.right[g]]=[a,0];g=0;for(l=b.down.length;g<l;g++)c[b.down[g]]=[0,a];g=0;for(l=b.up.length;g<l;g++)c[b.up[g]]=[0,-1*a]},_setZoomDelta:function(a){var c=this._zoomKeys={},b=this.keyCodes,g,l;g=0;for(l=b.zoomIn.length;g<l;g++)c[b.zoomIn[g]]=a;g=0;for(l=b.zoomOut.length;g<l;g++)c[b.zoomOut[g]]=-a},_addHooks:function(){c.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){c.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var b=a.keyCode,f=this._map;if(b in this._panKeys){if(f._panAnim&&f._panAnim._inProgress)return;b=this._panKeys[b];a.shiftKey&&(b=c.point(b).multiplyBy(3));f.panBy(b);f.options.maxBounds&&f.panInsideBounds(f.options.maxBounds)}else if(b in this._zoomKeys)f.setZoom(f.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[b]);else if(27===b)f.closePopup();else return;c.DomEvent.stop(a)}}});c.Map.addInitHook("addHandler","keyboard",c.Map.Keyboard);c.Handler.MarkerDrag=c.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new c.Draggable(a,a,!0));this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable();c.DomUtil.addClass(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable();this._marker._icon&&c.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng();this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(a){var b=this._marker,f=b._shadow,g=c.DomUtil.getPosition(b._icon),l=b._map.layerPointToLatLng(g);f&&c.DomUtil.setPosition(f,g);b._latlng=l;a.latlng=l;a.oldLatLng=this._oldLatLng;b.fire("move",a).fire("drag",a)},_onDragEnd:function(a){delete this._oldLatLng;this._marker.fire("moveend").fire("dragend",a)}});c.Control=c.Class.extend({options:{position:"topright"},initialize:function(a){c.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var c=this._map;c&&c.removeControl(this);this.options.position=a;c&&c.addControl(this);return this},getContainer:function(){return this._container},addTo:function(a){this.remove();this._map=a;var b=this._container=this.onAdd(a),f=this.getPosition();a=a._controlCorners[f];c.DomUtil.addClass(b,"leaflet-control");-1!==f.indexOf("bottom")?a.insertBefore(b,a.firstChild):a.appendChild(b);return this},remove:function(){if(!this._map)return this;c.DomUtil.remove(this._container);if(this.onRemove)this.onRemove(this._map);this._map=null;return this},_refocusOnMap:function(a){this._map&&a&&0<a.screenX&&0<a.screenY&&this._map.getContainer().focus()}});c.control=function(a){return new c.Control(a)};c.Map.include({addControl:function(a){a.addTo(this);return this},removeControl:function(a){a.remove();return this},_initControlPos:function(){function a(a,l){b[a+l]=c.DomUtil.create("div","leaflet-"+a+" leaflet-"+l,f)}var b=this._controlCorners={},f=this._controlContainer=c.DomUtil.create("div","leaflet-control-container",this._container);a("top","left");a("top","right");a("bottom","left");a("bottom","right")},_clearControlPos:function(){c.DomUtil.remove(this._controlContainer)}});c.Control.Zoom=c.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(a){var b=c.DomUtil.create("div","leaflet-control-zoom leaflet-bar"),f=this.options;this._zoomInButton=this._createButton(f.zoomInText,f.zoomInTitle,"leaflet-control-zoom-in",b,this._zoomIn);this._zoomOutButton=this._createButton(f.zoomOutText,f.zoomOutTitle,"leaflet-control-zoom-out",b,this._zoomOut);this._updateDisabled();a.on("zoomend zoomlevelschange",this._updateDisabled,this);return b},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){this._disabled=!0;this._updateDisabled();return this},enable:function(){this._disabled=!1;this._updateDisabled();return this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,b,f,g,l){f=c.DomUtil.create("a",f,g);f.innerHTML=a;f.href="#";f.title=b;f.setAttribute("role","button");f.setAttribute("aria-label",b);c.DomEvent.on(f,"mousedown dblclick",c.DomEvent.stopPropagation).on(f,"click",c.DomEvent.stop).on(f,"click",l,this).on(f,"click",this._refocusOnMap,this);return f},_updateDisabled:function(){var a=this._map;c.DomUtil.removeClass(this._zoomInButton,"leaflet-disabled");c.DomUtil.removeClass(this._zoomOutButton,"leaflet-disabled");(this._disabled||a._zoom===a.getMinZoom())&&c.DomUtil.addClass(this._zoomOutButton,"leaflet-disabled");(this._disabled||a._zoom===a.getMaxZoom())&&c.DomUtil.addClass(this._zoomInButton,"leaflet-disabled")}});c.Map.mergeOptions({zoomControl:!0});c.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new c.Control.Zoom,this.addControl(this.zoomControl))});c.control.zoom=function(a){return new c.Control.Zoom(a)};c.Control.Attribution=c.Control.extend({options:{position:"bottomright",prefix:'\x3ca href\x3d"http://leafletjs.com" title\x3d"A JS library for interactive maps"\x3eLeaflet\x3c/a\x3e'},initialize:function(a){c.setOptions(this,a);this._attributions={}},onAdd:function(a){a.attributionControl=this;this._container=c.DomUtil.create("div","leaflet-control-attribution");c.DomEvent&&c.DomEvent.disableClickPropagation(this._container);for(var b in a._layers)a._layers[b].getAttribution&&this.addAttribution(a._layers[b].getAttribution());this._update();return this._container},setPrefix:function(a){this.options.prefix=a;this._update();return this},addAttribution:function(a){if(!a)return this;this._attributions[a]||(this._attributions[a]=0);this._attributions[a]++;this._update();return this},removeAttribution:function(a){if(!a)return this;this._attributions[a]&&(this._attributions[a]--,this._update());return this},_update:function(){if(this._map){var a=[],c;for(c in this._attributions)this._attributions[c]&&a.push(c);c=[];this.options.prefix&&c.push(this.options.prefix);a.length&&c.push(a.join(", "));this._container.innerHTML=c.join(" | ")}}});c.Map.mergeOptions({attributionControl:!0});c.Map.addInitHook(function(){this.options.attributionControl&&(new c.Control.Attribution).addTo(this)});c.control.attribution=function(a){return new c.Control.Attribution(a)};c.Control.Scale=c.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var b=c.DomUtil.create("div","leaflet-control-scale"),f=this.options;this._addScales(f,"leaflet-control-scale-line",b);a.on(f.updateWhenIdle?"moveend":"move",this._update,this);a.whenReady(this._update,this);return b},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,b,f){a.metric&&(this._mScale=c.DomUtil.create("div",b,f));a.imperial&&(this._iScale=c.DomUtil.create("div",b,f))},_update:function(){var a=this._map,c=a.getSize().y/2,a=a.distance(a.containerPointToLatLng([0,c]),a.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(a)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a);this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var c=this._getRoundNum(a);this._updateScale(this._mScale,1E3>c?c+" m":c/1E3+" km",c/a)},_updateImperial:function(a){a*=3.2808399;var c;5280<a?(a/=5280,c=this._getRoundNum(a),this._updateScale(this._iScale,c+" mi",c/a)):(c=this._getRoundNum(a),this._updateScale(this._iScale,c+" ft",c/a))},_updateScale:function(a,c,b){a.style.width=Math.round(this.options.maxWidth*b)+"px";a.innerHTML=c},_getRoundNum:function(a){var c=Math.pow(10,(Math.floor(a)+"").length-1);a/=c;return c*(10<=a?10:5<=a?5:3<=a?3:2<=a?2:1)}});c.control.scale=function(a){return new c.Control.Scale(a)};c.Control.Layers=c.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,c,b,g){return b<g?-1:g<b?1:0}},initialize:function(a,b,f){c.setOptions(this,f);this._layers=[];this._lastZIndex=0;this._handlingClick=!1;for(var g in a)this._addLayer(a[g],g);for(g in b)this._addLayer(b[g],g,!0)},onAdd:function(a){this._initLayout();this._update();this._map=a;a.on("zoomend",this._checkDisabledLayers,this);return this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,c){this._addLayer(a,c);return this._map?this._update():this},addOverlay:function(a,c){this._addLayer(a,c,!0);return this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);(a=this._getLayer(c.stamp(a)))&&this._layers.splice(this._layers.indexOf(a),1);return this._map?this._update():this},expand:function(){c.DomUtil.addClass(this._container,"leaflet-control-layers-expanded");this._form.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);a<this._form.clientHeight?(c.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=a+"px"):c.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar");this._checkDisabledLayers();return this},collapse:function(){c.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded");return this},_initLayout:function(){var a=this._container=c.DomUtil.create("div","leaflet-control-layers"),b=this.options.collapsed;a.setAttribute("aria-haspopup",!0);c.DomEvent.disableClickPropagation(a);c.Browser.touch||c.DomEvent.disableScrollPropagation(a);var f=this._form=c.DomUtil.create("form","leaflet-control-layers-list");if(b&&(this._map.on("click",this.collapse,this),!c.Browser.android))c.DomEvent.on(a,{mouseenter:this.expand,mouseleave:this.collapse},this);var g=this._layersLink=c.DomUtil.create("a","leaflet-control-layers-toggle",a);g.href="#";g.title="Layers";if(c.Browser.touch)c.DomEvent.on(g,"click",c.DomEvent.stop).on(g,"click",this.expand,this);else c.DomEvent.on(g,"focus",this.expand,this);c.DomEvent.on(f,"click",function(){setTimeout(c.bind(this._onInputClick,this),0)},this);b||this.expand();this._baseLayersList=c.DomUtil.create("div","leaflet-control-layers-base",f);this._separator=c.DomUtil.create("div","leaflet-control-layers-separator",f);this._overlaysList=c.DomUtil.create("div","leaflet-control-layers-overlays",f);a.appendChild(f)},_getLayer:function(a){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&c.stamp(this._layers[b].layer)===a)return this._layers[b]},_addLayer:function(a,b,f){a.on("add remove",this._onLayerChange,this);this._layers.push({layer:a,name:b,overlay:f});this.options.sortLayers&&this._layers.sort(c.bind(function(a,c){return this.options.sortFunction(a.layer,c.layer,a.name,c.name)},this));this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;c.DomUtil.empty(this._baseLayersList);c.DomUtil.empty(this._overlaysList);var a,b,f,g,l=0;for(f=0;f<this._layers.length;f++)g=this._layers[f],this._addItem(g),b=b||g.overlay,a=a||!g.overlay,l+=g.overlay?0:1;this.options.hideSingleBase&&(a=a&&1<l,this._baseLayersList.style.display=a?"":"none");this._separator.style.display=b&&a?"":"none";return this},_onLayerChange:function(a){this._handlingClick||this._update();var b=this._getLayer(c.stamp(a.target));(a=b.overlay?"add"===a.type?"overlayadd":"overlayremove":"add"===a.type?"baselayerchange":null)&&this._map.fire(a,b)},_createRadioElement:function(a,c){var b='\x3cinput type\x3d"radio" class\x3d"leaflet-control-layers-selector" name\x3d"'+a+'"'+(c?' checked\x3d"checked"':"")+"/\x3e",g=e.createElement("div");g.innerHTML=b;return g.firstChild},_addItem:function(a){var b=e.createElement("label"),f=this._map.hasLayer(a.layer),g;a.overlay?(g=e.createElement("input"),g.type="checkbox",g.className="leaflet-control-layers-selector",g.defaultChecked=f):g=this._createRadioElement("leaflet-base-layers",f);g.layerId=c.stamp(a.layer);c.DomEvent.on(g,"click",this._onInputClick,this);f=e.createElement("span");f.innerHTML=" "+a.name;var l=e.createElement("div");b.appendChild(l);l.appendChild(g);l.appendChild(f);(a.overlay?this._overlaysList:this._baseLayersList).appendChild(b);this._checkDisabledLayers();return b},_onInputClick:function(){var a=this._form.getElementsByTagName("input"),c,b,g,l=[],h=[];this._handlingClick=!0;for(var m=a.length-1;0<=m;m--)c=a[m],b=this._getLayer(c.layerId).layer,g=this._map.hasLayer(b),c.checked&&!g?l.push(b):!c.checked&&g&&h.push(b);for(m=0;m<h.length;m++)this._map.removeLayer(h[m]);for(m=0;m<l.length;m++)this._map.addLayer(l[m]);this._handlingClick=!1;this._refocusOnMap()},_checkDisabledLayers:function(){for(var a=this._form.getElementsByTagName("input"),c,b,g=this._map.getZoom(),l=a.length-1;0<=l;l--)c=a[l],b=this._getLayer(c.layerId).layer,c.disabled=b.options.minZoom!==k&&g<b.options.minZoom||b.options.maxZoom!==k&&g>b.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}});c.control.layers=function(a,b,f){return new c.Control.Layers(a,b,f)}})(window,document);(function(n,e,k){L.drawVersion="0.4.9";L.Draw={};L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker"}},handlers:{circle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u52a8\u7ed8\u5236\u5706"},radius:"Radius"},marker:{tooltip:{start:"\u70b9\u51fb\u5730\u56fe\u7ed8\u5236\u70b9\u4f4d"}},polygon:{tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u591a\u8fb9\u5f62",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u591a\u8fb9\u5f62",end:"\u70b9\u51fb\u9996\u4e2a\u7ed8\u5236\u70b9\u5b8c\u6210\u7ed8\u5236"}},polyline:{error:"\x3cstrong\x3eError:\x3c/strong\x3e shape edges cannot cross!",tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u7ebf",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u7ebf",end:"\u53cc\u51fb\u5b8c\u6210\u7ed8\u5236"}},rectangle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u52a8\u5f00\u59cb\u7ed8\u5236\u77e9\u5f62"}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes.",text:"Save"},cancel:{title:"Cancel editing, discards all changes.",text:"Cancel"}},buttons:{edit:"Edit layers.",editDisabled:"No layers to edit.",remove:"Delete layers.",removeDisabled:"No layers to delete."}},handlers:{edit:{tooltip:{text:"Drag handles, or marker to edit feature.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove"}}}}};L.Draw.Event={};L.Draw.Event.CREATED="draw:created";L.Draw.Event.EDITED="draw:edited";L.Draw.Event.DELETED="draw:deleted";L.Draw.Event.DRAWSTART="draw:drawstart";L.Draw.Event.DRAWSTOP="draw:drawstop";L.Draw.Event.DRAWVERTEX="draw:drawvertex";L.Draw.Event.EDITSTART="draw:editstart";L.Draw.Event.EDITMOVE="draw:editmove";L.Draw.Event.EDITRESIZE="draw:editresize";L.Draw.Event.EDITVERTEX="draw:editvertex";L.Draw.Event.EDITSTOP="draw:editstop";L.Draw.Event.DELETESTART="draw:deletestart";L.Draw.Event.DELETESTOP="draw:deletestop";L.Draw=L.Draw||{};L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(b,c){this._map=b;this._container=b._container;this._overlayPane=b._panes.overlayPane;this._popupPane=b._panes.popupPane;c&&c.shapeOptions&&(c.shapeOptions=L.Util.extend({},this.options.shapeOptions,c.shapeOptions));L.setOptions(this,c)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var b=this._map;b&&(L.DomUtil.disableTextSelection(),b.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(b){L.setOptions(this,b)},_fireCreatedEvent:function(b){this._map.fire(L.Draw.Event.CREATED,{layer:b,layerType:this.type})},_cancelDrawing:function(b){this._map.fire("draw:canceled",{layerType:this.type});27===b.keyCode&&this.disable()}});L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4E3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2E3},initialize:function(b,c){L.Browser.touch&&(this.options.icon=this.options.touchIcon);this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error;c&&c.drawError&&(c.drawError=L.Util.extend({},this.options.drawError,c.drawError));this.type=L.Draw.Polyline.TYPE;L.Draw.Feature.prototype.initialize.call(this,b,c)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._clearHideErrorTimeout();this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this);this._map.removeLayer(this._mouseMarker);delete this._mouseMarker;this._clearGuides();this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(1>=this._markers.length)){var b=this._markers.pop(),c=this._poly,h=c.getLatLngs(),a=h.splice(-1,1)[0];this._poly.setLatLngs(h);this._markerGroup.removeLayer(b);2>c.getLatLngs().length&&this._map.removeLayer(c);this._vertexChanged(a,!1)}},addVertex:function(b){2<=this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(b)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(b)),this._poly.addLatLng(b),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(b,!0))},completeShape:function(){1>=this._markers.length||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var b=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),b=this._poly.newLatLngIntersects(b[b.length-1]);!this.options.allowIntersection&&b||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(b){var c=this._map.mouseEventToLayerPoint(b.originalEvent),h=this._map.layerPointToLatLng(c);this._currentLatLng=h;this._updateTooltip(h);this._updateGuide(c);this._mouseMarker.setLatLng(h);L.DomEvent.preventDefault(b.originalEvent)},_vertexChanged:function(b,c){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup});this._updateFinishHandler();this._updateRunningMeasure(b,c);this._clearGuides();this._updateTooltip()},_onMouseDown:function(b){this._clickHandled||this._touchHandled||this._disableMarkers||(this._onMouseMove(b),this._clickHandled=!0,this._disableNewMarkers(),b=b.originalEvent,this._startPoint.call(this,b.clientX,b.clientY))},_startPoint:function(b,c){this._mouseDownOrigin=L.point(b,c)},_onMouseUp:function(b){var c=b.originalEvent;this._endPoint.call(this,c.clientX,c.clientY,b);this._clickHandled=null},_endPoint:function(b,c,h){this._mouseDownOrigin&&(b=L.point(b,c).distanceTo(this._mouseDownOrigin),10>this._calculateFinishDistance(h.latlng)&&L.Browser.touch?this._finishShape():Math.abs(b)<9*(n.devicePixelRatio||1)&&this.addVertex(h.latlng),this._enableNewMarkers());this._mouseDownOrigin=null},_onTouch:function(b){var c=b.originalEvent,h;!c.touches||!c.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(h=c.touches[0].clientX,c=c.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,h,c),this._endPoint.call(this,h,c,b),this._touchHandled=null);this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(b){var c;if(0<this._markers.length){if(this.type===L.Draw.Polyline.TYPE)c=this._markers[this._markers.length-1];else if(this.type===L.Draw.Polygon.TYPE)c=this._markers[0];else return Infinity;c=this._map.latLngToContainerPoint(c.getLatLng());b=new L.Marker(b,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});b=this._map.latLngToContainerPoint(b.getLatLng());c=c.distanceTo(b)}else c=Infinity;return c},_updateFinishHandler:function(){var b=this._markers.length;if(1<b)this._markers[b-1].on("click",this._finishShape,this);2<b&&this._markers[b-2].off("click",this._finishShape,this)},_createMarker:function(b){b=new L.Marker(b,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});this._markerGroup.addLayer(b);return b},_updateGuide:function(b){var c=this._markers?this._markers.length:0;0<c&&(b=b||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[c-1].getLatLng()),b))},_updateTooltip:function(b){var c=this._getTooltipText();b&&this._tooltip.updatePosition(b);this._errorShown||this._tooltip.updateContent(c)},_drawGuide:function(b,c){var h=Math.floor(Math.sqrt(Math.pow(c.x-b.x,2)+Math.pow(c.y-b.y,2))),a=this.options.guidelineDistance,d=this.options.maxGuideLineLength,a=h>d?h-d:a,f;this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));for(;a<h;a+=this.options.guidelineDistance)d=a/h,d={x:Math.floor(b.x*(1-d)+d*c.x),y:Math.floor(b.y*(1-d)+d*c.y)},f=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),f.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(f,d)},_updateGuideColor:function(b){if(this._guidesContainer)for(var c=0,h=this._guidesContainer.childNodes.length;c<h;c++)this._guidesContainer.childNodes[c].style.backgroundColor=b},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var b=this.options.showLength;L.Browser.touch&&(b=!1);0===this._markers.length?b={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(b=b?this._getMeasurementString():"",b=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:b}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:b});return b},_updateRunningMeasure:function(b,c){var h=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(h=b.distanceTo(this._markers[h-(c?2:1)].getLatLng()),this._measurementRunningTotal+=h*(c?1:-1))},_getMeasurementString:function(){var b=this._currentLatLng,c=this._markers[this._markers.length-1].getLatLng(),b=this._measurementRunningTotal+b.distanceTo(c);return L.GeometryUtil.readableDistance(b,this.options.metric,this.options.feet,this.options.nautic)},_showErrorTooltip:function(){this._errorShown=!0;this._tooltip.showAsError().updateContent({text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1;this._clearHideErrorTimeout();this._tooltip.removeError().updateContent(this._getTooltipText());this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){1<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var b=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,b)}});L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(b,c){L.Draw.Polyline.prototype.initialize.call(this,b,c);this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var b=this._markers.length;if(1===b)this._markers[0].on("click",this._finishShape,this);2<b&&(this._markers[b-1].on("dblclick",this._finishShape,this),3<b&&this._markers[b-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var b,c;0===this._markers.length?b=L.drawLocal.draw.handlers.polygon.tooltip.start:3>this._markers.length?b=L.drawLocal.draw.handlers.polygon.tooltip.cont:(b=L.drawLocal.draw.handlers.polygon.tooltip.end,c=this._getMeasurementString());return{text:b,subtext:c}},_getMeasurementString:function(){var b=this._area;return b?L.GeometryUtil.readableArea(b,this.options.metric):null},_shapeIsValid:function(){return 3<=this._markers.length},_vertexChanged:function(b,c){var h;!this.options.allowIntersection&&this.options.showArea&&(h=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(h));L.Draw.Polyline.prototype._vertexChanged.call(this,b,c)},_cleanUpShape:function(){var b=this._markers.length;0<b&&(this._markers[0].off("click",this._finishShape,this),2<b&&this._markers[b-1].off("dblclick",this._finishShape,this))}});L.SimpleShape={};L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(b,c){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end;L.Draw.Feature.prototype.initialize.call(this,b,c)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&((this._mapDraggable=this._map.dragging.enabled())&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),this._shape&&(this._map.removeLayer(this._shape),delete this._shape));this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(b){this._isDrawing=!0;this._startLatLng=b.latlng;L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(b.originalEvent)},_onMouseMove:function(b){b=b.latlng;this._tooltip.updatePosition(b);this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(b))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()}});L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,showArea:!0,clickable:!0},metric:!0},initialize:function(b,c){this.type=L.Draw.Rectangle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,b,c)},_drawShape:function(b){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,b)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,b),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var b=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,b)},_getTooltipText:function(){var b=L.Draw.SimpleShape.prototype._getTooltipText.call(this),c=this.options.showArea,h;this._shape&&(h=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),h=L.GeometryUtil.geodesicArea(h),h=c?L.GeometryUtil.readableArea(h,this.options.metric):"");return{text:b.text,subtext:h}}});L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(b,c){this.type=L.Draw.Circle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,b,c)},_drawShape:function(b){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(b)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(b),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var b=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,b)},_onMouseMove:function(b){var c=b.latlng;b=this.options.showRadius;var h=this.options.metric;this._tooltip.updatePosition(c);if(this._isDrawing){this._drawShape(c);var c=this._shape.getRadius().toFixed(1),a="";b&&(a=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(c,h,this.options.feet,this.options.nautic));this._tooltip.updateContent({text:this._endLabelText,subtext:a})}}});L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2E3},initialize:function(b,c){this.type=L.Draw.Marker.TYPE;L.Draw.Feature.prototype.initialize.call(this,b,c)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).off("click",this._onTouch,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(b){b=b.latlng;this._tooltip.updatePosition(b);this._mouseMarker.setLatLng(b);this._marker?(b=this._mouseMarker.getLatLng(),this._marker.setLatLng(b)):(this._marker=new L.Marker(b,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()},_onTouch:function(b){this._onMouseMove(b);this._onClick()},_fireCreatedEvent:function(){var b=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,b)}});L.Edit=L.Edit||{};L.Edit.Marker=L.Handler.extend({initialize:function(b,c){this._marker=b;L.setOptions(this,c)},addHooks:function(){var b=this._marker;b.dragging.enable();b.on("dragend",this._onDragEnd,b);this._toggleMarkerHighlight()},removeHooks:function(){var b=this._marker;b.dragging.disable();b.off("dragend",this._onDragEnd,b);this._toggleMarkerHighlight()},_onDragEnd:function(b){b=b.target;b.edited=!0;this._map.fire(L.Draw.Event.EDITMOVE,{layer:b})},_toggleMarkerHighlight:function(){var b=this._marker._icon;b&&(b.style.display="none",L.DomUtil.hasClass(b,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(b,"leaflet-edit-marker-selected"),this._offsetMarker(b,-4)):(L.DomUtil.addClass(b,"leaflet-edit-marker-selected"),this._offsetMarker(b,4)),b.style.display="")},_offsetMarker:function(b,c){var h=parseInt(b.style.marginTop,10)-c,a=parseInt(b.style.marginLeft,10)-c;b.style.marginTop=h+"px";b.style.marginLeft=a+"px"}});L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())});L.Edit=L.Edit||{};L.Edit.Poly=L.Handler.extend({options:{},initialize:function(b,c){this.latlngs=[b._latlngs];b._holes&&(this.latlngs=this.latlngs.concat(b._holes));this._poly=b;L.setOptions(this,c);this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(b){for(var c=0;c<this._verticesHandlers.length;c++)b(this._verticesHandlers[c])},addHooks:function(){this._initHandlers();this._eachVertexHandler(function(b){b.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(b){b.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(b){b.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var b=0;b<this.latlngs.length;b++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[b],this.options))},_updateLatLngs:function(b){this.latlngs=[b.layer._latlngs];b.layer._holes&&(this.latlngs=this.latlngs.concat(b.layer._holes))}});L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1E3}},initialize:function(b,c,h){L.Browser.touch&&(this.options.icon=this.options.touchIcon);this._poly=b;h&&h.drawError&&(h.drawError=L.Util.extend({},this.options.drawError,h.drawError));this._latlngs=c;L.setOptions(this,h)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var b=this._poly;b instanceof L.Polygon||(b.options.fill=!1,b.options.editing&&(b.options.editing.fill=!1));b.setStyle(b.options.editing);this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var b=this._poly;b.setStyle(b.options.original);b._map&&(b._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup);this._markers=[];var b=this._defaultShape(),c,h,a;c=0;for(h=b.length;c<h;c++)a=this._createMarker(b[c],c),a.on("click",this._onMarkerClick,this),this._markers.push(a);c=0;for(b=h-1;c<h;b=c++)if(0!==c||L.Polygon&&this._poly instanceof L.Polygon)b=this._markers[b],a=this._markers[c],this._createMiddleMarker(b,a),this._updatePrevNext(b,a)},_createMarker:function(b,c){var h=new L.Marker.Touch(b,{draggable:!0,icon:this.options.icon});h._origLatLng=b;h._index=c;h.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this);this._markerGroup.addLayer(h);return h},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var b=this._defaultShape(),c=[].splice.apply(b,arguments);this._poly._convertLatLngs(b,!0);this._poly.redraw();return c},_removeMarker:function(b){var c=b._index;this._markerGroup.removeLayer(b);this._markers.splice(c,1);this._spliceLatLngs(c,1);this._updateIndexes(c,-1);b.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0;this._poly.fire("edit");this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(b){var c=b.target,h=this._poly;L.extend(c._origLatLng,c._latlng);c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c));c._middleRight&&c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next));if(h.options.poly){var a=h._map._editTooltip;if(!h.options.poly.allowIntersection&&h.intersects()){var d=h.options.color;h.setStyle({color:this.options.drawError.color});0!==L.version.indexOf("0.7")&&c.dragging._draggable._onUp(b);this._onMarkerClick(b);a&&a.updateContent({text:L.drawLocal.draw.handlers.polyline.error});setTimeout(function(){h.setStyle({color:d});a&&a.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1E3)}}this._poly.redraw();this._poly.fire("editdrag")},_onMarkerClick:function(b){var c=L.Polygon&&this._poly instanceof L.Polygon?4:3;b=b.target;this._defaultShape().length<c||(this._removeMarker(b),this._updatePrevNext(b._prev,b._next),b._middleLeft&&this._markerGroup.removeLayer(b._middleLeft),b._middleRight&&this._markerGroup.removeLayer(b._middleRight),b._prev&&b._next?this._createMiddleMarker(b._prev,b._next):b._prev?b._next||(b._prev._middleRight=null):b._next._middleLeft=null,this._fireEdit())},_onTouchMove:function(b){var c=this._map.mouseEventToLayerPoint(b.originalEvent.touches[0]),c=this._map.layerPointToLatLng(c);b=b.target;L.extend(b._origLatLng,c);b._middleLeft&&b._middleLeft.setLatLng(this._getMiddleLatLng(b._prev,b));b._middleRight&&b._middleRight.setLatLng(this._getMiddleLatLng(b,b._next));this._poly.redraw();this.updateMarkers()},_updateIndexes:function(b,c){this._markerGroup.eachLayer(function(h){h._index>b&&(h._index+=c)})},_createMiddleMarker:function(b,c){var h=this._getMiddleLatLng(b,c),a=this._createMarker(h),d,f,g;a.setOpacity(.6);b._middleRight=c._middleLeft=a;f=function(){a.off("touchmove",f,this);var g=c._index;a._index=g;a.off("click",d,this).on("click",this._onMarkerClick,this);h.lat=a.getLatLng().lat;h.lng=a.getLatLng().lng;this._spliceLatLngs(g,0,h);this._markers.splice(g,0,a);a.setOpacity(1);this._updateIndexes(g,1);c._index++;this._updatePrevNext(b,a);this._updatePrevNext(a,c);this._poly.fire("editstart")};g=function(){a.off("dragstart",f,this);a.off("dragend",g,this);a.off("touchmove",f,this);this._createMiddleMarker(b,a);this._createMiddleMarker(a,c)};d=function(){f.call(this);g.call(this);this._fireEdit()};a.on("click",d,this).on("dragstart",f,this).on("dragend",g,this).on("touchmove",f,this);this._markerGroup.addLayer(a)},_updatePrevNext:function(b,c){b&&(b._next=c);c&&(c._prev=b)},_getMiddleLatLng:function(b,c){var h=this._poly._map,a=h.project(b.getLatLng()),d=h.project(c.getLatLng());return h.unproject(a._add(d)._divideBy(2))}});L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this,this.options.poly),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))});L.Edit=L.Edit||{};L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(b,c){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon);this._shape=b;L.Util.setOptions(this,c)},addHooks:function(){var b=this._shape;this._shape._map&&(this._map=this._shape._map,b.setStyle(b.options.editing),b._map&&(this._map=b._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var b=this._shape;b.setStyle(b.options.original);if(b._map){this._unbindMarker(this._moveMarker);for(var b=0,c=this._resizeMarkers.length;b<c;b++)this._unbindMarker(this._resizeMarkers[b]);this._resizeMarkers=null;this._map.removeLayer(this._markerGroup);delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup);this._createMoveMarker();this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(b,c){var h=new L.Marker.Touch(b,{draggable:!0,icon:c,zIndexOffset:10});this._bindMarker(h);this._markerGroup.addLayer(h);return h},_bindMarker:function(b){b.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(b){b.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(b){b.target.setOpacity(0);this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0;this._shape.fire("edit")},_onMarkerDrag:function(b){b=b.target;var c=b.getLatLng();b===this._moveMarker?this._move(c):this._resize(c);this._shape.redraw();this._shape.fire("editdrag")},_onMarkerDragEnd:function(b){b.target.setOpacity(1);this._fireEdit()},_onTouchStart:function(b){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,b);if("function"===typeof this._getCorners){var c=this._getCorners();b=b.target;var h=b._cornerIndex;b.setOpacity(0);this._oppositeCorner=c[(h+2)%4];this._toggleCornerMarkers(0,h)}this._shape.fire("editstart")},_onTouchMove:function(b){var c=this._map.mouseEventToLayerPoint(b.originalEvent.touches[0]),c=this._map.layerPointToLatLng(c);b.target===this._moveMarker?this._move(c):this._resize(c);this._shape.redraw();return!1},_onTouchEnd:function(b){b.target.setOpacity(1);this.updateMarkers();this._fireEdit()},_move:function(){},_resize:function(){}});L.Edit=L.Edit||{};L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var b=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(b,this.options.moveIcon)},_createResizeMarker:function(){var b=this._getCorners();this._resizeMarkers=[];for(var c=0,h=b.length;c<h;c++)this._resizeMarkers.push(this._createMarker(b[c],this.options.resizeIcon)),this._resizeMarkers[c]._cornerIndex=c},_onMarkerDragStart:function(b){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,b);var c=this._getCorners();b=b.target._cornerIndex;this._oppositeCorner=c[(b+2)%4];this._toggleCornerMarkers(0,b)},_onMarkerDragEnd:function(b){var c=b.target,h;c===this._moveMarker&&(h=this._shape.getBounds(),h=h.getCenter(),c.setLatLng(h));this._toggleCornerMarkers(1);this._repositionCornerMarkers();L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,b)},_move:function(b){for(var c=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),h=this._shape.getBounds().getCenter(),a,d=[],f=0,g=c.length;f<g;f++)a=[c[f].lat-h.lat,c[f].lng-h.lng],d.push([b.lat+a[0],b.lng+a[1]]);this._shape.setLatLngs(d);this._repositionCornerMarkers();this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(b){this._shape.setBounds(L.latLngBounds(b,this._oppositeCorner));b=this._shape.getBounds();this._moveMarker.setLatLng(b.getCenter());this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var b=this._shape.getBounds(),c=b.getNorthWest(),h=b.getNorthEast(),a=b.getSouthEast(),b=b.getSouthWest();return[c,h,a,b]},_toggleCornerMarkers:function(b){for(var c=0,h=this._resizeMarkers.length;c<h;c++)this._resizeMarkers[c].setOpacity(b)},_repositionCornerMarkers:function(){for(var b=this._getCorners(),c=0,h=this._resizeMarkers.length;c<h;c++)this._resizeMarkers[c].setLatLng(b[c])}});L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())});L.Edit=L.Edit||{};L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var b=this._shape.getLatLng();this._moveMarker=this._createMarker(b,this.options.moveIcon)},_createResizeMarker:function(){var b=this._shape.getLatLng(),b=this._getResizeMarkerPoint(b);this._resizeMarkers=[];this._resizeMarkers.push(this._createMarker(b,this.options.resizeIcon))},_getResizeMarkerPoint:function(b){var c=this._shape._radius*Math.cos(Math.PI/4);b=this._map.project(b);return this._map.unproject([b.x+c,b.y-c])},_move:function(b){var c=this._getResizeMarkerPoint(b);this._resizeMarkers[0].setLatLng(c);this._shape.setLatLng(b);this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(b){b=this._moveMarker.getLatLng().distanceTo(b);this._shape.setRadius(b);this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}});L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable());this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()});this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})});L.Map.mergeOptions({touchExtend:!0});L.Map.TouchExtend=L.Handler.extend({initialize:function(b){this._map=b;this._container=b._container;this._pane=b._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this);L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this);L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this);this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart);L.DomEvent.off(this._container,"touchend",this._onTouchEnd);L.DomEvent.off(this._container,"touchmove",this._onTouchMove);this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDowm",this._onTouchStart),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave))},_touchEvent:function(b,c){var h={};if("undefined"!==typeof b.touches){if(!b.touches.length)return;h=b.touches[0]}else if("touch"===b.pointerType){if(h=b,!this._filterClick(b))return}else return;var a=this._map.mouseEventToContainerPoint(h),d=this._map.mouseEventToLayerPoint(h),f=this._map.layerPointToLatLng(d);this._map.fire(c,{latlng:f,layerPoint:d,containerPoint:a,pageX:h.pageX,pageY:h.pageY,originalEvent:b})},_filterClick:function(b){var c=b.timeStamp||b.originalEvent.timeStamp,h=L.DomEvent._lastClick&&c-L.DomEvent._lastClick;if(h&&100<h&&500>h||b.target._simulatedClick&&!b._simulated)return L.DomEvent.stop(b),!1;L.DomEvent._lastClick=c;return!0},_onTouchStart:function(b){this._map._loaded&&this._touchEvent(b,"touchstart")},_onTouchEnd:function(b){this._map._loaded&&this._touchEvent(b,"touchend")},_onTouchCancel:function(b){if(this._map._loaded){var c="touchcancel";this._detectIE()&&(c="pointercancel");this._touchEvent(b,c)}},_onTouchLeave:function(b){this._map._loaded&&this._touchEvent(b,"touchleave")},_onTouchMove:function(b){this._map._loaded&&this._touchEvent(b,"touchmove")},_detectIE:function(){var b=n.navigator.userAgent,c=b.indexOf("MSIE ");if(0<c)return parseInt(b.substring(c+5,b.indexOf(".",c)),10);if(0<b.indexOf("Trident/"))return c=b.indexOf("rv:"),parseInt(b.substring(c+3,b.indexOf(".",c)),10);c=b.indexOf("Edge/");return 0<c?parseInt(b.substring(c+5,b.indexOf(".",c)),10):!1}});L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend);L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var b=this._icon,c="dblclick mousedown mouseover mouseout contextmenu touchstart touchend touchmove".split(" ");this._detectIE?c.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):c.concat(["touchcancel"]);L.DomUtil.addClass(b,"leaflet-clickable");L.DomEvent.on(b,"click",this._onMouseClick,this);L.DomEvent.on(b,"keypress",this._onKeyPress,this);for(var h=0;h<c.length;h++)L.DomEvent.on(b,c[h],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var b=n.navigator.userAgent,c=b.indexOf("MSIE ");if(0<c)return parseInt(b.substring(c+5,b.indexOf(".",c)),10);if(0<b.indexOf("Trident/"))return c=b.indexOf("rv:"),parseInt(b.substring(c+3,b.indexOf(".",c)),10);c=b.indexOf("Edge/");return 0<c?parseInt(b.substring(c+5,b.indexOf(".",c)),10):!1}});L.LatLngUtil={cloneLatLngs:function(b){for(var c=[],h=0,a=b.length;h<a;h++)Array.isArray(b[h])?c.push(L.LatLngUtil.cloneLatLngs(b[h])):c.push(this.cloneLatLng(b[h]));return c},cloneLatLng:function(b){return L.latLng(b.lat,b.lng)}};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(b){var c=b.length,h=0,a=Math.PI/180,d,f;if(2<c){for(var g=0;g<c;g++)d=b[g],f=b[(g+1)%c],h+=(f.lng-d.lng)*a*(2+Math.sin(d.lat*a)+Math.sin(f.lat*a));h=40680631590769*h/2}return Math.abs(h)},readableArea:function(b,c){var h;c?h=1E4<=b?(1E-4*b).toFixed(2)+" ha":b.toFixed(2)+" m\x26sup2;":(b/=.836127,h=3097600<=b?(b/3097600).toFixed(2)+" mi\x26sup2;":4840<=b?(b/4840).toFixed(2)+" acres":Math.ceil(b)+" yd\x26sup2;");return h},readableDistance:function(b,c,h,a){switch("string"==typeof c?c:h?"feet":a?"nauticalMile":c?"metric":"yards"){case "metric":b=1E3<b?(b/1E3).toFixed(2)+" km":Math.ceil(b)+" m";break;case "feet":b=Math.ceil(3.28083*b)+" ft";break;case "nauticalMile":b*=.53996;b=(b/1E3).toFixed(2)+" nm";break;default:b*=1.09361,b=1760<b?(b/1760).toFixed(2)+" miles":Math.ceil(b)+" yd"}return b}});L.Util.extend(L.LineUtil,{segmentsIntersect:function(b,c,h,a){return this._checkCounterclockwise(b,h,a)!==this._checkCounterclockwise(c,h,a)&&this._checkCounterclockwise(b,c,h)!==this._checkCounterclockwise(b,c,a)},_checkCounterclockwise:function(b,c,h){return(h.y-b.y)*(c.x-b.x)>(c.y-b.y)*(h.x-b.x)}});L.Polyline.include({intersects:function(){var b=this._getProjectedPoints(),c=b?b.length:0,h,a;if(this._tooFewPointsForIntersection())return!1;for(--c;3<=c;c--)if(h=b[c-1],a=b[c],this._lineSegmentsIntersectsRange(h,a,c-2))return!0;return!1},newLatLngIntersects:function(b,c){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(b),c):!1},newPointIntersects:function(b,c){var h=this._getProjectedPoints(),a=h?h.length:0,h=h?h[a-1]:null,a=a-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(h,b,a,c?1:0)},_tooFewPointsForIntersection:function(b){var c=this._getProjectedPoints(),h=c?c.length:0;return!c||3>=h+(b||0)},_lineSegmentsIntersectsRange:function(b,c,h,a){var d=this._getProjectedPoints(),f;a=a||0;for(var g=h;g>a;g--)if(h=d[g-1],f=d[g],L.LineUtil.segmentsIntersect(b,c,h,f))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var b=[],c=this._defaultShape(),h=0;h<c.length;h++)b.push(this._map.latLngToLayerPoint(c[h]));return b}});L.Polygon.include({intersects:function(){var b=this._getProjectedPoints(),c;if(this._tooFewPointsForIntersection())return!1;if(L.Polyline.prototype.intersects.call(this))return!0;c=b.length;return this._lineSegmentsIntersectsRange(b[c-1],b[0],c-2,1)}});L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(b){if("0.7">L.version)throw Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,b);this._toolbars={};L.DrawToolbar&&this.options.draw&&(b=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=b,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this));L.EditToolbar&&this.options.edit&&(b=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=b,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this));L.toolbar=this},onAdd:function(b){var c=L.DomUtil.create("div","leaflet-draw"),h=!1,a,d;for(d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(a=this._toolbars[d].addToolbar(b))&&(h||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),h=!0),c.appendChild(a));return c},onRemove:function(){for(var b in this._toolbars)this._toolbars.hasOwnProperty(b)&&this._toolbars[b].removeToolbar()},setDrawingOptions:function(b){for(var c in this._toolbars)this._toolbars[c]instanceof L.DrawToolbar&&this._toolbars[c].setOptions(b)},_toolbarEnabled:function(b){b=b.target;for(var c in this._toolbars)this._toolbars[c]!==b&&this._toolbars[c].disable()}});L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1});L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))});L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(b){L.setOptions(this,b);this._modes={};this._actionButtons=[];this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(b){var c=L.DomUtil.create("div","leaflet-draw-section"),h=0,a=this._toolbarClass||"",d=this.getModeHandlers(b);this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar");this._map=b;for(b=0;b<d.length;b++)d[b].enabled&&this._initModeHandler(d[b].handler,this._toolbarContainer,h++,a,d[b].title);if(h)return this._lastButtonIndex=--h,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),c.appendChild(this._toolbarContainer),c.appendChild(this._actionsContainer),c},removeToolbar:function(){for(var b in this._modes)this._modes.hasOwnProperty(b)&&(this._disposeButton(this._modes[b].button,this._modes[b].handler.enable,this._modes[b].handler),this._modes[b].handler.disable(),this._modes[b].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};b=0;for(var c=this._actionButtons.length;b<c;b++)this._disposeButton(this._actionButtons[b].button,this._actionButtons[b].callback,this);this._actionButtons=[];this._actionsContainer=null},_initModeHandler:function(b,c,h,a,d){var f=b.type;this._modes[f]={};this._modes[f].handler=b;this._modes[f].button=this._createButton({type:f,title:d,className:a+"-"+f,container:c,callback:this._modes[f].handler.enable,context:this._modes[f].handler});this._modes[f].buttonIndex=h;this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(b){var c=L.DomUtil.create("a",b.className||"",b.container),h=L.DomUtil.create("span","sr-only",b.container);c.href="#";c.appendChild(h);b.title&&(c.title=b.title,h.innerHTML=b.title);b.text&&(c.innerHTML=b.text,h.innerHTML=b.text);L.DomEvent.on(c,"click",L.DomEvent.stopPropagation).on(c,"mousedown",L.DomEvent.stopPropagation).on(c,"dblclick",L.DomEvent.stopPropagation).on(c,"touchstart",L.DomEvent.stopPropagation).on(c,"click",L.DomEvent.preventDefault).on(c,"click",b.callback,b.context);return c},_disposeButton:function(b,c){L.DomEvent.off(b,"click",L.DomEvent.stopPropagation).off(b,"mousedown",L.DomEvent.stopPropagation).off(b,"dblclick",L.DomEvent.stopPropagation).off(b,"touchstart",L.DomEvent.stopPropagation).off(b,"click",L.DomEvent.preventDefault).off(b,"click",c)},_handlerActivated:function(b){this.disable();this._activeMode=this._modes[b.handler];L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled");this._showActionsToolbar();this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar();L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled");this._activeMode=null;this.fire("disable")},_createActions:function(b){var c=this._actionsContainer;b=this.getActions(b);var h=b.length,a,d;d=0;for(a=this._actionButtons.length;d<a;d++)this._disposeButton(this._actionButtons[d].button,this._actionButtons[d].callback);for(this._actionButtons=[];c.firstChild;)c.removeChild(c.firstChild);for(d=0;d<h;d++)"enabled"in b[d]&&!b[d].enabled||(a=L.DomUtil.create("li","",c),a=this._createButton({title:b[d].title,text:b[d].text,container:a,callback:b[d].callback,context:b[d].context}),this._actionButtons.push({button:a,callback:b[d].callback}))},_showActionsToolbar:function(){var b=this._activeMode.buttonIndex,c=this._lastButtonIndex,h=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler);this._actionsContainer.style.top=h+"px";0===b&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top"));b===c&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom"));this._actionsContainer.style.display="block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none";L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop");L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom");L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top");L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom")}});L.Draw=L.Draw||{};L.Draw.Tooltip=L.Class.extend({initialize:function(b){this._map=b;this._popupPane=b._panes.popupPane;this._container=b.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null;this._singleLineLabel=!1;this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this);this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(b){if(!this._container)return this;b.subtext=b.subtext||"";0!==b.subtext.length||this._singleLineLabel?0<b.subtext.length&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0);this._container.innerHTML=(0<b.subtext.length?'\x3cspan class\x3d"leaflet-draw-tooltip-subtext"\x3e'+b.subtext+"\x3c/span\x3e\x3cbr /\x3e":"")+"\x3cspan\x3e"+b.text+"\x3c/span\x3e";return this},updatePosition:function(b){b=this._map.latLngToLayerPoint(b);var c=this._container;this._container&&(c.style.visibility="inherit",L.DomUtil.setPosition(c,b));return this},showAsError:function(){this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip");return this},removeError:function(){this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip");return this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}});L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(b){for(var c in this.options)this.options.hasOwnProperty(c)&&b[c]&&(b[c]=L.extend({},this.options[c],b[c]));this._toolbarClass="leaflet-draw-draw";L.Toolbar.prototype.initialize.call(this,b)},getModeHandlers:function(b){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(b,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(b,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(b,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(b,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(b,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(b){return[{enabled:b.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:b.completeShape,context:b},{enabled:b.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:b.deleteLastVertex,context:b},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(b){L.setOptions(this,b);for(var c in this._modes)this._modes.hasOwnProperty(c)&&b.hasOwnProperty(c)&&this._modes[c].handler.setOptions(b[c])}});L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(b){b.edit&&("undefined"===typeof b.edit.selectedPathOptions&&(b.edit.selectedPathOptions=this.options.edit.selectedPathOptions),b.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,b.edit.selectedPathOptions));b.remove&&(b.remove=L.extend({},this.options.remove,b.remove));b.poly&&(b.poly=L.extend({},this.options.poly,b.poly));this._toolbarClass="leaflet-draw-edit";L.Toolbar.prototype.initialize.call(this,b);this._selectedFeatureCount=0},getModeHandlers:function(b){var c=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(b,{featureGroup:c,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(b,{featureGroup:c}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(b){b=L.Toolbar.prototype.addToolbar.call(this,b);this._checkDisabled();this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this);return b},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this);L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save();this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var b=0!==this.options.featureGroup.getLayers().length,c;this.options.edit&&(c=this._modes[L.EditToolbar.Edit.TYPE].button,b?L.DomUtil.removeClass(c,"leaflet-disabled"):L.DomUtil.addClass(c,"leaflet-disabled"),c.setAttribute("title",b?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled));this.options.remove&&(c=this._modes[L.EditToolbar.Delete.TYPE].button,b?L.DomUtil.removeClass(c,"leaflet-disabled"):L.DomUtil.addClass(c,"leaflet-disabled"),c.setAttribute("title",b?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}});L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},includes:L.Mixin.Events,initialize:function(b,c){L.Handler.prototype.initialize.call(this,b);L.setOptions(this,c);this._featureGroup=c.featureGroup;if(!(this._featureGroup instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={};this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var b=this._map;b&&(b.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),b._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(b){this._revertLayer(b)},this)},save:function(){var b=new L.LayerGroup;this._featureGroup.eachLayer(function(c){c.edited&&(b.addLayer(c),c.edited=!1)});this._map.fire(L.Draw.Event.EDITED,{layers:b})},_backupLayer:function(b){var c=L.Util.stamp(b);this._uneditedLayerProps[c]||(b instanceof L.Polyline||b instanceof L.Polygon||b instanceof L.Rectangle?this._uneditedLayerProps[c]={latlngs:L.LatLngUtil.cloneLatLngs(b.getLatLngs())}:b instanceof L.Circle?this._uneditedLayerProps[c]={latlng:L.LatLngUtil.cloneLatLng(b.getLatLng()),radius:b.getRadius()}:b instanceof L.Marker&&(this._uneditedLayerProps[c]={latlng:L.LatLngUtil.cloneLatLng(b.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(b){var c=L.Util.stamp(b);b.edited=!1;this._uneditedLayerProps.hasOwnProperty(c)&&(b instanceof L.Polyline||b instanceof L.Polygon||b instanceof L.Rectangle?b.setLatLngs(this._uneditedLayerProps[c].latlngs):b instanceof L.Circle?(b.setLatLng(this._uneditedLayerProps[c].latlng),b.setRadius(this._uneditedLayerProps[c].radius)):b instanceof L.Marker&&b.setLatLng(this._uneditedLayerProps[c].latlng),b.fire("revert-edited",{layer:b}))},_enableLayerEdit:function(b){b=b.layer||b.target||b;var c;this._backupLayer(b);this.options.poly&&(c=L.Util.extend({},this.options.poly),b.options.poly=c);this.options.selectedPathOptions&&(c=L.Util.extend({},this.options.selectedPathOptions),c.maintainColor&&(c.color=b.options.color,c.fillColor=b.options.fillColor),b.options.original=L.extend({},b.options),b.options.editing=c);b instanceof L.Marker?(b.editing&&b.editing.enable(),b.dragging.enable(),b.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):b.editing.enable()},_disableLayerEdit:function(b){b=b.layer||b.target||b;b.edited=!1;b.editing&&b.editing.disable();delete b.options.editing;delete b.options.original;this._selectedPathOptions&&(b instanceof L.Marker?this._toggleMarkerHighlight(b):(b.setStyle(b.options.previousOptions),delete b.options.previousOptions));b instanceof L.Marker?(b.dragging.disable(),b.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):b.editing.disable()},_onMouseMove:function(b){this._tooltip.updatePosition(b.latlng)},_onMarkerDragEnd:function(b){b=b.target;b.edited=!0;this._map.fire(L.Draw.Event.EDITMOVE,{layer:b})},_onTouchMove:function(b){var c=this._map.mouseEventToLayerPoint(b.originalEvent.changedTouches[0]),c=this._map.layerPointToLatLng(c);b.target.setLatLng(c)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}});L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},includes:L.Mixin.Events,initialize:function(b,c){L.Handler.prototype.initialize.call(this,b);L.Util.setOptions(this,c);this._deletableLayers=this.options.featureGroup;if(!(this._deletableLayers instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var b=this._map;b&&(b.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(b){this._deletableLayers.addLayer(b);b.fire("revert-deleted",{layer:b})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},_enableLayerDelete:function(b){(b.layer||b.target||b).on("click",this._removeLayer,this)},_disableLayerDelete:function(b){b=b.layer||b.target||b;b.off("click",this._removeLayer,this);this._deletedLayers.removeLayer(b)},_removeLayer:function(b){b=b.layer||b.target||b;this._deletableLayers.removeLayer(b);this._deletedLayers.addLayer(b);b.fire("deleted")},_onMouseMove:function(b){this._tooltip.updatePosition(b.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})})(window,document);!function(){L.Marker.Measurement=L[L.Layer?"Layer":"Class"].extend({options:{pane:"markerPane"},initialize:function(e,b,c,h,a){L.setOptions(this,a);this._latlng=e;this._measurement=b;this._title=c;this._rotation=h},addTo:function(e){e.addLayer(this);return this},onAdd:function(e){this._map=e;var b=this.getPane?this.getPane():e.getPanes().markerPane,b=this._element=L.DomUtil.create("div","leaflet-zoom-animated leaflet-measure-path-measurement",b),b=L.DomUtil.create("div","",b);b.title=this._title;b.innerHTML=this._measurement;e.on("zoomanim",this._animateZoom,this);this._setPosition()},onRemove:function(e){e.off("zoomanim",this._animateZoom,this);(this.getPane?this.getPane():e.getPanes().markerPane).removeChild(this._element);this._map=null},_setPosition:function(){L.DomUtil.setPosition(this._element,this._map.latLngToLayerPoint(this._latlng));this._element.style.transform+=" rotate("+this._rotation+"rad)"},_animateZoom:function(e){e=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();L.DomUtil.setPosition(this._element,e);this._element.style.transform+=" rotate("+this._rotation+"rad)"}});L.marker.measurement=function(e,b,c,h,a){return new L.Marker.Measurement(e,b,c,h,a)};var n=function(e){var b;this._measurementOptions.imperial?404.685642<e?(e/=4046.85642,b="ac"):(e/=.09290304,b="ft\u00b2"):1E6<e?(e/=1E6,b="km\u00b2"):b="m\u00b2";return 100>e?e.toFixed(1)+" "+b:Math.round(e)+" "+b},e=function(e,b,c){return c?function(){b.apply(this,arguments);return e.apply(this,arguments)}:function(){e.apply(this,arguments);return b.apply(this,arguments)}};L.Polyline.include({showMeasurements:function(e){if(!this._map||this._measurementLayer)return this;this._measurementOptions=L.extend({showOnHover:!1,minPixelDistance:30,showDistances:!0,showArea:!0,lang:{totalLength:"Total length",totalArea:"Total area",segmentLength:"Segment length"}},e||{});this._measurementLayer=L.layerGroup().addTo(this._map);this.updateMeasurements();this._map.on("zoomend",this.updateMeasurements,this);return this},hideMeasurements:function(){this._map.off("zoomend",this.updateMeasurements,this);if(!this._measurementLayer)return this;this._map.removeLayer(this._measurementLayer);this._measurementLayer=null;return this},onAdd:e(L.Polyline.prototype.onAdd,function(){this.options.showMeasurements&&this.showMeasurements(this.options.measurementOptions)}),onRemove:e(L.Polyline.prototype.onRemove,function(){this.hideMeasurements()},!0),setLatLngs:e(L.Polyline.prototype.setLatLngs,function(){return this.updateMeasurements()}),spliceLatLngs:e(L.Polyline.prototype.spliceLatLngs,function(){return this.updateMeasurements()}),formatDistance:function(e){var b;this._measurementOptions.imperial?(b=e/.3048,3E3<b?(e/=1609.344,b="mi"):(e=b,b="ft")):1E3<e?(e/=1E3,b="km"):b="m";return 100>e?e.toFixed(1)+" "+b:Math.round(e)+" "+b},formatArea:n,updateMeasurements:function(){if(!this._measurementLayer)return this;var e=this.getLatLngs(),b=this instanceof L.Polygon,c=this._measurementOptions,h=0,a,d,f,g,l,y,m;e&&e.length&&L.Util.isArray(e[0])&&(e=e[0]);this._measurementLayer.clearLayers();if(this._measurementOptions.showDistances&&1<e.length){a=this._measurementOptions.formatDistance||L.bind(this.formatDistance,this);for(var u=1,p=e.length;b&&u<=p||u<p;u++)d=e[u-1],f=e[u%p],m=d.distanceTo(f),h+=m,g=this._map.latLngToLayerPoint(d),l=this._map.latLngToLayerPoint(f),y=g.distanceTo(l),y>=c.minPixelDistance&&L.marker.measurement(this._map.layerPointToLatLng([(g.x+l.x)/2,(g.y+l.y)/2]),a(m),c.lang.segmentLength,this._getRotation(d,f),c).addTo(this._measurementLayer);b||L.marker.measurement(f,a(h),c.lang.totalLength,0,c).addTo(this._measurementLayer)}if(b&&c.showArea&&2<e.length){a=c.formatArea||L.bind(this.formatArea,this);b=0;h=e.length;if(2<h){for(d=0;d<h;d++)d===h-2?(f=h-2,l=h-1,g=0):d===h-1?(f=h-1,l=0,g=1):(f=d,l=d+1,g=d+2),f=e[f],l=e[l],g=e[g],b+=(g.lng*Math.PI/180-f.lng*Math.PI/180)*Math.sin(l.lat*Math.PI/180);b=40680631590769*b/2}e=Math.abs(b);L.marker.measurement(this.getBounds().getCenter(),a(e),c.lang.totalArea,0,c).addTo(this._measurementLayer)}return this},_getRotation:function(e,b){var c=this._map.project(e),h=this._map.project(b);return Math.atan((h.y-c.y)/(h.x-c.x))}});L.Polyline.addInitHook(function(){this.options.showMeasurements&&this.showMeasurements()});L.Circle.include({showMeasurements:function(e){if(!this._map||this._measurementLayer)return this;this._measurementOptions=L.extend({showOnHover:!1,showArea:!0,lang:{totalArea:"Total area"}},e||{});this._measurementLayer=L.layerGroup().addTo(this._map);this.updateMeasurements();this._map.on("zoomend",this.updateMeasurements,this);return this},hideMeasurements:function(){this._map.on("zoomend",this.updateMeasurements,this);if(!this._measurementLayer)return this;this._map.removeLayer(this._measurementLayer);this._measurementLayer=null;return this},onAdd:e(L.Circle.prototype.onAdd,function(){this.options.showMeasurements&&this.showMeasurements(this.options.measurementOptions)}),onRemove:e(L.Circle.prototype.onRemove,function(){this.hideMeasurements()},!0),setLatLng:e(L.Circle.prototype.setLatLng,function(){this.updateMeasurements()}),setRadius:e(L.Circle.prototype.setRadius,function(){this.updateMeasurements()}),formatArea:n,updateMeasurements:function(){if(this._measurementLayer){var e=this.getLatLng(),b=this._measurementOptions,c=b.formatArea||L.bind(this.formatArea,this);this._measurementLayer.clearLayers();if(b.showArea){var c=b.formatArea||L.bind(this.formatArea,this),h=this.getRadius()/6378137;L.marker.measurement(e,c(81361263181538*Math.PI*(1-Math.cos(h))),b.lang.totalArea,0,b).addTo(this._measurementLayer)}}}});L.Circle.addInitHook(function(){this.options.showMeasurements&&this.showMeasurements()})}();(function(n,e){"object"===typeof exports&&"undefined"!==typeof module?e(exports,require("leaflet")):"function"===typeof define&&define.amd?define(["exports","leaflet"],e):e((n.L=n.L||{},n.L.esri=n.L.esri||{}),n.L)})(this,function(n,e){function k(a){var c="";a.f=a.f||"json";for(var b in a)if(a.hasOwnProperty(b)){var d=a[b],f=Object.prototype.toString.call(d);c.length&&(c+="\x26");d="[object Array]"===f?"[object Object]"===Object.prototype.toString.call(d[0])?JSON.stringify(d):d.join(","):"[object Object]"===f?JSON.stringify(d):"[object Date]"===f?d.valueOf():d;c+=encodeURIComponent(b)+"\x3d"+encodeURIComponent(d)}return c}function b(a,c){var b=new window.XMLHttpRequest;b.onerror=function(d){b.onreadystatechange=e.Util.falseFn;a.call(c,{error:{code:500,message:"XMLHttpRequest error"}},null)};b.onreadystatechange=function(){var d,f;if(4===b.readyState){try{d=JSON.parse(b.responseText)}catch(g){d=null,f={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!f&&d.error&&(f=d.error,d=null);b.onerror=e.Util.falseFn;a.call(c,f,d)}};b.ontimeout=function(){this.onerror()};return b}function c(a,c,d,f){d=b(d,f);d.open("POST",a);"undefined"!==typeof f&&null!==f&&"undefined"!==typeof f.options&&(d.timeout=f.options.timeout);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(k(c));return d}function h(a,c,d,f){d=b(d,f);d.open("GET",a+"?"+k(c),!0);"undefined"!==typeof f&&null!==f&&"undefined"!==typeof f.options&&(d.timeout=f.options.timeout);d.send(null);return d}function a(a,c,f,g){var l=k(c),h=b(f,g),e=(a+"?"+l).length;2E3>=e&&H.cors?h.open("GET",a+"?"+l):2E3<e&&H.cors&&(h.open("POST",a),h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));"undefined"!==typeof g&&null!==g&&"undefined"!==typeof g.options&&(h.timeout=g.options.timeout);if(2E3>=e&&H.cors)h.send(null);else if(2E3<e&&H.cors)h.send(l);else{if(2E3>=e&&!H.cors)return d(a,c,f,g);z("a request to "+a+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");return}return h}function d(a,c,b,d){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var f="c"+W;c.callback="window._EsriLeafletCallbacks."+f;window._EsriLeafletCallbacks[f]=function(a){if(!0!==window._EsriLeafletCallbacks[f]){var c,g=Object.prototype.toString.call(a);"[object Object]"!==g&&"[object Array]"!==g&&(c={error:{code:500,message:"Expected array or object as JSONP response"}},a=null);!c&&a.error&&(c=a,a=null);b.call(d,c,a);window._EsriLeafletCallbacks[f]=!0}};var g=e.DomUtil.create("script",null,document.body);g.type="text/javascript";g.src=a+"?"+k(c);g.id=f;W++;return{id:f,url:g.src,abort:function(){window._EsriLeafletCallbacks._callback[f]({code:0,message:"Request aborted."})}}}function f(a){var c;a:{c=a[0];for(var b=0;b<c.length;b++)if(c[b]!==a[a.length-1][b]){c=!1;break a}c=!0}c||a.push(a[0]);return a}function g(a){var c=0,b=0,d=a.length,f=a[b],g;for(b;b<d-1;b++)g=a[b+1],c+=(g[0]-f[0])*(g[1]+f[1]),f=g;return 0<=c}function l(a,c){for(var b=0;b<a.length-1;b++)for(var d=0;d<c.length-1;d++){var f;a:{var g=a[b],l=a[b+1],h=c[d],e=c[d+1],m=(e[0]-h[0])*(g[1]-h[1])-(e[1]-h[1])*(g[0]-h[0]);f=(l[0]-g[0])*(g[1]-h[1])-(l[1]-g[1])*(g[0]-h[0]);g=(e[1]-h[1])*(l[0]-g[0])-(e[0]-h[0])*(l[1]-g[1]);if(0!==g&&(m/=g,f/=g,0<=m&&1>=m&&0<=f&&1>=f)){f=!0;break a}f=!1}if(f)return!0}return!1}function y(a){var c=[];a=a.slice(0);var b=f(a.shift().slice(0));if(4<=b.length)for(g(b)||b.reverse(),c.push(b),b=0;b<a.length;b++){var d=f(a[b].slice(0));4<=d.length&&(g(d)&&d.reverse(),c.push(d))}return c}function m(a){var c={},b;for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);return c}function u(a,c){var b={};"number"===typeof a.x&&"number"===typeof a.y&&(b.type="Point",b.coordinates=[a.x,a.y]);a.points&&(b.type="MultiPoint",b.coordinates=a.points.slice(0));a.paths&&(1===a.paths.length?(b.type="LineString",b.coordinates=a.paths[0].slice(0)):(b.type="MultiLineString",b.coordinates=a.paths.slice(0)));if(a.rings){var d=a.rings.slice(0),b=[],h=[],e,k;for(k=0;k<d.length;k++){var y=f(d[k].slice(0));4>y.length||(g(y)?b.push([y]):h.push(y))}for(y=[];h.length;){k=h.pop();for(var p=!1,d=b.length-1;0<=d;d--){var q=e=b[d][0],n=k;e=l(q,n);for(var n=n[0],r=!1,t=-1,v=q.length,w=v-1;++t<v;w=t)(q[t][1]<=n[1]&&n[1]<q[w][1]||q[w][1]<=n[1]&&n[1]<q[t][1])&&n[0]<(q[w][0]-q[t][0])*(n[1]-q[t][1])/(q[w][1]-q[t][1])+q[t][0]&&(r=!r);q=r;if(!e&&q){b[d].push(k);p=!0;break}}p||y.push(k)}for(;y.length;){k=y.pop();h=!1;for(d=b.length-1;0<=d;d--)if(e=b[d][0],l(e,k)){b[d].push(k);h=!0;break}h||b.push([k.reverse()])}b=1===b.length?{type:"Polygon",coordinates:b[0]}:{type:"MultiPolygon",coordinates:b}}if(a.geometry||a.attributes)b.type="Feature",b.geometry=a.geometry?u(a.geometry):null,b.properties=a.attributes?m(a.attributes):null,a.attributes&&(b.id=a.attributes[c]||a.attributes.OBJECTID||a.attributes.FID);return b}function p(a,c){c=c||"OBJECTID";var b={wkid:4326},d={};switch(a.type){case "Point":d.x=a.coordinates[0];d.y=a.coordinates[1];d.spatialReference=b;break;case "MultiPoint":d.points=a.coordinates.slice(0);d.spatialReference=b;break;case "LineString":d.paths=[a.coordinates.slice(0)];d.spatialReference=b;break;case "MultiLineString":d.paths=a.coordinates.slice(0);d.spatialReference=b;break;case "Polygon":d.rings=y(a.coordinates.slice(0));d.spatialReference=b;break;case "MultiPolygon":for(var f=d,g=a.coordinates.slice(0),l=[],h=0;h<g.length;h++)for(var e=y(g[h]),k=e.length-1;0<=k;k--){var u=e[k].slice(0);l.push(u)}f.rings=l;d.spatialReference=b;break;case "Feature":a.geometry&&(d.geometry=p(a.geometry,c));d.attributes=a.properties?m(a.properties):{};a.id&&(d.attributes[c]=a.id);break;case "FeatureCollection":d=[];for(b=0;b<a.features.length;b++)d.push(p(a.features[b],c));break;case "GeometryCollection":for(d=[],b=0;b<a.geometries.length;b++)d.push(p(a.geometries[b],c))}return d}function q(a){if("NaN"!==a.xmin&&"NaN"!==a.ymin&&"NaN"!==a.xmax&&"NaN"!==a.ymax){var c=e.latLng(a.ymin,a.xmin);a=e.latLng(a.ymax,a.xmax);return e.latLngBounds(c,a)}return null}function r(a){a=e.latLngBounds(a);return{xmin:a.getSouthWest().lng,ymin:a.getSouthWest().lat,xmax:a.getNorthEast().lng,ymax:a.getNorthEast().lat,spatialReference:{wkid:4326}}}function t(a,c){var b,d=a.features||a.results,f=d.length;if(c)b=c;else if(a.objectIdFieldName)b=a.objectIdFieldName;else if(a.fields)for(var g=0;g<=a.fields.length-1;g++){if("esriFieldTypeOID"===a.fields[g].type){b=a.fields[g].name;break}}else if(f)for(g in d[0].attributes)if(g.match(/^(OBJECTID|FID|OID|ID)$/i)){b=g;break}g={type:"FeatureCollection",features:[]};if(f)for(f=d.length-1;0<=f;f--){var l=u(d[f],b);g.features.push(l)}return g}function v(a){a=e.Util.trim(a);"/"!==a[a.length-1]&&(a+="/");return a}function w(a){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(a)}function x(a){var c;switch(a){case "Point":c="esriGeometryPoint";break;case "MultiPoint":c="esriGeometryMultipoint";break;case "LineString":c="esriGeometryPolyline";break;case "MultiLineString":c="esriGeometryPolyline";break;case "Polygon":c="esriGeometryPolygon";break;case "MultiPolygon":c="esriGeometryPolygon"}return c}function z(){console&&console.warn&&console.warn.apply(console,arguments)}function B(a){return a.getSize().x-X.attributionWidthOffset+"px"}function D(a,c){d(a,{},e.Util.bind(function(a,b){if(!a){c._esriAttributions=[];for(var d=0;d<b.contributors.length;d++)for(var f=b.contributors[d],g=0;g<f.coverageAreas.length;g++){var l=f.coverageAreas[g],h=e.latLng(l.bbox[0],l.bbox[1]),m=e.latLng(l.bbox[2],l.bbox[3]);c._esriAttributions.push({attribution:f.attribution,score:l.score,bounds:e.latLngBounds(h,m),minZoom:l.zoomMin,maxZoom:l.zoomMax})}c._esriAttributions.sort(function(a,c){return c.score-a.score});I({target:c})}},this))}function I(a){a=a.target;var c=a._esriAttributions;if(a&&a.attributionControl&&c){for(var b="",d=a.getBounds(),d=e.latLngBounds(d.getSouthWest().wrap(),d.getNorthEast().wrap()),f=a.getZoom(),g=0;g<c.length;g++){var l=c[g],h=l.attribution;!b.match(h)&&l.bounds.intersects(d)&&f>=l.minZoom&&f<=l.maxZoom&&(b+=", "+h)}b=b.substr(2);c=a.attributionControl._container.querySelector(".esri-dynamic-attribution");c.innerHTML=b;c.style.maxWidth=B(a);a.fire("attributionupdated",{attribution:b})}}function M(a){return new Y(a)}function V(a){return new Z(a)}function aa(a){return new ba(a)}function ca(a){return new da(a)}function T(a){return new ea(a)}function fa(a){return new ga(a)}function ha(a){return new ia(a)}function E(a){this.values=[].concat(a||[])}var C="default"in e?e["default"]:e,F=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,G=""===document.documentElement.style.pointerEvents,H={cors:F,pointerEvents:G},X={attributionWidthOffset:55},W=0,N=H.cors?h:d;N.CORS=h;N.JSONP=d;var O={request:a,get:N,post:c},ma={shallowClone:function(a){var c={},b;for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);return c},warn:z,cleanUrl:v,isArcgisOnline:w,geojsonTypeToArcGIS:x,responseToFeatureCollection:t,geojsonToArcGIS:function(a,c){return p(a,c)},arcgisToGeoJSON:function(a,c){return u(a,c)},boundsToExtent:r,extentToBounds:q,calcAttributionWidth:B,setEsriAttribution:function(a){},_getAttributionData:D,_updateMapAttribution:I},J=e.Class.extend({options:{proxy:!1,useCors:F},generateSetter:function(a,c){return e.Util.bind(function(c){this.params[a]=c;return this},c)},initialize:function(a){a.request&&a.options?(this._service=a,e.Util.setOptions(this,a.options)):(e.Util.setOptions(this,a),this.options.url=v(a.url));this.params=e.Util.extend({},this.params||{});if(this.setters)for(var c in this.setters)this[c]=this.generateSetter(this.setters[c],this)},token:function(a){this._service?this._service.authenticate(a):this.params.token=a;return this},request:function(a,c){return this._service?this._service.request(this.path,this.params,a,c):this._request("request",this.path,this.params,a,c)},_request:function(a,c,b,d,f){c=this.options.proxy?this.options.proxy+"?"+this.options.url+c:this.options.url+c;return"get"!==a&&"request"!==a||this.options.useCors?O[a](c,b,d,f):O.get.JSONP(c,b,d,f)}}),Y=J.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",token:"token"},path:"query",params:{returnGeometry:!0,where:"1\x3d1",outSr:4326,outFields:"*"},within:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelContains";return this},intersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelIntersects";return this},contains:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelWithin";return this},crosses:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelCrosses";return this},touches:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelTouches";return this},overlaps:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelOverlaps";return this},bboxIntersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelEnvelopeIntersects";return this},indexIntersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelIndexIntersects";return this},nearby:function(a,c){a=e.latLng(a);this.params.geometry=[a.lng,a.lat];this.params.geometryType="esriGeometryPoint";this.params.spatialRel="esriSpatialRelIntersects";this.params.units="esriSRUnit_Meter";this.params.distance=c;this.params.inSr=4326;return this},where:function(a){this.params.where=a;return this},between:function(a,c){this.params.time=[a.valueOf(),c.valueOf()];return this},simplify:function(a,c){var b=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=b/a.getSize().y*c;return this},orderBy:function(a,c){this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"";this.params.orderByFields+=[a,c||"ASC"].join(" ");return this},run:function(a,c){this._cleanParams();return this.options.isModern||w(this.options.url)?(this.params.f="geojson",this.request(function(b,d){this._trapSQLerrors(b);a.call(c,b,d,d)},this)):this.request(function(b,d){this._trapSQLerrors(b);a.call(c,b,d&&t(d),d)},this)},count:function(a,c){this._cleanParams();this.params.returnCountOnly=!0;return this.request(function(c,b){a.call(this,c,b&&b.count,b)},c)},ids:function(a,c){this._cleanParams();this.params.returnIdsOnly=!0;return this.request(function(c,b){a.call(this,c,b&&b.objectIds,b)},c)},bounds:function(a,c){this._cleanParams();this.params.returnExtentOnly=!0;return this.request(function(b,d){d&&d.extent&&q(d.extent)?a.call(c,b,q(d.extent),d):(b={message:"Invalid Bounds"},a.call(c,b,null,d))},c)},pixelSize:function(a){a=e.point(a);this.params.pixelSize=[a.x,a.y];return this},layer:function(a){this.path=a+"/query";return this},_trapSQLerrors:function(a){a&&"400"===a.code&&z("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly;delete this.params.returnExtentOnly;delete this.params.returnCountOnly},_setGeometry:function(a){this.params.inSr=4326;a instanceof e.LatLngBounds?(this.params.geometry=r(a),this.params.geometryType="esriGeometryEnvelope"):(a.getLatLng&&(a=a.getLatLng()),a instanceof e.LatLng&&(a={type:"Point",coordinates:[a.lng,a.lat]}),a instanceof e.GeoJSON&&(a=a.getLayers()[0].feature.geometry,this.params.geometry=p(a,void 0),this.params.geometryType=x(a.type)),a.toGeoJSON&&(a=a.toGeoJSON()),"Feature"===a.type&&(a=a.geometry),"Point"===a.type||"LineString"===a.type||"Polygon"===a.type||"MultiPolygon"===a.type?(this.params.geometry=p(a,void 0),this.params.geometryType=x(a.type)):z("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}}),Z=J.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(a,c){this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"";this.params.layerDefs+=[a,c].join(":");return this},simplify:function(a,c){var b=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=b/a.getSize().y*c;return this},run:function(a,c){return this.request(function(b,d){a.call(c,b,d&&t(d),d)},c)}}),P=J.extend({path:"identify",between:function(a,c){this.params.time=[a.valueOf(),c.valueOf()];return this}}),ba=P.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(a){var c=r(a.getBounds());a=a.getSize();this.params.imageDisplay=[a.x,a.y,96];this.params.mapExtent=[c.xmin,c.ymin,c.xmax,c.ymax];return this},at:function(a){a=e.latLng(a);this.params.geometry=[a.lng,a.lat];this.params.geometryType="esriGeometryPoint";return this},layerDef:function(a,c){this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"";this.params.layerDefs+=[a,c].join(":");return this},simplify:function(a,c){var b=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=b/a.getSize().y*c;return this},run:function(a,c){return this.request(function(b,d){if(b)a.call(c,b,void 0,d);else{var f=t(d);d.results=d.results.reverse();for(var g=0;g<f.features.length;g++)f.features[g].layerId=d.results[g].layerId;a.call(c,void 0,f,d)}})}}),da=P.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(a){a=e.latLng(a);this.params.geometry=JSON.stringify({x:a.lng,y:a.lat,spatialReference:{wkid:4326}});this.params.geometryType="esriGeometryPoint";return this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(a,c){return this.request(function(b,d){a.call(c,b,d&&this._responseToGeoJSON(d),d)},this)},_responseToGeoJSON:function(a){var c=a.location,b=a.catalogItems,d=a.catalogItemVisibilities,c={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[c.x,c.y]},crs:{type:"EPSG",properties:{code:c.spatialReference.wkid}},properties:{OBJECTID:a.objectId,name:a.name,value:a.value},id:a.objectId}};a.properties&&a.properties.Values&&(c.pixel.properties.values=a.properties.Values);if(b&&b.features&&(c.catalogItems=t(b),d&&d.length===c.catalogItems.features.length))for(a=d.length-1;0<=a;a--)c.catalogItems.features[a].properties.catalogItemVisibility=d[a];return c}}),K=e.Evented.extend({options:{proxy:!1,useCors:F,timeout:0},initialize:function(a){a=a||{};this._requestQueue=[];this._authenticating=!1;e.Util.setOptions(this,a);this.options.url=v(this.options.url)},get:function(a,c,b,d){return this._request("get",a,c,b,d)},post:function(a,c,b,d){return this._request("post",a,c,b,d)},request:function(a,c,b,d){return this._request("request",a,c,b,d)},metadata:function(a,c){return this._request("get","",{},a,c)},authenticate:function(a){this._authenticating=!1;this.options.token=a;this._runQueue();return this},getTimeout:function(){return this.options.timeout},setTimeout:function(a){this.options.timeout=a},_request:function(a,c,b,d,f){this.fire("requeststart",{url:this.options.url+c,params:b,method:a},!0);var g=this._createServiceCallback(a,c,b,d,f);this.options.token&&(b.token=this.options.token);if(this._authenticating)this._requestQueue.push([a,c,b,d,f]);else return c=this.options.proxy?this.options.proxy+"?"+this.options.url+c:this.options.url+c,"get"!==a&&"request"!==a||this.options.useCors?O[a](c,b,g,f):O.get.JSONP(c,b,g,f)},_createServiceCallback:function(a,c,b,d,f){return e.Util.bind(function(g,l){!g||499!==g.code&&498!==g.code||(this._authenticating=!0,this._requestQueue.push([a,c,b,d,f]),this.fire("authenticationrequired",{authenticate:e.Util.bind(this.authenticate,this)},!0),g.authenticate=e.Util.bind(this.authenticate,this));d.call(f,g,l);g?this.fire("requesterror",{url:this.options.url+c,params:b,message:g.message,code:g.code,method:a},!0):this.fire("requestsuccess",{url:this.options.url+c,params:b,response:l,method:a},!0);this.fire("requestend",{url:this.options.url+c,params:b,method:a},!0)},this)},_runQueue:function(){for(var a=this._requestQueue.length-1;0<=a;a--){var c=this._requestQueue[a];this[c.shift()].apply(this,c)}this._requestQueue=[]}}),ea=K.extend({identify:function(){return aa(this)},find:function(){return V(this)},query:function(){return M(this)}}),ga=K.extend({query:function(){return M(this)},identify:function(){return ca(this)}}),ia=K.extend({options:{idAttribute:"OBJECTID"},query:function(){return M(this)},addFeature:function(a,c,b){delete a.id;a=p(a,void 0);return this.post("addFeatures",{features:[a]},function(a,d){var f=d&&d.addResults?d.addResults[0]:void 0;c&&c.call(b,a||d.addResults[0].error,f)},b)},updateFeature:function(a,c,b){a=p(a,this.options.idAttribute);return this.post("updateFeatures",{features:[a]},function(a,d){var f=d&&d.updateResults?d.updateResults[0]:void 0;c&&c.call(b,a||d.updateResults[0].error,f)},b)},deleteFeature:function(a,c,b){return this.post("deleteFeatures",{objectIds:a},function(a,d){var f=d&&d.deleteResults?d.deleteResults[0]:void 0;c&&c.call(b,a||d.deleteResults[0].error,f)},b)},deleteFeatures:function(a,c,b){return this.post("deleteFeatures",{objectIds:a},function(a,d){var f=d&&d.deleteResults?d.deleteResults:void 0;c&&c.call(b,a||d.deleteResults[0].error,f)},b)}}),A="https:"!==window.location.protocol?"http:":"https:",Q=e.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:A+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:A+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:G?"esri-labels":"tilePane"}},NationalGeographic:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:G?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:G?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community"}},ImageryLabels:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:G?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:G?"esri-labels":"tilePane"}},ShadedRelief:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:G?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:G?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:A+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}}}},initialize:function(a,c){var b;if("object"===typeof a&&a.urlTemplate&&a.options)b=a;else if("string"===typeof a&&Q.TILES[a])b=Q.TILES[a];else throw Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');var d=e.Util.extend(b.options,c);e.Util.setOptions(this,d);this.options.token&&(b.urlTemplate+="?token\x3d"+this.options.token);e.TileLayer.prototype.initialize.call(this,b.urlTemplate,d)},onAdd:function(a){"esri-labels"===this.options.pane&&this._initPane();this.options.attributionUrl&&D(this.options.attributionUrl,a);a.on("moveend",I);e.TileLayer.prototype.onAdd.call(this,a)},onRemove:function(a){a.off("moveend",I);e.TileLayer.prototype.onRemove.call(this,a)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var a=this._map.createPane(this.options.pane);a.style.pointerEvents="none";a.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var a='\x3cspan class\x3d"esri-dynamic-attribution"\x3e'+this.options.attribution+"\x3c/span\x3e";return a}}),U=e.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg\x3d\x3d"},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(a){a.url=v(a.url);a=e.Util.setOptions(this,a);this.tileUrl=a.url+"tile/{z}/{y}/{x}";this.service=T(a);this.service.addEventParent(this);(new RegExp(/tiles.arcgis(online)?\.com/g)).test(a.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),a.subdomains=["1","2","3","4"]);this.options.token&&(this.tileUrl+="?token\x3d"+this.options.token);e.TileLayer.prototype.initialize.call(this,this.tileUrl,a)},getTileUrl:function(a){var c=this._getZoomForUrl();return e.Util.template(this.tileUrl,e.Util.extend({s:this._getSubdomain(a),x:a.x,y:a.y,z:this._lodMap&&this._lodMap[c]?this._lodMap[c]:c},this.options))},createTile:function(a,c){var b=document.createElement("img");L.DomEvent.on(b,"load",L.bind(this._tileOnLoad,this,c,b));L.DomEvent.on(b,"error",L.bind(this._tileOnError,this,c,b));this.options.crossOrigin&&(b.crossOrigin="");b.alt="";if(!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()])b.src=this.getTileUrl(a);else this.once("lodmap",function(){b.src=this.getTileUrl(a)},this);return b},onAdd:function(a){this._lodMap||this.metadata(function(c,b){if(!c&&b.spatialReference){var d=b.spatialReference.latestWkid||b.spatialReference.wkid;!this.options.attribution&&a.attributionControl&&b.copyrightText&&(this.options.attribution=b.copyrightText,a.attributionControl.addAttribution(this.getAttribution()));if(a.options.crs===L.CRS.EPSG3857&&102100===d||3857===d){this._lodMap={};for(var d=b.tileInfo.lods,f=U.MercatorZoomLevels,g=0;g<d.length;g++){var l=d[g],h;for(h in f)if(this._withinPercentage(l.resolution,f[h],this.options.zoomOffsetAllowance)){this._lodMap[h]=l.level;break}}this.fire("lodmap")}else proj4||z("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")}},this);e.TileLayer.prototype.onAdd.call(this,a)},metadata:function(a,c){this.service.metadata(a,c);return this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(a){var c="?token\x3d"+a;this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,c):this.tileUrl+c;this.options.token=a;this.service.authenticate(a);return this},_withinPercentage:function(a,c,b){return Math.abs(a/c-1)<b}}),na=e.ImageOverlay.extend({onAdd:function(a){this._topLeft=a.getPixelBounds().min;e.ImageOverlay.prototype.onAdd.call(this,a)},_reset:function(){this._map.options.crs===e.CRS.EPSG3857?e.ImageOverlay.prototype._reset.call(this):e.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),F=e.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:F,attribution:null,interactive:!1,alt:""},onAdd:function(a){this._update=e.Util.throttle(this._update,this.options.updateInterval,this);a.on("moveend",this._update,this);this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?a.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null);this._update();this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this));this.metadata(function(c,b){!c&&!this.options.attribution&&a.attributionControl&&b.copyrightText&&(this.options.attribution=b.copyrightText,a.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(a){this._currentImage&&this._map.removeLayer(this._currentImage);this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this));this._map.off("moveend",this._update,this)},bindPopup:function(a,c){this._lastClick=this._shouldRenderPopup=!1;this._popup=e.popup(c);this._popupFunction=a;this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this));return this},unbindPopup:function(){this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this));this._popup=!1;return this},bringToFront:function(){this.options.position="front";this._currentImage&&this._currentImage.bringToFront();return this},bringToBack:function(){this.options.position="back";this._currentImage&&this._currentImage.bringToBack();return this},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(a){this.options.opacity=a;this._currentImage&&this._currentImage.setOpacity(a);return this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(a,c){this.options.from=a;this.options.to=c;this._update();return this},metadata:function(a,c){this.service.metadata(a,c);return this},authenticate:function(a){this.service.authenticate(a);return this},redraw:function(){this._update()},_renderImage:function(a,c,b){this._map&&(b&&(a="data:"+b+";base64,"+a),(new na(a,c,{opacity:0,crossOrigin:this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive})).addTo(this._map).once("load",function(a){if(this._map){a=a.target;var b=this._currentImage;a._bounds.equals(c)&&a._bounds.equals(this._map.getBounds())?(this._currentImage=a,"front"===this.options.position?this.bringToFront():this.bringToBack(),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),b&&this._map&&this._map.removeLayer(b),b&&b._map&&b._map.removeLayer(b)):this._map.removeLayer(a)}this.fire("load",{bounds:c})},this),this.fire("loading",{bounds:c}))},_update:function(){if(this._map){var a=this._map.getZoom(),c=this._map.getBounds();this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress||(a>this.options.maxZoom||a<this.options.minZoom?this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null):(a=this._buildExportParams(),this._requestExport(a,c)))}},_renderPopup:function(a,c,b,d){a=e.latLng(a);this._shouldRenderPopup&&this._lastClick.equals(a)&&(c=this._popupFunction(c,b,d))&&this._popup.setLatLng(a).setContent(c).openOn(this._map)},_resetPopupState:function(a){this._shouldRenderPopup=!1;this._lastClick=a.latlng}}),ja=F.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"json"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(a){a.url=v(a.url);this.service=fa(a);this.service.addEventParent(this);e.Util.setOptions(this,a)},setPixelType:function(a){this.options.pixelType=a;this._update();return this},getPixelType:function(){return this.options.pixelType},setBandIds:function(a){e.Util.isArray(a)?this.options.bandIds=a.join(","):this.options.bandIds=a.toString();this._update();return this},getBandIds:function(){return this.options.bandIds},setNoData:function(a,c){e.Util.isArray(a)?this.options.noData=a.join(","):this.options.noData=a.toString();c&&(this.options.noDataInterpretation=c);this._update();return this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(a){this.options.renderingRule=a;this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(a){this.options.mosaicRule=a;this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(a){var c=e.Util.bind(function(c,b,d){c||setTimeout(e.Util.bind(function(){this._renderPopup(a.latlng,c,b,d)},this),300)},this),b=this.identify().at(a.latlng);this.options.mosaicRule&&b.setMosaicRule(this.options.mosaicRule);b.run(c);this._shouldRenderPopup=!0;this._lastClick=a.latlng},_buildExportParams:function(){var a=this._map.getBounds(),c=this._map.getSize(),b=this._map.options.crs.project(a._northEast),d=this._map.options.crs.project(a._southWest),f=this._map.latLngToLayerPoint(a._northEast),a=this._map.latLngToLayerPoint(a._southWest);if(0<f.y||a.y<c.y)c.y=a.y-f.y;f=parseInt(this._map.options.crs.code.split(":")[1],10);c={bbox:[d.x,d.y,b.x,b.y].join(),size:c.x+","+c.y,format:this.options.format,transparent:this.options.transparent,bboxSR:f,imageSR:f};this.options.from&&this.options.to&&(c.time=this.options.from.valueOf()+","+this.options.to.valueOf());this.options.pixelType&&(c.pixelType=this.options.pixelType);this.options.interpolation&&(c.interpolation=this.options.interpolation);this.options.compressionQuality&&(c.compressionQuality=this.options.compressionQuality);this.options.bandIds&&(c.bandIds=this.options.bandIds);this.options.noData&&(c.noData=this.options.noData);this.options.noDataInterpretation&&(c.noDataInterpretation=this.options.noDataInterpretation);this.service.options.token&&(c.token=this.service.options.token);this.options.renderingRule&&(c.renderingRule=JSON.stringify(this.options.renderingRule));this.options.mosaicRule&&(c.mosaicRule=JSON.stringify(this.options.mosaicRule));return c},_requestExport:function(a,c){"json"===this.options.f?this.service.request("exportImage",a,function(a,b){a||(this.options.token&&(b.href+="?token\x3d"+this.options.token),this._renderImage(b.href,c))},this):(a.f="image",this._renderImage(this.options.url+"exportImage"+e.Util.getParamString(a),c))}}),ka=F.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png24",transparent:!0,f:"json"},initialize:function(a){a.url=v(a.url);this.service=T(a);this.service.addEventParent(this);(a.proxy||a.token)&&"json"!==a.f&&(a.f="json");e.Util.setOptions(this,a)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(a){this.options.dynamicLayers=a;this._update();return this},getLayers:function(){return this.options.layers},setLayers:function(a){this.options.layers=a;this._update();return this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(a){this.options.layerDefs=a;this._update();return this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(a){this.options.timeOptions=a;this._update();return this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(a){var c=e.Util.bind(function(c,b,d){c||setTimeout(e.Util.bind(function(){this._renderPopup(a.latlng,c,b,d)},this),300)},this),b=this.identify().on(this._map).at(a.latlng);b.simplify(this._map,.5);this.options.layers?b.layers("visible:"+this.options.layers.join(",")):b.layers("visible");b.run(c);this._shouldRenderPopup=!0;this._lastClick=a.latlng},_buildExportParams:function(){var a=this._map.getBounds(),c=this._map.getSize(),b=this._map.options.crs.project(a.getNorthEast()),d=this._map.options.crs.project(a.getSouthWest()),f=parseInt(this._map.options.crs.code.split(":")[1],10),g=this._map.latLngToLayerPoint(a._northEast),a=this._map.latLngToLayerPoint(a._southWest);if(0<g.y||a.y<c.y)c.y=a.y-g.y;c={bbox:[d.x,d.y,b.x,b.y].join(),size:c.x+","+c.y,dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:f,imageSR:f};this.options.dynamicLayers&&(c.dynamicLayers=this.options.dynamicLayers);this.options.layers&&(c.layers="show:"+this.options.layers.join(","));this.options.layerDefs&&(c.layerDefs="string"===typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs));this.options.timeOptions&&(c.timeOptions=JSON.stringify(this.options.timeOptions));this.options.from&&this.options.to&&(c.time=this.options.from.valueOf()+","+this.options.to.valueOf());this.service.options.token&&(c.token=this.service.options.token);this.options.proxy&&(c.proxy=this.options.proxy);return c},_requestExport:function(a,c){"json"===this.options.f?this.service.request("export",a,function(a,b){a||(this.options.token&&(b.href+="?token\x3d"+this.options.token),this.options.proxy&&(b.href=this.options.proxy+"?"+b.href),b.href?this._renderImage(b.href,c):this._renderImage(b.imageData,c,b.contentType))},this):(a.f="image",this._renderImage(this.options.url+"export"+e.Util.getParamString(a),c))}}),R=C.Layer.extend({options:{cellSize:512,updateInterval:150},initialize:function(a){C.setOptions(this,a);this._zooming=!1},onAdd:function(a){this._map=a;this._update=C.Util.throttle(this._update,this.options.updateInterval,this);this._reset();this._update()},onRemove:function(){this._map.removeEventListener(this.getEvents(),this);this._removeCells()},getEvents:function(){return{moveend:this._update,zoomstart:this._zoomstart,zoomend:this._reset}},addTo:function(a){a.addLayer(this);return this},removeFrom:function(a){a.removeLayer(this);return this},_zoomstart:function(){this._zooming=!0},_reset:function(){this._removeCells();this._cells={};this._activeCells={};this._cellsTotal=this._cellsToLoad=0;this._cellNumBounds=this._getCellNumBounds();this._resetWrap();this._zooming=!1},_resetWrap:function(){var a=this._map,c=a.options.crs;if(!c.infinite){var b=this._getCellSize();c.wrapLng&&(this._wrapLng=[Math.floor(a.project([0,c.wrapLng[0]]).x/b),Math.ceil(a.project([0,c.wrapLng[1]]).x/b)]);c.wrapLat&&(this._wrapLat=[Math.floor(a.project([c.wrapLat[0],0]).y/b),Math.ceil(a.project([c.wrapLat[1],0]).y/b)])}},_getCellSize:function(){return this.options.cellSize},_update:function(){if(this._map){var a=this._map.getPixelBounds(),c=this._getCellSize(),a=C.bounds(a.min.divideBy(c).floor(),a.max.divideBy(c).floor());this._removeOtherCells(a);this._addCells(a);this.fire("cellsupdated")}},_addCells:function(a){var c=[],b=a.getCenter(),d=this._map.getZoom(),f,g,l;for(f=a.min.y;f<=a.max.y;f++)for(g=a.min.x;g<=a.max.x;g++)l=C.point(g,f),l.z=d,this._isValidCell(l)&&c.push(l);a=c.length;if(0!==a)for(this._cellsToLoad+=a,this._cellsTotal+=a,c.sort(function(a,c){return a.distanceTo(b)-c.distanceTo(b)}),g=0;g<a;g++)this._addCell(c[g])},_isValidCell:function(a){var c=this._map.options.crs;if(!c.infinite){var b=this._cellNumBounds;if(!c.wrapLng&&(a.x<b.min.x||a.x>b.max.x)||!c.wrapLat&&(a.y<b.min.y||a.y>b.max.y))return!1}if(!this.options.bounds)return!0;a=this._cellCoordsToBounds(a);return C.latLngBounds(this.options.bounds).intersects(a)},_cellCoordsToBounds:function(a){var c=this._map,b=this.options.cellSize,d=a.multiplyBy(b),b=d.add([b,b]),d=c.wrapLatLng(c.unproject(d,a.z));a=c.wrapLatLng(c.unproject(b,a.z));return C.latLngBounds(d,a)},_cellCoordsToKey:function(a){return a.x+":"+a.y},_keyToCellCoords:function(a){var c=a.split(":");a=parseInt(c[0],10);c=parseInt(c[1],10);return C.point(a,c)},_removeOtherCells:function(a){for(var c in this._cells)a.contains(this._keyToCellCoords(c))||this._removeCell(c)},_removeCell:function(a){var c=this._activeCells[a];c&&(delete this._activeCells[a],this.cellLeave&&this.cellLeave(c.bounds,c.coords),this.fire("cellleave",{bounds:c.bounds,coords:c.coords}))},_removeCells:function(){for(var a in this._cells){var c=this._cells[a].bounds,b=this._cells[a].coords;this.cellLeave&&this.cellLeave(c,b);this.fire("cellleave",{bounds:c,coords:b})}},_addCell:function(a){this._wrapCoords(a);var c=this._cellCoordsToKey(a),b=this._cells[c];b&&!this._activeCells[c]&&(this.cellEnter&&this.cellEnter(b.bounds,a),this.fire("cellenter",{bounds:b.bounds,coords:a}),this._activeCells[c]=b);b||(b={coords:a,bounds:this._cellCoordsToBounds(a)},this._cells[c]=b,this._activeCells[c]=b,this.createCell&&this.createCell(b.bounds,a),this.fire("cellcreate",{bounds:b.bounds,coords:a}))},_wrapCoords:function(a){a.x=this._wrapLng?C.Util.wrapNum(a.x,this._wrapLng):a.x;a.y=this._wrapLat?C.Util.wrapNum(a.y,this._wrapLat):a.y},_getCellNumBounds:function(){var a=this._map.getPixelWorldBounds(),c=this._getCellSize();return a?C.bounds(a.min.divideBy(c).floor(),a.max.divideBy(c).ceil().subtract([1,1])):null}});E.prototype.query=function(a){a=this.getIndex(a);return this.values[a]};E.prototype.getIndex=function(a){this.dirty&&this.sort();for(var c=0,b=this.values.length-1,d,f;c<=b;)if(d=(c+b)/2|0,f=this.values[Math.round(d)],+f.value<+a)c=d+1;else if(+f.value>+a)b=d-1;else return d;return Math.abs(~b)};E.prototype.between=function(a,c){var b=this.getIndex(a),d=this.getIndex(c);if(0===b&&0===d)return[];for(;this.values[b-1]&&this.values[b-1].value===a;)b--;for(;this.values[d+1]&&this.values[d+1].value===c;)d++;this.values[d]&&this.values[d].value===c&&this.values[d+1]&&d++;return this.values.slice(b,d)};E.prototype.insert=function(a){this.values.splice(this.getIndex(a.value),0,a);return this};E.prototype.bulkAdd=function(a,c){this.values=this.values.concat([].concat(a||[]));c?this.sort():this.dirty=!0;return this};E.prototype.sort=function(){this.values.sort(function(a,c){return+c.value-+a.value}).reverse();this.dirty=!1;return this};var S=R.extend({options:{attribution:null,where:"1\x3d1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6},initialize:function(a){R.prototype.initialize.call(this,a);a.url=v(a.url);a=e.setOptions(this,a);this.service=ha(a);this.service.addEventParent(this);if("*"!==this.options.fields[0]){a=!1;for(var c=0;c<this.options.fields.length;c++)this.options.fields[c].match(/^(OBJECTID|FID|OID|ID)$/i)&&(a=!0);!1===a&&z("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new E,this._endTimeIndex=new E):this.options.timeField&&(this._timeIndex=new E);this._cache={};this._currentSnapshot=[];this._activeRequests=0},onAdd:function(a){this.service.metadata(function(c,b){if(!c){var d=b.supportedQueryFormats,f=!1;!1===this.service.options.isModern&&(f=!0);!f&&d&&-1!==d.indexOf("geoJSON")&&(this.service.options.isModern=!0);!this.options.attribution&&a.attributionControl&&b.copyrightText&&(this.options.attribution=b.copyrightText,a.attributionControl.addAttribution(this.getAttribution()))}},this);a.on("zoomend",this._handleZoomChange,this);return R.prototype.onAdd.call(this,a)},onRemove:function(a){a.off("zoomend",this._handleZoomChange,this);return R.prototype.onRemove.call(this,a)},getAttribution:function(){return this.options.attribution},createCell:function(a,c){this._visibleZoom()&&this._requestFeatures(a,c)},_requestFeatures:function(a,c,b){this._activeRequests++;1===this._activeRequests&&this.fire("loading",{bounds:a},!0);return this._buildQuery(a).run(function(d,f,g){g&&g.exceededTransferLimit&&this.fire("drawlimitexceeded");!d&&f&&f.features.length&&e.Util.requestAnimFrame(e.Util.bind(function(){this._addFeatures(f.features,c);this._postProcessFeatures(a)},this));d||!f||f.features.length||this._postProcessFeatures(a);d&&this._postProcessFeatures(a);b&&b.call(this,d,f)},this)},_postProcessFeatures:function(a){this._activeRequests--;0>=this._activeRequests&&this.fire("load",{bounds:a})},_cacheKey:function(a){return a.z+":"+a.x+":"+a.y},_addFeatures:function(a,c){var b=this._cacheKey(c);this._cache[b]=this._cache[b]||[];for(var d=a.length-1;0<=d;d--){var f=a[d].id;-1===this._currentSnapshot.indexOf(f)&&this._currentSnapshot.push(f);-1===this._cache[b].indexOf(f)&&this._cache[b].push(f)}this.options.timeField&&this._buildTimeIndexes(a);this.createLayers(a)},_buildQuery:function(a){a=this.service.query().intersects(a).where(this.options.where).fields(this.options.fields).precision(this.options.precision);this.options.simplifyFactor&&a.simplify(this._map,this.options.simplifyFactor);"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&a.between(this.options.from,this.options.to);return a},setWhere:function(a,c,b){this.options.where=a&&a.length?a:"1\x3d1";var d=[],f=[],g=0,l=null;a=e.Util.bind(function(a,h){a&&(l=a);if(h)for(var m=h.features.length-1;0<=m;m--)f.push(h.features[m].id);g--;0>=g&&(this._currentSnapshot=f,e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(d);this.addLayers(f);c&&c.call(b,l)},this)))},this);for(var h=this._currentSnapshot.length-1;0<=h;h--)d.push(this._currentSnapshot[h]);for(var m in this._activeCells)g++,h=this._keyToCellCoords(m),h=this._cellCoordsToBounds(h),this._requestFeatures(h,m,a);return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(a,c,b,d){var f=this.options.from,g=this.options.to,l=0,h=null,m=e.Util.bind(function(e){e&&(h=e);this._filterExistingFeatures(f,g,a,c);l--;b&&0>=l&&b.call(d,h)},this);this.options.from=a;this.options.to=c;this._filterExistingFeatures(f,g,a,c);if("server"===this.options.timeFilterMode)for(var k in this._activeCells){l++;var y=this._keyToCellCoords(k),y=this._cellCoordsToBounds(y);this._requestFeatures(y,k,m)}return this},refresh:function(){for(var a in this._activeCells){var c=this._keyToCellCoords(a),c=this._cellCoordsToBounds(c);this._requestFeatures(c,a)}if(this.redraw)this.once("load",function(){this.eachFeature(function(a){this._redraw(a.feature.id)},this)},this)},_filterExistingFeatures:function(a,c,b,d){var f=a&&c?this._getFeaturesInTimeRange(a,c):this._currentSnapshot,g=this._getFeaturesInTimeRange(b,d);if(g.indexOf)for(a=0;a<g.length;a++)c=f.indexOf(g[a]),0<=c&&f.splice(c,1);e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(f);this.addLayers(g)},this))},_getFeaturesInTimeRange:function(a,c){var b=[],d;if(this.options.timeField.start&&this.options.timeField.end){d=this._startTimeIndex.between(a,c);var f=this._endTimeIndex.between(a,c);d=d.concat(f)}else d=this._timeIndex.between(a,c);for(f=d.length-1;0<=f;f--)b.push(d[f].id);return b},_buildTimeIndexes:function(a){var c,b;if(this.options.timeField.start&&this.options.timeField.end){var d=[],f=[];for(c=a.length-1;0<=c;c--)b=a[c],d.push({id:b.id,value:new Date(b.properties[this.options.timeField.start])}),f.push({id:b.id,value:new Date(b.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(d);this._endTimeIndex.bulkAdd(f)}else{d=[];for(c=a.length-1;0<=c;c--)b=a[c],d.push({id:b.id,value:new Date(b.properties[this.options.timeField])});this._timeIndex.bulkAdd(d)}},_featureWithinTimeRange:function(a){if(!this.options.from||!this.options.to)return!0;var c=+this.options.from.valueOf(),b=+this.options.to.valueOf();if("string"===typeof this.options.timeField){var d=+a.properties[this.options.timeField];return d>=c&&d<=b}if(this.options.timeField.start&&this.options.timeField.end)return d=+a.properties[this.options.timeField.start],a=+a.properties[this.options.timeField.end],d>=c&&d<=b||a>=c&&a<=b},_visibleZoom:function(){if(!this._map)return!1;var a=this._map.getZoom();return a>this.options.maxZoom||a<this.options.minZoom?!1:!0},_handleZoomChange:function(){if(this._visibleZoom())for(var a in this._activeCells){var c=this._cacheKey(this._activeCells[a].coords);this._cache[c]&&this.addLayers(this._cache[c])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(a){this.service.authenticate(a);return this},metadata:function(a,c){this.service.metadata(a,c);return this},query:function(){return this.service.query()},_getMetadata:function(a){this._metadata?a(void 0,this._metadata):this.metadata(e.Util.bind(function(c,b){this._metadata=b;a(c,this._metadata)},this))},addFeature:function(a,c,b){this._getMetadata(e.Util.bind(function(d,f){d?c&&c.call(this,d,null):this.service.addFeature(a,e.Util.bind(function(d,g){d||(a.properties[f.objectIdField]=g.objectId,a.id=g.objectId,this.createLayers([a]));c&&c.call(b,d,g)},this))},this))},updateFeature:function(a,c,b){this.service.updateFeature(a,function(d,f){d||(this.removeLayers([a.id],!0),this.createLayers([a]));c&&c.call(b,d,f)},this)},deleteFeature:function(a,c,b){this.service.deleteFeature(a,function(a,d){!a&&d.objectId&&this.removeLayers([d.objectId],!0);c&&c.call(b,a,d)},this)},deleteFeatures:function(a,c,b){return this.service.deleteFeatures(a,function(a,d){if(!a&&0<d.length)for(var f=0;f<d.length;f++)this.removeLayers([d[f].objectId],!0);c&&c.call(b,a,d)},this)}}),la=S.extend({options:{cacheLayers:!0},initialize:function(a){S.prototype.initialize.call(this,a);this._originalStyle=this.options.style;this._layers={}},onRemove:function(a){for(var c in this._layers)a.removeLayer(this._layers[c]),this.fire("removefeature",{feature:this._layers[c].feature,permanent:!1},!0);return S.prototype.onRemove.call(this,a)},createNewLayer:function(a){a=e.GeoJSON.geometryToLayer(a,this.options);a.defaultOptions=a.options;return a},_updateLayer:function(a,c){var b=[],b=this.options.coordsToLatLng||e.GeoJSON.coordsToLatLng;c.properties&&(a.feature.properties=c.properties);switch(c.geometry.type){case "Point":b=e.GeoJSON.coordsToLatLng(c.geometry.coordinates);a.setLatLng(b);break;case "LineString":b=e.GeoJSON.coordsToLatLngs(c.geometry.coordinates,0,b);a.setLatLngs(b);break;case "MultiLineString":b=e.GeoJSON.coordsToLatLngs(c.geometry.coordinates,1,b);a.setLatLngs(b);break;case "Polygon":b=e.GeoJSON.coordsToLatLngs(c.geometry.coordinates,1,b);a.setLatLngs(b);break;case "MultiPolygon":b=e.GeoJSON.coordsToLatLngs(c.geometry.coordinates,2,b),a.setLatLngs(b)}},createLayers:function(a){for(var c=a.length-1;0<=c;c--){var b=a[c],d=this._layers[b.id];this._visibleZoom()&&d&&!this._map.hasLayer(d)&&(this._map.addLayer(d),this.fire("addfeature",{feature:d.feature},!0));d&&0<this.options.simplifyFactor&&(d.setLatLngs||d.setLatLng)&&this._updateLayer(d,b);if(!d){d=this.createNewLayer(b);d.feature=b;d.addEventParent(this);if(this.options.onEachFeature)this.options.onEachFeature(d.feature,d);this._layers[d.feature.id]=d;this.setFeatureStyle(d.feature.id,this.options.style);this.fire("createfeature",{feature:d.feature},!0);this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(b))&&this._map.addLayer(d)}}},addLayers:function(a){for(var c=a.length-1;0<=c;c--){var b=this._layers[a[c]];b&&this._map.addLayer(b)}},removeLayers:function(a,c){for(var b=a.length-1;0<=b;b--){var d=a[b],f=this._layers[d];f&&(this.fire("removefeature",{feature:f.feature,permanent:c},!0),this._map.removeLayer(f));f&&c&&delete this._layers[d]}},cellEnter:function(a,c){this._visibleZoom()&&!this._zooming&&this._map&&e.Util.requestAnimFrame(e.Util.bind(function(){var a=this._cacheKey(c),b=this._cellCoordsToKey(c),a=this._cache[a];this._activeCells[b]&&a&&this.addLayers(a)},this))},cellLeave:function(a,c){this._zooming||e.Util.requestAnimFrame(e.Util.bind(function(){if(this._map){var a=this._cacheKey(c),b=this._cellCoordsToKey(c),d=this._cache[a],f=this._map.getBounds();if(!this._activeCells[b]&&d){for(var g=!0,l=0;l<d.length;l++){var h=this._layers[d[l]];h&&h.getBounds&&f.intersects(h.getBounds())&&(g=!1)}g&&this.removeLayers(d,!this.options.cacheLayers);!this.options.cacheLayers&&g&&(delete this._cache[a],delete this._cells[b],delete this._activeCells[b])}}},this))},resetStyle:function(){this.options.style=this._originalStyle;this.eachFeature(function(a){this.resetFeatureStyle(a.feature.id)},this);return this},setStyle:function(a){this.options.style=a;this.eachFeature(function(c){this.setFeatureStyle(c.feature.id,a)},this);return this},resetFeatureStyle:function(a){var c=this._layers[a],b=this._originalStyle||L.Path.prototype.options;c&&(e.Util.extend(c.options,c.defaultOptions),this.setFeatureStyle(a,b));return this},setFeatureStyle:function(a,c){var b=this._layers[a];"function"===typeof c&&(c=c(b.feature));b.setStyle&&b.setStyle(c);return this},eachActiveFeature:function(a,c){if(this._map){var b=this._map.getBounds(),d;for(d in this._layers)b.intersects(this._layers[d].getBounds())&&-1!==this._currentSnapshot.indexOf(this._layers[d].feature.id)&&a.call(c,this._layers[d])}return this},eachFeature:function(a,c){for(var b in this._layers)a.call(c,this._layers[b]);return this},getFeature:function(a){return this._layers[a]},bringToBack:function(){this.eachFeature(function(a){a.bringToBack&&a.bringToBack()})},bringToFront:function(){this.eachFeature(function(a){a.bringToFront&&a.bringToFront()})},redraw:function(a){a&&this._redraw(a);return this},_redraw:function(a){a=this._layers[a];var c=a.feature;if(a&&a.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var b=this.options.pointToLayer(c,e.latLng(c.geometry.coordinates[1],c.geometry.coordinates[0])).options.icon;a.setIcon(b)}a&&a.setStyle&&this.options.pointToLayer&&(b=this.options.pointToLayer(c,e.latLng(c.geometry.coordinates[1],c.geometry.coordinates[0])).options,this.setFeatureStyle(c.id,b));a&&a.setStyle&&this.options.style&&this.resetStyle(c.id)}});n.VERSION="2.0.8";n.Support=H;n.options=X;n.Util=ma;n.get=N;n.post=c;n.request=a;n.Task=J;n.task=function(a){return new J(a)};n.Query=Y;n.query=M;n.Find=Z;n.find=V;n.Identify=P;n.identify=function(a){return new P(a)};n.IdentifyFeatures=ba;n.identifyFeatures=aa;n.IdentifyImage=da;n.identifyImage=ca;n.Service=K;n.service=function(a){return new K(a)};n.MapService=ea;n.mapService=T;n.ImageService=ga;n.imageService=fa;n.FeatureLayerService=ia;n.featureLayerService=ha;n.BasemapLayer=Q;n.basemapLayer=function(a,c){return new Q(a,c)};n.TiledMapLayer=U;n.tiledMapLayer=function(a,c){return new U(a,c)};n.RasterLayer=F;n.ImageMapLayer=ja;n.imageMapLayer=function(a,c){return new ja(a,c)};n.DynamicMapLayer=ka;n.dynamicMapLayer=function(a,c){return new ka(a,c)};n.FeatureManager=S;n.FeatureLayer=la;n.featureLayer=function(a){return new la(a)}});(function(n){"object"===typeof exports&&"undefined"!==typeof module?module.exports=n():"function"===typeof define&&define.amd?define([],n):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).proj4=n()})(function(){return function e(k,b,c){function h(d,g){if(!b[d]){if(!k[d]){var l="function"==typeof require&&require;if(!g&&l)return l(d,!0);if(a)return a(d,!0);l=Error("Cannot find module '"+d+"'");throw l.code="MODULE_NOT_FOUND",l;}l=b[d]={exports:{}};k[d][0].call(l.exports,function(a){var c=k[d][1][a];return h(c?c:a)},l,l.exports,e,k,b,c)}return b[d].exports}for(var a="function"==typeof require&&require,d=0;d<c.length;d++)h(c[d]);return h}({"./includedProjections":[function(e,k,b){var c=[e("./lib/projections/tmerc"),e("./lib/projections/utm"),e("./lib/projections/sterea"),e("./lib/projections/stere"),e("./lib/projections/somerc"),e("./lib/projections/omerc"),e("./lib/projections/lcc"),e("./lib/projections/krovak"),e("./lib/projections/cass"),e("./lib/projections/laea"),e("./lib/projections/aea"),e("./lib/projections/gnom"),e("./lib/projections/cea"),e("./lib/projections/eqc"),e("./lib/projections/poly"),e("./lib/projections/nzmg"),e("./lib/projections/mill"),e("./lib/projections/sinu"),e("./lib/projections/moll"),e("./lib/projections/eqdc"),e("./lib/projections/vandg"),e("./lib/projections/aeqd"),e("./lib/projections/ortho")];k.exports=function(b){c.forEach(function(a){b.Proj.projections.add(a)})}},{"./lib/projections/aea":42,"./lib/projections/aeqd":43,"./lib/projections/cass":44,"./lib/projections/cea":45,"./lib/projections/eqc":46,"./lib/projections/eqdc":47,"./lib/projections/gnom":49,"./lib/projections/krovak":50,"./lib/projections/laea":51,"./lib/projections/lcc":52,"./lib/projections/mill":55,"./lib/projections/moll":56,"./lib/projections/nzmg":57,"./lib/projections/omerc":58,"./lib/projections/ortho":59,"./lib/projections/poly":60,"./lib/projections/sinu":61,"./lib/projections/somerc":62,"./lib/projections/stere":63,"./lib/projections/sterea":64,"./lib/projections/tmerc":65,"./lib/projections/utm":66,"./lib/projections/vandg":67}],"./lib/version":[function(e,k,b){k.exports="2.3.17"},{}],1:[function(e,k,b){function c(a,b,f){if(!(this instanceof c))return new c(a,b,f);Array.isArray(a)?(this.x=a[0],this.y=a[1],this.z=a[2]||0):"object"===typeof a?(this.x=a.x,this.y=a.y,this.z=a.z||0):"string"===typeof a&&"undefined"===typeof b?(a=a.split(","),this.x=parseFloat(a[0],10),this.y=parseFloat(a[1],10),this.z=parseFloat(a[2],10)||0):(this.x=a,this.y=b,this.z=f||0);console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var h=e("mgrs");c.fromMGRS=function(a){return new c(h.toPoint(a))};c.prototype.toMGRS=function(a){return h.forward([this.x,this.y],a)};k.exports=c},{mgrs:70}],2:[function(e,k,b){function c(b,e){if(!(this instanceof c))return new c(b);e=e||function(a){if(a)throw a;};var m=h(b);if("object"!==typeof m)e(b);else{var k=c.projections.get(m.projName);if(k){if(m.datumCode&&"none"!==m.datumCode){var p=f[m.datumCode];p&&(m.datum_params=p.towgs84?p.towgs84.split(","):null,m.ellps=p.ellipse,m.datumName=p.datumName?p.datumName:m.datumCode)}m.k0=m.k0||1;m.axis=m.axis||"enu";var p=d.sphere(m.a,m.b,m.rf,m.ellps,m.sphere),q=d.eccentricity(p.a,p.b,p.rf,m.R_A),r=m.datum||g(m.datumCode,m.datum_params,p.a,p.b,q.es,q.ep2);a(this,m);a(this,k);this.a=p.a;this.b=p.b;this.rf=p.rf;this.sphere=p.sphere;this.es=q.es;this.e=q.e;this.ep2=q.ep2;this.datum=r;this.init();e(null,this)}else e(b)}}var h=e("./parseCode"),a=e("./extend");b=e("./projections");var d=e("./deriveConstants"),f=e("./constants/Datum"),g=e("./datum");c.projections=b;c.projections.start();k.exports=c},{"./constants/Datum":26,"./datum":31,"./deriveConstants":35,"./extend":36,"./parseCode":39,"./projections":41}],3:[function(e,k,b){k.exports=function(c,b,a){var d=a.x,f=a.y,g=a.z||0,l,e,m,k={};for(m=0;3>m;m++)if(!b||2!==m||void 0!==a.z)switch(0===m?(l=d,e="x"):1===m?(l=f,e="y"):(l=g,e="z"),c.axis[m]){case "e":k[e]=l;break;case "w":k[e]=-l;break;case "n":k[e]=l;break;case "s":k[e]=-l;break;case "u":void 0!==a[e]&&(k.z=l);break;case "d":void 0!==a[e]&&(k.z=-l);break;default:return null}return k}},{}],4:[function(e,k,b){var c=Math.PI/2,h=e("./sign");k.exports=function(a){return Math.abs(a)<c?a:a-h(a)*Math.PI}},{"./sign":22}],5:[function(e,k,b){var c=2*Math.PI,h=e("./sign");k.exports=function(a){return 3.14159265359>=Math.abs(a)?a:a-h(a)*c}},{"./sign":22}],6:[function(e,k,b){var c=e("./adjust_lon");k.exports=function(b,a){if(void 0===b)return b=Math.floor(30*(c(a)+Math.PI)/Math.PI),0>b?0:60<=b?59:b;if(0<b&&60>=b)return b-1}},{"./adjust_lon":5}],7:[function(e,k,b){k.exports=function(c){1<Math.abs(c)&&(c=1<c?1:-1);return Math.asin(c)}},{}],8:[function(e,k,b){k.exports=function(c){return 1-.25*c*(1+c/16*(3+1.25*c))}},{}],9:[function(e,k,b){k.exports=function(c){return.375*c*(1+.25*c*(1+.46875*c))}},{}],10:[function(e,k,b){k.exports=function(c){return.05859375*c*c*(1+.75*c)}},{}],11:[function(e,k,b){k.exports=function(c){return 35/3072*c*c*c}},{}],12:[function(e,k,b){k.exports=function(c,b,a){b*=a;return c/Math.sqrt(1-b*b)}},{}],13:[function(e,k,b){k.exports=function(c,b,a,d,f){var g,l;g=c/b;for(var e=0;15>e;e++)if(l=(c-(b*g-a*Math.sin(2*g)+d*Math.sin(4*g)-f*Math.sin(6*g)))/(b-2*a*Math.cos(2*g)+4*d*Math.cos(4*g)-6*f*Math.cos(6*g)),g+=l,1E-10>=Math.abs(l))return g;return NaN}},{}],14:[function(e,k,b){var c=Math.PI/2;k.exports=function(b,a){if(1E-6>Math.abs(Math.abs(a)-(1-(1-b*b)/(2*b)*Math.log((1-b)/(1+b)))))return 0>a?-1*c:c;for(var d=Math.asin(.5*a),f,g,l,e=0;30>e;e++)if(f=Math.sin(d),g=Math.cos(d),l=b*f,f=Math.pow(1-l*l,2)/(2*g)*(a/(1-b*b)-f/(1-l*l)+.5/b*Math.log((1-l)/(1+l))),d+=f,1E-10>=Math.abs(f))return d;return NaN}},{}],15:[function(e,k,b){k.exports=function(c,b,a,d,f){return c*f-b*Math.sin(2*f)+a*Math.sin(4*f)-d*Math.sin(6*f)}},{}],16:[function(e,k,b){k.exports=function(c,b,a){c*=b;return a/Math.sqrt(1-c*c)}},{}],17:[function(e,k,b){var c=Math.PI/2;k.exports=function(b,a){for(var d=.5*b,f,g=c-2*Math.atan(a),l=0;15>=l;l++)if(f=b*Math.sin(g),f=c-2*Math.atan(a*Math.pow((1-f)/(1+f),d))-g,g+=f,1E-10>=Math.abs(f))return g;return-9999}},{}],18:[function(e,k,b){k.exports=function(c){var b=[];b[0]=1-c*(.25+c*(.046875+c*(.01953125+.01068115234375*c)));b[1]=c*(.75-c*(.046875+c*(.01953125+.01068115234375*c)));var a=c*c;b[2]=a*(.46875-c*(.013020833333333334+.007120768229166667*c));a*=c;b[3]=a*(.3645833333333333-.005696614583333333*c);b[4]=a*c*.3076171875;return b}},{}],19:[function(e,k,b){var c=e("./pj_mlfn");k.exports=function(b,a,d){for(var f=1/(1-a),g=b,l=20;l;--l){var e=Math.sin(g),m=1-a*e*e,m=(c(g,e,Math.cos(g),d)-b)*m*Math.sqrt(m)*f,g=g-m;if(1E-10>Math.abs(m))break}return g}},{"./pj_mlfn":20}],20:[function(e,k,b){k.exports=function(c,b,a,d){a*=b;b*=b;return d[0]*c-a*(d[1]+b*(d[2]+b*(d[3]+b*d[4])))}},{}],21:[function(e,k,b){k.exports=function(c,b){var a;return 1E-7<c?(a=c*b,(1-c*c)*(b/(1-a*a)-.5/c*Math.log((1-a)/(1+a)))):2*b}},{}],22:[function(e,k,b){k.exports=function(c){return 0>c?-1:1}},{}],23:[function(e,k,b){k.exports=function(c,b){return Math.pow((1-c)/(1+c),b)}},{}],24:[function(e,k,b){k.exports=function(c){var b={x:c[0],y:c[1]};2<c.length&&(b.z=c[2]);3<c.length&&(b.m=c[3]);return b}},{}],25:[function(e,k,b){var c=Math.PI/2;k.exports=function(b,a,d){d*=b;d=Math.pow((1-d)/(1+d),.5*b);return Math.tan(.5*(c-a))/d}},{}],26:[function(e,k,b){b.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};b.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};b.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};b.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};b.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};b.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};b.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};b.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"};b.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};b.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};b.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};b.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};b.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};b.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};b.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};b.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],27:[function(e,k,b){b.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};b.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};b.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};b.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};b.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"};b.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};b.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};b.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"};b.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};b.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl \x26 S. Amer. 1969"};b.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};b.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"};b.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};b.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"};b.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."};b.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"};b.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};b.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};b.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"};b.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"};b.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"};b.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"};b.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"};b.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah \x26 Sarawak)"};b.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};b.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};b.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};b.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};b.hough={a:6378270,rf:297,ellipseName:"Hough"};b.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};b.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};b.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};b.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};b.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"};b.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};b.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};b.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"};b.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"};b.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};b.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};b.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};b.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};b.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r\x3d6370997)"}},{}],28:[function(e,k,b){b.greenwich=0;b.lisbon=-9.131906111111;b.paris=2.337229166667;b.bogota=-74.080916666667;b.madrid=-3.687938888889;b.rome=12.452333333333;b.bern=7.439583333333;b.jakarta=106.807719444444;b.ferro=-17.666666666667;b.brussels=4.367975;b.stockholm=18.058277777778;b.athens=23.7163375;b.oslo=10.722916666667},{}],29:[function(e,k,b){b.ft={to_meter:.3048};b["us-ft"]={to_meter:1200/3937}},{}],30:[function(e,k,b){function c(a,c,b){return Array.isArray(b)?(a=d(a,c,b),3===b.length?[a.x,a.y,a.z]:[a.x,a.y]):d(a,c,b)}function h(c){return c instanceof a?c:c.oProj?c.oProj:a(c)}var a=e("./Proj"),d=e("./transform"),f=a("WGS84");k.exports=function(a,b,d){a=h(a);var e=!1;if("undefined"===typeof b)b=a,a=f,e=!0;else if("undefined"!==typeof b.x||Array.isArray(b))d=b,b=a,a=f,e=!0;b=h(b);if(d)return c(a,b,d);d={forward:function(d){return c(a,b,d)},inverse:function(d){return c(b,a,d)}};e&&(d.oProj=b);return d}},{"./Proj":2,"./transform":68}],31:[function(e,k,b){k.exports=function(c,b,a,d,f,g){var l={datum_type:4};c&&"none"===c&&(l.datum_type=5);if(b){l.datum_params=b.map(parseFloat);if(0!==l.datum_params[0]||0!==l.datum_params[1]||0!==l.datum_params[2])l.datum_type=1;3<l.datum_params.length&&(0!==l.datum_params[3]||0!==l.datum_params[4]||0!==l.datum_params[5]||0!==l.datum_params[6])&&(l.datum_type=2,l.datum_params[3]*=4.84813681109536E-6,l.datum_params[4]*=4.84813681109536E-6,l.datum_params[5]*=4.84813681109536E-6,l.datum_params[6]=l.datum_params[6]/1E6+1)}l.a=a;l.b=d;l.es=f;l.ep2=g;return l}},{}],32:[function(e,k,b){var c=Math.PI/2;b.compareDatums=function(c,a){return c.datum_type!==a.datum_type?!1:c.a!==a.a||5E-11<Math.abs(this.es-a.es)?!1:1===c.datum_type?this.datum_params[0]===a.datum_params[0]&&c.datum_params[1]===a.datum_params[1]&&c.datum_params[2]===a.datum_params[2]:2===c.datum_type?c.datum_params[0]===a.datum_params[0]&&c.datum_params[1]===a.datum_params[1]&&c.datum_params[2]===a.datum_params[2]&&c.datum_params[3]===a.datum_params[3]&&c.datum_params[4]===a.datum_params[4]&&c.datum_params[5]===a.datum_params[5]&&c.datum_params[6]===a.datum_params[6]:!0};b.geodeticToGeocentric=function(b,a,d){var f=b.x,g=b.y;b=b.z?b.z:0;var l;if(g<-c&&g>-1.001*c)g=-c;else if(g>c&&g<1.001*c)g=c;else if(g<-c||g>c)return null;f>Math.PI&&(f-=2*Math.PI);l=Math.sin(g);g=Math.cos(g);d/=Math.sqrt(1-a*l*l);return{x:(d+b)*g*Math.cos(f),y:(d+b)*g*Math.sin(f),z:(d*(1-a)+b)*l}};b.geocentricToGeodetic=function(c,a,b,f){var g,l,e,m,k,p,q,r=c.x;m=c.y;var t=c.z?c.z:0,v;f=Math.sqrt(r*r+m*m);g=Math.sqrt(r*r+m*m+t*t);if(1E-12>f/b){if(r=0,1E-12>g/b)return{x:c.x,y:c.y,z:c.z}}else r=Math.atan2(m,r);c=t/g;g=f/g;l=1/Math.sqrt(1-a*(2-a)*g*g);m=g*(1-a)*l;k=c*l;q=0;do q++,e=b/Math.sqrt(1-a*k*k),v=f*m+t*k-e*(1-a*k*k),e=a*e/(e+v),l=1/Math.sqrt(1-e*(2-e)*g*g),e=g*(1-e)*l,l*=c,p=l*m-e*k,m=e,k=l;while(1E-24<p*p&&30>q);return{x:r,y:Math.atan(l/Math.abs(e)),z:v}};b.geocentricToWgs84=function(c,a,b){if(1===a)return{x:c.x+b[0],y:c.y+b[1],z:c.z+b[2]};if(2===a){a=b[3];var f=b[4],g=b[5],l=b[6];return{x:l*(c.x-g*c.y+f*c.z)+b[0],y:l*(g*c.x+c.y-a*c.z)+b[1],z:l*(-f*c.x+a*c.y+c.z)+b[2]}}};b.geocentricFromWgs84=function(c,a,b){if(1===a)return{x:c.x-b[0],y:c.y-b[1],z:c.z-b[2]};if(2===a){a=b[3];var f=b[4],g=b[5],l=b[6],e=(c.x-b[0])/l,m=(c.y-b[1])/l;c=(c.z-b[2])/l;return{x:e+g*m-f*c,y:-g*e+m+a*c,z:f*e-a*m+c}}}},{}],33:[function(e,k,b){function c(a){return 1===a||2===a}var h=e("./datumUtils");k.exports=function(a,b,f){if(h.compareDatums(a,b)||5===a.datum_type||5===b.datum_type||a.es===b.es&&a.a===b.a&&!c(a.datum_type)&&!c(b.datum_type))return f;f=h.geodeticToGeocentric(f,a.es,a.a);c(a.datum_type)&&(f=h.geocentricToWgs84(f,a.datum_type,a.datum_params));c(b.datum_type)&&(f=h.geocentricFromWgs84(f,b.datum_type,b.datum_params));return h.geocentricToGeodetic(f,b.es,b.a,b.b)}},{"./datumUtils":32}],34:[function(e,k,b){function c(b){var f=this;if(2===arguments.length){var g=arguments[1];"string"===typeof g?"+"===g.charAt(0)?c[b]=h(arguments[1]):c[b]=a(arguments[1]):c[b]=g}else if(1===arguments.length){if(Array.isArray(b))return b.map(function(a){Array.isArray(a)?c.apply(f,a):c(a)});if("string"===typeof b){if(b in c)return c[b]}else"EPSG"in b?c["EPSG:"+b.EPSG]=b:"ESRI"in b?c["ESRI:"+b.ESRI]=b:"IAU2000"in b?c["IAU2000:"+b.IAU2000]=b:console.log(b)}}b=e("./global");var h=e("./projString"),a=e("./wkt");b(c);k.exports=c},{"./global":37,"./projString":40,"./wkt":69}],35:[function(e,k,b){var c=e("./constants/Ellipsoid");b.eccentricity=function(c,a,b,f){b=c*c;a*=a;var g=(b-a)/b,l=0;f?(c*=1-g*(.16666666666666666+g*(.04722222222222222+.022156084656084655*g)),b=c*c,g=0):l=Math.sqrt(g);return{es:g,e:l,ep2:(b-a)/a}};b.sphere=function(b,a,d,f,g){b||(d=c[f],d||(d=c.WGS84),b=d.a,a=d.b,d=d.rf);d&&!a&&(a=(1-1/d)*b);if(0===d||1E-10>Math.abs(b-a))g=!0,a=b;return{a:b,b:a,rf:d,sphere:g}}},{"./constants/Ellipsoid":27}],36:[function(e,k,b){k.exports=function(c,b){c=c||{};var a,d;if(!b)return c;for(d in b)a=b[d],void 0!==a&&(c[d]=a);return c}},{}],37:[function(e,k,b){k.exports=function(c){c("EPSG:4326","+title\x3dWGS 84 (long/lat) +proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +units\x3ddegrees");c("EPSG:4269","+title\x3dNAD83 (long/lat) +proj\x3dlonglat +a\x3d6378137.0 +b\x3d6356752.31414036 +ellps\x3dGRS80 +datum\x3dNAD83 +units\x3ddegrees");c("EPSG:3857","+title\x3dWGS 84 / Pseudo-Mercator +proj\x3dmerc +a\x3d6378137 +b\x3d6378137 +lat_ts\x3d0.0 +lon_0\x3d0.0 +x_0\x3d0.0 +y_0\x3d0 +k\x3d1.0 +units\x3dm +nadgrids\x3d@null +no_defs");c.WGS84=c["EPSG:4326"];c["EPSG:3785"]=c["EPSG:3857"];c.GOOGLE=c["EPSG:3857"];c["EPSG:900913"]=c["EPSG:3857"];c["EPSG:102113"]=c["EPSG:3857"]}},{}],38:[function(e,k,b){b=e("./core");b.defaultDatum="WGS84";b.Proj=e("./Proj");b.WGS84=new b.Proj("WGS84");b.Point=e("./Point");b.toPoint=e("./common/toPoint");b.defs=e("./defs");b.transform=e("./transform");b.mgrs=e("mgrs");b.version=e("./version");e("./includedProjections")(b);k.exports=b},{"./Point":1,"./Proj":2,"./common/toPoint":24,"./core":30,"./defs":34,"./includedProjections":"./includedProjections","./transform":68,"./version":"./lib/version",mgrs:70}],39:[function(e,k,b){function c(a){return f.some(function(c){return-1<a.indexOf(c)})}var h=e("./defs"),a=e("./wkt"),d=e("./projString"),f=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];k.exports=function(b){if("string"===typeof b){if(b in h)return h[b];if(c(b))return a(b);if("+"===b[0])return d(b)}else return b}},{"./defs":34,"./projString":40,"./wkt":69}],40:[function(e,k,b){var c=e("./constants/PrimeMeridian"),h=e("./constants/units");k.exports=function(a){var b={};a=a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,c){var b=c.split("\x3d");b.push(!0);a[b[0].toLowerCase()]=b[1];return a},{});var f,g,l,e={proj:"projName",datum:"datumCode",rf:function(a){b.rf=parseFloat(a)},lat_0:function(a){b.lat0=.017453292519943295*a},lat_1:function(a){b.lat1=.017453292519943295*a},lat_2:function(a){b.lat2=.017453292519943295*a},lat_ts:function(a){b.lat_ts=.017453292519943295*a},lon_0:function(a){b.long0=.017453292519943295*a},lon_1:function(a){b.long1=.017453292519943295*a},lon_2:function(a){b.long2=.017453292519943295*a},alpha:function(a){b.alpha=.017453292519943295*parseFloat(a)},lonc:function(a){b.longc=.017453292519943295*a},x_0:function(a){b.x0=parseFloat(a)},y_0:function(a){b.y0=parseFloat(a)},k_0:function(a){b.k0=parseFloat(a)},k:function(a){b.k0=parseFloat(a)},a:function(a){b.a=parseFloat(a)},b:function(a){b.b=parseFloat(a)},r_a:function(){b.R_A=!0},zone:function(a){b.zone=parseInt(a,10)},south:function(){b.utmSouth=!0},towgs84:function(a){b.datum_params=a.split(",").map(function(a){return parseFloat(a)})},to_meter:function(a){b.to_meter=parseFloat(a)},units:function(a){b.units=a;h[a]&&(b.to_meter=h[a].to_meter)},from_greenwich:function(a){b.from_greenwich=.017453292519943295*a},pm:function(a){b.from_greenwich=.017453292519943295*(c[a]?c[a]:parseFloat(a))},nadgrids:function(a){"@null"===a?b.datumCode="none":b.nadgrids=a},axis:function(a){3===a.length&&-1!=="ewnsud".indexOf(a.substr(0,1))&&-1!=="ewnsud".indexOf(a.substr(1,1))&&-1!=="ewnsud".indexOf(a.substr(2,1))&&(b.axis=a)}};for(f in a)g=a[f],f in e?(l=e[f],"function"===typeof l?l(g):b[l]=g):b[f]=g;"string"===typeof b.datumCode&&"WGS84"!==b.datumCode&&(b.datumCode=b.datumCode.toLowerCase());return b}},{"./constants/PrimeMeridian":28,"./constants/units":29}],41:[function(e,k,b){function c(c,b){var l=d.length;if(!c.names)return console.log(b),!0;d[l]=c;c.names.forEach(function(c){a[c.toLowerCase()]=l});return this}var h=[e("./projections/merc"),e("./projections/longlat")],a={},d=[];b.add=c;b.get=function(c){if(!c)return!1;c=c.toLowerCase();if("undefined"!==typeof a[c]&&d[a[c]])return d[a[c]]};b.start=function(){h.forEach(c)}},{"./projections/longlat":53,"./projections/merc":54}],42:[function(e,k,b){var c=e("../common/msfnz"),h=e("../common/qsfnz"),a=e("../common/adjust_lon"),d=e("../common/asinz");b.init=function(){1E-10>Math.abs(this.lat1+this.lat2)||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.con=this.t1=this.sin_po,this.ms1=c(this.e3,this.sin_po,this.cos_po),this.qs1=h(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=c(this.e3,this.sin_po,this.cos_po),this.qs2=h(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=h(this.e3,this.sin_po,this.cos_po),this.ns0=1E-10<Math.abs(this.lat1-this.lat2)?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)};b.forward=function(c){var b=c.x,d=c.y;this.sin_phi=Math.sin(d);this.cos_phi=Math.cos(d);var d=h(this.e3,this.sin_phi,this.cos_phi),d=this.a*Math.sqrt(this.c-this.ns0*d)/this.ns0,b=this.ns0*a(b-this.long0),e=this.rh-d*Math.cos(b)+this.y0;c.x=d*Math.sin(b)+this.x0;c.y=e;return c};b.inverse=function(c){var b,d,h;c.x-=this.x0;c.y=this.rh-c.y+this.y0;0<=this.ns0?(b=Math.sqrt(c.x*c.x+c.y*c.y),d=1):(b=-Math.sqrt(c.x*c.x+c.y*c.y),d=-1);h=0;0!==b&&(h=Math.atan2(d*c.x,d*c.y));d=b*this.ns0/this.a;this.sphere?b=Math.asin((this.c-d*d)/(2*this.ns0)):(b=(this.c-d*d)/this.ns0,b=this.phi1z(this.e3,b));h=a(h/this.ns0+this.long0);c.x=h;c.y=b;return c};b.phi1z=function(a,c){var b,h,e,k,p=d(.5*c);if(1E-10>a)return p;for(var q=a*a,r=1;25>=r;r++)if(b=Math.sin(p),h=Math.cos(p),e=a*b,k=1-e*e,b=.5*k*k/h*(c/(1-q)-b/k+.5/a*Math.log((1-e)/(1+e))),p+=b,1E-7>=Math.abs(b))return p;return null};b.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":7,"../common/msfnz":16,"../common/qsfnz":21}],43:[function(e,k,b){var c=e("../common/adjust_lon"),h=Math.PI/2,a=e("../common/mlfn"),d=e("../common/e0fn"),f=e("../common/e1fn"),g=e("../common/e2fn"),l=e("../common/e3fn"),y=e("../common/gN"),m=e("../common/asinz"),u=e("../common/imlfn");b.init=function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)};b.forward=function(b){var e=b.y,m=Math.sin(b.y),k=Math.cos(b.y),u=c(b.x-this.long0),w,x,z,B,D;this.sphere?1E-10>=Math.abs(this.sin_p12-1)?(b.x=this.x0+this.a*(h-e)*Math.sin(u),b.y=this.y0-this.a*(h-e)*Math.cos(u)):1E-10>=Math.abs(this.sin_p12+1)?(b.x=this.x0+this.a*(h+e)*Math.sin(u),b.y=this.y0+this.a*(h+e)*Math.cos(u)):(e=this.sin_p12*m+this.cos_p12*k*Math.cos(u),e=Math.acos(e),e/=Math.sin(e),b.x=this.x0+this.a*e*k*Math.sin(u),b.y=this.y0+this.a*e*(this.cos_p12*m-this.sin_p12*k*Math.cos(u))):(w=d(this.es),x=f(this.es),z=g(this.es),B=l(this.es),1E-10>=Math.abs(this.sin_p12-1)?(k=this.a*a(w,x,z,B,h),e=this.a*a(w,x,z,B,e),b.x=this.x0+(k-e)*Math.sin(u),b.y=this.y0-(k-e)*Math.cos(u)):1E-10>=Math.abs(this.sin_p12+1)?(k=this.a*a(w,x,z,B,h),e=this.a*a(w,x,z,B,e),b.x=this.x0+(k+e)*Math.sin(u),b.y=this.y0+(k+e)*Math.cos(u)):(w=m/k,e=y(this.a,this.e,this.sin_p12),m=y(this.a,this.e,m),m=Math.atan((1-this.es)*w+this.es*e*this.sin_p12/(m*k)),k=Math.atan2(Math.sin(u),this.cos_p12*Math.tan(m)-this.sin_p12*Math.cos(u)),w=0===k?Math.asin(this.cos_p12*Math.sin(m)-this.sin_p12*Math.cos(m)):1E-10>=Math.abs(Math.abs(k)-Math.PI)?-Math.asin(this.cos_p12*Math.sin(m)-this.sin_p12*Math.cos(m)):Math.asin(Math.sin(u)*Math.cos(m)/Math.sin(k)),u=this.e*this.sin_p12/Math.sqrt(1-this.es),x=this.e*this.cos_p12*Math.cos(k)/Math.sqrt(1-this.es),m=u*x,x*=x,z=w*w,B=z*w,D=B*w,e=e*w*(1-z*x*(1-x)/6+B/8*m*(1-2*x)+D/120*(x*(4-7*x)-3*u*u*(1-7*x))-D*w/48*m),b.x=this.x0+e*Math.sin(k),b.y=this.y0+e*Math.cos(k)));return b};b.inverse=function(b){b.x-=this.x0;b.y-=this.y0;var e,k,t,v,w,x;if(this.sphere){if(e=Math.sqrt(b.x*b.x+b.y*b.y),!(e>2*h*this.a))return k=e/this.a,t=Math.sin(k),v=Math.cos(k),k=this.long0,1E-10>=Math.abs(e)?w=this.lat0:(w=m(v*this.sin_p12+b.y*t*this.cos_p12/e),k=Math.abs(this.lat0)-h,k=1E-10>=Math.abs(k)?0<=this.lat0?c(this.long0+Math.atan2(b.x,-b.y)):c(this.long0-Math.atan2(-b.x,b.y)):c(this.long0+Math.atan2(b.x*t,e*this.cos_p12*v-b.y*this.sin_p12*t))),b.x=k,b.y=w,b}else return t=d(this.es),k=f(this.es),v=g(this.es),w=l(this.es),1E-10>=Math.abs(this.sin_p12-1)?(x=this.a*a(t,k,v,w,h),e=Math.sqrt(b.x*b.x+b.y*b.y),w=u((x-e)/this.a,t,k,v,w),k=c(this.long0+Math.atan2(b.x,-1*b.y))):1E-10>=Math.abs(this.sin_p12+1)?(x=this.a*a(t,k,v,w,h),e=Math.sqrt(b.x*b.x+b.y*b.y),w=u((e-x)/this.a,t,k,v,w),k=c(this.long0+Math.atan2(b.x,b.y))):(e=Math.sqrt(b.x*b.x+b.y*b.y),t=Math.atan2(b.x,b.y),w=y(this.a,this.e,this.sin_p12),k=Math.cos(t),v=this.e*this.cos_p12*k,v=-v*v/(1-this.es),x=3*this.es*(1-v)*this.sin_p12*this.cos_p12*k/(1-this.es),w=e/w,e=w-v*(1+v)*Math.pow(w,3)/6-x*(1+3*v)*Math.pow(w,4)/24,v=1-v*e*e/2-w*e*e*e/6,w=Math.asin(this.sin_p12*Math.cos(e)+this.cos_p12*Math.sin(e)*k),k=c(this.long0+Math.asin(Math.sin(t)*Math.sin(e)/Math.cos(w))),w=Math.atan((1-this.es*v*this.sin_p12/Math.sin(w))*Math.tan(w)/(1-this.es))),b.x=k,b.y=w,b};b.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":7,"../common/e0fn":8,"../common/e1fn":9,"../common/e2fn":10,"../common/e3fn":11,"../common/gN":12,"../common/imlfn":13,"../common/mlfn":15}],44:[function(e,k,b){var c=e("../common/mlfn"),h=e("../common/e0fn"),a=e("../common/e1fn"),d=e("../common/e2fn"),f=e("../common/e3fn"),g=e("../common/gN"),l=e("../common/adjust_lon"),y=e("../common/adjust_lat"),m=e("../common/imlfn"),u=Math.PI/2;b.init=function(){this.sphere||(this.e0=h(this.es),this.e1=a(this.es),this.e2=d(this.es),this.e3=f(this.es),this.ml0=this.a*c(this.e0,this.e1,this.e2,this.e3,this.lat0))};b.forward=function(a){var b,d,f=a.x,e=a.y,f=l(f-this.long0);if(this.sphere)b=this.a*Math.asin(Math.cos(e)*Math.sin(f)),d=this.a*(Math.atan2(Math.tan(e),Math.cos(f))-this.lat0);else{d=Math.sin(e);var h=Math.cos(e),m=g(this.a,this.e,d),k=Math.tan(e)*Math.tan(e);b=f*Math.cos(e);var f=b*b,y=this.es*h*h/(1-this.es),e=this.a*c(this.e0,this.e1,this.e2,this.e3,e);b=m*b*(1-f*k*(1/6-(8-k+8*y)*f/120));d=e-this.ml0+m*d/h*f*(.5+(5-k+6*y)*f/24)}a.x=b+this.x0;a.y=d+this.y0;return a};b.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var c=a.x/this.a,b=a.y/this.a,d;if(this.sphere)d=b+this.lat0,b=Math.asin(Math.sin(d)*Math.cos(c)),d=Math.atan2(Math.tan(c),Math.cos(d));else{d=m(this.ml0/this.a+b,this.e0,this.e1,this.e2,this.e3);if(1E-10>=Math.abs(Math.abs(d)-u))return a.x=this.long0,a.y=u,0>b&&(a.y*=-1),a;var b=g(this.a,this.e,Math.sin(d)),f=Math.pow(Math.tan(d),2),c=c*this.a/b,e=c*c,b=d-b*Math.tan(d)/(b*b*b/this.a/this.a*(1-this.es))*c*c*(.5-(1+3*f)*c*c/24);d=c*(1-e*(f/3+(1+3*f)*f*e/15))/Math.cos(d)}a.x=l(d+this.long0);a.y=y(b);return a};b.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":8,"../common/e1fn":9,"../common/e2fn":10,"../common/e3fn":11,"../common/gN":12,"../common/imlfn":13,"../common/mlfn":15}],45:[function(e,k,b){var c=e("../common/adjust_lon"),h=e("../common/qsfnz"),a=e("../common/msfnz"),d=e("../common/iqsfnz");b.init=function(){this.sphere||(this.k0=a(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))};b.forward=function(a){var b=a.y,d;d=c(a.x-this.long0);this.sphere?(d=this.x0+this.a*d*Math.cos(this.lat_ts),b=this.y0+this.a*Math.sin(b)/Math.cos(this.lat_ts)):(b=h(this.e,Math.sin(b)),d=this.x0+this.a*this.k0*d,b=this.y0+this.a*b*.5/this.k0);a.x=d;a.y=b;return a};b.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b,l;this.sphere?(b=c(this.long0+a.x/this.a/Math.cos(this.lat_ts)),l=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(l=d(this.e,2*a.y*this.k0/this.a),b=c(this.long0+a.x/(this.a*this.k0)));a.x=b;a.y=l;return a};b.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":14,"../common/msfnz":16,"../common/qsfnz":21}],46:[function(e,k,b){var c=e("../common/adjust_lon"),h=e("../common/adjust_lat");b.init=function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)};b.forward=function(a){var b=a.y,f=c(a.x-this.long0),b=h(b-this.lat0);a.x=this.x0+this.a*f*this.rc;a.y=this.y0+this.a*b;return a};b.inverse=function(a){var b=a.y;a.x=c(this.long0+(a.x-this.x0)/(this.a*this.rc));a.y=h(this.lat0+(b-this.y0)/this.a);return a};b.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],47:[function(e,k,b){var c=e("../common/e0fn"),h=e("../common/e1fn"),a=e("../common/e2fn"),d=e("../common/e3fn"),f=e("../common/msfnz"),g=e("../common/mlfn"),l=e("../common/adjust_lon"),y=e("../common/adjust_lat"),m=e("../common/imlfn");b.init=function(){1E-10>Math.abs(this.lat1+this.lat2)||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=c(this.es),this.e1=h(this.es),this.e2=a(this.es),this.e3=d(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=f(this.e,this.sinphi,this.cosphi),this.ml1=g(this.e0,this.e1,this.e2,this.e3,this.lat1),1E-10>Math.abs(this.lat1-this.lat2)?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=f(this.e,this.sinphi,this.cosphi),this.ml2=g(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=g(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))};b.forward=function(a){var c=a.x,b=a.y;this.sphere||(b=g(this.e0,this.e1,this.e2,this.e3,b));var b=this.a*(this.g-b),c=this.ns*l(c-this.long0),d=this.y0+this.rh-b*Math.cos(c);a.x=this.x0+b*Math.sin(c);a.y=d;return a};b.inverse=function(a){a.x-=this.x0;a.y=this.rh-a.y+this.y0;var c,b,d;0<=this.ns?(b=Math.sqrt(a.x*a.x+a.y*a.y),c=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),c=-1);d=0;0!==b&&(d=Math.atan2(c*a.x,c*a.y));this.sphere?(d=l(this.long0+d/this.ns),b=y(this.g-b/this.a)):(b=m(this.g-b/this.a,this.e0,this.e1,this.e2,this.e3),d=l(this.long0+d/this.ns));a.x=d;a.y=b;return a};b.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":8,"../common/e1fn":9,"../common/e2fn":10,"../common/e3fn":11,"../common/imlfn":13,"../common/mlfn":15,"../common/msfnz":16}],48:[function(e,k,b){var c=Math.PI/4,h=e("../common/srat"),a=Math.PI/2;b.init=function(){var a=Math.sin(this.lat0),b=Math.cos(this.lat0),b=b*b;this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a);this.C=Math.sqrt(1+this.es*b*b/(1-this.es));this.phic0=Math.asin(a/this.C);this.ratexp=.5*this.C*this.e;this.K=Math.tan(.5*this.phic0+c)/(Math.pow(Math.tan(.5*this.lat0+c),this.C)*h(this.e*a,this.ratexp))};b.forward=function(b){var f=b.x,g=b.y;b.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*g+c),this.C)*h(this.e*Math.sin(g),this.ratexp))-a;b.x=this.C*f;return b};b.inverse=function(b){for(var f=b.x/this.C,g=b.y,l=Math.pow(Math.tan(.5*g+c)/this.K,1/this.C),e=20;0<e;--e){g=2*Math.atan(l*h(this.e*Math.sin(b.y),-.5*this.e))-a;if(1E-14>Math.abs(g-b.y))break;b.y=g}if(!e)return null;b.x=f;b.y=g;return b};b.names=["gauss"]},{"../common/srat":23}],49:[function(e,k,b){var c=e("../common/adjust_lon"),h=e("../common/asinz");b.init=function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1E3*this.a;this.rc=1};b.forward=function(a){var b,f,g,l,e;f=a.y;g=c(a.x-this.long0);b=Math.sin(f);f=Math.cos(f);l=Math.cos(g);e=this.sin_p14*b+this.cos_p14*f*l;0<e||1E-10>=Math.abs(e)?(g=this.x0+1*this.a*f*Math.sin(g)/e,b=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*f*l)/e):(g=this.x0+this.infinity_dist*f*Math.sin(g),b=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*f*l));a.x=g;a.y=b;return a};b.inverse=function(a){var b,f,g,l;a.x=(a.x-this.x0)/this.a;a.y=(a.y-this.y0)/this.a;a.x/=this.k0;a.y/=this.k0;(b=Math.sqrt(a.x*a.x+a.y*a.y))?(l=Math.atan2(b,this.rc),f=Math.sin(l),g=Math.cos(l),l=h(g*this.sin_p14+a.y*f*this.cos_p14/b),b=Math.atan2(a.x*f,b*this.cos_p14*g-a.y*this.sin_p14*f),b=c(this.long0+b)):(l=this.phic0,b=0);a.x=b;a.y=l;return a};b.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":7}],50:[function(e,k,b){var c=e("../common/adjust_lon");b.init=function(){this.a=6377397.155;this.es=.006674372230614;this.e=Math.sqrt(this.es);this.lat0||(this.lat0=.863937979737193);this.long0||(this.long0=.4334234309119251);this.k0||(this.k0=.9999);this.s45=.785398163397448;this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq};b.forward=function(b){var a,d,f;a=b.y;f=c(b.x-this.long0);a=2*(Math.atan(this.k*Math.pow(Math.tan(a/2+this.s45),this.alfa)/Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.alfa*this.e/2))-this.s45);d=-f*this.alfa;f=Math.asin(Math.cos(this.ad)*Math.sin(a)+Math.sin(this.ad)*Math.cos(a)*Math.cos(d));a=this.n*Math.asin(Math.cos(a)*Math.sin(d)/Math.cos(f));f=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(f/2+this.s45),this.n);b.y=f*Math.cos(a)/1;b.x=f*Math.sin(a)/1;this.czech||(b.y*=-1,b.x*=-1);return b};b.inverse=function(b){var a,c,f;a=b.x;b.x=b.y;b.y=a;this.czech||(b.y*=-1,b.x*=-1);a=Math.sqrt(b.x*b.x+b.y*b.y);f=Math.atan2(b.y,b.x)/Math.sin(this.s0);c=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);a=Math.asin(Math.cos(this.ad)*Math.sin(c)-Math.sin(this.ad)*Math.cos(c)*Math.cos(f));b.x=this.long0-Math.asin(Math.cos(c)*Math.sin(f)/Math.cos(a))/this.alfa;f=a;var g=c=0;do b.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(a/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(f))/(1-this.e*Math.sin(f)),this.e/2))-this.s45),1E-10>Math.abs(f-b.y)&&(c=1),f=b.y,g+=1;while(0===c&&15>g);return 15<=g?null:b};b.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],51:[function(e,k,b){var c=Math.PI/2,h=Math.PI/4,a=e("../common/qsfnz"),d=e("../common/adjust_lon");b.S_POLE=1;b.N_POLE=2;b.EQUIT=3;b.OBLIQ=4;b.init=function(){var b=Math.abs(this.lat0);this.mode=1E-10>Math.abs(b-c)?0>this.lat0?this.S_POLE:this.N_POLE:1E-10>Math.abs(b)?this.EQUIT:this.OBLIQ;if(0<this.es)switch(this.qp=a(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),b=Math.sin(this.lat0),this.sinb1=a(this.e,b)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*b*b)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))};b.forward=function(b){var g,l,e,m,k,p,q,r;m=b.x;var t=b.y;m=d(m-this.long0);if(this.sphere)if(k=Math.sin(t),p=Math.cos(t),e=Math.cos(m),this.mode===this.OBLIQ||this.mode===this.EQUIT){l=this.mode===this.EQUIT?1+p*e:1+this.sinph0*k+this.cosph0*p*e;if(1E-10>=l)return null;l=Math.sqrt(2/l);g=l*p*Math.sin(m);l*=this.mode===this.EQUIT?k:this.cosph0*k-this.sinph0*p*e}else{if(this.mode===this.N_POLE||this.mode===this.S_POLE){this.mode===this.N_POLE&&(e=-e);if(1E-10>Math.abs(t+this.phi0))return null;l=h-.5*t;l=2*(this.mode===this.S_POLE?Math.cos(l):Math.sin(l));g=l*Math.sin(m);l*=e}}else{r=q=p=0;e=Math.cos(m);m=Math.sin(m);k=Math.sin(t);k=a(this.e,k);if(this.mode===this.OBLIQ||this.mode===this.EQUIT)p=k/this.qp,q=Math.sqrt(1-p*p);switch(this.mode){case this.OBLIQ:r=1+this.sinb1*p+this.cosb1*q*e;break;case this.EQUIT:r=1+q*e;break;case this.N_POLE:r=c+t;k=this.qp-k;break;case this.S_POLE:r=t-c,k=this.qp+k}if(1E-10>Math.abs(r))return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:r=Math.sqrt(2/r);l=this.mode===this.OBLIQ?this.ymf*r*(this.cosb1*p-this.sinb1*q*e):(r=Math.sqrt(2/(1+q*e)))*p*this.ymf;g=this.xmf*r*q*m;break;case this.N_POLE:case this.S_POLE:0<=k?(g=(r=Math.sqrt(k))*m,l=e*(this.mode===this.S_POLE?r:-r)):g=l=0}}b.x=this.a*g+this.x0;b.y=this.a*l+this.y0;return b};b.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b=a.x/this.a,l=a.y/this.a,e,h,k,p;if(this.sphere){p=h=0;k=Math.sqrt(b*b+l*l);e=.5*k;if(1<e)return null;e=2*Math.asin(e);if(this.mode===this.OBLIQ||this.mode===this.EQUIT)p=Math.sin(e),h=Math.cos(e);switch(this.mode){case this.EQUIT:e=1E-10>=Math.abs(k)?0:Math.asin(l*p/k);b*=p;l=h*k;break;case this.OBLIQ:e=1E-10>=Math.abs(k)?this.phi0:Math.asin(h*this.sinph0+l*p*this.cosph0/k);b=b*p*this.cosph0;l=(h-Math.sin(e)*this.sinph0)*k;break;case this.N_POLE:l=-l;e=c-e;break;case this.S_POLE:e-=c}b=0!==l||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(b,l):0}else{e=0;if(this.mode===this.OBLIQ||this.mode===this.EQUIT){b/=this.dd;l*=this.dd;p=Math.sqrt(b*b+l*l);if(1E-10>p)return a.x=0,a.y=this.phi0,a;k=2*Math.asin(.5*p/this.rq);h=Math.cos(k);b*=k=Math.sin(k);this.mode===this.OBLIQ?(e=h*this.sinb1+l*k*this.cosb1/p,l=p*this.cosb1*h-l*this.sinb1*k):(e=l*k/p,l=p*h)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){this.mode===this.N_POLE&&(l=-l);e=b*b+l*l;if(!e)return a.x=0,a.y=this.phi0,a;e=1-e/this.qp;this.mode===this.S_POLE&&(e=-e)}b=Math.atan2(b,l);e=this.authlat(Math.asin(e),this.apa)}a.x=d(this.long0+b);a.y=e;return a};b.P00=.3333333333333333;b.P01=.17222222222222222;b.P02=.10257936507936508;b.P10=.06388888888888888;b.P11=.0664021164021164;b.P20=.016415012942191543;b.authset=function(a){var b,c=[];c[0]=a*this.P00;b=a*a;c[0]+=b*this.P01;c[1]=b*this.P10;b*=a;c[0]+=b*this.P02;c[1]+=b*this.P11;c[2]=b*this.P20;return c};b.authlat=function(a,b){var c=a+a;return a+b[0]*Math.sin(c)+b[1]*Math.sin(c+c)+b[2]*Math.sin(c+c+c)};b.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":21}],52:[function(e,k,b){var c=e("../common/msfnz"),h=e("../common/tsfnz"),a=Math.PI/2,d=e("../common/sign"),f=e("../common/adjust_lon"),g=e("../common/phi2z");b.init=function(){this.lat2||(this.lat2=this.lat1);this.k0||(this.k0=1);this.x0=this.x0||0;this.y0=this.y0||0;if(!(1E-10>Math.abs(this.lat1+this.lat2))){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var a=Math.sin(this.lat1),b=c(this.e,a,Math.cos(this.lat1)),d=h(this.e,this.lat1,a),f=Math.sin(this.lat2),g=c(this.e,f,Math.cos(this.lat2)),f=h(this.e,this.lat2,f),e=h(this.e,this.lat0,Math.sin(this.lat0));this.ns=1E-10<Math.abs(this.lat1-this.lat2)?Math.log(b/g)/Math.log(d/f):a;isNaN(this.ns)&&(this.ns=a);this.f0=b/(this.ns*Math.pow(d,this.ns));this.rh=this.a*this.f0*Math.pow(e,this.ns);this.title||(this.title="Lambert Conformal Conic")}};b.forward=function(b){var c=b.x,g=b.y;1E-10>=Math.abs(2*Math.abs(g)-Math.PI)&&(g=d(g)*(a-2E-10));var e=Math.abs(Math.abs(g)-a);if(1E-10<e)g=h(this.e,g,Math.sin(g)),g=this.a*this.f0*Math.pow(g,this.ns);else{e=g*this.ns;if(0>=e)return null;g=0}c=this.ns*f(c-this.long0);b.x=this.k0*g*Math.sin(c)+this.x0;b.y=this.k0*(this.rh-g*Math.cos(c))+this.y0;return b};b.inverse=function(b){var c,d,e,h=(b.x-this.x0)/this.k0,k=this.rh-(b.y-this.y0)/this.k0;0<this.ns?(c=Math.sqrt(h*h+k*k),d=1):(c=-Math.sqrt(h*h+k*k),d=-1);e=0;0!==c&&(e=Math.atan2(d*h,d*k));if(0!==c||0<this.ns){if(d=1/this.ns,c=Math.pow(c/(this.a*this.f0),d),c=g(this.e,c),-9999===c)return null}else c=-a;e=f(e/this.ns+this.long0);b.x=e;b.y=c;return b};b.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":16,"../common/phi2z":17,"../common/sign":22,"../common/tsfnz":25}],53:[function(e,k,b){function c(b){return b}b.init=function(){};b.forward=c;b.inverse=c;b.names=["longlat","identity"]},{}],54:[function(e,k,b){var c=e("../common/msfnz"),h=Math.PI/2,a=e("../common/adjust_lon"),d=Math.PI/4,f=e("../common/tsfnz"),g=e("../common/phi2z");b.init=function(){var a=this.b/this.a;this.es=1-a*a;"x0"in this||(this.x0=0);"y0"in this||(this.y0=0);this.e=Math.sqrt(this.es);this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):c(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)};b.forward=function(b){var c=b.x,g=b.y;if(90<57.29577951308232*g&&-90>57.29577951308232*g&&180<57.29577951308232*c&&-180>57.29577951308232*c||1E-10>=Math.abs(Math.abs(g)-h))return null;this.sphere?(c=this.x0+this.a*this.k0*a(c-this.long0),g=this.y0+this.a*this.k0*Math.log(Math.tan(d+.5*g))):(g=f(this.e,g,Math.sin(g)),c=this.x0+this.a*this.k0*a(c-this.long0),g=this.y0-this.a*this.k0*Math.log(g));b.x=c;b.y=g;return b};b.inverse=function(b){var c=b.x-this.x0,d=b.y-this.y0;if(this.sphere)d=h-2*Math.atan(Math.exp(-d/(this.a*this.k0)));else if(d=g(this.e,Math.exp(-d/(this.a*this.k0))),-9999===d)return null;c=a(this.long0+c/(this.a*this.k0));b.x=c;b.y=d;return b};b.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":16,"../common/phi2z":17,"../common/tsfnz":25}],55:[function(e,k,b){var c=e("../common/adjust_lon");b.init=function(){};b.forward=function(b){var a=b.y,d=c(b.x-this.long0),a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+a/2.5))*1.25;b.x=this.x0+this.a*d;b.y=a;return b};b.inverse=function(b){b.x-=this.x0;b.y-=this.y0;var a=c(this.long0+b.x/this.a),d=2.5*(Math.atan(Math.exp(.8*b.y/this.a))-Math.PI/4);b.x=a;b.y=d;return b};b.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],56:[function(e,k,b){var c=e("../common/adjust_lon");b.init=function(){};b.forward=function(b){for(var a=b.y,d=c(b.x-this.long0),f=a,g=Math.PI*Math.sin(a),l=0;;l++){var e=-(f+Math.sin(f)-g)/(1+Math.cos(f)),f=f+e;if(1E-10>Math.abs(e))break}f/=2;1E-10>Math.PI/2-Math.abs(a)&&(d=0);a=1.4142135623731*this.a*Math.sin(f)+this.y0;b.x=.900316316158*this.a*d*Math.cos(f)+this.x0;b.y=a;return b};b.inverse=function(b){var a;b.x-=this.x0;b.y-=this.y0;a=b.y/(1.4142135623731*this.a);.999999999999<Math.abs(a)&&(a=.999999999999);a=Math.asin(a);var d=c(this.long0+b.x/(.900316316158*this.a*Math.cos(a)));d<-Math.PI&&(d=-Math.PI);d>Math.PI&&(d=Math.PI);a=(2*a+Math.sin(2*a))/Math.PI;1<Math.abs(a)&&(a=1);a=Math.asin(a);b.x=d;b.y=a;return b};b.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],57:[function(e,k,b){b.iterations=1;b.init=function(){this.A=[];this.A[1]=.6399175073;this.A[2]=-.1358797613;this.A[3]=.063294409;this.A[4]=-.02526853;this.A[5]=.0117879;this.A[6]=-.0055161;this.A[7]=.0026906;this.A[8]=-.001333;this.A[9]=6.7E-4;this.A[10]=-3.4E-4;this.B_re=[];this.B_im=[];this.B_re[1]=.7557853228;this.B_im[1]=0;this.B_re[2]=.249204646;this.B_im[2]=.003371507;this.B_re[3]=-.001541739;this.B_im[3]=.04105856;this.B_re[4]=-.10162907;this.B_im[4]=.01727609;this.B_re[5]=-.26623489;this.B_im[5]=-.36249218;this.B_re[6]=-.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-.577245789;this.C_im[2]=-.007809598;this.C_re[3]=.508307513;this.C_im[3]=-.112208952;this.C_re[4]=-.15094762;this.C_im[4]=.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=.5185406398;this.D[3]=-.03333098;this.D[4]=-.1052906;this.D[5]=-.0368594;this.D[6]=.007317;this.D[7]=.0122;this.D[8]=.00394;this.D[9]=-.0013};b.forward=function(b){var e,a=(b.y-this.lat0)/4.84813681109536E-6*1E-5,d=b.x-this.long0,f=1,g=0;for(e=1;10>=e;e++)f*=a,g+=this.A[e]*f;var a=g,f=1,l=0,k=0,m=0;for(e=1;6>=e;e++)g=f*a-l*d,l=l*a+f*d,f=g,k=k+this.B_re[e]*f-this.B_im[e]*l,m=m+this.B_im[e]*f+this.B_re[e]*l;b.x=m*this.a+this.x0;b.y=k*this.a+this.y0;return b};b.inverse=function(b){var e,a=(b.y-this.y0)/this.a,d=(b.x-this.x0)/this.a,f=1,g=0,l,k=0,m=0;for(e=1;6>=e;e++)l=f*a-g*d,g=g*a+f*d,f=l,k=k+this.C_re[e]*f-this.C_im[e]*g,m=m+this.C_im[e]*f+this.C_re[e]*g;for(f=0;f<this.iterations;f++){var u=k,p=m,q;l=a;g=d;for(e=2;6>=e;e++)q=u*k-p*m,p=p*k+u*m,u=q,l+=(e-1)*(this.B_re[e]*u-this.B_im[e]*p),g+=(e-1)*(this.B_im[e]*u+this.B_re[e]*p);var u=1,p=0,r=this.B_re[1],t=this.B_im[1];for(e=2;6>=e;e++)q=u*k-p*m,p=p*k+u*m,u=q,r+=e*(this.B_re[e]*u-this.B_im[e]*p),t+=e*(this.B_im[e]*u+this.B_re[e]*p);m=r*r+t*t;k=(l*r+g*t)/m;m=(g*r-l*t)/m}a=k;d=1;k=0;for(e=1;9>=e;e++)d*=a,k+=this.D[e]*d;e=this.lat0+.484813681109536*k;b.x=this.long0+m;b.y=e;return b};b.names=["New_Zealand_Map_Grid","nzmg"]},{}],58:[function(e,k,b){var c=e("../common/tsfnz"),h=e("../common/adjust_lon"),a=e("../common/phi2z"),d=Math.PI/2,f=Math.PI/4;b.init=function(){this.no_off=this.no_off||!1;this.no_rot=this.no_rot||!1;isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),b=Math.cos(this.lat0),d=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(b,4));this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-d*d);a=c(this.e,this.lat0,a);b=this.bl/b*Math.sqrt((1-this.es)/(1-d*d));1>b*b&&(b=1);var f;if(isNaN(this.longc)){d=c(this.e,this.lat1,Math.sin(this.lat1));f=c(this.e,this.lat2,Math.sin(this.lat2));this.el=0<=this.lat0?(b+Math.sqrt(b*b-1))*Math.pow(a,this.bl):(b-Math.sqrt(b*b-1))*Math.pow(a,this.bl);var d=Math.pow(d,this.bl),e=Math.pow(f,this.bl);f=this.el/d;a=.5*(f-1/f);f=(this.el*this.el-e*d)/(this.el*this.el+e*d);d=(e-d)/(e+d);e=h(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(f*Math.tan(.5*this.bl*e)/d)/this.bl;this.long0=h(this.long0);d=h(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*d)/a);this.alpha=Math.asin(b*Math.sin(this.gamma0))}else f=0<=this.lat0?b+Math.sqrt(b*b-1):b-Math.sqrt(b*b-1),this.el=f*Math.pow(a,this.bl),this.gamma0=Math.asin(Math.sin(this.alpha)/b),this.long0=this.longc-Math.asin(.5*(f-1/f)*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:0<=this.lat0?this.al/this.bl*Math.atan2(Math.sqrt(b*b-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(b*b-1),Math.cos(this.alpha))};b.forward=function(a){var b=a.y,e=h(a.x-this.long0);if(1E-10>=Math.abs(Math.abs(b)-d))e=0<b?-1:1,b=this.al/this.bl*Math.log(Math.tan(f+e*this.gamma0*.5)),e=-1*e*d*this.al/this.bl;else var b=c(this.e,b,Math.sin(b)),b=this.el/Math.pow(b,this.bl),k=.5*(b-1/b),u=Math.sin(this.bl*e),b=(k*Math.sin(this.gamma0)-u*Math.cos(this.gamma0))/(.5*(b+1/b)),b=1E-10>=Math.abs(Math.abs(b)-1)?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-b)/(1+b))/this.bl,e=1E-10>=Math.abs(Math.cos(this.bl*e))?this.al*this.bl*e:this.al*Math.atan2(k*Math.cos(this.gamma0)+u*Math.sin(this.gamma0),Math.cos(this.bl*e))/this.bl;this.no_rot?(a.x=this.x0+e,a.y=this.y0+b):(e-=this.uc,a.x=this.x0+b*Math.cos(this.alpha)+e*Math.sin(this.alpha),a.y=this.y0+e*Math.cos(this.alpha)-b*Math.sin(this.alpha));return a};b.inverse=function(b){var c,f;this.no_rot?(f=b.y-this.y0,c=b.x-this.x0):(f=(b.x-this.x0)*Math.cos(this.alpha)-(b.y-this.y0)*Math.sin(this.alpha),c=(b.y-this.y0)*Math.cos(this.alpha)+(b.x-this.x0)*Math.sin(this.alpha),c+=this.uc);var e=Math.exp(-1*this.bl*f/this.al);f=.5*(e-1/e);var k=Math.sin(this.bl*c/this.al),e=(k*Math.cos(this.gamma0)+f*Math.sin(this.gamma0))/(.5*(e+1/e)),p=Math.pow(this.el/Math.sqrt((1+e)/(1-e)),1/this.bl);1E-10>Math.abs(e-1)?(b.x=this.long0,b.y=d):1E-10>Math.abs(e+1)?(b.x=this.long0,b.y=-1*d):(b.y=a(this.e,p),b.x=h(this.long0-Math.atan2(f*Math.cos(this.gamma0)-k*Math.sin(this.gamma0),Math.cos(this.bl*c/this.al))/this.bl));return b};b.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":17,"../common/tsfnz":25}],59:[function(e,k,b){var c=e("../common/adjust_lon"),h=e("../common/asinz"),a=Math.PI/2;b.init=function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0)};b.forward=function(a){var b,g,e,h,k,u,p;g=a.y;e=c(a.x-this.long0);b=Math.sin(g);g=Math.cos(g);h=Math.cos(e);k=this.sin_p14*b+this.cos_p14*g*h;if(0<k||1E-10>=Math.abs(k))u=1*this.a*g*Math.sin(e),p=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*g*h);a.x=u;a.y=p;return a};b.inverse=function(b){var f,g,e,k,m;b.x-=this.x0;b.y-=this.y0;f=Math.sqrt(b.x*b.x+b.y*b.y);g=h(f/this.a);e=Math.sin(g);g=Math.cos(g);k=this.long0;if(1E-10>=Math.abs(f))return m=this.lat0,b.x=k,b.y=m,b;m=h(g*this.sin_p14+b.y*e*this.cos_p14/f);if(1E-10>=Math.abs(Math.abs(this.lat0)-a))return k=0<=this.lat0?c(this.long0+Math.atan2(b.x,-b.y)):c(this.long0-Math.atan2(-b.x,b.y)),b.x=k,b.y=m,b;k=c(this.long0+Math.atan2(b.x*e,f*this.cos_p14*g-b.y*this.sin_p14*e));b.x=k;b.y=m;return b};b.names=["ortho"]},{"../common/adjust_lon":5,"../common/asinz":7}],60:[function(e,k,b){var c=e("../common/e0fn"),h=e("../common/e1fn"),a=e("../common/e2fn"),d=e("../common/e3fn"),f=e("../common/adjust_lon"),g=e("../common/adjust_lat"),l=e("../common/mlfn"),y=e("../common/gN");b.init=function(){this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=c(this.es);this.e1=h(this.es);this.e2=a(this.es);this.e3=d(this.es);this.ml0=this.a*l(this.e0,this.e1,this.e2,this.e3,this.lat0)};b.forward=function(a){var b=a.y,c,d;c=f(a.x-this.long0);d=c*Math.sin(b);if(this.sphere)1E-10>=Math.abs(b)?(c*=this.a,b=-1*this.a*this.lat0):(c=this.a*Math.sin(d)/Math.tan(b),b=this.a*(g(b-this.lat0)+(1-Math.cos(d))/Math.tan(b)));else if(1E-10>=Math.abs(b))c*=this.a,b=-1*this.ml0;else{var e=y(this.a,this.e,Math.sin(b))/Math.tan(b);c=e*Math.sin(d);b=this.a*l(this.e0,this.e1,this.e2,this.e3,b)-this.ml0+e*(1-Math.cos(d))}a.x=c+this.x0;a.y=b+this.y0;return a};b.inverse=function(a){var b,c,d,g,e,h,k;b=a.x-this.x0;d=a.y-this.y0;if(this.sphere)if(1E-10>=Math.abs(d+this.a*this.lat0))b=f(b/this.a+this.long0),c=0;else{g=this.lat0+d/this.a;e=b*b/this.a/this.a+g*g;h=g;for(d=20;d;--d)if(k=Math.tan(h),k=-1*(g*(h*k+1)-h-.5*(h*h+e)*k)/((h-g)/k-1),h+=k,1E-10>=Math.abs(k)){c=h;break}b=f(this.long0+Math.asin(b*Math.tan(h)/this.a)/Math.sin(c))}else if(1E-10>=Math.abs(d+this.ml0))c=0,b=f(this.long0+b/this.a);else{g=(this.ml0+d)/this.a;e=b*b/this.a/this.a+g*g;h=g;var y,z;for(d=20;d;--d)if(k=this.e*Math.sin(h),k=Math.sqrt(1-k*k)*Math.tan(h),y=this.a*l(this.e0,this.e1,this.e2,this.e3,h),z=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),y/=this.a,k=(g*(k*y+1)-y-.5*k*(y*y+e))/(this.es*Math.sin(2*h)*(y*y+e-2*g*y)/(4*k)+(g-y)*(k*z-2/Math.sin(2*h))-z),h-=k,1E-10>=Math.abs(k)){c=h;break}k=Math.sqrt(1-this.es*Math.pow(Math.sin(c),2))*Math.tan(c);b=f(this.long0+Math.asin(b*k/this.a)/Math.sin(c))}a.x=b;a.y=c;return a};b.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":8,"../common/e1fn":9,"../common/e2fn":10,"../common/e3fn":11,"../common/gN":12,"../common/mlfn":15}],61:[function(e,k,b){var c=e("../common/adjust_lon"),h=e("../common/adjust_lat"),a=e("../common/pj_enfn"),d=e("../common/pj_mlfn"),f=e("../common/pj_inv_mlfn"),g=Math.PI/2,l=e("../common/asinz");b.init=function(){this.sphere?(this.n=1,this.es=this.m=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=a(this.es)};b.forward=function(a){var b,f;b=a.x;f=a.y;b=c(b-this.long0);if(this.sphere){if(this.m)for(var g=this.n*Math.sin(f),e=20;e;--e){var l=(this.m*f+Math.sin(f)-g)/(this.m+Math.cos(f));f-=l;if(1E-10>Math.abs(l))break}else f=1!==this.n?Math.asin(this.n*Math.sin(f)):f;b=this.a*this.C_x*b*(this.m+Math.cos(f));f*=this.a*this.C_y}else g=Math.sin(f),e=Math.cos(f),f=this.a*d(f,g,e,this.en),b=this.a*b*e/Math.sqrt(1-this.es*g*g);a.x=b;a.y=f;return a};b.inverse=function(a){var b,d,e;a.x-=this.x0;d=a.x/this.a;a.y-=this.y0;b=a.y/this.a;this.sphere?(b/=this.C_y,d/=this.C_x*(this.m+Math.cos(b)),this.m?b=l((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=l(Math.sin(b)/this.n)),d=c(d+this.long0),b=h(b)):(b=f(a.y/this.a,this.es,this.en),e=Math.abs(b),e<g?(e=Math.sin(b),d=this.long0+a.x*Math.sqrt(1-this.es*e*e)/(this.a*Math.cos(b)),d=c(d)):e-1E-10<g&&(d=this.long0));a.x=d;a.y=b;return a};b.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":7,"../common/pj_enfn":18,"../common/pj_inv_mlfn":19,"../common/pj_mlfn":20}],62:[function(e,k,b){b.init=function(){var b=this.lat0;this.lambda0=this.long0;var e=Math.sin(b),a=this.a,d=1/this.rf,d=2*d-Math.pow(d,2),f=this.e=Math.sqrt(d);this.R=this.k0*a*Math.sqrt(1-d)/(1-d*Math.pow(e,2));this.alpha=Math.sqrt(1+d/(1-d)*Math.pow(Math.cos(b),4));this.b0=Math.asin(e/this.alpha);this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-this.alpha*Math.log(Math.tan(Math.PI/4+b/2))+this.alpha*f/2*Math.log((1+f*e)/(1-f*e))};b.forward=function(b){var e=2*(Math.atan(Math.exp(-this.alpha*(Math.log(Math.tan(Math.PI/4-b.y/2))+this.e/2*Math.log((1+this.e*Math.sin(b.y))/(1-this.e*Math.sin(b.y))))+this.K))-Math.PI/4),a=this.alpha*(b.x-this.lambda0),d=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(e)+Math.cos(this.b0)*Math.cos(a))),e=Math.asin(Math.cos(this.b0)*Math.sin(e)-Math.sin(this.b0)*Math.cos(e)*Math.cos(a));b.y=this.R/2*Math.log((1+Math.sin(e))/(1-Math.sin(e)))+this.y0;b.x=this.R*d+this.x0;return b};b.inverse=function(b){for(var e=(b.x-this.x0)/this.R,a=2*(Math.atan(Math.exp((b.y-this.y0)/this.R))-Math.PI/4),d=Math.asin(Math.cos(this.b0)*Math.sin(a)+Math.sin(this.b0)*Math.cos(a)*Math.cos(e)),e=this.lambda0+Math.atan(Math.sin(e)/(Math.cos(this.b0)*Math.cos(e)-Math.sin(this.b0)*Math.tan(a)))/this.alpha,a=0,f=d,g=-1E3,l=0;1E-7<Math.abs(f-g);){if(20<++l)return;a=1/this.alpha*(Math.log(Math.tan(Math.PI/4+d/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(f))/2));g=f;f=2*Math.atan(Math.exp(a))-Math.PI/2}b.x=e;b.y=f;return b};b.names=["somerc"]},{}],63:[function(e,k,b){var c=Math.PI/2,h=e("../common/sign"),a=e("../common/msfnz"),d=e("../common/tsfnz"),f=e("../common/phi2z"),g=e("../common/adjust_lon");b.ssfn_=function(a,b,d){b*=d;return Math.tan(.5*(c+a))*Math.pow((1-b)/(1+b),.5*d)};b.init=function(){this.coslat0=Math.cos(this.lat0);this.sinlat0=Math.sin(this.lat0);this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&1E-10>=Math.abs(this.coslat0)&&(this.k0=.5*(1+h(this.lat0)*Math.sin(this.lat_ts))):(1E-10>=Math.abs(this.coslat0)&&(this.con=0<this.lat0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&1E-10>=Math.abs(this.coslat0)&&(this.k0=.5*this.cons*a(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/d(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=a(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-c,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))};b.forward=function(a){var b=a.x,f=a.y,e=Math.sin(f),h=Math.cos(f),k,r=g(b-this.long0);if(1E-10>=Math.abs(Math.abs(b-this.long0)-Math.PI)&&1E-10>=Math.abs(f+this.lat0))return a.x=NaN,a.y=NaN,a;if(this.sphere)b=2*this.k0/(1+this.sinlat0*e+this.coslat0*h*Math.cos(r)),a.x=this.a*b*h*Math.sin(r)+this.x0,a.y=this.a*b*(this.coslat0*e-this.sinlat0*h*Math.cos(r))+this.y0;else{k=2*Math.atan(this.ssfn_(f,e,this.e))-c;h=Math.cos(k);k=Math.sin(k);if(1E-10>=Math.abs(this.coslat0))return e=d(this.e,f*this.con,this.con*e),e=2*this.a*this.k0*e/this.cons,a.x=this.x0+e*Math.sin(b-this.long0),a.y=this.y0-this.con*e*Math.cos(b-this.long0),a;1E-10>Math.abs(this.sinlat0)?(b=2*this.a*this.k0/(1+h*Math.cos(r)),a.y=b*k):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*k+this.cosX0*h*Math.cos(r))),a.y=b*(this.cosX0*k-this.sinX0*h*Math.cos(r))+this.y0);a.x=b*h*Math.sin(r)+this.x0}return a};b.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b,d,e,h=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere){e=2*Math.atan(h/(.5*this.a*this.k0));b=this.long0;d=this.lat0;if(1E-10>=h)return a.x=b,a.y=d,a;d=Math.asin(Math.cos(e)*this.sinlat0+a.y*Math.sin(e)*this.coslat0/h);b=1E-10>Math.abs(this.coslat0)?0<this.lat0?g(this.long0+Math.atan2(a.x,-1*a.y)):g(this.long0+Math.atan2(a.x,a.y)):g(this.long0+Math.atan2(a.x*Math.sin(e),h*this.coslat0*Math.cos(e)-a.y*this.sinlat0*Math.sin(e)));a.x=b;a.y=d;return a}if(1E-10>=Math.abs(this.coslat0)){if(1E-10>=h)return d=this.lat0,b=this.long0,a.x=b,a.y=d,a;a.x*=this.con;a.y*=this.con;b=h*this.cons/(2*this.a*this.k0);d=this.con*f(this.e,b);b=this.con*g(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else d=2*Math.atan(h*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,1E-10>=h?e=this.X0:(e=Math.asin(Math.cos(d)*this.sinX0+a.y*Math.sin(d)*this.cosX0/h),b=g(this.long0+Math.atan2(a.x*Math.sin(d),h*this.cosX0*Math.cos(d)-a.y*this.sinX0*Math.sin(d)))),d=-1*f(this.e,Math.tan(.5*(c+e)));a.x=b;a.y=d;return a};b.names=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"]},{"../common/adjust_lon":5,"../common/msfnz":16,"../common/phi2z":17,"../common/sign":22,"../common/tsfnz":25}],64:[function(e,k,b){var c=e("./gauss"),h=e("../common/adjust_lon");b.init=function(){c.init.apply(this);this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))};b.forward=function(a){var b,f,e,l;a.x=h(a.x-this.long0);c.forward.apply(this,[a]);b=Math.sin(a.y);f=Math.cos(a.y);e=Math.cos(a.x);l=this.k0*this.R2/(1+this.sinc0*b+this.cosc0*f*e);a.x=l*f*Math.sin(a.x);a.y=l*(this.cosc0*b-this.sinc0*f*e);a.x=this.a*a.x+this.x0;a.y=this.a*a.y+this.y0;return a};b.inverse=function(a){var b,f,e,l;a.x=(a.x-this.x0)/this.a;a.y=(a.y-this.y0)/this.a;a.x/=this.k0;a.y/=this.k0;(l=Math.sqrt(a.x*a.x+a.y*a.y))?(e=2*Math.atan2(l,this.R2),b=Math.sin(e),f=Math.cos(e),e=Math.asin(f*this.sinc0+a.y*b*this.cosc0/l),b=Math.atan2(a.x*b,l*this.cosc0*f-a.y*this.sinc0*b)):(e=this.phic0,b=0);a.x=b;a.y=e;c.inverse.apply(this,[a]);a.x=h(a.x+this.long0);return a};b.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":48}],65:[function(e,k,b){var c=e("../common/pj_enfn"),h=e("../common/pj_mlfn"),a=e("../common/pj_inv_mlfn"),d=e("../common/adjust_lon"),f=Math.PI/2,g=e("../common/sign");b.init=function(){this.x0=void 0!==this.x0?this.x0:0;this.y0=void 0!==this.y0?this.y0:0;this.long0=void 0!==this.long0?this.long0:0;this.lat0=void 0!==this.lat0?this.lat0:0;this.es&&(this.en=c(this.es),this.ml0=h(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))};b.forward=function(a){var b=a.y,c=d(a.x-this.long0),f,e=Math.sin(b),g=Math.cos(b);if(this.es){var k=g*c,t=Math.pow(k,2),v=this.ep2*Math.pow(g,2),w=Math.pow(v,2),x=Math.pow(1E-10<Math.abs(g)?Math.tan(b):0,2),z=Math.pow(x,2);f=1-this.es*Math.pow(e,2);k/=Math.sqrt(f);b=h(b,e,g,this.en);f=this.a*this.k0*k*(1+t/6*(1-x+v+t/20*(5-18*x+z+14*v-58*x*v+t/42*(61+179*z-z*x-479*x))))+this.x0;c=this.a*this.k0*(b-this.ml0+e*c*k/2*(1+t/12*(5-x+9*v+4*w+t/30*(61+z-58*x+270*v-330*x*v+t/56*(1385+543*z-z*x-3111*x)))))+this.y0}else{e=g*Math.sin(c);if(1E-10>Math.abs(Math.abs(e)-1))return 93;f=.5*this.a*this.k0*Math.log((1+e)/(1-e))+this.x0;c=g*Math.cos(c)/Math.sqrt(1-Math.pow(e,2));e=Math.abs(c);if(1<=e){if(1E-10<e-1)return 93;c=0}else c=Math.acos(c);0>b&&(c=-c);c=this.a*this.k0*(c-this.lat0)+this.y0}a.x=f;a.y=c;return a};b.inverse=function(b){var c,e,h=1/this.a*(b.x-this.x0),k=1/this.a*(b.y-this.y0);if(this.es)if(c=this.ml0+k/this.k0,e=a(c,this.es,this.en),Math.abs(e)<f){var k=Math.cos(e),q=1E-10<Math.abs(k)?Math.tan(e):0,r=this.ep2*Math.pow(k,2),t=Math.pow(r,2),v=Math.pow(q,2),w=Math.pow(v,2);c=1-this.es*Math.pow(Math.sin(e),2);var h=h*Math.sqrt(c)/this.k0,x=Math.pow(h,2);c=e-c*q*x/(1-this.es)*.5*(1-x/12*(5+3*v-9*r*v+r-4*t-x/30*(61+90*v-252*r*v+45*w+46*r-x/56*(1385+3633*v+4095*w+1574*w*v))));e=d(this.long0+h*(1-x/6*(1+2*v+r-x/20*(5+28*v+24*w+8*r*v+6*r-x/42*(61+662*v+1320*w+720*w*v))))/k)}else c=f*g(k),e=0;else c=Math.exp(h/this.k0),e=.5*(c-1/c),r=Math.cos(this.lat0+k/this.k0),c=Math.sqrt((1-Math.pow(r,2))/(1+Math.pow(e,2))),c=Math.asin(c),0>k&&(c=-c),e=0===e&&0===r?0:d(Math.atan2(e,r)+this.long0);b.x=e;b.y=c;return b};b.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/pj_enfn":18,"../common/pj_inv_mlfn":19,"../common/pj_mlfn":20,"../common/sign":22}],66:[function(e,k,b){var c=e("../common/adjust_zone"),h=e("./tmerc");b.dependsOn="tmerc";b.init=function(){var a=c(this.zone,this.long0);if(void 0===a)throw Error("unknown utm zone");this.lat0=0;this.long0=(a+.5)*Math.PI/30-Math.PI;this.x0=5E5;this.y0=this.utmSouth?1E7:0;this.k0=.9996;h.init.apply(this);this.forward=h.forward;this.inverse=h.inverse};b.names=["Universal Transverse Mercator System","utm"]},{"../common/adjust_zone":6,"./tmerc":65}],67:[function(e,k,b){var c=e("../common/adjust_lon"),h=e("../common/asinz");b.init=function(){this.R=this.a};b.forward=function(a){var b=a.y,f=c(a.x-this.long0),e=h(2*Math.abs(b/Math.PI)),l=.5*Math.abs(Math.PI/f-f/Math.PI),k=l*l,m=Math.sin(e),e=Math.cos(e),e=e/(m+e-1),m=e*(2/m-1),u=m*m,p=Math.PI*this.R*(l*(e-u)+Math.sqrt(k*(e-u)*(e-u)-(u+k)*(e*e-u)))/(u+k);0>f&&(p=-p);f=this.x0+p;e=k+e;p=Math.PI*this.R*(m*e-l*Math.sqrt((u+k)*(k+1)-e*e))/(u+k);b=0<=b?this.y0+p:this.y0-p;a.x=f;a.y=b;return a};b.inverse=function(a){var b,f,e,l,h,k,u,p;a.x-=this.x0;a.y-=this.y0;h=Math.PI*this.R;b=a.x/h;e=a.y/h;l=b*b+e*e;h=-Math.abs(e)*(1+l);f=h-2*e*e+b*b;k=-2*h+1+2*e*e+l*l;u=(h-f*f/3/k)/k;p=2*Math.sqrt(-u/3);h=3*(e*e/k+(2*f*f*f/k/k/k-9*h*f/k/k)/27)/u/p;1<Math.abs(h)&&(h=0<=h?1:-1);h=Math.acos(h)/3;f=0<=a.y?(-p*Math.cos(h+Math.PI/3)-f/3/k)*Math.PI:-(-p*Math.cos(h+Math.PI/3)-f/3/k)*Math.PI;b=1E-10>Math.abs(b)?this.long0:c(this.long0+Math.PI*(l-1+Math.sqrt(1+2*(b*b-e*e)+l*l))/2/b);a.x=b;a.y=f;return a};b.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":7}],68:[function(e,k,b){var c=e("./datum_transform"),h=e("./adjust_axis"),a=e("./Proj"),d=e("./common/toPoint");k.exports=function g(b,e,k){var u;Array.isArray(k)&&(k=d(k));b.datum&&e.datum&&((1===b.datum.datum_type||2===b.datum.datum_type)&&"WGS84"!==e.datumCode||(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==b.datumCode)&&(u=new a("WGS84"),k=g(b,u,k),b=u);"enu"!==b.axis&&(k=h(b,!1,k));"longlat"===b.projName?k={x:.017453292519943295*k.x,y:.017453292519943295*k.y}:(b.to_meter&&(k={x:k.x*b.to_meter,y:k.y*b.to_meter}),k=b.inverse(k));b.from_greenwich&&(k.x+=b.from_greenwich);k=c(b.datum,e.datum,k);e.from_greenwich&&(k={x:k.x-e.grom_greenwich,y:k.y});"longlat"===e.projName?k={x:57.29577951308232*k.x,y:57.29577951308232*k.y}:(k=e.forward(k),e.to_meter&&(k={x:k.x/e.to_meter,y:k.y/e.to_meter}));return"enu"!==e.axis?h(e,!0,k):k}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":24,"./datum_transform":33}],69:[function(e,k,b){function c(a,b,c){a[b]=c.map(function(a){var b={};h(a,b);return b}).reduce(function(a,b){return f(a,b)},{})}function h(a,b){var d;Array.isArray(a)?(d=a.shift(),"PARAMETER"===d&&(d=a.shift()),1===a.length?Array.isArray(a[0])?(b[d]={},h(a[0],b[d])):b[d]=a[0]:a.length?"TOWGS84"===d?b[d]=a:(b[d]={},-1<["UNIT","PRIMEM","VERT_DATUM"].indexOf(d)?(b[d]={name:a[0].toLowerCase(),convert:a[1]},3===a.length&&(b[d].auth=a[2])):"SPHEROID"===d?(b[d]={name:a[0],a:a[1],rf:a[2]},4===a.length&&(b[d].auth=a[3])):-1<"GEOGCS GEOCCS DATUM VERT_CS COMPD_CS LOCAL_CS FITTED_CS LOCAL_DATUM".split(" ").indexOf(d)?(a[0]=["name",a[0]],c(b,d,a)):a.every(function(a){return Array.isArray(a)})?c(b,d,a):h(a,b[d])):b[d]=!0):b[a]=!0}function a(a){return.017453292519943295*a}function d(b){function c(a){var d=b.to_meter||1;return parseFloat(a,10)*d}"GEOGCS"===b.type?b.projName="longlat":"LOCAL_CS"===b.type?(b.projName="identity",b.local=!0):b.projName="object"===typeof b.PROJECTION?Object.keys(b.PROJECTION)[0]:b.PROJECTION;b.UNIT&&(b.units=b.UNIT.name.toLowerCase(),"metre"===b.units&&(b.units="meter"),b.UNIT.convert&&("GEOGCS"===b.type?b.DATUM&&b.DATUM.SPHEROID&&(b.to_meter=parseFloat(b.UNIT.convert,10)*b.DATUM.SPHEROID.a):b.to_meter=parseFloat(b.UNIT.convert,10)));if(b.GEOGCS){b.datumCode=b.GEOGCS.DATUM?b.GEOGCS.DATUM.name.toLowerCase():b.GEOGCS.name.toLowerCase();"d_"===b.datumCode.slice(0,2)&&(b.datumCode=b.datumCode.slice(2));if("new_zealand_geodetic_datum_1949"===b.datumCode||"new_zealand_1949"===b.datumCode)b.datumCode="nzgd49";"wgs_1984"===b.datumCode&&("Mercator_Auxiliary_Sphere"===b.PROJECTION&&(b.sphere=!0),b.datumCode="wgs84");"_ferro"===b.datumCode.slice(-6)&&(b.datumCode=b.datumCode.slice(0,-6));"_jakarta"===b.datumCode.slice(-8)&&(b.datumCode=b.datumCode.slice(0,-8));~b.datumCode.indexOf("belge")&&(b.datumCode="rnb72");b.GEOGCS.DATUM&&b.GEOGCS.DATUM.SPHEROID&&(b.ellps=b.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===b.ellps.toLowerCase().slice(0,13)&&(b.ellps="intl"),b.a=b.GEOGCS.DATUM.SPHEROID.a,b.rf=parseFloat(b.GEOGCS.DATUM.SPHEROID.rf,10));~b.datumCode.indexOf("osgb_1936")&&(b.datumCode="osgb36")}b.b&&!isFinite(b.b)&&(b.b=b.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",a],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",a],["x0","false_easting",c],["y0","false_northing",c],["long0","central_meridian",a],["lat0","latitude_of_origin",a],["lat0","standard_parallel_1",a],["lat1","standard_parallel_1",a],["lat2","standard_parallel_2",a],["alpha","azimuth",a],["srsCode","name"]].forEach(function(a){var c=a[0],d=a[1];!(c in b)&&d in b&&(b[c]=b[d],3===a.length&&(b[c]=a[2](b[c])))});b.long0||!b.longc||"Albers_Conic_Equal_Area"!==b.projName&&"Lambert_Azimuthal_Equal_Area"!==b.projName||(b.long0=b.longc);b.lat_ts||!b.lat1||"Stereographic_South_Pole"!==b.projName&&"Polar Stereographic (variant B)"!==b.projName||(b.lat0=.017453292519943295*(0<b.lat1?90:-90),b.lat_ts=b.lat1)}var f=e("./extend");k.exports=function(a,b){var c=JSON.parse((","+a).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]').replace(/,\["VERTCS".+/,"")),e=c.shift(),k=c.shift();c.unshift(["name",k]);c.unshift(["type",e]);c.unshift("output");e={};h(c,e);d(e.output);return f(b,e.output)}},{"./extend":36}],70:[function(e,k,b){function c(a){var b=a.zoneNumber;if(0>b||60<b)return null;var d=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),e,h,k,p,q;p=a.easting-5E5;h=a.northing;"N">a.zoneLetter&&(h-=1E7);h=h/.9996/6367449.145945056;q=h+(3*d/2-27*d*d*d/32)*Math.sin(2*h)+(21*d*d/16-55*d*d*d*d/32)*Math.sin(4*h)+151*d*d*d/96*Math.sin(6*h);e=6378137/Math.sqrt(1-.00669438*Math.sin(q)*Math.sin(q));d=Math.tan(q)*Math.tan(q);h=.006739496752268451*Math.cos(q)*Math.cos(q);k=6335439.32722994/Math.pow(1-.00669438*Math.sin(q)*Math.sin(q),1.5);p/=.9996*e;e=q-e*Math.tan(q)/k*(p*p/2-(5+3*d+10*h-4*h*h-.06065547077041606)*p*p*p*p/24+(61+90*d+298*h+45*d*d-1.6983531815716497-3*h*h)*p*p*p*p*p*p/720);e=e/Math.PI*180;p=(p-(1+2*d+h)*p*p*p/6+(5-2*h+28*d-3*h*h+.05391597401814761+24*d*d)*p*p*p*p*p/120)/Math.cos(q);p=6*(b-1)-180+3+p/Math.PI*180;a.accuracy?(a=c({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber}),a={top:a.lat,right:a.lon,bottom:e,left:p}):a={lat:e,lon:p};return a}function h(a){a%=6;0===a&&(a=6);return a}function a(a){if(a&&0===a.length)throw"MGRSPoint coverting from nothing";for(var b=a.length,c=null,e="",k,u=0;!/[A-Z]/.test(k=a.charAt(u));){if(2<=u)throw"MGRSPoint bad conversion from: "+a;e+=k;u++}e=parseInt(e,10);if(0===u||u+3>b)throw"MGRSPoint bad conversion from: "+a;k=a.charAt(u++);if("A">=k||"B"===k||"Y"===k||"Z"<=k||"I"===k||"O"===k)throw"MGRSPoint zone letter "+k+" not handled: "+a;var c=a.substring(u,u+=2),p=h(e),q;q=c.charAt(0);for(var r="AJSAJS".charCodeAt(p-1),t=1E5,v=!1;r!==q.charCodeAt(0);){r++;73===r&&r++;79===r&&r++;if(90<r){if(v)throw"Bad character: "+q;r=65;v=!0}t+=1E5}q=t;c=c.charAt(1);if("V"<c)throw"MGRSPoint given invalid Northing "+c;p="AFAFAF".charCodeAt(p-1);r=0;for(t=!1;p!==c.charCodeAt(0);){p++;73===p&&p++;79===p&&p++;if(86<p){if(t)throw"Bad character: "+c;p=65;t=!0}r+=1E5}for(p=r;p<d(k);)p+=2E6;b-=u;if(0!==b%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var b=b/2,r=c=0,w;0<b&&(w=1E5/Math.pow(10,b),c=a.substring(u,u+b),c=parseFloat(c)*w,a=a.substring(u+b),r=parseFloat(a)*w);return{easting:c+q,northing:r+p,zoneLetter:k,zoneNumber:e,accuracy:w}}function d(a){var b;switch(a){case "C":b=11E5;break;case "D":b=2E6;break;case "E":b=28E5;break;case "F":b=37E5;break;case "G":b=46E5;break;case "H":b=55E5;break;case "J":b=64E5;break;case "K":b=73E5;break;case "L":b=82E5;break;case "M":b=91E5;break;case "N":b=0;break;case "P":b=8E5;break;case "Q":b=17E5;break;case "R":b=26E5;break;case "S":b=35E5;break;case "T":b=44E5;break;case "U":b=53E5;break;case "V":b=62E5;break;case "W":b=7E6;break;case "X":b=79E5;break;default:b=-1}if(0<=b)return b;throw"Invalid zone letter: "+a;}b.forward=function(a,b){var c,d,e,k=a[1],p=a[0],q;c=Math.PI/180*k;e=Math.PI/180*p;var r,t;t=Math.floor((p+180)/6)+1;180===p&&(t=60);56<=k&&64>k&&3<=p&&12>p&&(t=32);72<=k&&84>k&&(0<=p&&9>p?t=31:9<=p&&21>p?t=33:21<=p&&33>p?t=35:33<=p&&42>p&&(t=37));r=Math.PI/180*(6*(t-1)-180+3);p=6378137/Math.sqrt(1-.00669438*Math.sin(c)*Math.sin(c));q=Math.tan(c)*Math.tan(c);d=.006739496752268451*Math.cos(c)*Math.cos(c);e=Math.cos(c)*(e-r);c=.9996*(6378137*(.9983242984503243*c-.002514607064228144*Math.sin(2*c)+2.639046602129982E-6*Math.sin(4*c)-3.4180461016968582E-9*Math.sin(6*c))+p*Math.tan(c)*(e*e/2+(5-q+9*d+4*d*d)*e*e*e*e/24+(61-58*q+q*q+600*d-2.2240339282485886)*e*e*e*e*e*e/720));0>k&&(c+=1E7);c=Math.round(c);d=Math.round(.9996*p*(e+(1-q+d)*e*e*e/6+(5-18*q+q*q+72*d-.39089081163157013)*e*e*e*e*e/120)+5E5);e=t;q="Z";84>=k&&72<=k?q="X":72>k&&64<=k?q="W":64>k&&56<=k?q="V":56>k&&48<=k?q="U":48>k&&40<=k?q="T":40>k&&32<=k?q="S":32>k&&24<=k?q="R":24>k&&16<=k?q="Q":16>k&&8<=k?q="P":8>k&&0<=k?q="N":0>k&&-8<=k?q="M":-8>k&&-16<=k?q="L":-16>k&&-24<=k?q="K":-24>k&&-32<=k?q="J":-32>k&&-40<=k?q="H":-40>k&&-48<=k?q="G":-48>k&&-56<=k?q="F":-56>k&&-64<=k?q="E":-64>k&&-72<=k?q="D":-72>k&&-80<=k&&(q="C");k=b||5;t="00000"+d;p="00000"+c;q=e+q;r=h(e);d=Math.floor(d/1E5);e=Math.floor(c/1E5)%20;--r;c="AJSAJS".charCodeAt(r);r="AFAFAF".charCodeAt(r);d=c+d-1;e=r+e;var v=!1;90<d&&(d=d-90+65-1,v=!0);(73===d||73>c&&73<d||(73<d||73>c)&&v)&&d++;if(79===d||79>c&&79<d||(79<d||79>c)&&v)d++,73===d&&d++;90<d&&(d=d-90+65-1);86<e?(e=e-86+65-1,v=!0):v=!1;(73===e||73>r&&73<e||(73<e||73>r)&&v)&&e++;if(79===e||79>r&&79<e||(79<e||79>r)&&v)e++,73===e&&e++;86<e&&(e=e-86+65-1);c=String.fromCharCode(d)+String.fromCharCode(e);return q+c+t.substr(t.length-5,k)+p.substr(p.length-5,k)};b.inverse=function(b){b=c(a(b.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat,b.lon,b.lat]:[b.left,b.bottom,b.right,b.top]};b.toPoint=function(b){b=c(a(b.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat]:[(b.left+b.right)/2,(b.top+b.bottom)/2]}},{}]},{},[38])(38)});(function(n){var e,k;if("function"===typeof define&&define.amd)define(["leaflet","proj4"],n);else if("object"===typeof module&&"object"===typeof module.exports)e=require("leaflet"),k=require("proj4"),module.exports=n(e,k);else{if("undefined"===typeof window.L||"undefined"===typeof window.proj4)throw"Leaflet and proj4 must be loaded first";n(window.L,window.proj4)}})(function(n,e){n.Proj={};n.Proj._isProj4Obj=function(e){return"undefined"!==typeof e.inverse&&"undefined"!==typeof e.forward};n.Proj.Projection=n.Class.extend({initialize:function(e,b,c){var h=n.Proj._isProj4Obj(e);this._proj=h?e:this._projFromCodeDef(e,b);this.bounds=h?b:c},project:function(e){e=this._proj.forward([e.lng,e.lat]);return new n.Point(e[0],e[1])},unproject:function(e,b){var c=this._proj.inverse([e.x,e.y]);return new n.LatLng(c[1],c[0],b)},_projFromCodeDef:function(k,b){if(b)e.defs(k,b);else if(void 0===e.defs[k]){var c=k.split(":");3<c.length&&(k=c[c.length-3]+":"+c[c.length-1]);if(void 0===e.defs[k])throw"No projection definition for code "+k;}return e(k)}});n.Proj.CRS=n.Class.extend({includes:n.CRS,options:{transformation:new n.Transformation(1,0,-1,0)},initialize:function(e,b,c){var h;n.Proj._isProj4Obj(e)?(h=e.srsCode,c=b||{},this.projection=new n.Proj.Projection(e,c.bounds)):(h=e,c=c||{},this.projection=new n.Proj.Projection(h,b,c.bounds));n.Util.setOptions(this,c);this.code=h;this.transformation=this.options.transformation;this.options.origin&&(this.transformation=new n.Transformation(1,-this.options.origin[0],-1,this.options.origin[1]));if(this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions)for(this._scales=[],e=this.options.resolutions.length-1;0<=e;e--)this.options.resolutions[e]&&(this._scales[e]=1/this.options.resolutions[e]);this.infinite=!this.options.bounds},scale:function(e){var b=Math.floor(e),c;if(e===b)return this._scales[e];c=this._scales[b];return c+(this._scales[b+1]-c)*(e-b)},zoom:function(e){var b=this._closestElement(this._scales,e),c=this._scales.indexOf(b),h;if(e===b)return c;h=this._scales[c+1];return void 0===h?Infinity:(e-b)/(h-b)+c},distance:n.CRS.Earth.distance,R:n.CRS.Earth.R,_closestElement:function(e,b){for(var c,h=e.length;h--;)e[h]<=b&&(void 0===c||c<e[h])&&(c=e[h]);return c}});n.Proj.GeoJSON=n.GeoJSON.extend({initialize:function(e,b){this._callLevel=0;n.GeoJSON.prototype.initialize.call(this,e,b)},addData:function(e){var b;e&&(e.crs&&"name"===e.crs.type?b=new n.Proj.CRS(e.crs.properties.name):e.crs&&e.crs.type&&(b=new n.Proj.CRS(e.crs.type+":"+e.crs.properties.code)),void 0!==b&&(this.options.coordsToLatLng=function(c){c=n.point(c[0],c[1]);return b.projection.unproject(c)}));this._callLevel++;try{n.GeoJSON.prototype.addData.call(this,e)}finally{this._callLevel--,0===this._callLevel&&delete this.options.coordsToLatLng}}});n.Proj.geoJson=function(e,b){return new n.Proj.GeoJSON(e,b)};n.Proj.ImageOverlay=n.ImageOverlay.extend({initialize:function(e,b,c){n.ImageOverlay.prototype.initialize.call(this,e,null,c);this._projectedBounds=b},_animateZoom:function(e){var b=this._map.getZoomScale(e.zoom),c=n.point(this._projectedBounds.min.x,this._projectedBounds.max.y);e=this._projectedToNewLayerPoint(c,e.zoom,e.center);n.DomUtil.setTransform(this._image,e,b)},_reset:function(){var e=this._map.getZoom(),b=this._map.getPixelOrigin(),e=n.bounds(this._transform(this._projectedBounds.min,e)._subtract(b),this._transform(this._projectedBounds.max,e)._subtract(b)),b=e.getSize();n.DomUtil.setPosition(this._image,e.min);this._image.style.width=b.x+"px";this._image.style.height=b.y+"px"},_projectedToNewLayerPoint:function(e,b,c){var h=this._map.getSize()._divideBy(2);c=this._map.project(c,b)._subtract(h)._round().add(this._map._getMapPanePos());return this._transform(e,b)._subtract(c)},_transform:function(e,b){var c=this._map.options.crs,h=c.transformation,c=c.scale(b);return h.transform(e,c)}});n.Proj.imageOverlay=function(e,b,c){return new n.Proj.ImageOverlay(e,b,c)};return n.Proj});L.TileLayer.ChinaProvider=L.TileLayer.extend({initialize:function(n,e){var k=L.TileLayer.ChinaProvider.providers,b=n.split("."),c=b[0],b=k[c][b[1]][b[2]];e.subdomains=k[c].Subdomains;L.TileLayer.prototype.initialize.call(this,b,e)}});L.TileLayer.ChinaProvider.providers={TianDiTu:{Normal:{Map:"http://t{s}.tianditu.cn/DataServer?T\x3dvec_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}",Annotion:"http://t{s}.tianditu.cn/DataServer?T\x3dcva_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}"},Satellite:{Map:"http://t{s}.tianditu.cn/DataServer?T\x3dimg_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}",Annotion:"http://t{s}.tianditu.cn/DataServer?T\x3dcia_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}"},Terrain:{Map:"http://t{s}.tianditu.cn/DataServer?T\x3dter_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}",Annotion:"http://t{s}.tianditu.cn/DataServer?T\x3dcta_w\x26X\x3d{x}\x26Y\x3d{y}\x26L\x3d{z}"},Subdomains:"01234567".split("")},GaoDe:{Normal:{Map:"http://webrd0{s}.is.autonavi.com/appmaptile?lang\x3dzh_cn\x26size\x3d1\x26scale\x3d1\x26style\x3d8\x26x\x3d{x}\x26y\x3d{y}\x26z\x3d{z}"},Satellite:{Map:"http://webst0{s}.is.autonavi.com/appmaptile?style\x3d6\x26x\x3d{x}\x26y\x3d{y}\x26z\x3d{z}",Annotion:"http://webst0{s}.is.autonavi.com/appmaptile?style\x3d8\x26x\x3d{x}\x26y\x3d{y}\x26z\x3d{z}"},Subdomains:["1","2","3","4"]},Google:{Normal:{Map:"http://www.google.cn/maps/vt?lyrs\x3dm@189\x26gl\x3dcn\x26x\x3d{x}\x26y\x3d{y}\x26z\x3d{z}"},Satellite:{Map:"http://www.google.cn/maps/vt?lyrs\x3ds@189\x26gl\x3dcn\x26x\x3d{x}\x26y\x3d{y}\x26z\x3d{z}"},Subdomains:[]},Geoq:{Normal:{Map:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}",Color:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetColor/MapServer/tile/{z}/{y}/{x}",PurplishBlue:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}",Gray:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetGray/MapServer/tile/{z}/{y}/{x}",Warm:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetWarm/MapServer/tile/{z}/{y}/{x}",Cold:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetCold/MapServer/tile/{z}/{y}/{x}"},Subdomains:[]}};L.tileLayer.chinaProvider=function(n,e){return new L.TileLayer.ChinaProvider(n,e)};(function(n){var e;if("function"===typeof define&&define.amd)define(["leaflet"],n);else if("undefined"!==typeof module)e=require("leaflet"),module.exports=n(e);else{if("undefined"===typeof window.L)throw Error("Leaflet must be loaded first");n(window.L)}})(function(n){n.Circle.SECTIONS_COUNT=64;n.Circle.toPolygon=function(e,k,b){b=b||e._map;if(!b)throw Error("Can't figure out points without adding the feature to the map");var c=[],h=b.options.crs,a=2*Math.PI,d=0,f;h===n.CRS.EPSG3857?(f=b.latLngToLayerPoint.bind(b),h=b.layerPointToLatLng.bind(b),b=e._radius):(f=h.projection.project.bind(h.projection),h=h.projection.unproject.bind(h.projection),b=e._mRadius);e=f(e._latlng);k=k||n.Circle.SECTIONS_COUNT;for(var g=0;g<k;g++)d-=a/k,f=new n.Point(e.x+b*Math.cos(d),e.y+b*Math.sin(d)),0<g&&f.equals(c[g-1])||c.push(h(f));return c};n.Circle.prototype.toPolygon=function(e,k){return n.Circle.toPolygon(this,e,k||this._map)}});(function(n){var e;if("function"===typeof define&&define.amd)define(["leaflet"],n);else if("undefined"!==typeof module)e=require("leaflet"),module.exports=n(e);else{if("undefined"===typeof window.L)throw"Leaflet must be loaded first";n(window.L)}})(function(n){n.Polyline._flat=n.Polyline._flat||function(e){return!n.Util.isArray(e[0])||"object"!==typeof e[0][0]&&"undefined"!==typeof e[0][0]};n.GeometryUtil=n.extend(n.GeometryUtil||{},{distance:function(e,k,b){return e.latLngToLayerPoint(k).distanceTo(e.latLngToLayerPoint(b))},distanceSegment:function(e,k,b,c){k=e.latLngToLayerPoint(k);b=e.latLngToLayerPoint(b);e=e.latLngToLayerPoint(c);return n.LineUtil.pointToSegmentDistance(k,b,e)},readableDistance:function(e,k){var b;"imperial"!==k?b=1E3<e?(e/1E3).toFixed(2)+" km":Math.ceil(e)+" m":(e*=1.09361,b=1760<e?(e/1760).toFixed(2)+" miles":Math.ceil(e)+" yd");return b},belongsSegment:function(e,k,b,c){c=void 0===c?.2:c;var h=k.distanceTo(b);return(k.distanceTo(e)+e.distanceTo(b)-h)/h<c},length:function(e){e=n.GeometryUtil.accumulatedLengths(e);return 0<e.length?e[e.length-1]:0},accumulatedLengths:function(e){"function"==typeof e.getLatLngs&&(e=e.getLatLngs());if(0===e.length)return[];for(var k=0,b=[0],c=0,h=e.length-1;c<h;c++)k+=e[c].distanceTo(e[c+1]),b.push(k);return b},closestOnSegment:function(e,k,b,c){var h=e.getMaxZoom();Infinity===h&&(h=e.getZoom());k=e.project(k,h);b=e.project(b,h);c=e.project(c,h);c=n.LineUtil.closestPointOnSegment(k,b,c);return e.unproject(c,h)},closest:function(e,k,b,c){var h,a=Infinity,d=null,f;if(k instanceof Array){if(k[0]instanceof Array&&"number"!==typeof k[0][0]){for(f=0;f<k.length;f++){var g=n.GeometryUtil.closest(e,k[f],b,c);g.distance<a&&(a=g.distance,d=g)}return d}if(k[0]instanceof n.LatLng||"number"===typeof k[0][0]||"number"===typeof k[0].lat)k=n.polyline(k);else return d}if(!(k instanceof n.Polyline))return d;h=JSON.parse(JSON.stringify(k.getLatLngs().slice(0)));if(k instanceof n.Polygon){var l=function(a){if(n.Polyline._flat(a))a.push(a[0]);else for(var b=0;b<a.length;b++)l(a[b])};l(h)}if(n.Polyline._flat(h)){if(c){f=0;for(k=h.length;f<k;f++)g=h[f],c=n.GeometryUtil.distance(e,b,g),c<a&&(a=c,d=g,d.distance=c);return d}f=0;for(k=h.length;f<k-1;f++){var g=h[f],y=h[f+1];c=n.GeometryUtil.distanceSegment(e,b,g,y);c<=a&&(a=c,d=n.GeometryUtil.closestOnSegment(e,b,g,y),d.distance=c)}}else for(f=0;f<h.length;f++)g=n.GeometryUtil.closest(e,h[f],b,c),g.distance<a&&(a=g.distance,d=g);return d},closestLayer:function(e,k,b){for(var c=Infinity,h=null,a=null,d=Infinity,f=0,g=k.length;f<g;f++){var l=k[f];if(l instanceof n.LayerGroup)a=n.GeometryUtil.closestLayer(e,l.getLayers(),b),a.distance<c&&(c=a.distance,h=a);else{if("function"==typeof l.getLatLng)a=l.getLatLng(),d=n.GeometryUtil.distance(e,b,a);else if(a=n.GeometryUtil.closest(e,l,b))d=a.distance;d<c&&(c=d,h={layer:l,latlng:a,distance:d})}}return h},nClosestLayers:function(e,k,b,c){c="number"===typeof c?c:k.length;if(1>c||1>k.length)return null;for(var h=[],a,d,f=0,g=k.length;f<g;f++){var l=k[f];if(l instanceof n.LayerGroup)d=n.GeometryUtil.closestLayer(e,l.getLayers(),b),h.push(d);else{if("function"==typeof l.getLatLng)d=l.getLatLng(),a=n.GeometryUtil.distance(e,b,d);else if(d=n.GeometryUtil.closest(e,l,b))a=d.distance;h.push({layer:l,latlng:d,distance:a})}}h.sort(function(a,b){return a.distance-b.distance});return h.length>c?h.slice(0,c):h},layersWithin:function(e,k,b,c){c="number"==typeof c?c:Infinity;for(var h=[],a=null,d=0,f=0,g=k.length;f<g;f++){var l=k[f];if("function"==typeof l.getLatLng)a=l.getLatLng(),d=n.GeometryUtil.distance(e,b,a);else if(a=n.GeometryUtil.closest(e,l,b))d=a.distance;a&&d<c&&h.push({layer:l,latlng:a,distance:d})}return h.sort(function(a,b){return a.distance-b.distance})},closestLayerSnap:function(e,k,b,c,h){c="number"==typeof c?c:Infinity;h="boolean"==typeof h?h:!0;k=n.GeometryUtil.closestLayer(e,k,b);if(!k||k.distance>c)return null;h&&"function"==typeof k.layer.getLatLngs&&(h=n.GeometryUtil.closest(e,k.layer,k.latlng,!0),h.distance<c&&(k.latlng=h,k.distance=n.GeometryUtil.distance(e,h,b)));return k},interpolateOnPointSegment:function(e,k,b){return n.point(e.x*(1-b)+b*k.x,e.y*(1-b)+b*k.y)},interpolateOnLine:function(e,k,b){k=k instanceof n.Polyline?k.getLatLngs():k;var c=k.length;if(2>c)return null;b=Math.max(Math.min(b,1),0);if(0===b)return{latLng:k[0]instanceof n.LatLng?k[0]:n.latLng(k[0]),predecessor:-1};if(1==b)return{latLng:k[k.length-1]instanceof n.LatLng?k[k.length-1]:n.latLng(k[k.length-1]),predecessor:k.length-2};var h=e.getMaxZoom();Infinity===h&&(h=e.getZoom());for(var a=[],d=0,f=0;f<c;f++)a[f]=e.project(k[f],h),0<f&&(d+=a[f-1].distanceTo(a[f]));b*=d;var d=a[0],f=a[1],g=0,l=d.distanceTo(f);for(k=1;k<c&&l<b;k++)d=f,g=l,f=a[k],l+=d.distanceTo(f);c=n.GeometryUtil.interpolateOnPointSegment(d,f,0!==l-g?(b-g)/(l-g):0);return{latLng:e.unproject(c,h),predecessor:k-2}},locateOnLine:function(e,k,b){var c=k.getLatLngs();if(b.equals(c[0]))return 0;if(b.equals(c[c.length-1]))return 1;e=n.GeometryUtil.closest(e,k,b,!1);for(var h=n.GeometryUtil.accumulatedLengths(c),a=h[h.length-1],d=0,f=!1,g=0,l=c.length-1;g<l;g++){var y=c[g],m=c[g+1],d=h[g];if(n.GeometryUtil.belongsSegment(e,y,m)){d+=y.distanceTo(e);f=!0;break}}if(!f)throw"Could not interpolate "+b.toString()+" within "+k.toString();return d/a},reverse:function(e){return n.polyline(e.getLatLngs().slice(0).reverse())},extract:function(e,k,b,c){if(b>c)return n.GeometryUtil.extract(e,n.GeometryUtil.reverse(k),1-b,1-c);b=Math.max(Math.min(b,1),0);c=Math.max(Math.min(c,1),0);var h=k.getLatLngs(),a=n.GeometryUtil.interpolateOnLine(e,k,b),d=n.GeometryUtil.interpolateOnLine(e,k,c);if(b==c)return[n.GeometryUtil.interpolateOnLine(e,k,c).latLng];-1==a.predecessor&&(a.predecessor=0);-1==d.predecessor&&(d.predecessor=0);e=h.slice(a.predecessor+1,d.predecessor+1);e.unshift(a.latLng);e.push(d.latLng);return e},isBefore:function(e,k){if(!k)return!1;var b=e.getLatLngs(),c=k.getLatLngs();return b[b.length-1].equals(c[0])},isAfter:function(e,k){if(!k)return!1;var b=e.getLatLngs(),c=k.getLatLngs();return b[0].equals(c[c.length-1])},startsAtExtremity:function(e,k){if(!k)return!1;var b=e.getLatLngs(),c=k.getLatLngs(),b=b[0];return b.equals(c[0])||b.equals(c[c.length-1])},computeAngle:function(e,k){return 180*Math.atan2(k.y-e.y,k.x-e.x)/Math.PI},computeSlope:function(e,k){var b=(k.y-e.y)/(k.x-e.x);return{a:b,b:e.y-b*e.x}},rotatePoint:function(e,k,b,c){var h=e.getMaxZoom();Infinity===h&&(h=e.getZoom());b=b*Math.PI/180;k=e.project(k,h);c=e.project(c,h);return e.unproject(new n.Point(Math.cos(b)*(k.x-c.x)-Math.sin(b)*(k.y-c.y)+c.x,Math.sin(b)*(k.x-c.x)+Math.cos(b)*(k.y-c.y)+c.y),h)},bearing:function(e,k){var b=Math.PI/180,c=e.lat*b,h=k.lat*b,a=e.lng*b,b=k.lng*b,c=(180*Math.atan2(Math.sin(b-a)*Math.cos(h),Math.cos(c)*Math.sin(h)-Math.sin(c)*Math.cos(h)*Math.cos(b-a))/Math.PI+360)%360;return 180<=c?c-360:c},destination:function(e,k,b){var c=Math.PI/180,h=180/Math.PI,a=e.lat*c;k=(k+360)%360*c;var d=Math.sin(a),a=Math.cos(a),f=Math.cos(b/6378137),g=Math.sin(b/6378137);b=Math.asin(d*f+a*g*Math.cos(k));e=e.lng*c+Math.atan2(Math.sin(k)*g*a,f-d*Math.sin(b));e*=h;return n.latLng([b*h,180<e?e-360:-180>e?e+360:e])}});return n.GeometryUtil});(function(n){L.Icon.Pulse=L.DivIcon.extend({options:{className:"",iconSize:[12,12],color:"red",animate:!0,heartbeat:1},initialize:function(e){L.setOptions(this,e);var k="lpi-"+(new Date).getTime()+"-"+Math.round(1E5*Math.random()),b=["background-color: "+this.options.color],c=["box-shadow: 0 0 6px 2px "+this.options.color,"animation: pulsate "+this.options.heartbeat+"s ease-out","animation-iteration-count: infinite","animation-delay: 0s"];this.options.animate||(c.push("animation: none"),c.push("box-shadow:none"));b=["."+k+"{"+b.join(";")+";}","."+k+":after{"+c.join(";")+";}"].join("");c=document.createElement("style");c.styleSheet?c.styleSheet.cssText=b:c.appendChild(document.createTextNode(b));document.getElementsByTagName("head")[0].appendChild(c);this.options.className=this.options.className+" leaflet-pulsing-icon "+k;L.DivIcon.prototype.initialize.call(this,e)}});L.icon.pulse=function(e){return new L.Icon.Pulse(e)};L.Marker.Pulse=L.Marker.extend({initialize:function(e,k){k.icon=L.icon.pulse(k);L.Marker.prototype.initialize.call(this,e,k)}});L.marker.pulse=function(e,k){return new L.Marker.Pulse(e,k)}})(window);